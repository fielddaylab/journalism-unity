<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta content="width=device-width, initial-scale=1" name="viewport">
<title>Journalism Table Prototype</title>
<style title="Twine CSS">@keyframes appear{0%{opacity:0}to{opacity:1}}@keyframes fade-in-out{0%,to{opacity:0}50%{opacity:1}}@keyframes rumble{25%{top:-0.1em}75%{top:0.1em}0%,to{top:0px}}@keyframes shudder{25%{left:0.1em}75%{left:-0.1em}0%,to{left:0px}}@keyframes buoy{25%{top:0.25em}75%{top:-0.25em}0%,to{top:0px}}@keyframes sway{25%{left:0.25em}75%{left:-0.25em}0%,to{left:0px}}@keyframes pulse{0%{transform:scale(0, 0)}20%{transform:scale(1.2, 1.2)}40%{transform:scale(0.9, 0.9)}60%{transform:scale(1.05, 1.05)}80%{transform:scale(0.925, 0.925)}to{transform:scale(1, 1)}}@keyframes zoom-in{0%{transform:scale(0, 0)}to{transform:scale(1, 1)}}@keyframes shudder-in{0%, to{transform:translateX(0em)}5%, 25%, 45%{transform:translateX(-1em)}15%, 35%, 55%{transform:translateX(1em)}65%{transform:translateX(-0.6em)}75%{transform:translateX(0.6em)}85%{transform:translateX(-0.2em)}95%{transform:translateX(0.2em)}}@keyframes rumble-in{0%, to{transform:translateY(0em)}5%, 25%, 45%{transform:translateY(-1em)}15%, 35%, 55%{transform:translateY(1em)}65%{transform:translateY(-0.6em)}75%{transform:translateY(0.6em)}85%{transform:translateY(-0.2em)}95%{transform:translateY(0.2em)}}@keyframes fidget{0%, 8.1%, 82.1%, 31.1%, 38.1%, 44.1%, 40.1%, 47.1%, 74.1%, 16.1%, 27.1%, 72.1%, 24.1%, 95.1%, 6.1%, 36.1%, 20.1%, 4.1%, 91.1%, 14.1%, 87.1%, to{left:0px;top:0px}8%, 82%, 31%, 38%, 44%{left:-1px}40%, 47%, 74%, 16%, 27%{left:1px}72%, 24%, 95%, 6%, 36%{top:-1px}20%, 4%, 91%, 14%, 87%{top:1px}}@keyframes slide-right{0%{transform:translateX(-100vw)}}@keyframes slide-left{0%{transform:translateX(100vw)}}@keyframes slide-up{0%{transform:translateY(100vh)}}@keyframes slide-down{0%{transform:translateY(-100vh)}}@keyframes fade-right{0%{opacity:0;transform:translateX(-1em)}to{opacity:1}}@keyframes fade-left{0%{opacity:0;transform:translateX(1em)}to{opacity:1}}@keyframes fade-up{0%{opacity:0;transform:translateY(1em)}to{opacity:1}}@keyframes fade-down{0%{opacity:0;transform:translateY(-1em)}to{opacity:1}}@keyframes flicker{0%,29%,31%,63%,65%,77%,79%,86%,88%,91%,93%{opacity:0}30%{opacity:0.2}64%{opacity:0.4}78%{opacity:0.6}87%{opacity:0.8}92%, to{opacity:1}}@keyframes blur{0%{filter:blur(2rem);opacity:0}25%{opacity:1}to{filter:blur(0rem);opacity:1}}.dom-debug-mode tw-story,.dom-debug-mode tw-passage,.dom-debug-mode tw-sidebar,.dom-debug-mode tw-include,.dom-debug-mode tw-hook,.dom-debug-mode tw-expression,.dom-debug-mode tw-link,.dom-debug-mode tw-dialog,.dom-debug-mode tw-columns,.dom-debug-mode tw-column,.dom-debug-mode tw-align{outline:1px solid #f5a3da;min-height:32px;display:block !important}.dom-debug-mode tw-story::before,.dom-debug-mode tw-passage::before,.dom-debug-mode tw-sidebar::before,.dom-debug-mode tw-include::before,.dom-debug-mode tw-hook::before,.dom-debug-mode tw-expression::before,.dom-debug-mode tw-link::before,.dom-debug-mode tw-dialog::before,.dom-debug-mode tw-columns::before,.dom-debug-mode tw-column::before,.dom-debug-mode tw-align::before{position:absolute;top:0;left:0;height:16px;background-color:#f5a3da;color:black;font-size:16px;font-weight:normal;font-style:normal;font-family:monospace;display:inline-block;line-height:100%;white-space:pre;z-index:999997}.dom-debug-mode tw-story:hover,.dom-debug-mode tw-passage:hover,.dom-debug-mode tw-sidebar:hover,.dom-debug-mode tw-include:hover,.dom-debug-mode tw-hook:hover,.dom-debug-mode tw-expression:hover,.dom-debug-mode tw-link:hover,.dom-debug-mode tw-dialog:hover,.dom-debug-mode tw-columns:hover,.dom-debug-mode tw-column:hover,.dom-debug-mode tw-align:hover{outline:1px solid #fc9}.dom-debug-mode tw-story:hover::before,.dom-debug-mode tw-passage:hover::before,.dom-debug-mode tw-sidebar:hover::before,.dom-debug-mode tw-include:hover::before,.dom-debug-mode tw-hook:hover::before,.dom-debug-mode tw-expression:hover::before,.dom-debug-mode tw-link:hover::before,.dom-debug-mode tw-dialog:hover::before,.dom-debug-mode tw-columns:hover::before,.dom-debug-mode tw-column:hover::before,.dom-debug-mode tw-align:hover::before{background-color:#fc9;transition:background-color 1s}.dom-debug-mode tw-passage,.dom-debug-mode tw-include,.dom-debug-mode tw-hook,.dom-debug-mode tw-expression,.dom-debug-mode tw-link,.dom-debug-mode tw-dialog,.dom-debug-mode tw-columns,.dom-debug-mode tw-column,.dom-debug-mode tw-align{padding:1em;margin:0}.dom-debug-mode tw-story::before{content:'<tw-story tags="' attr(tags) '">'}.dom-debug-mode tw-passage::before{top:-16px;content:'<tw-passage tags="' attr(tags) '">'}.dom-debug-mode tw-sidebar::before{top:-16px;content:"<tw-sidebar>"}.dom-debug-mode tw-hook::before{content:'<tw-hook name="' attr(name) '">'}.dom-debug-mode tw-expression::before{content:'<tw-expression name="' attr(name) '">'}.dom-debug-mode tw-link::before{content:'<tw-link name="' attr(name) '">'}.dom-debug-mode tw-dialog::before{content:"<tw-dialog>"}.dom-debug-mode tw-columns::before{content:"<tw-columns>"}.dom-debug-mode tw-column::before{content:"<tw-column>"}.dom-debug-mode tw-align::before{content:"<tw-align>"}.dom-debug-mode tw-include::before{content:'<tw-include type="' attr(type) '" title="' attr(title) '">'}.debug-mode tw-expression{display:inline-block !important}.debug-mode tw-expression[type=variable]::after{font-size:0.8rem;padding-left:0.2rem;padding-right:0.2rem;vertical-align:top;content:"$" attr(name)}.debug-mode tw-expression[type=tempVariable]::after{font-size:0.8rem;padding-left:0.2rem;padding-right:0.2rem;vertical-align:top;content:"_" attr(name)}.debug-mode tw-expression[return=boolean]{background-color:rgba(179,179,179,0.2)}.debug-mode tw-expression[return=array]{background-color:rgba(255,102,102,0.2)}.debug-mode tw-expression[return=dataset]{background-color:rgba(255,128,0,0.2)}.debug-mode tw-expression[return=number]{background-color:rgba(255,179,102,0.2)}.debug-mode tw-expression[return=datamap]{background-color:rgba(255,255,102,0.2)}.debug-mode tw-expression[return=changer]{background-color:rgba(179,255,102,0.2)}.debug-mode tw-expression[return=lambda]{background-color:rgba(102,255,102,0.2)}.debug-mode tw-expression[return=hookname]{background-color:rgba(102,255,204,0.2)}.debug-mode tw-expression[return=string]{background-color:rgba(102,255,255,0.2)}.debug-mode tw-expression[return=datatype]{background-color:rgba(102,153,255,0.2)}.debug-mode tw-expression[return=gradient],.debug-mode tw-expression[return=colour]{background-color:rgba(204,102,255,0.2)}.debug-mode tw-expression[return=instant],.debug-mode tw-expression[return=macro]{background-color:rgba(240,117,199,0.2)}.debug-mode tw-expression[return=command]{background-color:rgba(153,153,255,0.2)}.debug-mode tw-expression.false{background-color:rgba(255,0,0,0.2) !important}.debug-mode tw-expression[type=macro]::before{content:"(" attr(name) ":)";padding:0 0.5rem;font-size:1rem;vertical-align:middle;line-height:normal;background-color:inherit;border:1px solid rgba(255,255,255,0.5)}.debug-mode tw-hook{background-color:rgba(0,85,255,0.1) !important}.debug-mode tw-hook::before{font-size:0.8rem;padding-left:0.2rem;padding-right:0.2rem;vertical-align:top;content:"["}.debug-mode tw-hook::after{font-size:0.8rem;padding-left:0.2rem;padding-right:0.2rem;vertical-align:top;content:"]"}.debug-mode tw-hook[name]::after{font-size:0.8rem;padding-left:0.2rem;padding-right:0.2rem;vertical-align:top;content:"]<" attr(name) "|"}.debug-mode tw-pseudo-hook{background-color:rgba(255,170,0,0.1) !important}.debug-mode tw-collapsed::before{font-size:0.8rem;padding-left:0.2rem;padding-right:0.2rem;vertical-align:top;content:"{"}.debug-mode tw-collapsed::after{font-size:0.8rem;padding-left:0.2rem;padding-right:0.2rem;vertical-align:top;content:"}"}.debug-mode tw-verbatim::before,.debug-mode tw-verbatim::after{font-size:0.8rem;padding-left:0.2rem;padding-right:0.2rem;vertical-align:top;content:"`"}.debug-mode tw-align[style*="text-align: center"]{background:linear-gradient(to right, rgba(255,204,189,0) 0%, rgba(255,204,189,0.25) 50%, rgba(255,204,189,0) 100%)}.debug-mode tw-align[style*="text-align: left"]{background:linear-gradient(to right, rgba(255,204,189,0.25) 0%, rgba(255,204,189,0) 100%)}.debug-mode tw-align[style*="text-align: right"]{background:linear-gradient(to right, rgba(255,204,189,0) 0%, rgba(255,204,189,0.25) 100%)}.debug-mode tw-column{background-color:rgba(189,228,255,0.2)}.debug-mode tw-enchantment{animation:enchantment 0.5s infinite;border:1px solid}.debug-mode tw-link::after,.debug-mode tw-broken-link::after{font-size:0.8rem;padding-left:0.2rem;padding-right:0.2rem;vertical-align:top;content:attr(passage-name)}.debug-mode tw-include{background-color:rgba(204,128,51,0.1)}.debug-mode tw-include::before{font-size:0.8rem;padding-left:0.2rem;padding-right:0.2rem;vertical-align:top;content:attr(type) ' "' attr(title) '"'}@keyframes enchantment{0%,to{border-color:#ffb366}50%{border-color:#6fc}}tw-debugger{position:fixed;box-sizing:border-box;bottom:0;right:0;z-index:999999;min-width:10em;min-height:1em;padding:0em 0.5em 0.5em 1em;font-size:1.25em;font-family:sans-serif;color:#000;border-left:solid #000 2px;border-top:solid #000 2px;border-top-left-radius:.5em;background:#fff;opacity:1}tw-debugger select{margin-right:1em;width:12em}tw-debugger button{border-radius:3px;border:solid #999 1px;margin:auto 4px;background-color:#fff;font-size:inherit;color:#000}tw-debugger button.enabled{background-color:#eee;box-shadow:inset #ddd 3px 5px 0.5em}tw-debugger .panel{display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column;position:absolute;bottom:100%;left:-2px;right:0;padding:1em;max-height:40vh;overflow-y:scroll;overflow-x:hidden;z-index:999998;background:#fff;border:inherit;border-bottom:solid #999 2px;border-top-left-radius:.5em;border-bottom-left-radius:.5em;font-size:0.8em}tw-debugger .panel:empty,tw-debugger .panel[hidden]{display:none}tw-debugger .panel-source,tw-debugger .panel-row-source{font-family:monospace;overflow-x:scroll;white-space:pre;-ms-flex-preferred-size:100%;flex-basis:100%}tw-debugger .panel-row-source{margin:5px 0}tw-debugger .panel-rows{width:100%;overflow-x:scroll}tw-debugger .panel-rows>*{display:table-row}tw-debugger .panel-rows>div:nth-of-type(2n){background:#EEE}tw-debugger .panel-row-buttons{text-align:right}tw-debugger .panel-variables .panel-rows:empty::before{content:"~ No variables ~";font-style:italic;color:#888;text-align:center}tw-debugger .panel-enchantments .panel-rows:empty::before{content:"~ No enchantments ~";font-style:italic;color:#888;text-align:center}tw-debugger .panel-errors .panel-rows:empty::before{content:"~ No errors... for now. ~";font-style:italic;color:#888;text-align:center}tw-debugger .panel-rows:empty+.panel-variables-bottom{display:none}tw-debugger .panel-storylets:not(.panel-exclusive) .storylet-exclusive,tw-debugger .panel-storylets:not(.panel-urgent) .storylet-urgent{display:none}tw-debugger .panel-variables-bottom{padding-top:5px}tw-debugger .enchantment-row{min-height:1.5em}tw-debugger .variable-path{opacity:0.4}tw-debugger .temporary-variable-scope,tw-debugger .enchantment-local{font-family:sans-serif;font-weight:normal;opacity:0.8;font-size:0.75em}tw-debugger .temporary-variable-scope:not(:empty)::before,tw-debugger .enchantment-local:not(:empty)::before{content:" in "}tw-debugger .variable-name,tw-debugger .enchantment-name{font-family:monospace;font-weight:bold}tw-debugger .variable-type{color:#444;font-weight:normal;text-overflow:ellipsis;overflow:hidden;max-width:10em}tw-debugger .error-row{display:table-row;background-color:rgba(230,101,204,0.3)}tw-debugger .error-row:nth-of-type(2n){background-color:rgba(237,145,219,0.3)}tw-debugger .error-row>*{display:table-cell;padding:0.25em 0.5em}tw-debugger .error-row .error-message{cursor:help}tw-debugger .error-row .error-passage{color:#444}tw-debugger .storylet-row{background-color:rgba(201,233,222,0.3)}tw-debugger .storylet-row:nth-child(2n){background-color:rgba(128,203,178,0.3)}tw-debugger .storylet-row.storylet-closed{font-style:italic;opacity:0.4;background-color:rgba(217,217,217,0.3)}tw-debugger .storylet-row.storylet-closed:nth-child(2n){background-color:rgba(166,166,166,0.3)}.storylet-error tw-debugger .storylet-row{background-color:rgba(230,101,204,0.3)}.storylet-error tw-debugger .storylet-row:nth-child(2n){background-color:rgba(237,145,219,0.3)}tw-debugger .storylet-row .storylet-name,tw-debugger .storylet-row .storylet-value{display:inline-block;width:50%}tw-debugger .tabs{padding-bottom:0.5em}tw-debugger .tab{border-radius:0px 0px 0.5em 0.5em;border-top:none}tw-debugger .resizer{position:absolute;height:3em;border-left:2px solid #ccc;border-right:2px solid #ccc;top:10px;left:4px;width:8px;cursor:ew-resize}tw-dialog{z-index:999997;border:#fff solid 2px;padding:2em;color:#fff;background-color:#000;display:block}@media (min-width: 576px){tw-dialog{max-width:50vw}}tw-dialog input[type=text]{font-size:inherit;width:100%}tw-dialog-links{text-align:right;display:-ms-flexbox;display:flex;-ms-flex-pack:end;justify-content:flex-end}tw-backdrop{z-index:999996;position:fixed;top:0;left:0;right:0;bottom:0;background-color:rgba(0,0,0,0.8);display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center;-ms-flex-pack:center;justify-content:center}tw-backdrop ~ tw-backdrop{display:none}tw-link,.link,tw-icon,.enchantment-clickblock{cursor:pointer}tw-link,.enchantment-link{color:#4169E1;font-weight:bold;text-decoration:none;transition:color 0.2s ease-in-out}tw-passage [style^="color"] tw-link:not(:hover),tw-passage [style*=" color"] tw-link:not(:hover),tw-passage [style^="color"][hover="true"] tw-link:hover,tw-passage [style*=" color"][hover="true"] tw-link:hover,tw-passage [style^="color"] .enchantment-link:not(:hover),tw-passage [style*=" color"] .enchantment-link:not(:hover),tw-passage [style^="color"][hover="true"] .enchantment-link:hover,tw-passage [style*=" color"][hover="true"] .enchantment-link:hover{color:inherit}tw-link:hover,.enchantment-link:hover{color:#00bfff}tw-link:active,.enchantment-link:active{color:#DD4B39}.visited{color:#6941e1}tw-passage [style^="color"] .visited:not(:hover),tw-passage [style*=" color"] .visited:not(:hover),tw-passage [style^="color"][hover="true"] .visited:hover,tw-passage [style*=" color"][hover="true"] .visited:hover{color:inherit}.visited:hover{color:#E3E}tw-broken-link{color:#993333;border-bottom:2px solid #993333;cursor:not-allowed}tw-passage [style^="color"] tw-broken-link:not(:hover),tw-passage [style*=" color"] tw-broken-link:not(:hover),tw-passage [style^="color"][hover="true"] tw-broken-link:hover,tw-passage [style*=" color"][hover="true"] tw-broken-link:hover{color:inherit}.enchantment-mouseover{border-bottom:2px dashed #999}.enchantment-mouseout{border:rgba(64,149,191,0.6) 1px solid}.enchantment-mouseout:hover{background-color:rgba(175,197,207,0.75);border:transparent 1px solid;border-radius:0.2em}.enchantment-clickblock{width:100%;height:100%;display:block}.enchantment-clickblock>:not(tw-enchantment)::after{content:"";width:100%;height:100%;top:0;left:0;display:block;box-sizing:border-box;position:absolute;pointer-events:none;color:rgba(65,105,225,0.5);transition:color 0.2s ease-in-out}.enchantment-clickblock>:not(tw-enchantment):hover::after{color:rgba(0,191,255,0.5)}.enchantment-clickblock>:not(tw-enchantment):active::after{color:rgba(222,78,59,0.5)}.enchantment-clickblock>:not(tw-enchantment)::after{box-shadow:inset 0 0 0 0.5vmax}.enchantment-clickblock>tw-passage::after,.enchantment-clickblock>tw-sidebar::after{box-shadow:0 0 0 0.5vmax}.enchantment-mouseoverblock>:not(tw-enchantment)::after{content:"";width:100%;height:100%;top:0;left:0;display:block;box-sizing:border-box;position:absolute;pointer-events:none;border:2px dashed #999}.enchantment-mouseoutblock>:not(tw-enchantment)::after{content:"";width:100%;height:100%;top:0;left:0;display:block;box-sizing:border-box;position:absolute;pointer-events:none;border:rgba(64,149,191,0.6) 2px solid}.enchantment-mouseoutblock:hover>:not(tw-enchantment)::after{content:"";width:100%;height:100%;top:0;left:0;display:block;box-sizing:border-box;position:absolute;pointer-events:none;background-color:rgba(175,197,207,0.75);border:transparent 2px solid;border-radius:0.2em}tw-link.enchantment-button,.enchantment-link.enchantment-button,.enchantment-button:not(.enchantment-link) tw-link,.enchantment-button:not(.enchantment-link) .enchantment-link{border-radius:16px;border-style:solid;border-width:2px;text-align:center;padding:0px 8px;display:block}tw-dialog-links{padding-top:1.5em}tw-dialog-links tw-link{border-radius:16px;border-style:solid;border-width:2px;text-align:center;padding:0px 8px;display:block;display:inline-block}html{margin:0;height:100%;overflow-x:hidden}*,:before,:after{position:relative;box-sizing:inherit}body{margin:0;height:100%}tw-storydata{display:none}tw-story{display:-ms-flexbox;display:flex;-ms-flex-direction:column;flex-direction:column;font:100% Georgia, serif;box-sizing:border-box;width:100%;min-height:100%;font-size:1.5em;line-height:1.5em;padding:5% 5%;overflow:hidden;background-color:#000;color:#fff}tw-story [style*=content-box] *{box-sizing:border-box}@media (min-width: 576px){tw-story{padding:5% 20%}}tw-story tw-consecutive-br{display:block;height:1.6ex;visibility:hidden}tw-story select{background-color:transparent;font:inherit;border-style:solid;padding:2px}tw-story select:not([disabled]){color:inherit}tw-story textarea{resize:none;background-color:transparent;font:inherit;color:inherit;border-style:none;padding:2px}tw-story input[type=checkbox]{transform:scale(1.5);margin:0 0.5em}tw-story tw-noscript{animation:appear 0.8s}tw-passage{display:block}tw-sidebar{text-align:center;display:-ms-flexbox;display:flex;-ms-flex-pack:justify;justify-content:space-between}@media (min-width: 576px){tw-sidebar{left:-5em;width:3em;position:absolute;-ms-flex-direction:column;flex-direction:column}tw-enchantment[style*="width"]>tw-sidebar{width:inherit}}tw-icon{display:inline-block;margin:0.5em 0;font-size:66px;font-family:"Verdana",sans-serif}tw-icon[alt]{opacity:0.2}tw-icon[alt]:hover{opacity:0.4}tw-icon[data-label]::after{font-weight:bold;content:attr(data-label);font-size:20px;bottom:-20px;left:-50%;white-space:nowrap}tw-meter{display:block}tw-hook:empty,tw-expression:empty{display:none}tw-error{display:inline-block;border-radius:0.2em;padding:0.2em;font-size:1rem;cursor:help;white-space:pre-wrap}tw-error.error{background-color:rgba(223,58,190,0.6);color:#fff}tw-error.warning{background-color:rgba(223,140,58,0.6);color:#fff;display:none}.debug-mode tw-error.warning{display:inline}tw-error-explanation{display:block;font-size:0.8rem;line-height:1rem}tw-open-button,tw-folddown{cursor:pointer;line-height:0em;border-radius:1px;border:1px solid black;font-size:0.8rem;margin:0 0.4rem;padding:2px;white-space:pre}tw-folddown::after{content:"\25b6"}tw-folddown.open::after{content:"\25bc"}tw-open-button::after{content:"Open"}tw-notifier{border-radius:0.2em;padding:0.2em;font-size:1rem;background-color:rgba(223,182,58,0.4);display:none}.debug-mode tw-notifier{display:inline}tw-notifier::before{content:attr(message)}tw-colour{border:1px solid black;display:inline-block;width:1em;height:1em}tw-enchantment:empty{display:none}h1{font-size:3em}h2{font-size:2.25em}h3{font-size:1.75em}h1,h2,h3,h4,h5,h6{line-height:1em;margin:0.3em 0 0.6em 0}pre{font-size:1rem;line-height:initial}small{font-size:70%}big{font-size:120%}mark{color:rgba(0,0,0,0.6);background-color:#ff9}ins{color:rgba(0,0,0,0.6);background-color:rgba(255,242,204,0.5);border-radius:0.5em;box-shadow:0em 0em 0.2em #ffe699;text-decoration:none}center{text-align:center;margin:0 auto;width:60%}blink{text-decoration:none;animation:fade-in-out 1s steps(1, end) infinite alternate}tw-align{display:block}tw-columns{display:-ms-flexbox;display:flex;-ms-flex-direction:row;flex-direction:row;-ms-flex-pack:justify;justify-content:space-between}.transition-in{animation:appear 0ms step-start}.transition-out{animation:appear 0ms step-end}[data-t8n^=dissolve].transition-in,[data-t8n=fade].transition-in{animation:appear .8s}[data-t8n^=dissolve].transition-out,[data-t8n=fade].transition-out{animation:appear .8s reverse}[data-t8n^=shudder].transition-in{display:inline-block !important;animation:shudder-in .8s}[data-t8n^=shudder].transition-out{display:inline-block !important;animation:shudder-in .8s reverse}[data-t8n^=rumble].transition-in{display:inline-block !important;animation:rumble-in .8s}[data-t8n^=rumble].transition-out{display:inline-block !important;animation:rumble-in .8s reverse}[data-t8n^=pulse].transition-in{animation:pulse .8s;display:inline-block !important}[data-t8n^=pulse].transition-out{animation:pulse .8s reverse;display:inline-block !important}[data-t8n^=zoom].transition-in{animation:zoom-in .8s;display:inline-block !important}[data-t8n^=zoom].transition-out{animation:zoom-in .8s reverse;display:inline-block !important}[data-t8n^=blur].transition-in{animation:blur .8s;display:inline-block !important}[data-t8n^=blur].transition-out{animation:blur .8s reverse;display:inline-block !important}[data-t8n^=slideleft].transition-in{animation:slide-left .8s;display:inline-block !important}[data-t8n^=slideleft].transition-out{animation:slide-right .8s reverse;display:inline-block !important}[data-t8n^=slideright].transition-in{animation:slide-right .8s;display:inline-block !important}[data-t8n^=slideright].transition-out{animation:slide-left .8s reverse;display:inline-block !important}[data-t8n^=slideup].transition-in{animation:slide-up .8s;display:inline-block !important}[data-t8n^=slideup].transition-out{animation:slide-down .8s reverse;display:inline-block !important}[data-t8n^=slidedown].transition-in{animation:slide-down .8s;display:inline-block !important}[data-t8n^=slidedown].transition-out{animation:slide-up .8s reverse;display:inline-block !important}[data-t8n^=fadeleft].transition-in{animation:fade-left .8s;display:inline-block !important}[data-t8n^=fadeleft].transition-out{animation:fade-right .8s reverse;display:inline-block !important}[data-t8n^=faderight].transition-in{animation:fade-right .8s;display:inline-block !important}[data-t8n^=faderight].transition-out{animation:fade-left .8s reverse;display:inline-block !important}[data-t8n^=fadeup].transition-in{animation:fade-up .8s;display:inline-block !important}[data-t8n^=fadeup].transition-out{animation:fade-down .8s reverse;display:inline-block !important}[data-t8n^=fadedown].transition-in{animation:fade-down .8s;display:inline-block !important}[data-t8n^=fadedown].transition-out{animation:fade-up .8s reverse;display:inline-block !important}[data-t8n^=flicker].transition-in{animation:flicker .8s}[data-t8n^=flicker].transition-out{animation:flicker .8s reverse}
</style>
</head>
<body>
<tw-story><noscript><tw-noscript>JavaScript needs to be enabled to play Journalism Table Prototype.</tw-noscript></noscript></tw-story>
<tw-storydata name="Journalism Table Prototype" startnode="273" creator="Twine" creator-version="2.3.14" ifid="38D0254F-1201-4A17-B70E-05F05EBF9D17" zoom="0.6" format="Harlowe" format-version="3.2.2" options="" hidden><style role="stylesheet" id="twine-user-stylesheet" type="text/twine-css">tw-story {
	background-color: white;
  color: black;

}
.transition-in[data-t8n^=dissolve] {
	-webkit-animation:appear 0ms step-start;
	animation:appear 0ms step-start
}</style><script role="script" id="twine-user-script" type="text/twine-javascript"></script><tw-tag name="Bad" color="red"></tw-tag>,<tw-tag name="Bookworm" color="blue"></tw-tag>,<tw-tag name="Egghead" color="blue"></tw-tag>,<tw-tag name="Endurance" color="orange"></tw-tag>,<tw-tag name="Fact" color="green"></tw-tag>,<tw-tag name="Good" color="yellow"></tw-tag>,<tw-tag name="Graph" color="red"></tw-tag>,<tw-tag name="Great" color="green"></tw-tag>,<tw-tag name="Observation" color="orange"></tw-tag>,<tw-tag name="Photo" color="blue"></tw-tag>,<tw-tag name="Quote" color="purple"></tw-tag>,<tw-tag name="Resourceful" color="green"></tw-tag>,<tw-tag name="Snippet" color="gray"></tw-tag>,<tw-tag name="Social" color="red"></tw-tag>,<tw-tag name="Techie" color="purple"></tw-tag>,<tw-tag name="Trust" color="yellow"></tw-tag><tw-passagedata pid="1" name="&quot;On my way.&quot;" tags="" position="571,550" size="100,100">This is it, Rookie. Your first big scoop. 

You have a feeling this &quot;flood&quot; will end up being more of a glorified puddle. 

But this is your first serious story. You don&#39;t want to mess it up. 

You have time to do one thing before you head to the newsroom.

[[Check on your upstairs neighbor, who hates thunderstorms]]
[[Round up your tech and rain gear]]
[[Dig through the fridge for something nourishing]]
[[Check social media for posts and photos about the storm]]</tw-passagedata><tw-passagedata pid="2" name="RESOURCEFUL CHARACTER" tags="Resourceful" position="425,300" size="100,100">Double-click this passage to edit it.</tw-passagedata><tw-passagedata pid="3" name="BOOKWORM CHARACTER" tags="Egghead Bookworm" position="425,175" size="100,100">Double-click this passage to edit it.</tw-passagedata><tw-passagedata pid="4" name="ENDURANCE" tags="Endurance" position="425,425" size="100,100">Double-click this passage to edit it.</tw-passagedata><tw-passagedata pid="5" name="SOCIAL BUTTERFLY CHARACTER" tags="Social" position="425,800" size="100,100">Double-click this passage to edit it.</tw-passagedata><tw-passagedata pid="6" name="TECHIE CHARACTER" tags="Techie" position="425,675" size="100,100">Double-click this passage to edit it.</tw-passagedata><tw-passagedata pid="7" name="TRUST CHARACTER" tags="Trust" position="425,925" size="100,100">Double-click this passage to edit it.</tw-passagedata><tw-passagedata pid="8" name="Round up your tech and rain gear" tags="Techie Resourceful" position="700,675" size="100,100">You run around the apartment, gathering your tech and rain gear.
&lt;img src=&quot;https://journalism-game-master.netlify.app/assets/enml-phoneaccessories.jpg&quot; title=&quot;Buzzing phone&quot; width=&quot;400&quot;/&gt;
You can&#39;t find your raincoat, but you do manage to dig up a large trash bag and your old swim goggles!

($changeStat:$techieName, 1)
($changeStat:$resourcefulName, 1)

[[Off to work]]</tw-passagedata><tw-passagedata pid="9" name="Dig through the fridge for something nourishing" tags="Endurance" position="700,426" size="100,100">You haven&#39;t had time to grocery shop this week. Luckily, your fridge is full of cherry-themed gifts from your neighbors.

Cherry pie, cherry granola, cherry summer sausage.

You eat some of everything and pack up some dried cherry granola for later.

($changeStat:$enduranceName,1)
($changeStat:$resourcefulName, 1)

[[Off to work]]</tw-passagedata><tw-passagedata pid="10" name="Check social media for posts and photos about the storm" tags="" position="575,175" size="100,200">You scroll through posts on Squawker. 

(Insert art here: Squawker post with flooded hospital parking lot) 
[[See if the nurse will let you use his photo.-&gt;Message Nurse]]

(Insert art here: Squawker post with flood safety article) 
[[Read article and brush up on your survival skills.-&gt;Read flooding article.]]</tw-passagedata><tw-passagedata pid="11" name="Off to work" tags="" position="843,550" size="100,100">&lt;img src=&quot;https://journalism-game-master.netlify.app/assets/enml-waterrushing.gif&quot; title=&quot;Flapping chicken&quot; width=&quot;400&quot;/&gt;
Your apartment is located over a local bookstore.

You come downstairs and walk through the enormous, decorative metal bird sculptures out front. They look even more terrifying in the dark.  

Next door, your neighbor is running around in a panic. Her backyard chickens have escaped their coop.

“Help!” she cries, her arms full of clucking, feathered things.

[[Help her]]
[[Rush to work&lt;-There&#39;s no time, I&#39;ve got to get into work!]]</tw-passagedata><tw-passagedata pid="12" name="Help her" tags="" position="825,825" size="100,200">The whole coop is running around like chickens with... well, you know.
&lt;img src=&quot;https://journalism-game-master.netlify.app/assets/enml-escapedchicken.jpg&quot; title=&quot;Flapping chicken&quot; width=&quot;400&quot;/&gt;
You need to save them before they get swept away! 

[[Chase after the chickens-&gt;Chase chickens]]
[[Lure them with food-&gt;Lure chickens]]</tw-passagedata><tw-passagedata pid="13" name="Load your bike, it could be useful later." tags="Resourceful" position="975,425" size="200,100">You fill up your tires and squeeze your bike into the trunk. 

The hatch doesn&#39;t shut all the way, but it&#39;s nothing a bungee cord can&#39;t fix.

You drive to work, dodging flooded streets along the way.

Looks like this flood might actually be a big deal. 

//You can use your bike later//
($changeStat: $resourcefulName, 1)
(set: $hasBike to true)

[[Arrive at work.]]</tw-passagedata><tw-passagedata pid="14" name="Office 1 - Weather" tags="" position="1325,175" size="100,100">You check the forecast: 10 inches of rain fell overnight, and more is on the way. 

The website includes a live flood map of the city, which includes flooded streets and areas at risk.

This will be perfect to include in your story!

($gainSnippet:&quot;Graph&quot;,&quot;Flood map&quot;)
($gainSnippet:&quot;Fact&quot;,&quot;Weather stats&quot;)

(display: &quot;Office 1 - Clock&quot;)</tw-passagedata><tw-passagedata pid="15" name="Office 1 - Coworker" tags="" position="1325,925" size="100,100">You&#39;ve heard about a retired reporter who used to cover local floods, Jenkins Something.

Maybe he&#39;s got old files you could look through!

[[Track down his computer.-&gt;Jenkins&#39;s Computer]]</tw-passagedata><tw-passagedata pid="16" name="Office 1 - DNR" tags="" position="1326,675" size="100,100">You ask the DNR worker what&#39;s going on.
($statGate: $socialName, 2)
(if: $social &gt;1)[The worker sounds relieved to have someone to talk to.

He vents about the flooding, and you end up with a great quote!

($gainSnippet:&quot;Quote&quot;,&quot;Good DNR&quot;)
](else:)[He sounds overworked and gives you a clearly rehearsed quote: stay off the roads, avoid downtown. 

($gainSnippet:&quot;Quote&quot;,&quot;Rehearsed DNR&quot;)]
(if:(history:) contains &quot;Jenkins&#39;s Computer&quot;)[
(link:&quot;Call Jenkins&#39;s DNR Contact&quot;)[Jenkins&#39;s contact, Wynne D. Storme, is excited to talk to you. 

&quot;We&#39;ve never seen anything like this,&quot; she tells you. &quot;They&#39;re calling it a 100-year flood!&quot; 

($statGate: $bookwormName, 2)
(if: $bookworm &gt; 1)[You remember that term from your research: a flood that only happens once every 100 years.

Wynne is impressed by your book smarts! She gives you tons of great data for your story.

($gainSnippet:&quot;Fact&quot;,&quot;DNR Data&quot;)]
(else:)[You&#39;re horrified. A flood that lasts 100 years??? 

By the time Wynne gets you caught up on what &quot;100-year flood&quot; actually means, she&#39;s out of time. No more questions.]]]

(display: &quot;Office 1 - Clock&quot;)</tw-passagedata><tw-passagedata pid="17" name="Office 1 - Police" tags="" position="1325,425" size="100,100">The police spokesman seems suspicious of your credentials.

&quot;I&#39;ve never heard of you,&quot; he says. &quot;Who did you say you work for?&quot;

[[&quot;The Twin Lakes Herald.&quot;-&gt;Police Response]]</tw-passagedata><tw-passagedata pid="18" name="Office 1 - City Hall" tags="" position="1325,300" size="100,100">($statGate: $socialName, 2)
(if: $social is &gt;1)[Your city council contact is thrilled to hear from you. 

&quot;Everyone is still talking about those cherry glazed donuts you brought last time!&quot; she says.

&lt;img src=&quot;https://journalism-game-master.netlify.app/assets/enml-coffeedonuts.jpg&quot; title=&quot;Buzzing phone&quot; width=&quot;400&quot;/&gt;
She tells you that the flood started at the dam, and most of downtown is at risk.

Volunteers are working to lay sandbags, while the city struggles to keep up with rescues and emergency calls.

&quot;I wish I could say nobody saw this coming,&quot; she says. &quot;But this city has been on the verge of a flood like this for years.&quot; 

You thank her for her time. These quotes will be amazing for your article!

($gainSnippet:&quot;Fact&quot;,&quot;Flood background&quot;)
($gainSnippet:&quot;Quote&quot;,&quot;City Hall shock&quot;)
](else:)[You interviewed your city hall contact last week. She doesn&#39;t seem thrilled to hear from you again.

Come to think of it, calling the cherry festival a &quot;nice distraction from the soul-crushing boredom of small town life&quot; might&#39;ve been a mistake.   

She tells you that the flood started at the dam. 

&quot;We&#39;re pretty busy here,&quot; she says, sounding annoyed. &quot;Check our website later.&quot;

($gainSnippet:&quot;Fact&quot;,&quot;Flood background&quot;)
($gainSnippet:&quot;Observation&quot;,&quot;City Hall annoyance&quot;)]

(display: &quot;Office 1 - Clock&quot;)</tw-passagedata><tw-passagedata pid="19" name="Office 1 - Social Media" tags="" position="1325,800" size="100,100">($statGate: $bookwormName, 2)
(if:$bookworm &gt; 1)[You get online and see what your friends are posting.

Thanks to your bookish tendencies, you find a lead: a book club friend livestreaming from outside the library!

The parking lot is under a few inches of water, and the street has become a rushing stream.

You message her, and she sends you some amazing photos. 

($gainSnippet:&quot;Photo&quot;,&quot;Library lot&quot;)
](else:)[You get on Squawker and check the #TwinLakesFlood hashtag.

There are no super impressive shots, but plenty of dark, grainy pictures of flooded streets.

[[Message CherryCharlie07 for permission to use their photo-&gt;Message CherryCharlie07]] (text-colour:purple)[(10 minutes)]]

(display:&quot;Office 1 - Clock&quot;)</tw-passagedata><tw-passagedata pid="20" name="Answer the phone" tags="Trust Social" position="1200,925" size="100,100">(t8n:&quot;slideright&quot;)[&quot;Hello?&quot;]
(t8n:&quot;slideleft&quot;)+(t8n-delay:1s)[&quot;Hiya!! This is Fred Finkler. You might remember me from the town hall meetings.&quot;]
(t8n:&quot;fade&quot;)+(t8n-delay:3s)[=
Oh gosh. You remember Fred Finkler, alright. This guy is singlehandedly responsible for at least 14 town hall sessions going over time.

(set: $currentTime to it - 15)
[ [[&quot;Sorry, Fred, I&#39;m pretty swamped here. Can&#39;t talk now.&quot;-&gt;Breaking News Story]] ]&lt;hangup|
(link-reveal:&quot;\&quot;Ahh, yes. Fred. What can I do for you?\&quot;&quot;)[= 
(hide: ?hangup)
(set: $currentTime to it - 30)
He tells you all his storm woes--his zinnias are flooded and his cat is getting cranky and the ceiling is leaking. 

You don&#39;t get any information for the story, but he seems grateful to you for listening.

($changeStat: $trustName, 1)
($changeStat: $socialName, 1)
[ [[Return to your desk-&gt;Breaking News Story]] ]&lt;ReturnToDesk|</tw-passagedata><tw-passagedata pid="21" name="You have just enough time to compile the story now." tags="" position="1600,550" size="100,100">It&#39;s been a hectic morning, but you think you might be able to piece together a halfway decent story out of this melange.
(set: $storyType to &quot;Breaking News&quot;)
(set: $snippetLimit to 4)
(set: $destination to &quot;Story 2 Intro&quot;)
(display: &quot;STORY EVALUATION&quot;)</tw-passagedata><tw-passagedata pid="22" name="Office 1 - Clock" tags="" position="1450,550" size="100,100">{(if: $currentTime is &lt;=30)[
	[[You have just enough time to compile the story now.]]
](else:)[
	[[Return to your desk-&gt;Breaking News Story]] 
]}</tw-passagedata><tw-passagedata pid="23" name="STORY EVALUATION" tags="" position="175,50" size="100,100">(set: $includedSnippets to (a:))
(set: $bonuses to (a:))
=|= 
Snippet 
=|| 
Content
=||=
Include
|==|

(for: each _snippet, ...(datanames:$StoryInventory))[
=|=
(text-colour:lime)[(print: (passage:_snippet)&#39;s tags&#39;s 1st): ]
(print: _snippet)
=||
(display: _snippet)
=||=
(checkbox: 2bind _snippet of $StoryInventory, &quot;&quot;)
|==|
]
{(live: 100)[

(set: $includedSnippets to (find: _includedSnippet where _includedSnippet of $StoryInventory, ...(datanames: $StoryInventory)))


(if: $includedSnippets&#39;s length &gt; $snippetLimit or $includedSnippets&#39;s length &lt; 1)[(hide: ?Submit) 
	(change: ?Warning, (text-colour:red))]
(else:)[(show: ?Submit)
	(change: ?Warning, (text-colour:white))]
]}
{[&#39;&#39;Select 1 to $snippetLimit snippets to include from your inventory&#39;&#39;]&lt;Warning|
[ [[Submit story]] ]&lt;Submit|}</tw-passagedata><tw-passagedata pid="24" name="Abandoned Cherrymobile" tags="Photo Great" position="950,1175" size="100,100">&lt;img src=&quot;https://journalism-game-master.netlify.app/assets/enml-stuckcar.jpg&quot; title=&quot;Car stuck in the water&quot; width=&quot;400&quot;/&gt;</tw-passagedata><tw-passagedata pid="25" name="Hospital ducks" tags="Photo Good" position="700,1175" size="100,100">Insert a photo of ducks swimming in the hospital parking lot. </tw-passagedata><tw-passagedata pid="26" name="Submit story" tags="" position="300,50" size="100,100">{(set: $score to 0)
(set: $ticker to 0)
(set: $speed to 1)
(display: &quot;Story type multiplier&quot;)
}
(box:&quot;X&quot;)+(b4r:&quot;dashed&quot;)+(b4r-colour:grey)+(font: &quot;Courier New&quot;)+(background:#ced4da)+(text-colour:black)[
=|=
(align:&quot;=&gt;&lt;=&quot;)+(box:&quot;X&quot;)[&#39;&#39;The Twin Lakes Herald&#39;&#39;
---]
(for: each _snippet, ...$includedSnippets)[
{(set: $JudgedSnippet to _snippet)
(display: &quot;Judge Snippet&quot;)
(display: _snippet)}]

]
(link-reveal: &quot;Judge Story&quot;)[
(set: _bonusTick to 0)
(text-style:&quot;italic&quot;)+(text-size:0.8)[(for: each _bonus, ...$bonuses)[_bonus
]]
(live:100)[(b4r:&quot;inset&quot;)+(b4r-colour:grey)(meter: bind $ticker, 100, &quot;~X=&quot;, &quot; Score: $ticker&quot;, blue)
	{(if: $ticker + $speed &lt; $score)[
		(set: $ticker to it + $speed)
		(change: &quot;Score: &quot;, (text-style:&quot;rumble&quot;))
	](else:)[
		(set: $ticker to $score)
		(stop:)
		(text-style:&quot;bold&quot;,&quot;buoy&quot;)[
		(if: $score &gt; 80)[(text-colour:#ffd700)[Excellent story!]]
		(elseif: $score &gt; 60)[(text-colour:blue)[Great story!]]
		(elseif: $score &gt; 40)[(text-colour:green)[Good story!]]
		(elseif: $score &gt; 20)[(text-color:orange)[Acceptable story.]]
		(else:)[(text-colour:red)+(text-style:&quot;shudder&quot;)[AWFUL story.]]]		
	]}
]
(set: $StoryInventory to (dm:), $bonuses to (a:))
(link-goto:$destination)
]

(change:&quot;Judge Story&quot;,(align:&quot;=&gt;&lt;=&quot;)+(box:&quot;=XX=&quot;,2))</tw-passagedata><tw-passagedata pid="27" name="Judge Snippet" tags="" position="300,175" size="100,100">{

(if: (passage: $JudgedSnippet)&#39;s tags contains &quot;Bad&quot;)[(set:$score to it+10, $bonuses to it + (a:&quot;Low-quality snippet: +10&quot;))]
(elseif: (passage: $JudgedSnippet)&#39;s tags contains &quot;Good&quot;)[(set:$score to it+15, $bonuses to it + (a:&quot;Good-quality snippet: +15&quot;))]
(elseif: (passage: $JudgedSnippet)&#39;s tags contains &quot;Great&quot;)[(set:$score to it+20, $bonuses to it + (a:&quot;Great-quality snippet: +20&quot;))]
(else:)[(print: &quot;Error: no quality tag. It might be written as (passage: $JudgedSnippet)&#39;s tags&#39;s 2nd&quot;)]

(if: (passage: $JudgedSnippet)&#39;s tags contains &quot;Photo&quot;)[
	(set: $score to it + $photoMod)
	(if:$photoMod &gt; 0)[(set:$bonuses to it + (a:&quot;$storyType story bonus: Photo +$photoMod&quot;))]]
(if: (passage: $JudgedSnippet)&#39;s tags contains &quot;Graph&quot;)[
	(set: $score to it + $graphMod)
	(if:$graphMod &gt; 0)[(set:$bonuses to it + (a:&quot;$storyType story bonus: Graph +$graphMod&quot;))]]
(if: (passage: $JudgedSnippet)&#39;s tags contains &quot;Quote&quot;)[
	(set: $score to it + $quoteMod)
	(if:$quoteMod &gt; 0)[(set:$bonuses to it + (a:&quot;$storyType story bonus: Quote +$quoteMod&quot;))]]
(if: (passage: $JudgedSnippet)&#39;s tags contains &quot;Fact&quot;)[
	(set: $score to it + $factMod)
	(if:$factMod &gt; 0)[(set:$bonuses to it + (a:&quot;$storyType story bonus: Fact +$factMod&quot;))]]
(if: (passage: $JudgedSnippet)&#39;s tags contains &quot;Observation&quot;)[
	(set: $score to it + $observationMod)
	(if:$observationMod &gt; 0)[(set:$bonuses to it + (a:&quot;$storyType story bonus: Observation +$observationMod&quot;))]]

(set: $JudgedSnippet to 0)}</tw-passagedata><tw-passagedata pid="28" name="Rude shopkeeper" tags="Quote Bad" position="950,1400" size="100,100">Snippet body not implemented.</tw-passagedata><tw-passagedata pid="29" name="Story type multiplier" tags="" position="175,175" size="100,100">(if: $storyType is &quot;Breaking News&quot;)[
	(set: $photoMod to 0, 
	$graphMod to 0, 
	$quoteMod to 5, 
	$factMod to 0, 
	$observationMod to 0)
](elseif: $storyType is &quot;Science&quot;)[
	(set: $photoMod to 0, 
	$graphMod to 5, 
	$quoteMod to 0, 
	$factMod to 0, 
	$observationMod to 0)
](elseif: $storyType is &quot;Investigation&quot;)[
	(set: $photoMod to 5, 
	$graphMod to 0, 
	$quoteMod to 0, 
	$factMod to 0, 
	$observationMod to 5)
](elseif: $storyType is &quot;Human Interest&quot;)[
	(set: $photoMod to 0, 
	$graphMod to 0, 
	$quoteMod to 5, 
	$factMod to 0, 
	$observationMod to 0)
](elseif: $storyType is &quot;PSA&quot;)[
	(set: $photoMod to 0, 
	$graphMod to 0, 
	$quoteMod to 0, 
	$factMod to 5, 
	$observationMod to 0)
](else:)[
(text-colour:red)[ERROR: Could not perform type evaluation, story type unknown! Check the &quot;Story type multiplier&quot; passage to see valid types.]
]</tw-passagedata><tw-passagedata pid="30" name="Friendly shopkeeper" tags="Quote Good" position="1050,1400" size="100,100">Snippet body not implemented.</tw-passagedata><tw-passagedata pid="31" name="Good DNR" tags="Quote Good" position="1300,1550" size="100,100">Snippet body not implemented.</tw-passagedata><tw-passagedata pid="32" name="Rehearsed DNR" tags="Quote Bad" position="1400,1550" size="100,100">Snippet body not implemented.</tw-passagedata><tw-passagedata pid="33" name="Police safety quote" tags="Quote Good" position="1400,1425" size="100,100">Snippet body not implemented.</tw-passagedata><tw-passagedata pid="34" name="Flood map" tags="Graph Good" position="1300,1175" size="100,100">Snippet body not implemented.</tw-passagedata><tw-passagedata pid="35" name="Police story" tags="Great Quote" position="1300,1425" size="100,100">Snippet body not implemented.</tw-passagedata><tw-passagedata pid="36" name="DNR Data" tags="Fact Great" position="1525,1550" size="100,100">Snippet body not implemented.</tw-passagedata><tw-passagedata pid="37" name="Graphs" tags="Graph" position="425,1300" size="100,100"></tw-passagedata><tw-passagedata pid="38" name="Observations" tags="Observation" position="425,1675" size="100,100">Double-click this passage to edit it.</tw-passagedata><tw-passagedata pid="39" name="Quotes" tags="Quote" position="425,1425" size="100,100">Double-click this passage to edit it.</tw-passagedata><tw-passagedata pid="40" name="Photos" tags="Photo" position="425,1175" size="100,100">Double-click this passage to edit it.</tw-passagedata><tw-passagedata pid="41" name="Fact" tags="Fact" position="425,1550" size="100,100">Double-click this passage to edit it.</tw-passagedata><tw-passagedata pid="42" name="Difficult commute" tags="Observation Bad" position="1175,1175" size="100,100">Snippet body not implemented.</tw-passagedata><tw-passagedata pid="43" name="Scientist quotes" tags="Fact Quote Great" position="1300,1800" size="100,100">Snippet body not implemented.</tw-passagedata><tw-passagedata pid="44" name="City Hall shock" tags="Quote Great" position="1300,1300" size="100,100">Snippet body not implemented.</tw-passagedata><tw-passagedata pid="45" name="City Hall annoyance" tags="Observation Bad" position="1400,1300" size="100,100">Snippet body not implemented.</tw-passagedata><tw-passagedata pid="46" name="Library lot" tags="Photo Great" position="1300,1675" size="100,100">Snippet body not implemented.</tw-passagedata><tw-passagedata pid="47" name="START" tags="" position="46,550" size="100,100">(t8n-time:3s)+(link:&quot;Wake up&quot;)+(t8n:&quot;fade&quot;)[

It&#39;s 5AM.

Dark, rainy, and way too early. 
&lt;img src=&quot;https://journalism-game-master.netlify.app/assets/enml-rain.gif&quot; title=&quot;Buzzing phone&quot; width=&quot;400&quot;/&gt;
[[Check your phone.]]]</tw-passagedata><tw-passagedata pid="48" name="Message Nurse" tags="" position="700,300" size="100,100">(Insert photo of hospital parking lot)
This photo would be perfect for your story!

(link:&quot;Send message&quot;)[=The nurse is happy to let you use his photo. He even has some headline ideas:

(text-style:&quot;sway&quot;)[//Fowl weather at the quack of dawn!//

//Storm expected to rack up large bill//]

(link:&quot;\&quot;Thanks. I&#39;ll keep those in mind.\&quot; &quot;)[=

($gainSnippet:&quot;Photo&quot;,&quot;Hospital ducks&quot;)
[[Off to work]]</tw-passagedata><tw-passagedata pid="49" name="Read flooding article." tags="Egghead" position="700,175" size="100,100">(Insert article photo here)

You learn all about flood safety:

Use sandbags to protect your house.

Do NOT try to walk through moving water. 

Don&#39;t panic if you encounter snakes--there are only a few venomous ones around here. 

($changeStat: $bookwormName, 1)
[[Off to work]]</tw-passagedata><tw-passagedata pid="50" name="Check on your upstairs neighbor, who hates thunderstorms" tags="Social Trust" position="698,921" size="100,100">The sweet old lady in the upstairs flat, Jeanie, gets nervous when it rains.

You help her find batteries for her flashlight and put out some food for her cats.

In return, she gives you a mustard yellow hat with little embroidered cherries on it. &quot;I made this just for you, Dear,&quot; she says cheerfully. &quot;Thought it would go nicely with your red hair.&quot;

&quot;Thanks!&quot; you say, stuffing it into your bag. &quot;It&#39;s really something.&quot; 

($changeStat: $trustName, 1)
($changeStat: $socialName, 1)
[[Off to work]]</tw-passagedata><tw-passagedata pid="51" name="Check your phone." tags="" position="173,550" size="100,100">5 missed calls from your editor.

Probably checking up on your puff piece about the cherry festival.

&lt;img src=&quot;https://journalism-game-master.netlify.app/assets/enml-buzzingphone.gif&quot; title=&quot;Buzzing phone&quot; width=&quot;400&quot;/&gt;
[[Call back.-&gt;Call your editor.]]</tw-passagedata><tw-passagedata pid="52" name="Call your editor." tags="" position="300,550" size="100,100">(text-colour:grey)[&quot;(text-style:&quot;rumble&quot;)[FINALLY!] Where have you been??&quot;]

Before you can tell her where you&#39;ve been (sleeping, because it&#39;s //FIVE// in the //MORNING//), she gives you the lowdown:

(text-colour:grey)[Downtown is flooding!

You need to get to the newsroom and put out a breaking news update, ASAP.]

[[&quot;On my way.&quot;-&gt;&quot;On my way.&quot;]]</tw-passagedata><tw-passagedata pid="53" name="Rush to work" tags="" position="825,175" size="100,200">You make up an excuse and hurry to your car.

Your neighbor can get her own coop in a group!

[[Load your bike, it could be useful later.]]
[[I&#39;m in a hurry, there&#39;s no need to bring the bike!]]</tw-passagedata><tw-passagedata pid="54" name="Chase chickens" tags="Trust Endurance" position="950,925" size="100,100">You help round up the chickens and only get pecked twice.

&quot;Oh, thank you!” your neighbor cries. 

You tell her it&#39;s no big deal, you were (mostly) happy to help.

($changeStat: $trustName, 1)
($changeStat: $enduranceName, 1)
[[Hit the road-&gt;Hit the road]]</tw-passagedata><tw-passagedata pid="55" name="Lure chickens" tags="Trust Resourceful" position="950,800" size="100,100">You make a trail of cherry granola and the chickens come running!

The good news: the chickens are safe now.

The bad news: they follow you to your car, clucking for more treats. 

($changeStat: $resourcefulName, 1)
($changeStat: $trustName, 1)
[[Hit the road]] </tw-passagedata><tw-passagedata pid="56" name="Hit the road" tags="" position="1075,850" size="100,100">Turns out the flood is a little more serious than you thought. 

The town&#39;s famous Cherrymobile is abandoned in high water.

Birds are pecking at pastries that have drifted out of a local bakery. 

You wish you could snag some photos, but your editor is texting you. No time to stop.
&lt;img src=&quot;https://journalism-game-master.netlify.app/assets/enml-textmessage.jpg&quot; title=&quot;Your boss&#39;s angry text&quot; width=&quot;400&quot;/&gt;
[[Arrive at work.&lt;-Rush to work]] </tw-passagedata><tw-passagedata pid="57" name="I&#39;m in a hurry, there&#39;s no need to bring the bike!" tags="" position="1075,175" size="200,100">You drive toward the newsroom, windshield wipers working frantically. 

Your usual route is covered with water. Mayyybe this flood is a little worse than you thought. 

(link:&quot;Stop to look around.&quot;)[=A baker is piling up burlap sacks in front of her shop.

Cars are abandoned--including the famous Twin Lakes Cherrymobile!
&lt;img src=&quot;https://journalism-game-master.netlify.app/assets/enml-stuckcar.jpg&quot; title=&quot;Car stuck in the water&quot; width=&quot;400&quot;/&gt;

[[Help the baker-&gt;Help the baker]]
[[Take some photos-&gt;Take some photos]]</tw-passagedata><tw-passagedata pid="58" name="Arrive at work." tags="" position="1075,550" size="100,100">The newsroom is the emptiest you&#39;ve ever seen it.

The lights are flickering and rainwater drips from the ceiling. 

Your editor looks relieved to see you.

(if:(history:)contains &quot;Help her&quot;)[&quot;I&#39;m not even gonna ask why you&#39;re covered in feathers,&quot; she says.
](else-if:(history:)contains &quot;Round up your gear&quot;)[&quot;I like your gear,&quot; she says. &quot;The swim goggles are a nice touch.&quot;
](else:)[&quot;You made it,&quot; she says. &quot;I&#39;m impressed.&quot;]

(link:&quot;\&quot;Where is everybody??\&quot;&quot;)[She explains that the other field reporters are stranded in the flood, or bailing out their flooded basements.

($gainSnippet:&quot;Observation&quot;,&quot;Difficult commute&quot;)

(link:&quot;\&quot;How can I help?\&quot;&quot;)[&quot;We need a breaking news story, so that the people of Twin Lakes will know what&#39;s going on.&quot;

&quot;Keep it short and sweet--what&#39;s the situation, and how can people stay safe.&quot; 

&quot;You&#39;ve got 2 hours.&quot;

[[&quot;On it.&quot;-&gt;Breaking News Story]]]]</tw-passagedata><tw-passagedata pid="59" name="Help the baker" tags="" position="1200,300" size="100,100">{($statGate: $enduranceName, 2)
(if: $endurance is &gt;1)[You rush over, emboldened by your cherry breakfast full of healthy antioxidants.

The baker is stacking up bags of flour. 

You&#39;re not sure if this will actually protect her shop or just turn into play dough, but you help anyway.

&quot;I don&#39;t know where to get sandbags,&quot; she explains. &quot;It all happened so fast!&quot;

($gainSnippet:&quot;Quote&quot;,&quot;Friendly shopkeeper&quot;)]}
(elseif: $social is &gt;1)[($statGate: $socialName, 2)
You rush over, your heart going out to the struggling baker.

She&#39;s stacking up bags of flour.

&quot;I know sandbags work better,&quot; she says. &quot;I don&#39;t know where to find them!&quot;

You&#39;re not strong enough to help much--maybe you should&#39;ve had breakfast--but talking to you seems to cheer her up. 

She agrees to let you quote her for your story, and she gives you a chocolate croissant for the road. 

($gainSnippet:&quot;Quote&quot;,&quot;Friendly shopkeeper&quot;)](else:)[($statGate: $socialName, 2)
The baker is stacking up bags of flour to stop the floodwater.

&quot;I think you&#39;re supposed to use sandbags,&quot; you tell her.

The baker seems exasperated and tells you to get out of the way.

Maybe you could quote this, if you remove the profanity...

($gainSnippet:&quot;Quote&quot;,&quot;Rude shopkeeper&quot;)]

[[Arrive at work.]]</tw-passagedata><tw-passagedata pid="60" name="Take some photos" tags="" position="1075,300" size="100,100">($statGate: $techieName, 2)
(if:$techie is &gt;1)[You climb up on your car for a better view.

With your zoom lens, you get an awesome photo: the abandoned Cherrymobile, juxtaposed with the stacking shopkeep!

($gainSnippet:&quot;Photo&quot;,&quot;Abandoned Cherrymobile&quot;)
](else:)[You pull over and snap some photos. 

You can’t get close enough to get a good shot. A zoom lens would&#39;ve been useful, but that&#39;s buried in your closet somewhere. 

Hopefully blurry cars in blurry water will be good enough for your editor. 

($gainSnippet:&quot;Photo&quot;,&quot;Blurry cars&quot;)]

[[Arrive at work.]]</tw-passagedata><tw-passagedata pid="61" name="Breaking News Story" tags="" position="1200,551" size="100,100">Get to work on your breaking news story!
(if: visits is 1)[(set: $currentTime to 120,$DNRnumber to false)]
You have (display:&quot;PRINT TIME&quot;) remaining to submit the story.

{(if: visits is 1)[(text-style:&quot;shudder&quot;)[RRRRING.]
[[Answer the phone]] (text-colour:purple)[(??? minutes)]]}

($hubChoice: &quot;Office 1 - Weather&quot;,&quot;Check the weather online&quot;, 10)
($hubChoice: &quot;Office 1 - Coworker&quot;,&quot;Dig through old files about local flooding&quot;, 45)
($hubChoice: &quot;Office 1 - DNR&quot;,&quot;Call the Department of Natural Resources for background and flood safety advice&quot;, 30)
($hubChoice: &quot;Office 1 - Police&quot;,&quot;Call your police contact for safety information&quot;, 30)
($hubChoice: &quot;Office 1 - City Hall&quot;,&quot;Call your City Hall contact to ask about the city&#39;s response&quot;, 30)
($hubChoice: &quot;Office 1 - Social Media&quot;,&quot;Check Squawker for photos to use in your story&quot;, 15)
</tw-passagedata><tw-passagedata pid="62" name="Blurry cars" tags="Photo Bad" position="1050,1175" size="100,100">&lt;img src=&quot;https://journalism-game-master.netlify.app/assets/enml-stuckcar.jpg&quot; title=&quot;Car stuck in the water&quot; width=&quot;400&quot;/&gt;</tw-passagedata><tw-passagedata pid="63" name="Jenkins&#39;s Computer" tags="" position="1450,925" size="100,100">&lt;img src=&quot;https://journalism-game-master.netlify.app/assets/enml-oldcomputer.jpg&quot; title=&quot;Old computer&quot; width=&quot;400&quot;/&gt;
($statGate: $techieName, 2)
(if: $techie &gt; 1)[You take a few guesses at his password. 

PASSWORD doesn&#39;t work, but PASSWORD123 is a match!

You find a treasure trove of quotes, plus a phone number for his DNR contact, Wynne D. Storme. 

($gainSnippet:&quot;Quote/Data&quot;,&quot;Scientist quotes&quot;)]
(else:)[Jenkins&#39;s computer looks like it&#39;s from the stone age. Or at least the 90&#39;s. You don&#39;t know how to turn it on.

You do find a sticky note on his file cabinet: //Contact Wynne D. Storme, expert @ DNR// ]
(display: &quot;Office 1 - Clock&quot;)</tw-passagedata><tw-passagedata pid="64" name="Online picture" tags="Photo Good" position="1400,1675" size="100,100">Snippet body not implemented.</tw-passagedata><tw-passagedata pid="65" name="Grainy picture" tags="Photo Bad" position="1500,1675" size="100,100">Snippet body not implemented.</tw-passagedata><tw-passagedata pid="66" name="Weather stats" tags="Fact Good" position="1400,1175" size="100,100">Snippet body not implemented.</tw-passagedata><tw-passagedata pid="67" name="Flood background" tags="Fact Good" position="1525,1425" size="100,100">Snippet body not implemented.</tw-passagedata><tw-passagedata pid="68" name="STARTUP VALUES" tags="startup" position="50,50" size="100,100">{
(set: $StoryInventory to (dm:))

(set: $snippetTypes to (a:&quot;Quote&quot;,&quot;Fact&quot;,&quot;Photo&quot;,&quot;Observation&quot;,&quot;Graph&quot;))

(set: $bookwormName to &quot;Bookworm&quot;, 
$resourcefulName to &quot;Resourceful&quot;, 
$enduranceName to &quot;Endurance&quot;, 
$techieName to &quot;Techie&quot;, 
$socialName to &quot;Social Butterfly&quot;, 
$trustName to &quot;Trust&quot;)

(set: $stats to (dm:
	  $bookwormName, 1,
	  $resourcefulName, 1,
	  $enduranceName, 1,
	  $techieName, 1,
	  $socialName, 1,
	  $trustName, 1)
)

(set: $bookworm to $bookwormName of $stats)
(set: $resourceful to $resourcefulName of $stats)
(set: $endurance to $enduranceName of $stats)
(set: $techie to $techieName of $stats)
(set: $social to $socialName of $stats)
(set: $trust to $trustName of $stats)

(set: $badSnippetPoints to 10,
$goodSnippetPoints to 15,
$greatSnippetPoints to 20)

(set: $gainSnippet to (macro: str-type _snipType, str-type _snipName, [
	{(output:)[
		(set: $StoryInventory to it + (dm: _snipName, false)) (text-style:&quot;italic&quot;)+(prepend-with: &quot;Gained Snippet! &quot;)+(text-colour:lime)[_snipType: _snipName]]
}]))

(set: $hubChoice to (macro: str-type _passage, str-type _desc, num-type _minutes, [(output:)[(unless: (history:) contains _passage or $currentTime &lt; _minutes)[(link:_desc)[(set: $currentTime to it - _minutes)(goto:_passage)] (text-colour:purple)+(append-with:&quot;)&quot;)+(prepend-with:&quot; (&quot;)[_minutes minutes]]]]))

(set: $statGate to (macro: str-type _skillName, num-type _threshold, [
	(display: &quot;REFRESH STATS&quot;)
	(set: num-type _skillVal to _skillName of $stats)
	(set: str-type _outputString to &quot;_skillName check of difficulty _threshold&quot;)
	(if: _skillVal &lt; _threshold)[
		(set: str-type _outputString to &quot;(text-colour:red)+(text-style:&#39;italic&#39;)[&quot; + it + &quot; failed!]&quot;)
		]
	(else:)[
		(set: str-type _outputString to &quot;(text-colour:green)+(text-style:&#39;italic&#39;)[&quot; + it + &quot; passed!]&quot;)
		]
	(output:)[_outputString]
]
))

(set: $changeStat to (macro: str-type _statName, num-type _change, [
	(set: _outputText to &quot;(text-style:&#39;italic&#39;)[&quot; + _statName + &quot;]&quot;)
	(if: _change &gt; 0)[(set: _outputText to &quot;(text-color:cyan)+(prepend-with: &#39;+_change &#39;)+&quot; + it)]
	(else:)[(set: _outputText to &quot;(text-color:orange)+(prepend-with: &#39;_change &#39;)+&quot; + it)]
	(output:)[{_outputText
	(set: _statName of $stats to _statName of $stats + (_change/2))
	(display: &quot;REFRESH STATS&quot;)}]
	
]))}


</tw-passagedata><tw-passagedata pid="69" name="STATS SIDEBAR" tags="header" position="50,175" size="100,100">(float-box: &quot;X========&quot;, &quot;Y&quot;)+(css: &quot;background-color:dimgrey&quot;)+(text-color:white)[&#39;&#39;Stats: &#39;&#39;(text-size:0.8)[=(live: 10)[
---
&#39;&#39;$bookwormName: (text-colour:cyan)[$bookworm]&#39;&#39;
|desc)[Your knowledge and nerdiness.]

&#39;&#39;$resourcefulName: (text-colour:cyan)[$resourceful]&#39;&#39;
|desc)[Your supplies and readiness.]

&#39;&#39;$enduranceName: (text-colour:cyan)[$endurance]&#39;&#39;
|desc)[Your energy and physical prowess.]

&#39;&#39;$techieName: (text-colour:cyan)[$techie]&#39;&#39;
|desc)[Your skill with gizmos and gadgets.]

&#39;&#39;$socialName: (text-colour:cyan)[$social]&#39;&#39;
|desc)[Your charm and emotional intelligence.]

&#39;&#39;$trustName: (text-colour:cyan)[$trust]&#39;&#39;
|desc)[Your presence in the community.]
(change: ?desc, (text-size:0.5)+(text-style:&quot;italic&quot;)+(text-colour: grey))
(if: $showStatDescriptions is &quot;hide descriptions&quot;)[(show: ?desc)]]]

(float-box: &quot;X========&quot;, &quot;=========Y&quot;)+(css: &quot;background-color:dimgrey&quot;)+(text-color:grey)+(text-size:0.8)[(cycling-link: 2bind $showStatDescriptions, &quot;show descriptions&quot;, &quot;hide descriptions&quot;)]
(display:&quot;REFRESH STATS&quot;)</tw-passagedata><tw-passagedata pid="70" name="SNIPPET SIDEBAR" tags="header" position="50,300" size="100,100">(float-box: &quot;=====X&quot;, &quot;Y&quot;)+(css: &quot;background-color:dimgrey&quot;)+(text-color:white)[&#39;&#39;Story Snippets: &#39;&#39;(text-size:0.8)[=
---
(for: each _snippet, ...(datanames:$StoryInventory))[
(background:(gradient: 90, 0,grey,1,transparent))[(text-colour:lime)+(text-style:&quot;bold&quot;)[(print: (passage:_snippet)&#39;s tags&#39;s 1st): ](print: _snippet)]]]</tw-passagedata><tw-passagedata pid="71" name="Story 2 Intro" tags="" position="1925,550" size="100,100">Your next assignment: get to the flood site and report on what&#39;s happening. 

&quot;We need to get ahead of this story,&quot; your editor says. &quot;Do you think you can handle it?&quot;

[[&quot;Don&#39;t worry. I got this.&quot;-&gt;Get Ready]]</tw-passagedata><tw-passagedata pid="72" name="Get Ready" tags="" position="2050,550" size="100,100">(if: visits is 1)[(set: $currentTime to 45)]

You have about (display: &quot;PRINT TIME&quot;) before you should get going.

($statGate: $techieName, 2)
($statGate: $resourcefulName, 2)
(if:$techie is &lt; 2 and $resourceful is &lt;2)[First things first. You need more tech and rain gear, or you&#39;ll be dead in the water.

($hubChoice: &quot;Borrow gear&quot;, &quot;Ask to borrow rain gear&quot;, 10)
($hubChoice: &quot;Borrow tech&quot;, &quot;Ask to borrow tech&quot;, 10)
($hubChoice: &quot;Lost and Found&quot;, &quot;Check the Lost and Found&quot;, 15)
($hubChoice: &#39;&quot;Borrow&quot; charger&#39;, &#39;&quot;Borrow&quot; someone\&#39;s charger&#39;, 15)]

(elseif:$resourceful is &lt; 2)[It&#39;s a mess out there. You&#39;ll need some rain gear before you leave. 

($hubChoice: &quot;Borrow gear&quot;, &quot;Ask to borrow rain gear&quot;, 10)
($hubChoice: &quot;Lost and Found&quot;, &quot;Check the Lost and Found&quot;, 15)]

(elseif:$techie is &lt; 2)[You still need some tech before you head out.

($hubChoice: &quot;Borrow tech&quot;, &quot;Ask to borrow tech&quot;, 10)
($hubChoice: &quot;Lost and Found&quot;, &quot;Check the Lost and Found&quot;, 15)
($hubChoice: &#39;&quot;Borrow&quot; charger&#39;, &#39;&quot;Borrow&quot; someone\&#39;s charger&#39;, 15)]

(elseif: $techie is &gt;=2 and $resourceful is &gt;=2)[You&#39;ve got all the tech and gear you need! 

[[Prepare to brave the storm-&gt;Get Ready part 2]]]</tw-passagedata><tw-passagedata pid="73" name="Borrow gear" tags="Resourceful" position="2175,300" size="100,100">(if:(history:) contains &quot;Borrow tech&quot;)[Your coworkers aren&#39;t thrilled to have to lend you stuff. Again. 

You end up with everything you need, including a light-up jellyfish umbrella! 

You&#39;ll just need to swing by the Lost and Found later for your dignity. 

($changeStat: $resourcefulName, 2)
($changeStat: $socialName, -1)
($changeStat: $trustName, -1)]
(else:)[One of the copyeditors lends you his rain boots and a light-up jellyfish umbrella.

&quot;I worked hard on that thing,&quot; he tells you. &quot;You better not harm a single tentacle.&quot; 

($changeStat: $techieName, 2)
($changeStat: $socialName, -1)]

(if:$resourceful is &gt;= 2 and $techie is &gt;=2)[[[Back to your desk-&gt;Get Ready part 2]]]
(else:)[[[Back to your desk-&gt;Get Ready]]]
</tw-passagedata><tw-passagedata pid="74" name="Lost and Found" tags="Resourceful Techie" position="2050,300" size="100,100">You dig through old, lost things: a flip phone, an mP3 player, a 2010 Cherry Festival T-shirt. 

Then--score! A phone charger and some rain gear!

($changeStat: $resourcefulName, 1)
($changeStat: $techieName, 1)

[[Back to your desk-&gt;Get Ready part 2]]</tw-passagedata><tw-passagedata pid="75" name="Borrow tech" tags="Techie" position="2050,675" size="100,100">(if:(history:) contains &quot;Borrow gear&quot;)[Your coworkers are tired of lending you stuff.

They give you the tech you need, but you notice that people have started hiding under their desks when you walk toward them. 

($changeStat: $techieName, 2)
($changeStat: $socialName, -1)
($changeStat: $trustName, -1)]
(else:)[You wander around, asking for a phone charger.

Your editor overhears your plight and lets you borrow her tech.

&quot;Journalism 101,&quot; she says. &quot;Don&#39;t let your phone die in the middle of a  natural disaster.&quot;

($changeStat: $techieName, 2)
($changeStat: $trustName, -1)]
(if:$resourceful is &gt;= 2)+(if:$techie is &gt;=2)[[[Back to your desk-&gt;Get Ready part 2]]]
(if:$resourceful is &lt; 2)[[[Back to your desk-&gt;Get Ready]]]</tw-passagedata><tw-passagedata pid="76" name="Get Ready part 2" tags="" position="2175,550" size="100,100">(if:$currentTime &gt; 0)[You&#39;ve got all the gear you need!

Your coworkers are rushing around, making phone calls. You should be out of here in (display: &quot;PRINT TIME&quot;).

(unless:(history:) contains &quot;Help Khalisa&quot;)[Outside, you notice Khalisa--the other field reporter--stuck in the flooded parking lot. 

You don&#39;t know much about her. Just that she&#39;s about your age, she grew up here in Twin Lakes, and gets a kick out of the fact that your last name is Rookie.

($hubChoice: &quot;Help Khalisa&quot;, &quot;Help Khalisa push her car to safety&quot;, 30)]

($hubChoice: &quot;Breakroom&quot;, &quot;Search the break room for snacks&quot;, 10)

($hubChoice: &quot;Research option - fill in&quot;, &quot;Read up on flooding at the library across the street&quot;, 30)

[[Enough stalling. Time to go.-&gt;Head out]]]
(else:)[You return to the office one last time and check the clock.

[[Oh no, you should be out there already...-&gt;Eject: Wasted too much time]]]</tw-passagedata><tw-passagedata pid="77" name="Drive" tags="" position="2700,300" size="100,100">($statGate: $bookwormName, 2)
(if: $bookworm is &gt;= 2)[Thanks to your meticulous planning, you manage to avoid the most dangerous flood zones!

Unfortunately, it also takes three times longer than usual to get downtown.

[[Arrive at flood site]]](else:)[You head out into the storm, wipers on full blast.

If you&#39;d done more research, maybe you&#39;d know which streets to avoid, but it&#39;s too late now. 

You&#39;re half a mile from downtown when water starts rising. 

The road ahead is totally covered! 

[[Find higher ground and pull over ASAP-&gt;Find higher ground]]
[[Try to drive through-&gt;Floor it]]]</tw-passagedata><tw-passagedata pid="78" name="Listen to the police scanner" tags="Egghead" position="2450,225" size="100,100">There&#39;s no such thing as too much research! 

Wellll....ok, maybe there is, but you&#39;re not about to go out in a 100-year-flood unprepared. 

You check in with your coworker, Sudha, whose job includes police-scanner monitoring.

She gives you an update--Main Street has become a rushing river, and half of the Cherry Festival tents have been swept away! You scribble down the details in your trusty notebook. 

($changeStat: $bookwormName, 1)
[[Back to your desk-&gt;Get Ready part 2]]</tw-passagedata><tw-passagedata pid="79" name="Head out" tags="" position="2575,550" size="100,100">Forget cats and dogs. It&#39;s raining an entire pet store. 

How are you going to get downtown in this mess? 

(if: $hasBike is true)[[Bike]]
[[Drive]]
(unless:(history:) contains &quot;Track down an expert to help you&quot;)[[Track down an expert to help you]]</tw-passagedata><tw-passagedata pid="80" name="Breakroom" tags="" position="2275,425" size="100,100">The storm has left the breakroom in shambles: 

Puddles of water on the floor, rain dripping from the ceiling into the coffee pot, a half-empty box of soggy donuts on the counter. 

[[Make a fresh pot of coffee for the newsroom]]
[[Search for snacks to boost your strength]]</tw-passagedata><tw-passagedata pid="81" name="Help Khalisa" tags="Endurance Trust" position="2300,875" size="100,100">Khalisa&#39;s car is stuck in a small puddle the size of a large puddle.

($statGate: $enduranceName, 2)
(if: $endurance &gt;= 2)[You muster up all your strength and manage to push her car to dry ground!](else:)[You push with all your strength and move her car about an inch.]

(if: $endurance &gt;=3)[&quot;Thanks, rookie,&quot; Khalisa says. &quot;I owe you one.&quot;](else:)[&quot;It&#39;s ok,&quot; Khalisa says. &quot;I appreciate the effort.&quot;]

($changeStat: $enduranceName, 1)
($changeStat: $trustName, 1)

[[Back to your desk-&gt;Get Ready part 2]]</tw-passagedata><tw-passagedata pid="82" name="Make a fresh pot of coffee for the newsroom" tags="Social Endurance" position="2350,550" size="100,100">You brew some cherry-infused Twin Lakes coffee. Locally made!

Soon all your coworkers are gathered around, trading flood stories.

The coffee tastes like vaguely fruit-flavored mud, but at least it&#39;s caffeinated! 

($changeStat: $socialName, 1)
($changeStat: $enduranceName, 1)
[[Back to your desk-&gt;Get Ready part 2]]</tw-passagedata><tw-passagedata pid="83" name="Search for snacks to boost your strength" tags="" position="2455,416" size="100,100">You find some organic, protein-infused cherry yogurt in the fridge, labeled K. Jones.

Also, some extra saltine crackers stuffed in a drawer.

[[Eat the yogurt for a boost of energy.-&gt;Yogurt]]
[[Grab a few saltine crackers.-&gt;Crackers]]</tw-passagedata><tw-passagedata pid="84" name="Eject: Wasted too much time" tags="" position="2350,675" size="100,100">You&#39;re about to head out into the storm when your editor strolls by.

&quot;Want to put on some coffee?&quot; she asks. &quot;We&#39;re almost out.&quot;

(link-reveal:&quot;\&quot;But... shouldn&#39;t I head downtown?\&quot; &quot;)[=

Your boss shakes her head. &quot;I saw you were still sitting around, so I gave the story to Khalisa.&quot;

You lost the scoop, rookie. Better luck next time! 

&#39;&#39;GAME OVER&#39;&#39;</tw-passagedata><tw-passagedata pid="85" name="&quot;Borrow&quot; charger" tags="" position="2168,678" size="100,100">One of the copyeditors is away from his desk. 

He left his phone charging, right out in the open. 

[[Swipe his charger]]
[[Unplug his phone and charge yours]]
[[Forget it. I&#39;ll find another way.-&gt;Get Ready]]</tw-passagedata><tw-passagedata pid="86" name="Swipe his charger" tags="" position="2175,875" size="100,100">You grab his charger and tuck it into your pocket.

His phone is at 92% battery. It&#39;ll be fine.

At least, you think it will be, until your editor calls you into her office. 

&quot;Look on the bright side,&quot; she says. &quot;You&#39;ll have a fully charged phone for your job hunt!&quot;

Apparently, this is a journalistic way of saying &quot;you&#39;re fired.&quot;
&#39;&#39;GAME OVER&#39;&#39;</tw-passagedata><tw-passagedata pid="87" name="Unplug his phone and charge yours" tags="Techie" position="2050,875" size="100,100">You can hear the copyeditor in the breakroom, bragging about his new, tricked-out jellyfish umbrella.

You unplug his phone, plug in yours, and try to look innocent.

When you hear him coming, you turn tail and run for it. 40% battery should be good enough. Probably. 

($changeStat: $techieName, 2)
($changeStat: $trustName, -1)

(if:$resourceful is &gt;= 2)+(if:$techie is &gt;=2)[[[Back to your desk-&gt;Get Ready part 2]]]
(if:$resourceful is &lt; 2)[[[Back to your desk-&gt;Get Ready]]]
</tw-passagedata><tw-passagedata pid="88" name="Track down an expert to help you" tags="" position="2725,700" size="100,100">You ask around for an expert informant to help you get downtown, but no one has any leads. 

(unless:(history:) contains &quot;Help Khalisa&quot;)[Khalisa might know someone. Too bad she&#39;s still bailing out her flooded car.

[[Back to your desk-&gt;Head out]]](elseif:(history:) contains &quot;Yogurt&quot;)[Khalisa might know someone, but she&#39;s digging through the breakroom fridge, looking annoyed. Muttering something about yogurt...

Now might not be the best time to bother her. 

[[Back to your desk-&gt;Head out]]](elseif:(history:) contains &quot;Help Khalisa&quot;)[Khalisa swings by your desk.

&quot;You need help getting downtown, rookie?&quot; she says. &quot;I know a great informant. Retired fire chief. Also happens to be my dad.&quot;

[[Call informant]]]</tw-passagedata><tw-passagedata pid="89" name="Bike" tags="Endurance" position="2700,550" size="100,100">Half of the roads are covered in water. Also fish, snakes, and the occasional sandhill crane. 

Good thing you can bike around them!

You weave around flooded areas, zoom down the bike path, and make it downtown in record time!

($changeStat: $enduranceName, 1)

[[Arrive at flood site]]</tw-passagedata><tw-passagedata pid="90" name="Call informant" tags="" position="2850,700" size="100,100">Khalisa&#39;s firefighter dad is happy to give you a lift downtown.

&quot;It&#39;s not safe out there for out-of-towners,&quot; he says. &quot;Wait out front, I&#39;ll come get you! 

[[Wait for a ride-&gt;Wait outside]]
[[Thanks, but I&#39;ll find my own way-&gt;Head out]]</tw-passagedata><tw-passagedata pid="91" name="Wait outside" tags="" position="2975,700" size="100,100">The former fire chief shows up in a tricked-out flood rescue vehicle. 

&quot;Rigged this baby up in my spare time,&quot; he says, and ferries you off into the floodwater. 

[[Take photos on the way]]
[[Ask for an interview]]</tw-passagedata><tw-passagedata pid="92" name="Find higher ground" tags="" position="2825,425" size="100,100">You swerve into a dry parking lot, just in time. 

People on the street are stalling out, abandoning their cars, and even climbing up onto their car roofs! 
	
You still need to get downtown. You try to check the flood map, but your wifi won&#39;t cooperate. 

[[Look around for something useful]]</tw-passagedata><tw-passagedata pid="93" name="Floor it" tags="" position="2825,300" size="100,100">You floor it and hope for the best. 

Your car splashes valiantly through the water for a few seconds, then sputters and dies. You’re stranded! 

You climb out onto the roof, floodwater rushing past. 

Minnows and bluegills jump around you. 

[[Swim for it]]
[[Wait for rescue]]
</tw-passagedata><tw-passagedata pid="94" name="Ask to borrow a kayak" tags="" position="3100,425" size="100,100">($statGate: $trustName, 4)
(if: $trust is &gt;=4)[The driver is happy to lend you their kayak.

&quot;I read your piece about the possoms living behind the high school. Really nice work!&quot;

&quot;Oh!&quot; You&#39;re amazed that anyone actually read it. &quot;Um, thank you!&quot;

[[Start paddling]]
](else:)[The driver looks reluctant.

&quot;You expect me to just //give// you my kayak? How do I know you&#39;re even a real reporter?&quot;

[[Make a trade to earn their trust]]
[[Head into the deli and find another way-&gt;Use deli wifi]]]</tw-passagedata><tw-passagedata pid="95" name="Use deli wifi" tags="Bookworm Resourceful" position="3225,300" size="100,100">($statGate: $socialName, 3)
(if: $social is &gt;=3)[You check the flood map and find a safer route!

The deli owner is worried about you.

He gives you a free sandwich to take with you and tells you to be careful out there.
($changeStat: $bookwormName, 1)
($changeStat: $resourcefulName, 1)](else:)[You check the flood map and find a safer route!

The deli owner gives you the side-eye.

He tells you to buy something if you want to stick around. This place is for paying customers only. 
($changeStat: $bookwormName, 1)]

[[Arrive at flood site]]</tw-passagedata><tw-passagedata pid="96" name="Start paddling" tags="Endurance" position="3100,550" size="100,100">You paddle out into the street. 

($changeStat: $enduranceName, 1)

Fish jump into your kayak, and debris from the cherry festival floats around you. 

[[Stop to take photos]]
[[Get downtown ASAP-&gt;Arrive at flood site]]</tw-passagedata><tw-passagedata pid="97" name="Arrive at flood site" tags="" position="3400,550" size="100,100">&#39;&#39;Location: the Upper Lake Dam&#39;&#39;
(if:visits is 1)[(set: $currentTime to 120)]
Volunteers are stacking sandbags by the road, with a DNR worker leading the effort.

You have (display:&quot;PRINT TIME&quot;) remaining to submit this story.

(if: $currentTime &gt; 20)[A houseboat floats on the overflowing river, with a lady lounging on deck and &quot;Nora&#39;s Ark&quot; painted on the hull. 

($hubChoice: &quot;Talk to volunteer # 1&quot;,&quot;Speak with a volunteer taking a break from heaving sandbags&quot;, 20)
($hubChoice: &quot;Talk to volunteer # 2&quot;,&quot;Speak with a volunteer gearing up to leave&quot;, 20)
($hubChoice: &quot;Interview the DNR worker&quot;,&quot;Speak with the woman leading things&quot;, 20)
($hubChoice: &quot;Talk to the houseboat lady&quot;,&quot;Climb up onto... \&quot;Nora&#39;s Ark\&quot;&quot;, 30)
($hubChoice: &quot;Take photos of the flood site&quot;,&quot;Snap some photos of the area&quot;, 20)
($hubChoice: &quot;Cherry Festival Map&quot;,&quot;Walk down the street to the Cherry Festival&quot;, 10)
](else:)[That leaves just enough time to [[compile your story...]] ]


[[Skip to Level 2, Story 3: The Science Story-&gt;Level 2, Story 3: The Science Story]]</tw-passagedata><tw-passagedata pid="98" name="Yogurt" tags="Endurance" position="2300,225" size="100,100">You take a yogurt cup. Mmm. Sweet, protein-rich goodness.

K. Jones won&#39;t even notice. Probably.

($changeStat: $enduranceName, 2)
($changeStat: $trustName, -1)
[[Back to your desk-&gt;Get Ready part 2]]</tw-passagedata><tw-passagedata pid="99" name="Crackers" tags="Endurance" position="2300,100" size="100,100">You nibble on a few crackers.

They&#39;re not exactly nourishing, but at least you&#39;ve dodged the breach in trust that comes with stealing an innocent coworker&#39;s snacks!

($changeStat: $enduranceName, 1)

[[Back to your desk-&gt;Get Ready part 2]]</tw-passagedata><tw-passagedata pid="100" name="Swim for it" tags="" position="2825,175" size="100,100">The rushing water comes up to your knees.

At first you think you might make it!

(text-style:&quot;sway&quot;)[Then the current sweeps you off your feet. ]

[[Just keep swimming...-&gt;Eject: Just keep swimming...]]</tw-passagedata><tw-passagedata pid="101" name="Wait for rescue" tags="" position="2950,300" size="100,100">You sit on your car roof, contemplating the meaning of life.

Finally, a retired firefighter swings by in a flood rescue vehicle! 

($statGate: $socialName, 3)
(if: $social is &lt;= 2)[He&#39;s happy to drive you downtown, but less inclined to give an interview. 

&quot;Sorry,&quot; he says, &quot;no time for idle chit chat. I&#39;ve got a pint of black cherry ice cream melting in the back.&quot;

You wish you could change his mind, but social niceties aren&#39;t exactly your thing. 

[[Arrive at flood site]]]

(if: $social is &gt;2)[You have a great conversation as he drives you downtown. He even grabs some black cherry ice cream from the back and shares it with you.

&quot;I was the Twin Lakes fire chief for twenty years,&quot; he says. &quot;I&#39;ve never seen anything like this.&quot;

($gainSnippet: &quot;Quote&quot;,&quot;Fire chief quote&quot;)

[[Arrive at flood site]]]</tw-passagedata><tw-passagedata pid="102" name="Eject: Just keep swimming..." tags="" position="2950,175" size="100,100">You end up in a lake, which used to be the high school football field.  

The good news: you&#39;re alive!

The bad news: you lose your shoes, ruin all your tech, and sit on the bleachers for hours waiting to be rescued. 

&#39;&#39;GAME OVER&#39;&#39;</tw-passagedata><tw-passagedata pid="103" name="Take photos on the way" tags="" position="3100,800" size="100,100">($statGate: $techieName, 3)
(if: $techie &gt;=3)[On the way downtown, you get some great shots with your zoom lens:

People kayaking down Shortbread Street, and a crate of fresh cherries floating down the road!

($gainSnippet:&quot;Photo&quot;,&quot;Great flood photos&quot;)](else:)[You snap photos of the street around you. 

Too bad you don&#39;t have the right lens. 

There&#39;s a crate of cherries floating through the water, but it ends up looking like a red blur.

($gainSnippet:&quot;Photo&quot;,&quot;Blurry flood photos&quot;)]

[[Arrive at flood site]]</tw-passagedata><tw-passagedata pid="104" name="Ask for an interview" tags="" position="3100,675" size="100,100">The former chief is thrilled to chat with you.

He spends most of the ride trying to set you up with Khalisa (she&#39;s single, adventurous, loves yogurt and long walks on the beach). 

You should have time to squeeze in one question. 

[[Ask how the flood has affected his family.]]
[[Ask for flood safety tips.]]
[[Ask what caused the flood.]]</tw-passagedata><tw-passagedata pid="105" name="Talk to volunteer # 1" tags="" position="3575,125" size="100,100">A volunteer is standing off to the side, wiping rain off his glasses.

($statGate: $socialName, 3)
(if: $social &gt;2)[He&#39;s thrilled when you ask to interview him! You seem to be getting a reputation for being easy to talk to. 

He tells you how he became a volunteer and where people can find sandbags.

...also, his favorite color and the names of his three German Shepherds.

($gainSnippet:&quot;Quote&quot;, &quot;Sandbag quote&quot;)
($gainSnippet:&quot;Fact&quot;, &quot;Volunteer info&quot;)

](else:)[You ask for an interview, but he seems reluctant to talk to you.

[[Offer to share some food with him]]
[[Ask if he&#39;ll talk off the record]]]
[[Back to the dam-&gt;Arrive at flood site]]</tw-passagedata><tw-passagedata pid="106" name="Interview the DNR worker" tags="" position="3575,625" size="100,100">($statGate: $socialName, 3)
(if: $social &gt;2)[The DNR worker seems to recognize you.

&quot;You work for the Herald, right?&quot; she says. &quot;Sounds like you&#39;ve been making a lot of friends around here! Do you need an interview?&quot;

[[&quot;Oh... yeah, that would be great!&quot;-&gt;Dam: Interview DNR Worker]]](if: $social &lt;=2)[The DNR worker looks relieved to see you. Then she notices you&#39;re a reporter, not a volunteer.

&quot;Sorry, kid, but we&#39;re literally swamped here. Help or get out of the way.&quot;

[[Help move some sandbags.]]
[[Talk to someone else.-&gt;Arrive at flood site]]]</tw-passagedata><tw-passagedata pid="107" name="Talk to the houseboat lady" tags="" position="3575,850" size="100,100">The houseboat lady is thrilled to talk with you.

&quot;Houseboat, stay afloat!&quot; she chants.

[[&quot;Can you tell me how the flood has affected you?&quot;]]
[[&quot;What&#39;s the deal with the houseboat?&quot;]]</tw-passagedata><tw-passagedata pid="108" name="Take photos of the flood site" tags="" position="3400,800" size="100,100">($statGate:$techieName, 3)
(if: $techie &gt;= 3)[The conditions are terrible out here.

Luckily you&#39;ve got a fully charged phone and a fancy zoom lens!

You snag some great photos--the volunteers working, the overflowing dam, and two cats peeking out the window of the houseboat. 

($gainSnippet:&quot;Photo&quot;,&quot;Houseboat photos&quot;)](if:$techie is 2 and $endurance &gt;=3)[($statGate:$enduranceName, 3)
You don&#39;t have a zoom lens, but you notice a sturdy-looking tree near the dam! 

You muster up all your strength and climb to the top branches for a perfect shot.

(if:(history:) contains &quot;Chase chickens&quot;)[Turns out running around after chickens is a pretty great workout!](else:)[Looks like your cherry-themed breakfast is paying off.]

($gainSnippet:&quot;Photo&quot;,&quot;Houseboat photos&quot;)](elseif:$techie is 2 and $resourceful &gt;=3)[($statGate:$resourcefulName, 3)
Your gear isn&#39;t fancy, but that&#39;s never stopped you before. 

You rig up a tripod with a broken branch, a shoelace, and a hair scrunchie. 

You didn&#39;t binge-watch all those episodes of MacGyver for nothing. 

($gainSnippet:&quot;Photo&quot;,&quot;Houseboat photos&quot;)](else-if:$techie is 2 and $social &gt;=3)[($statGate:$socialName, 3)
You can&#39;t get a clear shot without a zoom lens.

You&#39;re about to give up when when you hear a voice from behind you.

($gainSnippet:&quot;Photo&quot;,&quot;Houseboat photos&quot;)](elseif:$techie is 2)[You use your modest tech gear to snap some photos.

They might not win any prizes, but they should be good enough.

($gainSnippet:&quot;Photo&quot;,&quot;Okay houseboat photos&quot;)]
(if: $techie is 1)[The conditions are terrible and so is your photography gear.

You manage to snap a few blurry shots. 

($gainSnippet:&quot;Photo&quot;,&quot;Blurry houseboat photos&quot;)]
[[Back to the dam-&gt;Arrive at flood site]]</tw-passagedata><tw-passagedata pid="109" name="Offer to share some food with him" tags="" position="3700,125" size="100,100">($statGate: $resourcefulName, 4)
(if: $resourceful is &gt;=4)[You unwrap your sandwich and give the volunteer half.

It&#39;s a little soggy, but he still seems grateful.

He tells you about how he started volunteering. 

&quot;People can sign up at the Twin Lakes Community Center,&quot; he says. &quot;They&#39;ve got plenty of sandbags, but a lot of people don&#39;t know where to find them!&quot;

($gainSnippet:&quot;Quote&quot;,&quot;Great volunteering quote&quot;)
($gainSnippet:&quot;Fact&quot;,&quot;Volunteer info&quot;)](if: $resourceful is &lt;4)[You dig through your backpack and find half a protein bar.

&quot;Um...do you want this?&quot; you say awkwardly. 

He shakes his head. &quot;Nah. Thanks, but I better get back to work.&quot;

[[Ask if he&#39;ll talk off the record]]]

[[Back to the dam-&gt;Arrive at flood site]]</tw-passagedata><tw-passagedata pid="110" name="Ask if he&#39;ll talk off the record" tags="" position="3700,250" size="100,100">($statGate:$trustName, 3)
(if: $trust is &lt; 3)[He still doesn&#39;t seem convinced. &quot;Please don&#39;t put my name in your article, okay?&quot; 

He tells you that he did flood training at the community center. 

You reeeeally wish you could quote him, but it&#39;s better than nothing.

($gainSnippet:&quot;Fact&quot;,&quot;Volunteer info&quot;)]
(if: $trust is &gt;=3)[Something about talking with you seems to put his mind at ease.

He gives you an amazing quote, and tons of great info about volunteering!

($gainSnippet:&quot;Quote&quot;,&quot;Great volunteering quote&quot;)
($gainSnippet:&quot;Fact&quot;,&quot;Volunteer info&quot;)]


[[Back to the dam-&gt;Arrive at flood site]]</tw-passagedata><tw-passagedata pid="111" name="Record your observations" tags="" position="3400,925" size="100,100">($statGate:$techieName, 3)
(if: $techie &gt;=3)[You use your voice app to rattle off some notes: 

The overflowing dam, the 10 volunteers and the brand of rain jackets they&#39;re wearing, the make and models of the cars stranded in the street, even the name of the houseboat--Nora&#39;s Ark.

($gainSnippet:&quot;Observation&quot;,&quot;Super detailed observation&quot;)](elseif: $resourceful &gt;2)[
($statGate:$resourcefulName, 3)
Normally you&#39;d take notes on your phone, but your battery power is alarmingly low. 

Luckily, you came prepared! You whip out your trusty notebook and record your observations, writing to the glow of your light-up umbrella. 

($gainSnippet:&quot;Observation&quot;,&quot;Detailed observation&quot;)](elseif: $social &gt;3)[
($statGate:$resourcefulName, 3)
($statGate:$socialName, 4)
Your phone battery is low, and your notebook is lost somewhere in the war zone of your apartment.

Thankfully, one of the volunteers is willing to lend you their charger!

You charm them with witty conversation while your phone charges, and even end up with a quote for your story.

($gainSnippet:&quot;Observation&quot;,&quot;Detailed observation&quot;)
($gainSnippet:&quot;Quote&quot;,&quot;Volunteer conversation&quot;)](else:)[($statGate:$resourcefulName, 3)
($statGate:$socialName, 4)
Your phone battery is alarmingly low.

You switch to airplane mode to save power and take a few frantic notes.

It&#39;s not exactly prize-winning prose, but it&#39;s better than nothing.

($gainSnippet:&quot;Observation&quot;,&quot;Basic observation&quot;)]

[[Back to the dam-&gt;Arrive at flood site]]</tw-passagedata><tw-passagedata pid="112" name="Help move some sandbags." tags="" position="3700,725" size="100,100">($statGate:$enduranceName,3)
(if: $endurance is &gt;=3)[You grab some sandbags and start stacking. Easy, peasy. 

The DNR worker looks impressed. &quot;You&#39;re tougher than you look. I guess I can answer a few questions.&quot;


[[Interview DNR Worker-&gt;Dam: Interview DNR Worker]]](if: $endurance is &lt;3)[You try to lift a sandbag, which goes about as well as you&#39;d expect for someone who woke up at 4 a.m. and had saltine crackers for breakfast. 

To the DNR worker&#39;s credit, she only laughs a little.

&quot;Don&#39;t worry,&quot; she says. &quot;I can barely lift those myself.&quot;

She agrees to answer one question. 

[[&quot;When will the situation be under control?&quot;]]
[[&quot;How can people protect their houses and businesses?&quot;]]
[[&quot;How did the city let this happen?&quot;]]]</tw-passagedata><tw-passagedata pid="113" name="Look around for something useful" tags="" position="2950,425" size="100,100">You see a deli with a (text-style:&quot;blink&quot;)+(text-color:red)+(text-style:&quot;smear&quot;)[Come On In!] sign flashing. 

Another driver is stranded with you, a pair of kayaks strapped to their roof. 

[[Ask to borrow a kayak]]
[[Go into the deli and use their wifi-&gt;Use deli wifi]]</tw-passagedata><tw-passagedata pid="114" name="Ask how the flood has affected his family." tags="" position="3225,925" size="100,100">&quot;We&#39;re doing fine,&quot; he says. &quot;But our house is on high ground, and we&#39;ve got plenty of sandbags. Other folks aren&#39;t so lucky.&quot;

($gainSnippet:&quot;Quote&quot;,&quot;Great flood quote&quot;)

[[Arrive at flood site]]</tw-passagedata><tw-passagedata pid="115" name="Ask for flood safety tips." tags="" position="3225,675" size="100,100">He gives you some great tips:

Don&#39;t try to drive through floodwater, and use sandbags to protect your house.

&quot;The problem is, most people don&#39;t have sandbags and don&#39;t know where to get&#39;em,&quot; he says.

($gainSnippet:&quot;Quote&quot;,&quot;Great flood quote&quot;)
($gainSnippet:&quot;Fact&quot;,&quot;Flood safety tips&quot;)

[[Arrive at flood site]]</tw-passagedata><tw-passagedata pid="116" name="Ask what caused the flood." tags="" position="3225,800" size="100,100">He gives you a funny look. &quot;I&#39;m gonna go out on a limb here and say that it was the rain.&quot;

Well, he&#39;s got a point there. 

[[Arrive at flood site]]</tw-passagedata><tw-passagedata pid="117" name="Talk to volunteer # 2" tags="" position="3575,375" size="100,100">You approach a volunteer as she&#39;s just packing up.

&quot;Sorry, can&#39;t talk, gotta go sample the bacterial contamination in the epilimnion of Upper Lake,&quot; she says.

($statGate:$bookwormName, 3)
(if: $bookworm &gt;=3)[[[&quot;Interesting. Are you worried the flooding will contribute to toxic algae growth?&quot;-&gt;Bookworm answer]]]
(else:)[[[&quot;Um....epi-whatium?&quot;-&gt;Non-bookworm answer]]]</tw-passagedata><tw-passagedata pid="118" name="&quot;What&#39;s the deal with the houseboat?&quot;" tags="" position="3700,835" size="100,100">&quot;I&#39;ve been telling everyone for years,&quot; she says. &quot;Houseboats are the future!&quot; 

Uh oh. This could go on for a while. 

($statGate:$socialName, 3)
(if: $social &gt;=3)[Fortunately, you have the social know-how to gracefully exit the conversation.

&quot;Float on by any time,&quot; she calls. &quot;You know where to find me!&quot;

($gainSnippet:&quot;Quote&quot;,&quot;Houseboat story&quot;)
[[Back to the dam-&gt;Arrive at flood site]]](else:)[You try to escape, but you can&#39;t get a single word in.

The plus side: now you know more about houseboats than literally anyone else you&#39;ve ever met. 

($gainSnippet:&quot;Quote&quot;,&quot;Houseboat story&quot;)

[[Back to the dam (finally!!!)-&gt;Arrive at flood site]]]</tw-passagedata><tw-passagedata pid="119" name="Interview her" tags="" position="3851,345" size="100,100">The lake expert is happy to talk to a fellow limnology nerd.

She tells you that she&#39;s been warning about a catastrophic flood for years.

&quot;The lake levels were too high,&quot; she says. &quot;It was only a matter of time.&quot;

($gainSnippet: &quot;Quote&quot;,&quot;Lake levels&quot;)
($gainSnippet: &quot;Info&quot;,&quot;Flood cause&quot;)

[[Back to the dam -&gt;Arrive at flood site]]</tw-passagedata><tw-passagedata pid="120" name="Ask to go with her" tags="" position="3825,475" size="100,100">($statGate: $trustName, 3)
(if: $trust &gt;=3)[She&#39;s happy to take a fellow limnologist along for the ride! 

She gives you some spare waders to put on, and you go out into the shallows, where she takes samples with some fancy tech.

You end up getting some great photos and science info about the Twin Lakes watershed!

Unfortunately, it also takes you an hour just to make it back to the dam.
(set: $currentTime to it - 60)
($gainSnippet: &quot;Fact&quot;,&quot;Flood science&quot;)
($gainSnippet: &quot;Photo&quot;,&quot;Lakewater study&quot;)

[[Back to flood site-&gt;Arrive at flood site]]]
(else:)[She gives you a sideways glance. &quot;Uh... Sorry, I don&#39;t gather data together until at //least// the second date.&quot;

She leaves in short order - and good thing, too, because that was getting awkward.
[[Back to flood site-&gt;Arrive at flood site]]]</tw-passagedata><tw-passagedata pid="121" name="Bookworm answer" tags="" position="3701,361" size="100,100">She looks surprised. &quot;Are you a limnologist, too?&quot;

&quot;Just a reporter, but I&#39;m also an avid reader.&quot;

She frowns. &quot;I could answer a few questions, but then I need to run.&quot;

[[Interview her]]
[[Ask to go with her]]</tw-passagedata><tw-passagedata pid="122" name="Non-bookworm answer" tags="" position="3700,475" size="100,100">She shakes her head. 

&quot;Sorry, it&#39;s a lake science thing. You wouldn&#39;t understand.&quot;

[[Back to the dam-&gt;Arrive at flood site]]]</tw-passagedata><tw-passagedata pid="123" name="&quot;Can you tell me how the flood has affected you?&quot;" tags="" position="3700,950" size="100,100">&quot;The flood has been lovely,&quot; she says. &quot;Though all those volunteers would probably be happier on a houseboat.&quot;

($statGate:$trustName, 3)
(if: $trust &gt;=3)[You agree with her, they probably would.

The houseboat lady, whose name really is Nora, seems to trust you.

She tells you all about what she saw when the flood started, and even lets you pet one of her matching pairs of cats. 

($gainSnippet:&quot;Quote&quot;,&quot;Great houseboat story&quot;)](elseif: $bookworm &gt;=3)[You try to explain that a world full of people on boats probably isn&#39;t the answer to climate change.

Nora the houseboat lady isn&#39;t convinced. &quot;Save your debate team arguments, dear. My cats and I are purrrrfectly happy here. Pun very much intended.&quot;

($gainSnippet:&quot;Quote&quot;,&quot;Houseboat story&quot;)

[[Back to the dam-&gt;Arrive at flood site]]](else:)[You ask her about the flooding.

&quot;It&#39;s not just about floods,&quot; she says. &quot;Hosueboats are great in winter, too. Just travel south! If geese can do it, why not us?&quot; 

(link:&quot;\&quot;Yeah, that&#39;s great. So about the flooding...\&quot;&quot;)[&quot;Let me put it this way. My houseboat can do literally anything your house can do. Plus, float!!&quot; 

($gainSnippet:&quot;Quote&quot;,&quot;Houseboat story&quot;)

[[Back to the dam -&gt;Arrive at flood site]]]]</tw-passagedata><tw-passagedata pid="124" name="Message CherryCharlie07" tags="" position="1450,800" size="100,100">($statGate: $trustName, 2)
(set: $currentTime to it - 10)
(if:$trust &gt; 1)[//oh yeah, i recognize your username from some of the stories you&#39;ve Squawked out! go right ahead 😊//

($gainSnippet:&quot;Photo&quot;,&quot;Library lot&quot;)](else:)[//the twin lakes herald?? that sounds fake. how do i know you&#39;re a real reporter?//

($statGate: $techieName, 3)
(if: $techie &gt; 2)[You&#39;ve been waiting your whole life for this moment.

You rain down on them with credentials: press badge, bylines, your photo on the Twin Lake Herald website (whch you singlehandedly created).  

You&#39;ve earned their permission--and their respect.

($gainSnippet:&quot;Photo&quot;,&quot;Library lot&quot;)](else:)[You don&#39;t have time for this. You log off and grab a stock photo. 

At least it&#39;s better than nothing. Probably.

($gainSnippet:&quot;Photo&quot;,&quot;Grainy picture&quot;)]]


(display: &quot;Office 1 - Clock&quot;)</tw-passagedata><tw-passagedata pid="125" name="Police Response" tags="" position="1450,425" size="100,100">(if:(history:) contains &quot;Help Her&quot;)[The officer is suddenly more cheerful. &quot;Oh, I&#39;ve heard of you! Didn&#39;t you help rescue Maureen&#39;s chickens this morning?&quot;

You&#39;re shocked that he knows about this. &quot;Yeah, uh, that was me.&quot;

He gives you a great interview, including an anectdote about a man whose car got swept into a ditch! 

&quot;Rescuers pulled him out just in time,&quot; he says. &quot;People need to remember: turn around, don&#39;t drown!&quot;

($gainSnippet:&quot;Fact&quot;,&quot;Flood background&quot;)
($gainSnippet:&quot;Quote&quot;,&quot;Police story&quot;)
](else:)[The officer coughs awkwardly. &quot;Um. You&#39;re Maureen&#39;s neighbor, aren&#39;t you? She said you nearly ran over her chickens this morning.&quot;

It seems so unfair that he knows about this. &quot;I wouldn&#39;t say &#39;ran over,&#39; exactly...&quot;

He gives you a few basic quotes about safety: don&#39;t drive through high water, and avoid flood risk areas.

&quot;Just check the city map next time,&quot; he says gruffly, &quot;it&#39;s all in there.&quot;

($gainSnippet:&quot;Quote&quot;,&quot;Police safety quote&quot;)]

(display: &quot;Office 1 - Clock&quot;)</tw-passagedata><tw-passagedata pid="126" name="Make a trade to earn their trust" tags="Resourceful Techie" position="3225,425" size="100,100">You dig through your bag and find an expensive set of camera lenses. 

(if:(history:) contains &quot;Grab some breakfast&quot;)[The driver isn&#39;t interested--but they do notice the granola you brought from home. 

&quot;Wow! Is that Jim&#39;s famous cherry crisp granola??&quot; 

(link:&quot;\&quot;Uh, I think so? Jim is my neighbor.\&quot;&quot;)[The driver gladly accepts the trade.

Time to get on the water!

($changeStat: $resourcefulName, -1)

[[Start paddling]]]](if:(history:) contains &quot;Check on your upstairs neighbor&quot;)[You neighbor isn&#39;t interested--but they do notice the cherry-embroidered hat from your neighbor.

&quot;Wow! What lovely craftsmanship!&quot; 

You offer them the hat as collateral, and they lend you the kayak!

($changeStat: $resourcefulName, -1)

[[Start paddling]]](else:)[The driver still seems reluctant, but they accept the trade and give you the kayak. 

The good news: you&#39;ve got a way to get downtown!

The bad news: it&#39;ll be tricky to get decent photos once you get there. 

($changeStat: $techieName, -2)

[[Start paddling]]]</tw-passagedata><tw-passagedata pid="127" name="Stop to take photos" tags="" position="3225,550" size="100,100">($statGate: $techieName, 2)
(if: $techie &lt;=1)[You float in the street and snap some photos.

As expected, they turn out awful. You&#39;re already wishing you had those lenses back.

($gainSnippet:&quot;Photo&quot;,&quot;Blurry flood photos&quot;)


[[Arrive at flood site]]]
(if: $techie is 2)[You float in the street and snap some photos.

You don&#39;t have your zoom lens, but you&#39;re right in the middle of the action, so the photos turn out okay!

($gainSnippet: &quot;Photo&quot;,&quot;Good flood photos&quot;)

[[Arrive at flood site]]](if: $techie &gt;2)[You use your tech gear to snap some amazing photos!

Jars of cherry jam, carp flopping out of the water, and even a water snake slithering by.

($gainSnippet:&quot;Photo&quot;,&quot;Great flood photos&quot;)

[[Arrive at flood site]]]
</tw-passagedata><tw-passagedata pid="128" name="Level 2, Story 3: The Science Story" tags="" position="4550,550" size="100,100">(link:&quot;The next morning...&quot;)[You wake up to an eerily quiet morning.

The chance of rain is hovering at 30%. If more rain comes, Twin Lakes could be in big trouble. 

[[Gather flood gear]]
[[Go outside and help your neighbors]]
[[Make breakfast]]
[[Check social media]]
[[Read a book before work]]]</tw-passagedata><tw-passagedata pid="129" name="Cherry Festival Map" tags="" position="3965,548" size="100,100">&#39;&#39;Location: the Main Street Cherry Festival&#39;&#39;
You wade through a few inches of water to get to Main Street.

As soon as you arrive, you realize how serious this is.

The street is a rushing river, with wreckage everywhere--broken signs, tents flapping in the wind, thousands of cherries floating downstream. 

Cars are stranded, and people are clustered in dry areas and on rooftops. From around the corner, you can hear sirens and splashing. There&#39;s movement in a cheese shop nearby.

You have (display:&quot;PRINT TIME&quot;) remaining to submit this story.

(if: $currentTime &gt; 20)[($hubChoice:&quot;Go inside specialty cheese shop&quot;,&quot;Go inside specialty cheese shop&quot;, 10)
($hubChoice:&quot;Take photos of the street&quot;,&quot;Snap some pictures of the dismal scene&quot;, 20)
($hubChoice:&quot;Follow the sirens&quot;,&quot;Head towards the source of the sirens and splashing&quot;, 20)

($hubChoice:&quot;Arrive at flood site&quot;,&quot;Head back to the flood site&quot;, 20)]
(else:)[That leaves just enough time to [[compile your story...]] ]</tw-passagedata><tw-passagedata pid="130" name="Take photos of the street" tags="" position="4098,685" size="100,100">You get some amazing photos of deep water rushing down Main Street. 

You never imagined it would get this bad. It&#39;s like a scene out of a disaster movie.

//Get photos: flooded Main Street//

[[Cherry Festival Map]]</tw-passagedata><tw-passagedata pid="131" name="Follow the sirens" tags="" position="4100,413" size="100,100">You turn the corner and find a rescue in progress: a van stuck in a ditch, water rushing all around it!

You snap some photos as firefighters pull the passengers out.

A dog nearly gets swept away, but a rescue worker scoops it up just in time.

($gainSnippet: &quot;Fact&quot;,&quot;Dog rescue&quot;)
($gainSnippet: &quot;Photo&quot;,&quot;Dog rescue picture&quot;)

[[Cherry Festival Map]]</tw-passagedata><tw-passagedata pid="132" name="Answer phone" tags="" position="4900,525" size="100,100">It&#39;s your editor, calling from the newsroom. 

Which, according to her, is now completely flooded.

&quot;The computers are ruined,&quot; she says. &quot;The plants are thriving, though. I always forget to water them.&quot;

She gives you your next assignment: a feature on the science of flooding.

[[&quot;Um... I&#39;m not really a science writer.&quot;-&gt;Assignment: Science Story]]</tw-passagedata><tw-passagedata pid="133" name="Assignment: Science Story" tags="" position="5025,525" size="100,100">&quot;Then it&#39;s the perfect time to learn,&quot; she says. &quot;I need you to report on the science of how this happened, and how we can prevent it from happening again.&quot;

[[&quot;Ok. Uh... any tips?&quot;]]</tw-passagedata><tw-passagedata pid="134" name="Make breakfast" tags="Endurance Trust Social" position="4725,525" size="100,100">Yesterday would have been grocery day if it weren&#39;t for all of the... yeah.

(if:(history:) contains &quot;Help her&quot;)[Your cupboards are still pretty empty.

Luckily, Maureen stops by with a carton of fresh eggs!

You chat with her while you whip up an omelet. 

($changeStat:$enduranceName, 1)
($changeStat:$socialName, 1)]
(elseif:(history:) contains &quot;Help the baker&quot;)[You&#39;re starting to get sick of cherry pie for breakfast. 

Then you remember the leftover granola from the bakery! You text the baker a quick thank you, and she texts back:

//No prob, thanks for the help yesterday. Loved ur story! xoxo//

($changeStat:$enduranceName, 1)
($changeStat:$socialName, 1)]
(elseif:(history:) contains &quot;Help him pack up his wares&quot;)[The sparse cupboards make your stomach grumble when you suddenly remember!

In the corner of the fridge is some slightly soggy Emmentaler cheese that shop-owner offered you when you helped bail out the cheese emporium. Score!
($changeStat:$enduranceName, 2)]

(else:)[You&#39;re struggling to find some not-expired food when a neighbor shouts through the front window.

&quot;Hiya! You wrote that news story yesterday, right? Thanks to you, I got all my stuff out of the basement before it flooded!&quot;

He offers you a homemade lemon loaf--a little off-brand for the Cherry Capital of the Midwest, but still delicious.  

($changeStat:$enduranceName, 1)
($changeStat:$trustName, 1)]

[(text-style:&quot;shudder&quot;)[RRRRING.]
[[Answer phone]]]</tw-passagedata><tw-passagedata pid="135" name="Check social media" tags="Social Trust" position="4725,400" size="100,100">Your story has been liked and re-squawked hundreds of times!

Most people in the comments are thanking you for helping them stay safe. 

A few are convinced that the flood is just a scam to get people to buy flood insurance, because //their// streets are fine. 
($changeStat:$socialName, 1)

(link-reveal: &quot;Ignore the haters&quot;)[(replace:&quot;Dunk on the haters&quot;)[]
You keep a stiff upper lip and disregard the trolls commenting on your article.

($changeStat:$trustName, 1)

(text-style:&quot;shudder&quot;)[RRRRING.]
[[Answer phone]]]
(link-reveal: &quot;Dunk on the haters&quot;)[(replace:&quot;Ignore the haters&quot;)[]
($statGate:$techieName,3)
(if:$techie &gt;=3)[You quote-resquawk some of the haters&#39; replies with a sick own and ratio them //real// good. The clicks on your article keep going up, plus a few extra followers too!

($changeStat:$socialName, 1)](else:)[In a bit of a tizzy, you Squawk out some ill-advised hot takes.

You take a break to cool off and come back to you find that you&#39;ve been cancelled by a not-insignificant portion of the website. Whoops.

($changeStat:$trustName, -2)]

(text-style:&quot;shudder&quot;)[RRRRING.]
[[Answer phone]]]




</tw-passagedata><tw-passagedata pid="136" name="Science Story Map" tags="" position="5275,475" size="200,200">&#39;&#39;Twin Lakes Map&#39;&#39;
(if: visits is 1)[(set:$currentTime to 180)]

(unless: $currentTime &lt;= 20)[
This story is due in (display: &quot;PRINT TIME&quot;).
What do you want to do? 

($hubChoice: &quot;Bike downtown to survey the damage&quot;, &quot;Bike downtown to survey the damage&quot;, 20)
($hubChoice: &quot;DNR Map&quot;, &quot;Stop by the Department of Natural Resources&quot;, 20)
($hubChoice: &quot;Gather flooding info from academic papers&quot;, &quot;Get online and read academic papers about flooding&quot;, 30)

(if:(history:) contains &quot;Thanks, plus university contact&quot; or &quot;Read the bulletin board in the hallway&quot;)[($hubChoice: &quot;Department of Limnology&quot;, &quot;Visit the Department of Limnology&quot;, 20)]

[[Phone Contacts]]]
(else:)[ [[Time to assemble the science story...]]
]</tw-passagedata><tw-passagedata pid="137" name="Bike downtown to survey the damage" tags="" position="5400,725" size="100,100">You pedal through town, weaving around abandoned cars and piles of trash.
($changeStat:$enduranceName, 1)

All up and down the streets, people are dragging soaked furniture outside and shoring up sandbags.

(if:(history:) contains &quot;Help her&quot;)[From down a side street, you hear a soft clucking. Did another of Maureen&#39;s chickens escape its coop??](else:)[From down a side street, you hear a soft clucking. Amelia Egghart???]

[[Follow the chicken]] (text-colour:purple)[(10 minutes)]
[[Head straight to Main Street-&gt;Main Street Flood Recovery]]</tw-passagedata><tw-passagedata pid="138" name="DNR Map" tags="" position="5650,271" size="100,200">&#39;&#39;Location: DNR Headquarters&#39;&#39;
This story is due in (display: &quot;PRINT TIME&quot;).

Turns out even the DNR headquarters isn&#39;t safe from flooding!

Workers are airing out the hallways with giant fans. The carpets squelch like swampland under your feet.

($hubChoice:&quot;Knock on the nearest office door&quot;,&quot;Knock on the nearest office door&quot;, 20)
($hubChoice:&quot;Read the bulletin board in the hallway&quot;,&quot;Read the bulletin board in the hallway&quot;, 20)
($hubChoice:&quot;Run into the mayor in hallway&quot;,&quot;Head out&quot;, 20)

(if:(history:) contains &quot;Jenkins&#39;s Computer&quot;)[ ($hubChoice:&quot;Look for your DNR Contact, Wynne D. Storme&quot;,&quot;Look for your DNR Contact, Wynne D. Storme&quot;, 20) ]

[[Time to head back-&gt;Science Story Map]]</tw-passagedata><tw-passagedata pid="139" name="Gather flooding info from academic papers" tags="" position="5195,975" size="100,100">($statGate:$bookwormName, 3)
(if: $bookworm &gt;=3)[You get online and find several academic papers about flooding! 

As a proud bookworm, you have no problem deciphering the info. 

You end up with tons of great background on the Twin Lakes watershed, plus some graphics for your article!

($gainSnippet: &quot;Fact&quot;,&quot;Science of flooding&quot;)
($gainSnippet: &quot;Graph&quot;,&quot;Flood probability&quot;)](else:)[You end up with a ton of handwritten notes about the science of flooding!

Now if only you had a clue what any of it meant, or what all these confusing-looking diagrams were for...

($gainSnippet: &quot;Observation&quot;,&quot;Flood mumbo jumbo&quot;)
($gainSnippet: &quot;Graph&quot;,&quot;Confusing graphic&quot;)]

[[Science Story Map]]</tw-passagedata><tw-passagedata pid="140" name="Department of Limnology" tags="" position="6566,900" size="100,200">You arrive at the Department of Limnology, located right on the lake.

The dock is covered in murky, greenish water.

People are rushing in and out of the boathouse, bailing out water. 

(unless: $currentTime &lt;= 20)[
($hubChoice:&quot;Photograph flooded dock&quot;,&quot;Take some pictures of the flooded dock&quot;,15)
[[Look for someone to interview]] 
[[Science Story Map]] ]
(else:)[ [[Time to assemble the science story...]] ]</tw-passagedata><tw-passagedata pid="141" name="Knock on the nearest office door" tags="" position="5775,323" size="100,100">You find an office with a handwritten sign on the door: //Knock for math puns.//

&quot;Oh, hi there!&quot; the DNR worker says, looking up from his computer. &quot;Wanna hear a joke?&quot;

[[&quot;Sure, why not?&quot;-&gt;Math joke!]]
[[&quot;No thanks.&quot;]]</tw-passagedata><tw-passagedata pid="142" name="Look for your DNR Contact, Wynne D. Storme" tags="" position="5775,200" size="100,100">(unless:(history:) contains &quot;Phone Call: Wynne D. Storme @ DNR&quot;)[&quot;Oh, hi!&quot; she says. &quot;You&#39;re that new reporter, right?&quot;

($statGate: $socialName, 5) 
(if: $social &gt;4)[She&#39;s busy and stressed, but your conversational skills seem to put her at ease.

She gives you a ton of great info and statistics: 

Since 1900, rainfall in Twin Lakes has increased by roughly 10%.

The volume of the river that connects the two lakes is up by 40%.

Oh, and Upper Lake is being kept 5 feet higher than its normal level.

&quot;It&#39;s basically a perfect storm,&quot; she says. 

($gainSnippet: &quot;Fact&quot;, &quot;Detailed flood background&quot;)
($gainSnippet: &quot;Graph&quot;, &quot;Floods and climate change&quot;)
($gainSnippet: &quot;Quote&quot;, &quot;Cause of flood&quot;)](elseif: $bookworm &gt;4)[($statGate: $bookwormName, 5)
She&#39;s excited to talk to someone who&#39;s so well-informed on floods and climate change.

She gives you a ton of great info and statistics: 

Since 1900, rainfall in Twin Lakes has increased by roughly 10%. 

The volume of the river that connects the two lakes is up 40%.

Oh, and Upper Lake is being kept 5 feet higher than its normal level.

&quot;It&#39;s basically a perfect storm,&quot; she says. 

($gainSnippet: &quot;Fact&quot;, &quot;Detailed flood background&quot;)
($gainSnippet: &quot;Graph&quot;, &quot;Floods and climate change&quot;)
($gainSnippet: &quot;Quote&quot;, &quot;Cause of flood&quot;)](else:)[($statGate: $bookwormName, 5)
She doesn&#39;t seem interested in socializing much, but she does give you some quick background on severe weather in Twin Lakes. 

&quot;Over time, storms in Twin Lakes are becoming more severe AND more frequent,&quot; she says. &quot;We&#39;ve had a lot of floods around here, but this one was by far the worst.&quot;

($gainSnippet: &quot;Fact&quot;, &quot;Basic flood background&quot;)]](else:)[&quot;Oh, hey there!&quot; she says. &quot;I enjoyed our talk on the phone, I&#39;m looking forward to seeing what you publish!&quot;

($changeStat:$trustName, 1)]

[[Look for someone else to talk to-&gt;Run into the mayor in hallway]]
[[Read the bulletin board in the hallway]]</tw-passagedata><tw-passagedata pid="143" name="Phone Contacts" tags="" position="5275,300" size="200,100">This story is due in (display: &quot;PRINT TIME&quot;).
Phone Contacts:

($hubChoice: &quot;Phone Call: DNR Headquarters&quot;, &quot;Main DNR Number&quot;, 30)
(if:(history:) contains &quot;Jenkins&#39;s Computer&quot;)[($hubChoice: &quot;Phone Call: Wynne D. Storme @ DNR&quot;, &quot;DNR Contact: Wynne D. Storme&quot;, 30)]
($hubChoice: &quot;Phone Call: City Hall&quot;, &quot;City Hall Contact&quot;, 30)
(if:(history:) contains &quot;Ask around for its owner&quot;)[ 
($hubChoice: &quot;Phone Call: Mayor&#39;s Personal Number&quot;, &quot;Mayor&#39;s Personal Number&quot;, 30)]

[[Back to map-&gt;Science Story Map]]</tw-passagedata><tw-passagedata pid="144" name="Take photos of the debris" tags="" position="6150,725" size="100,100">($statGate: $techieName, 3)
($statGate: $trustName, 4)
(if: $techie &gt;=3 and $trust &gt;=4)[You get some amazing photos of Main Street!

The business owners all agree to let you use pictures of them alongside your article.

&quot;I read your article yesterday,&quot; one of the shop owners says. &quot;You&#39;re one of the good ones. Happy to help.&quot;

($gainSnippet:&quot;Photo&quot;,&quot;Inspiring downtown recovery&quot;)](If: $techie &gt;=3 and $trust &lt;4)[You get some amazing photos of Main Street!

You ask the business owners in the shot if they&#39;re okay with you using their picture.

Some of them agree, but others aren&#39;t so sure.

&quot;Sorry,&quot; they say. &quot;How can I trust that you won&#39;t make me look stupid?&quot;

Well, you can still use these photos, if you crop some of the people out...

($gainSnippet:&quot;Photo&quot;,&quot;Downtown recovery&quot;)](if: $techie &lt;3)[Uh oh. Your phone screen is on the fritz and you have no idea how to fix it! 

Maybe it&#39;s water damage? Low battery? Some kind of 100-year-flood curse? 

You snap a few random photos and hope for the best.

($gainSnippet:&quot;Photo&quot;,&quot;Blurry downtown recovery&quot;)]

[[Keep looking around-&gt;Main Street Flood Recovery]]


</tw-passagedata><tw-passagedata pid="145" name="Run into the mayor in hallway" tags="" position="6725,200" size="100,100">As you&#39;re leaving, you literally run into someone.

&quot;Ope, sorry,&quot; he says, straightening his glasses.

You recognize him from all the local press conferences: Barry Johnson, the mayor of Twin Lakes!

[[Ask for an interview-&gt;Interview mayor]] (text-colour:purple)[(20 minutes)]
[[Gotta go!-&gt;Science Story Map]]</tw-passagedata><tw-passagedata pid="146" name="Photograph flooded dock" tags="" position="6731,775" size="100,100">The dock is covered with murky-looking water. The lighting is great--you get some photos of an eerie blue-green shine on the water. More artful than journalistic, but hey - they&#39;ll make a great addition to your collection.

As you turn to leave, you bump into someone--a researcher in knee-high boots and waders. Her nametag says &quot;S. McCloud.&quot; 

&quot;Hey!&quot; she says. &quot;Careful out here, that&#39;s toxic blue-green algae. I&#39;m here to take some samples.&quot;

[[Ask if she has time to talk-&gt;Quick Interview: Limnology Expert]]
(elseif:(history:) contains &quot;Thanks, plus university contact&quot;)[ [[Tell her you met her sister!]] ]</tw-passagedata><tw-passagedata pid="147" name="Help bail out water from boathouse" tags="" position="6875,1150" size="100,100">You follow the scientist into the boathouse. 

Several people are inflating a portable dam to stop the water, while others bail out the water that&#39;s already there.

You grab your extra-large water bottle and join in, scooping out floodwater. 

&quot;Thanks!&quot; the scientist says. &quot;I guess I could do a quick interview while we work. Just make sure not to accidentally drink from that bottle later. This floodwater is nasty stuff.&quot;

($hubChoice: &quot;Interview scientist&quot;,&quot;Well, let&#39;s get started then...&quot;,15)
[[...actually, I gotta go!-&gt;Department of Limnology]]</tw-passagedata><tw-passagedata pid="148" name="Interview scientist" tags="" position="7000,1200" size="100,100">[[&quot;What caused the flood?&quot;]]
[[&quot;How can the city prevent this from happening next time?&quot;]]

[[Twin Lakes Map-&gt;Science Story Map]]</tw-passagedata><tw-passagedata pid="149" name="Interview mayor" tags="" position="5385,1302" size="100,100">&quot;Sure thing,&quot; the mayor says. &quot;I&#39;d be happy to answer a couple questions.&quot; 
(set:$currentTime to it - 20)
This will be an amazing boost for your article, but you try to play it cool. 

[[&quot;What kind of impact will this flood have on Twin Lakes?&quot;]]
[[&quot;What is the city doing to stop this from happening again?&quot;]]</tw-passagedata><tw-passagedata pid="150" name="Phone Call: DNR Headquarters" tags="" position="5250,150" size="100,100">You call the DNR Headquarters. 

The person you reach sounds a little distracted, but he&#39;s willing to talk!

He tells you the cause of the flooding: extreme rainfall, and less places (like rain gardens and wetlands) for water to go.  

&quot;This flood has already forced people out of their homes and caused millions of dollars in damages,&quot; he says. &quot;We need better policies to prevent this kind of disaster in the future.&quot;

($gainSnippet: &quot;Fact&quot;,&quot;Basic flood background&quot;)
($gainSnippet: &quot;Fact&quot;,&quot;Basic flood prevention&quot;)

[[Phone Contacts]]
[[Map-&gt;Science Story Map]]</tw-passagedata><tw-passagedata pid="151" name="Phone Call: City Hall" tags="" position="5375,150" size="100,100">You call City Hall, but it&#39;s impossible to really get through to anyone.

You ask about the science behind the flooding, but they give you a clearly prewritten statement:

&quot;We&#39;re still working to mitigate damage from the flood. We&#39;re working to get sandbags to the right locations and evacuate people from at-risk areas. Feel free to check our website for more info!&quot;

//Get unscientific statement about flood damage//

[[Phone Contacts]]
[[Map-&gt;Science Story Map]]</tw-passagedata><tw-passagedata pid="152" name="Phone Call: Wynne D. Storme @ DNR" tags="" position="5500,150" size="100,100">&quot;Oh, hi!&quot; she says. &quot;You&#39;re that new reporter, right?&quot;

($statGate:$socialName, 5)
(if: $social &gt;4)[She sounds busy, but your conversational skills seem to put her at ease.

She gives you a ton of great info and statistics: 

Since 1900, rainfall in Twin Lakes has increased by roughly 10%.

The volume of the river that connects the two lakes is up by 40%.

Oh, and Upper Lake is being kept 5 feet higher than its normal level.

&quot;It&#39;s basically a perfect storm,&quot; she says. 

($gainSnippet: &quot;Fact&quot;, &quot;Detailed flood background&quot;)
($gainSnippet: &quot;Graph&quot;, &quot;Floods and climate change&quot;)
($gainSnippet: &quot;Quote&quot;, &quot;Cause of flood&quot;)](elseif: $bookworm &gt;4)[($statGate:$bookwormName, 5)
She&#39;s excited to talk to someone who&#39;s so well-informed on floods and climate change.

She gives you a ton of great info and statistics: 

Since 1900, rainfall in Twin Lakes has increased by roughly 10%. 

The volume of the river that connects the two lakes is up 40%.

Oh, and Upper Lake is being kept 5 feet higher than its normal level.

&quot;It&#39;s basically a perfect storm,&quot; she says. 

($gainSnippet: &quot;Fact&quot;, &quot;Detailed flood background&quot;)
($gainSnippet: &quot;Graph&quot;, &quot;Floods and climate change&quot;)
($gainSnippet: &quot;Quote&quot;, &quot;Cause of flood&quot;)](else:)[($statGate:$bookwormName, 5)
She doesn&#39;t seem interested in socializing much, but she does give you some quick background on severe weather in Twin Lakes. 

&quot;Over time, storms in Twin Lakes are becoming more severe AND more frequent,&quot; she says. &quot;We&#39;ve had a lot of floods around here, but this one was by far the worst.&quot;

($gainSnippet: &quot;Fact&quot;, &quot;Basic flood background&quot;)]

[[Phone Contacts]]
[[Map-&gt;Science Story Map]]</tw-passagedata><tw-passagedata pid="153" name="Phone Call: Mayor&#39;s Personal Number" tags="" position="5125,150" size="100,100">The mayor has already heard about how you rescued poor Omelette!

He&#39;s happy to talk with you and give you some type of quote.

[[Phone Contacts]]</tw-passagedata><tw-passagedata pid="154" name="Main Street Flood Recovery" tags="" position="5925,725" size="200,100">&#39;&#39;LOCATION MAP: MAIN STREET&#39;&#39;
This story is due in (display: &quot;PRINT TIME&quot;).

Main Street is cordoned off. 

The floodwater has gone down, but there&#39;s mud and debris everywhere. 

You duck under the barricade and take a look around.

(unless: $currentTime &lt;= 20)[
[[Talk to the gallery owner airing out his artwork-&gt;Main Street Gallery Owner]]
[[Go into the cafe with a &quot;PLEASE COME IN, WE&#39;RE OPEN!! (REALLY!)&quot; sign in the window-&gt;Main Street Cafe]]
($hubChoice:&quot;Take photos of the debris&quot;,&quot;Snap some pictures of the debris&quot;, 20)

[[Twin Lakes Map -&gt;Science Story Map]]]
(else:)[ [[Time to assemble the science story...]] ]</tw-passagedata><tw-passagedata pid="155" name="Follow the chicken" tags="" position="5400,850" size="100,100">You race around the corner like an Olympic biker out for gold.
($changeStat:$enduranceName, 1)
(set:$currentTime to it - 10)
There&#39;s a chicken wandering in circles in the middle of a puddle!

[[Call your neighbor and see if it&#39;s hers]] (text-colour:purple)[(10 minutes)]
[[Ask around for its owner]] (text-colour:purple)[(20 minutes)]</tw-passagedata><tw-passagedata pid="156" name="Call your neighbor and see if it&#39;s hers" tags="" position="5525,850" size="100,100">(set:$currentTime to it - 10)
(if:(history:) contains &quot;Help her&quot;)[You call Maureen. &quot;Hey! Um, weird question... did any more of your chickens fly the coop?&quot;

&quot;Hmm? Nope, we&#39;re all fine here. No signs of fowl play. Thank you, though, Dear!&quot; 
($changeStat: $trustName, 1)

She hangs up, leaving you with a strange chicken staring up at you hopefully. 

[[Ask around for its owner]] (text-colour:purple)[(20 minutes)]
[[Leave the chicken to fend for itself]]](else:)[You call Maureen. &quot;Hey!! I think I found your chicken!&quot;

&quot;Amelia Egghart? Oh, she actually just showed up back home! Thank you for calling, though!&quot;
($changeStat: $trustName, 1)

&quot;But...&quot;

&quot;Sorry, Dear, gotta go. Amelia&#39;s a bit peckish.&quot;

She hangs up, leaving you with a strange chicken staring up at you hopefully. 

[[Ask around for its owner]] (text-colour:purple)[(20 minutes)]
[[Leave the chicken to fend for itself]]]</tw-passagedata><tw-passagedata pid="157" name="Ask around for its owner" tags="" position="5400,975" size="100,100">You wander the area, the rumpled chicken in your arms.
(set:$currentTime to it - 20)
You&#39;re about to give up when a woman in a messy ponytail runs over to you. 

&quot;Oh, you found Omelette! Thank you so much! My daughter was heartbroken.&quot;

($changeStat:$trustName,1)

You hand over the pet chicken with relief, wondering whatever happened to cats and dogs and hamsters. 

[[&quot;No problem. I better go, I&#39;ve got a story to write.]]</tw-passagedata><tw-passagedata pid="158" name="Tell him you&#39;re a big fan of his work" tags="" position="5900,1025" size="100,100">($statGate: $socialName, 4)
(if: $social &gt;3)[&quot;Really?&quot; he says, sounding doubtful. 

&quot;Yeah, I saw your new art installation at the ice cream social! Sorry you got caught in the flood.&quot;

&quot;Well,&quot; he says, more cheerful now, &quot;this is my series on toxic lakewater bacteria, so it&#39;s actually pretty meta. I&#39;m guessing these prints are soaked with it by now.&quot;

He&#39;s so excited you&#39;ve heard of his work that he agrees to an interview!

($hubChoice: &quot;Interview Gallery Owner&quot;, &#39;&quot;Well, let\&#39;s get started then...&quot;&#39;, 20)
[[...nevermind, I gotta get going!-&gt;Main Street Flood Recovery]] 

](if: $social &lt;3)[&quot;Sure you are,&quot; he says. &quot;Tell me one thing you like about my paintings.&quot;

&quot;They&#39;re very.... um.... green?&quot;

He rolls his eyes. &quot;You can&#39;t butter me up that easy. If you&#39;ll excuse me, I&#39;ve got some cleaning up to do.&quot;

[[Well, you tried. Better leave this guy alone.-&gt;Main Street Flood Recovery]]]</tw-passagedata><tw-passagedata pid="159" name="Ask if he needs help" tags="" position="5775,1025" size="100,100">&quot;Hmm. Let&#39;s see. My gallery is totally destroyed. The storm kept me up all night. And all I had for breakfast was tic tacs and oyster crackers. Would //you// say I need help?&quot;

[[Offer him some food]]
($hubChoice:&quot;Help him carry furniture outside&quot;,&quot;Help him carry furniture outside&quot;,15)
[[Tell him you&#39;re a big fan of his work]]</tw-passagedata><tw-passagedata pid="160" name="Offer him some food" tags="" position="5900,1150" size="100,100">($statGate: $resourcefulName, 4)
(if: $resourceful &gt;3)[You look through your bag. Luckily, you came prepared! 

You give him a locally-made protein bar and a bottle of water. 

&quot;Thanks,&quot; he says, looking grateful. &quot;I guess I could do a quick interview, while you&#39;re here.&quot;

($hubChoice: &quot;Interview Gallery Owner&quot;, &#39;&quot;Well, let\&#39;s get started then...&quot;&#39;, 20)
[[...actually, I gotta get going!-&gt;Main Street Flood Recovery]] ](else:)[You dig through your bag for something to offer him, but come up empty.

He looks frustrated. &quot;Can I get back to work now?&quot;

You better leave this guy alone.

[[Find someone else to talk to.-&gt;Main Street Flood Recovery]]]</tw-passagedata><tw-passagedata pid="161" name="&quot;No problem. I better go, I&#39;ve got a story to write." tags="" position="5400,1100" size="100,100">The woman looks surprised. &quot;Oh, you&#39;re a reporter? You should talk to my brother! He&#39;ll know all the details.&quot;

She scribbles down her brother&#39;s contact info: //Barry Zingerman, 555-1678//

(link-reveal:&quot;\&quot;Barry Zingerman? You mean.... the mayor of Twin Lakes?\&quot;&quot;)[

&quot;Oh, you&#39;ve heard of him? Give him a call. Tell him you rescued his niece&#39;s pet. I&#39;m sure he&#39;d love to chat.&quot;

//Get Mayor&#39;s Contact Info//

[[Open Phone Contacts-&gt;Phone Contacts]]
[[Keep biking toward Main Street-&gt;Main Street Flood Recovery]]


[[Science Story Map]]]</tw-passagedata><tw-passagedata pid="162" name="Leave the chicken to fend for itself" tags="" position="5650,725" size="100,100">The chicken will be fine. It looks fully capable.

You jump back on your bike and continue downtown.

[[Arrive at Main Street-&gt;Main Street Flood Recovery]]</tw-passagedata><tw-passagedata pid="163" name="Main Street Gallery Owner" tags="" position="5725,900" size="200,100">The gallery owner is hanging soggy art prints on a clothesline and grumbling under his breath.

His art is mostly abstract--blue-green swirls and squiggles, close-ups of greenish beads, eerie chartreuse umbrellas.

[[Ask to interview him]]
[[Ask if he needs help]]
[[Tell him you&#39;re a big fan of his work]] (text-colour:purple)[(10 minutes)]</tw-passagedata><tw-passagedata pid="164" name="Main Street Cafe" tags="" position="6125,900" size="200,100">You walk into the cafe on a bridge of wet cardboard. 

The owner is sitting on a table to keep her feet dry, muttering insults at her malfunctioning laptop.   

Her eyes light up when she notices you.

&quot;Oh, I didn&#39;t see ya there! What can I getcha?&quot;

[[Ask to interview her-&gt;Interview Cafe Owner]]
($hubChoice: &quot;Order the daily special&quot;,&quot;Order the daily special&quot;, 15)
($hubChoice: &quot;Help with her computer&quot;,&#39;&quot;Actually, do you need help with that laptop?&quot;&#39;, 15)</tw-passagedata><tw-passagedata pid="165" name="Ask to interview him" tags="" position="5650,1025" size="100,100">He doesn&#39;t even glance at you. &quot;Do I look like I&#39;m in a chatty mood?&quot;

[[Ask if he needs help]]
[[Tell him you&#39;re a big fan of his work]]
[[Leave him alone. There must be someone else you can talk to.-&gt;Main Street Flood Recovery]]</tw-passagedata><tw-passagedata pid="166" name="Help with the clean up" tags="Endurance Social" position="4575,100" size="100,100">You pitch in with the neighborhood cleanup, trading stories and gathering up debris. 

The storm must&#39;ve gotten pretty fierce last night. You&#39;ve never seen so many headless plastic flamingos in your life. 

($changeStat:$enduranceName, 1)
($changeStat:$socialName, 1)

[(text-style:&quot;shudder&quot;)[RRRRING.]
[[Answer phone]]]</tw-passagedata><tw-passagedata pid="167" name="Help Jim get his phone working" tags="Trust Techie" position="4875,100" size="100,100">Jim is a genius when it comes to granola-making, but technology isn&#39;t his thing.

You turn off airplane mode so he can use his phone, and you also get him caught up with the latest 16 software updates.

($changeStat:$trustName, 1)
($changeStat:$techieName, 1)

[(text-style:&quot;shudder&quot;)[RRRRING.]
[[Answer phone]]]</tw-passagedata><tw-passagedata pid="168" name="Hang Lost Chicken posters" tags="Trust Techie" position="4725,100" size="100,100">You post a bunch of signs on doors and trees and telephone poles.

You even help Maureen set up a &quot;Lost Chicken&quot; bulletin on NeighborSquawk.com. Anything to help poor Amelia Egghart. 

($changeStat:$trustName, 1)
($changeStat:$techieName, 1)

[(text-style:&quot;shudder&quot;)[RRRRING.]
[[Answer phone]]]</tw-passagedata><tw-passagedata pid="169" name="Make an excuse and rush back inside" tags="" position="4550,425" size="100,100">Ahh. Back in the blissful cave of your home. 
($changeStat:$socialName, -1)

[[Make breakfast]]
[[Check social media]]
[[Read a book before work]]
[[Gather flood gear]]</tw-passagedata><tw-passagedata pid="170" name="&quot;Ok. Uh... any tips?&quot;" tags="" position="5150,525" size="100,100">She must hear some of the expertly hidden panic in your voice. 

She sends a checklist of what you&#39;ll need for your story:
* Expert quote: cause of flood
* Quote: why this story matters 
* Flooding graphics and statistics
* Facts about flooding 
* Quotes and vignettes for color
* One or more photos

&quot;If I were you, I&#39;d start at the DNR,&quot; she says. &quot;Or you could head downtown to get some color. It&#39;d be great if you could score an interview with the mayor, but he&#39;s probably swamped.&quot; 

Looks like you&#39;re gonna have to follow your own instincts on where to start. 

[[&quot;Got it. Thanks.&quot;-&gt;Science Story Map]]</tw-passagedata><tw-passagedata pid="171" name="Read a book before work" tags="Bookworm" position="4725,675" size="100,100">You track down the book you grabbed from the library: a novel from local horror author, Stephanie Queen. 

The book is about a tiny lakeside town being overtaken by literal cats and dogs falling from the sky, and the chaos that ensues. 

Something about the fictional town of Dual Ponds feels strangely familiar...

($changeStat:$bookwormName, 2)

[(text-style:&quot;shudder&quot;)[RRRRING.]
[[Answer phone]]]</tw-passagedata><tw-passagedata pid="172" name="Go outside and help your neighbors" tags="" position="4725,275" size="100,100">Your street is covered in junk--trash, broken branches, toppled lawn ornaments. 

(if:(history:) contains &quot;Lure chickens&quot;)[You step outside and Maureen&#39;s chickens come running, pecking around your feet for more granola.

Your other neighbor, Jim, is struggling to make a phone call. &quot;The storm must&#39;ve knocked out the service!&quot; he says, scratching his head.

[[Help with the clean up]]
[[Help Jim get his phone working]]](if:(history:) contains &quot;Chase chickens&quot;)[Maureen sees you and waves. &quot;Great article yesterday! We&#39;re lucky to have a top-notch reporter in the neighborhood.&quot;

Your other neighbor, Jim, is struggling to make a phone call. &quot;The storm must&#39;ve knocked out the service!&quot; he says, scratching his head.

[[Help with the clean up]]
[[Help Jim get his phone working]]](else:)[Maureen shoves a stack of Lost Chicken posters into your hands.

&quot;After all, it&#39;s your fault Amelia Egghart is still missing,&quot; she says. &quot;Not that I&#39;m blaming you, of course.&quot;

[[Hang Lost Chicken posters]]
[[Take some posters for later and join the clean-up effort-&gt;Help with the clean up]]
[[Make an excuse and rush back inside]]]</tw-passagedata><tw-passagedata pid="173" name="Help him carry furniture outside" tags="" position="5775,1150" size="100,100">($statGate: $enduranceName, 4)
(if: $endurance &gt;3)[The gallery owner looks impressed as you help him carry out a sofa, table, and several easels.

&quot;Are you a weightlifter?&quot; he asks. 

(if:(history:) contains &quot;Help her&quot; or it contains &quot;Follow the chicken&quot;)[&quot;Nah, I just eat lots of antioxidants and spend a lot of time chasing after chickens.&quot;
](elseif:(history:) contains &quot;Yogurt&quot;)[&quot;Nah, I just steal people&#39;s yogurt and spend a lot of time biking around town.&quot;](else:)[&quot;Nah, I just eat lots of antioxidants and carry about a hundred pounds of gear around town.&quot;]

He&#39;s so thankful for your help that he agrees to a quick interview!

($hubChoice: &quot;Interview Gallery Owner&quot;, &#39;&quot;Well, let\&#39;s get started then...&quot;&#39;, 20)
[[...nevermind, I gotta get going!-&gt;Main Street Flood Recovery]] ](else:)[You try to help him lift a sofa--no luck.

You forgot, manual labor isn&#39;t exactly your thing. 

&quot;No offense,&quot; he says, &quot;but I&#39;ve got a lot of work to do here.&quot;

[[Find someone else to talk to.-&gt;Main Street Flood Recovery]]]</tw-passagedata><tw-passagedata pid="174" name="Interview Gallery Owner" tags="" position="5775,1281" size="100,100">He tells you this is his third year running the gallery. The damage from this flood could cost him thousands of dollars. 

&quot;We&#39;ve had a little flooding every year, but nothing like this,&quot; he says. &quot;It was like a disaster movie out there. I gotta tell ya, a lot of downtown businesses are hurting.&quot; 

($gainSnippet: &quot;Quote&quot;, &quot;Art business impact&quot;)

[[Thank him and let him get back to work-&gt;Main Street Flood Recovery]]</tw-passagedata><tw-passagedata pid="175" name="Interview Cafe Owner" tags="" position="6175,1025" size="100,100">(if:(history:) contains &quot;Order the daily special&quot;)[&quot;Of course!&quot; she says. &quot;It&#39;s the least I can do for a fellow PB&amp;J lover.&quot;](elseif:(history:)contains &quot;Help with her computer&quot;)[&quot;You dealt with that migraine-inducing nightmare of a website,&quot; she says. &quot;It&#39;s the least I can do.&quot;](else:)[Her face falls. &quot;Sure, I guess. It&#39;s not like I&#39;ve got any customers, anyhow.&quot;]

($hubChoice: &quot;Interview Questions: Cafe Owner&quot;,&quot;Well, let&#39;s get started then...&quot;, 15)
[[...nevermind, I gotta go!-&gt;Main Street Flood Recovery]]</tw-passagedata><tw-passagedata pid="176" name="&quot;How has the flood affected your business?&quot;" tags="" position="6175,1275" size="100,100">&quot;Oy.&quot; She shakes her head. &quot;It&#39;s a disaster. The Cherry Festival is usually my busiest week of the year. Now you&#39;re the first customer I&#39;ve seen all morning.&quot;

(unless:(history:) contains &quot;Are you worried about more rain coming?&quot;)[ [[&quot;Are you worried about more rain coming?&quot;]] ]
(unless:(history:)  contains &quot;How do you think it&#39;ll impact Twin Lakes if the flooding keeps up?&quot;)[ [[&quot;How do you think it&#39;ll impact Twin Lakes if the flooding keeps up?&quot;]] ]

(if:(history:) contains &quot;Order the daily special&quot; or it contains &quot;Help with her computer&quot;) [[[Thank her for her time-&gt;Thanks, plus university contact]]
](else:)[[[Thank her for her time-&gt;Thanks]]]
</tw-passagedata><tw-passagedata pid="177" name="&quot;Are you worried about more rain coming?&quot;" tags="" position="6050,1275" size="100,100">&quot;Well, yah. Of course I am.&quot;

(unless:(history:) contains &quot;How has the flood affected your business?&quot;)[ [[&quot;How has the flood affected your business?&quot;]] ]
(unless:(history:) contains &quot;How do you think it&#39;ll impact Twin Lakes if the flooding keeps up?&quot;)[ [[&quot;How do you think it&#39;ll impact Twin Lakes if the flooding keeps up?&quot;]] ]

(if:(history:) contains &quot;Order the daily special&quot; or it contains &quot;Help with her computer&quot;) [[[Thank her for her time-&gt;Thanks, plus university contact]]
](else:)[[[Thank her for her time-&gt;Thanks]]]
</tw-passagedata><tw-passagedata pid="178" name="Order the daily special" tags="Endurance" position="6300,1025" size="100,100">&quot;Great!&quot; She rummages around behind the counter and comes back with peanut butter and jelly on white bread.

&quot;Um, sorry,&quot; she says sheepishly. &quot;The storm knocked out the power. No oven, no fridge.&quot; 

&quot;No problem,&quot; you tell her honestly. It&#39;s the best peanut butter and jelly you&#39;ve ever tasted. 

($changeStat: $enduranceName, 1)

[[Ask for a quick interview while you eat-&gt;Interview Cafe Owner]]</tw-passagedata><tw-passagedata pid="179" name="Help with her computer" tags="" position="6050,1025" size="100,100">&quot;I don&#39;t know why they make this so impossible,&quot; she says, struggling with a very glitchy flood insurance website.

($statGate: $techieName, 4)
(if: $techie &gt;3)[Luckily, you&#39;re able to use your tech savvy and save the day!

[[Ask if she has time for an interview-&gt;Interview Cafe Owner]]](else:)[You try to help, but you&#39;re as clueless about tech stuff as she is.]

[[Ask to order food-&gt;Order the daily special]]
[[Head back out to Main Street. She seems too busy to talk.-&gt;Main Street Flood Recovery]]</tw-passagedata><tw-passagedata pid="180" name="Thanks, plus university contact" tags="" position="6150,1473" size="100,100">&quot;No problem,&quot; she says. &quot;And since you helped me out, I&#39;ve got a tip for ya! You oughta talk to my sister, Sarah McCloud--she&#39;s a researcher at the college. They basically predicted this flood, but nobody listened.&quot;

She gives you the address for the Department of Limnology.

&quot;Thanks again!&quot; she says. &quot;Stop by any time.&quot;

(text-colour:magenta)[//Gained new location: Department of Limnology//]

[[Back to Main Street-&gt;Main Street Flood Recovery]]
[[Twin Lakes Map-&gt;Science Story Map]]</tw-passagedata><tw-passagedata pid="181" name="Thanks" tags="" position="6275,1475" size="100,100">&quot;No problem,&quot; she says. &quot;Stop by any time!&quot;

[[Back to Main Street-&gt;Main Street Flood Recovery]]
[[Twin Lakes Map-&gt;Science Story Map]]</tw-passagedata><tw-passagedata pid="182" name="&quot;How do you think it&#39;ll impact Twin Lakes if the flooding keeps up?&quot;" tags="" position="6300,1275" size="100,100">&quot;The city needs to do somethin&#39; to stop flooding before it&#39;s too late,&quot; she says. &quot;It&#39;s only gonna keep getting worse, ya know. Climate change and all that.&quot; 

(unless:(history:) contains &quot;How has the flood affected your business?&quot;)[ [[&quot;How has the flood affected your business?&quot;]] ]
(unless:(history:) contains &quot;Are you worried about more rain coming?&quot;)[ [[&quot;Are you worried about more rain coming?&quot;]] ]

(if:(history:) contains &quot;Order the daily special&quot; or it contains &quot;Help with her computer&quot;) [[[Thank her for her time-&gt;Thanks, plus university contact]]
](else:)[[[Thank her for her time-&gt;Thanks]]]</tw-passagedata><tw-passagedata pid="183" name="Interview Questions: Cafe Owner" tags="" position="6175,1150" size="100,100">(unless:(history:)contains &quot;How has the flood affected your business?&quot;)[ [[&quot;How has the flood affected your business?&quot;]] ]
(unless:(history:) contains &quot;Are you worried about more rain coming?&quot;)[ [[&quot;Are you worried about more rain coming?&quot;]] ]
(unless:(history:) contains &quot;How do you think it&#39;ll impact Twin Lakes if the flooding keeps up?&quot;)[ [[&quot;How do you think it&#39;ll impact Twin Lakes if the flooding keeps up?&quot;]] ]

(if:(history:) contains &quot;Order the daily special&quot; or it contains &quot;Help with her computer&quot;) [[[Thank her for her time-&gt;Thanks, plus university contact]]
](else:)[[[Thank her for her time-&gt;Thanks]]]</tw-passagedata><tw-passagedata pid="184" name="Look for someone to interview" tags="" position="6728,1025" size="100,100">You try to catch someone as they run by, but he&#39;s too busy to talk. 

&quot;Sorry,&quot; he says. &quot;We&#39;ve got a lot of damage control to do here.&quot;

($hubChoice:&quot;Help bail out water from boathouse&quot;,&quot;Help bail out water from boathouse&quot;,15)
($hubChoice:&quot;Grab coffee for the Limnology Department&quot;,&quot;Grab coffee for the Limnology Department&quot;,30)
[[Head back to the docks-&gt;Department of Limnology]]</tw-passagedata><tw-passagedata pid="185" name="Grab coffee for the Limnology Department" tags="Social" position="6875,1275" size="100,100">You bike to a campus coffee shop and order as many coffees as you can carry! 

When you get back, the scientists pause in their work, drawn to the tantalizing aroma of medium roast. 
($changeStat:$socialName,1)

&quot;Thanks!&quot; says the scientist from earlier. &quot;I guess I could do a quick interview over coffee.&quot;

($hubChoice: &quot;Interview scientist&quot;,&quot;Well, let&#39;s get started then...&quot;,15)
[[...actually, I gotta go!-&gt;Department of Limnology]]</tw-passagedata><tw-passagedata pid="186" name="&quot;What caused the flood?&quot;" tags="" position="7125,1150" size="100,100">He tells you a big part of the problem is climate change and higher lake levels. 

&quot;Extreme weather events are happening more often,&quot; he says. &quot;The city is going to need to make some big changes to keep people safe.&quot;

($gainSnippet: &quot;Quote&quot;, &quot;Cause of flood&quot;)
($gainSnippet: &quot;Fact&quot;, &quot;Basic flood background&quot;)

[[&quot;How can the city prevent this from happening next time?&quot;]]
[[&quot;Tell me more about the high lake levels.&quot;]]

(unless:(history:) contains &quot;Photograph flooded dock&quot;)[ [[Thank him and go take photos of the dock-&gt;Photograph flooded dock]] ]

[[Twin Lakes Map-&gt;Science Story Map]]

</tw-passagedata><tw-passagedata pid="187" name="&quot;How can the city prevent this from happening next time?&quot;" tags="" position="7125,1275" size="100,100">He tells you it&#39;ll take more than just some sandbags.

&quot;This is a long-term, city-wide problem,&quot; he says. &quot;We need to work on some engineered solutions. The problem is, it&#39;ll be VERY expensive.&quot;

($gainSnippet: &quot;Fact&quot;, &quot;Basic flood background&quot;)
($gainSnippet: &quot;Quote&quot;, &quot;Basic flood prevention&quot;)

(unless:(history:) contains &quot;What caused the flood?&quot;)[ [[&quot;What caused the flood?&quot;]] ]

[[What do you mean, engineered solutions?]]

(unless:(history:) contains &quot;Photograph flooded dock&quot;)[ [[Thank him and go take photos of the dock-&gt;Photograph flooded dock]] ]

[[Twin Lakes Map-&gt;Science Story Map]]</tw-passagedata><tw-passagedata pid="188" name="Quick Interview: Limnology Expert" tags="" position="6875,1023" size="100,100">($statGate: $socialName, 4)
(if: $social &lt;4)[&quot;Well..... I guess I could chat for a minute,&quot; she says.

She tells you about one of the main causes of the flooding: more extreme weather from climate change. 

&quot;We&#39;re going to keep seeing more and more heavy rain,&quot; she says. &quot;The town is going to need to make some changes if it wants to survive. Sorry, wish I could talk more, but I gotta run.&quot;

($gainSnippet: &quot;Fact&quot;, &quot;Basic flood background&quot;)

(unless:(history:)contains &quot;Look for someone to interview&quot;)[ [[Look for someone else to talk to-&gt;Look for someone to interview]]]
[[Back to Twin Lakes Map-&gt;Science Story Map]]](if: $social&gt;=4)[She seems busy, but your social graces win her over. 

&quot;Sure,&quot; she says, &quot;I&#39;d be happy to talk!&quot; 

($hubChoice: &quot;Interview scientist&quot;,&quot;Well, let&#39;s get started then...&quot;,15)
[[...actually, I gotta go!-&gt;Department of Limnology]]]</tw-passagedata><tw-passagedata pid="189" name="In-Depth Interview: Limnology Expert" tags="" position="7000,775" size="100,100">She tells you how she predicted the flood would happen. 

&quot;Twin Lakes is super vulnerable to flooding,&quot; she says. &quot;We&#39;re got water on two sides! That, plus the higher lake levels... it was a disaster waiting to happen.&quot;

[[Ask what people can do to help]]
[[Ask if she has graphics you can use]]</tw-passagedata><tw-passagedata pid="190" name="Ask what people can do to help" tags="" position="7125,900" size="100,100">&quot;Welllll... it&#39;s complicated,&quot; she says. &quot;For now, filling sandbags and helping people find shelter is probably the best thing you could do. But we also need long-term solutions.&quot;

[[&quot;Can you give me some examples?&quot;]]</tw-passagedata><tw-passagedata pid="191" name="Ask if she has graphics you can use" tags="" position="7125,775" size="100,100">&quot;Oh, totally!&quot; she says, pulling some files up on her phone. &quot;I&#39;ve got tons of great visuals in my research.&quot;

($gainSnippet: &quot;Graph&quot;, &quot;Rainfall stats&quot;)

[[Ask what people can do to help]]
[[Thank her for her help-&gt;Department of Limnology]]</tw-passagedata><tw-passagedata pid="192" name="&quot;What is the city doing to stop this from happening again?&quot;" tags="" position="5521,1430" size="100,100">&quot;Of course we&#39;re working on getting sandbags to the right people,&quot; he says. &quot;But in the long-term, that won&#39;t be enough. We need new policies. I&#39;m hoping this disaster will push people to make some changes around here.&quot;

($gainSnippet: &quot;Quote&quot;,&quot;Mayor - Response&quot;)

[[&quot;What kind of new policies?&quot;]]
[[&quot;What kind of impact will this flood have on Twin Lakes?&quot;]]</tw-passagedata><tw-passagedata pid="193" name="&quot;What kind of impact will this flood have on Twin Lakes?&quot;" tags="" position="5526,1293" size="100,100">&quot;It will be a long recovery, with millions of dollars in damages,&quot; he says. &quot;Right now I&#39;m just hoping we don&#39;t get another storm this week--I don&#39;t think the watershed could take it.&quot; 

($gainSnippet: &quot;Quote&quot;,&quot;Mayor - Impact&quot;)

[[&quot;What is the city doing to stop this from happening again?&quot;]]</tw-passagedata><tw-passagedata pid="194" name="What do you mean, engineered solutions?" tags="" position="7250,1275" size="100,100">He gives you some examples:
-A better storm drain system to carry water away
-Flood walls along the river
-Rain gardens designed to soak up water

[[Department of Limnology]] </tw-passagedata><tw-passagedata pid="195" name="&quot;Tell me more about the high lake levels.&quot;" tags="" position="7248,1150" size="100,100">&quot;Well, I&#39;m not an expert on this part, but I know the lakes are being kept  high on purpose,&quot; he says. &quot;The city uses the dam to keep Upper Lake a whole five feet higher than it would normally be!&quot;

[[Department of Limnology]] </tw-passagedata><tw-passagedata pid="196" name="Dam: Interview DNR Worker" tags="" position="3700,600" size="100,100">[[&quot;When will the situation be under control?&quot;]]
[[&quot;How can people protect their houses and businesses?&quot;]]
[[&quot;How did the city let this happen?&quot;]]</tw-passagedata><tw-passagedata pid="197" name="&quot;When will the situation be under control?&quot;" tags="" position="3825,723" size="100,100">She tells you the situation depends on how much it rains.

&quot;We&#39;re expecting things to get worse before they get better.&quot;

($gainSnippet: &quot;Quote&quot;,&quot;DNR expectations&quot;)
($gainSnippet: &quot;Fact&quot;, &quot;Flood info&quot;)
[[Back to the dam -&gt;Arrive at flood site]]</tw-passagedata><tw-passagedata pid="198" name="&quot;How can people protect their houses and businesses?&quot;" tags="" position="3825,600" size="100,100">She tells you there are free sandbags at the community center. 

&quot;The problem is, a lot of people can&#39;t get to them,&quot; she says. &quot;We need a better way to reach people.&quot;  

($gainSnippet:&quot;Quote&quot;,&quot;Sandbag troubles&quot;)
($gainSnippet:&quot;Fact&quot;,&quot;Sandbag location&quot;)

[[Back to the dam-&gt;Arrive at flood site]]</tw-passagedata><tw-passagedata pid="199" name="&quot;How did the city let this happen?&quot;" tags="" position="3825,850" size="100,100">She looks annoyed. 

&quot;One question, and that&#39;s what you go with? It&#39;s a complicated situation. Now I better go--//the city// and I are busy trying to stop this disaster from getting worse.&quot;

($changeStat: $socialName, -1)

[[Back to dam-&gt;Arrive at flood site]]</tw-passagedata><tw-passagedata pid="200" name="Gather flood gear" tags="Resourceful" position="4725,800" size="100,100">You get online and find a flood gear checklist. Score!!

You gather up supplies--boots, waders, a flashlight, snacks and water.

Your waders are technically snowpants, and your flashlight is a sloth-shaped keychain whose eyes light up. But it&#39;s better than nothing.

($changeStat:$resourcefulName, 1)

[(text-style:&quot;shudder&quot;)[RRRRING.]
[[Answer phone]]]</tw-passagedata><tw-passagedata pid="201" name="Math joke!" tags="" position="5925,325" size="100,100">&quot;Ok, ok, let&#39;s see... Did you hear the one about the law of averages? I&#39;d tell it to you, but it&#39;s too //mean.//&quot; He grins. 

($statGate: $bookwormName, 4)
(if: $bookworm &gt;=4)[Ha! You&#39;ve been reading up on statistics lately--you can top that one. 

&quot;Did you hear about the haunted graph?&quot; you say. &quot;It had paranormal distribution.&quot; 

He grins. &quot;Not bad, kid. Not bad.&quot;

[[Interview DNR Worker.-&gt;Good DNR Interview]]](if: $techie &gt;=4)[($statGate: $techieName, 4)
Ha! Being a techie with a back pocket full of computer jokes, you can definitely top that one.

&quot;Did you hear about the computer that was full of bugs?&quot; you say. &quot;It had a broken screen.&quot; 

He grins. &quot;Ha! Not bad, kid.&quot;

[[Interview DNR Worker.-&gt;Good DNR Interview]]](else:)[($statGate: $techieName, 4)
&quot;Um.... good one!&quot; you say, the joke flying right over your non-techie, non-bookworm head. &quot;Can I ask you some questions about the flood?&quot;

He looks slightly disappointed. &quot;Well, I don&#39;t have time for an interview. I could give you a statement, though.&quot;

[[Get DNR Statement-&gt;DNR Statement]]]</tw-passagedata><tw-passagedata pid="202" name="DNR Statement" tags="" position="6075,450" size="100,100">He tells you the cause of the flooding: extreme rainfall, and less places (like rain gardens and wetlands) for water to go.  

&quot;This flood has already forced people out of their homes and caused millions of dollars in damages,&quot; he says. &quot;We need better policies to prevent this kind of disaster in the future.&quot;

($gainSnippet: &quot;Fact&quot;, &quot;Basic flood background&quot;)
($gainSnippet: &quot;Quote&quot;, &quot;Basic flood prevention&quot;)

[[DNR Map]]</tw-passagedata><tw-passagedata pid="203" name="Good DNR Interview" tags="" position="6075,325" size="100,100">You sit down with the DNR worker and polish off your interviewing skills.

[[&quot;What was the cause of the flood?&quot;]]
[[&quot;Has Twin Lakes ever had a flood like this before?&quot;]]</tw-passagedata><tw-passagedata pid="204" name="&quot;No thanks.&quot;" tags="" position="5925,450" size="100,100">He doesn&#39;t seem to hear you. 

(display:&quot;Math joke!&quot;)</tw-passagedata><tw-passagedata pid="205" name="&quot;What was the cause of the flood?&quot;" tags="" position="6225,325" size="100,100">&quot;I&#39;d say the flood was caused by a couple factors,&quot; he says. &quot;Extreme rainfall, and less places for that water to go.&quot;

($gainSnippet: &quot;Quote&quot;, &quot;Cause of flood&quot;)

[[&quot;Can you give me the rainfall statistics?&quot;]]
[[&quot;What do you mean, less places for the water to go?&quot;]]</tw-passagedata><tw-passagedata pid="206" name="&quot;Can you give me the rainfall statistics?&quot;" tags="" position="6350,450" size="100,100">&quot;We got an average of 14 inches of rain within 24 hours,&quot; he says. &quot;That&#39;s the worst rain to hit Twin Lakes since 1957! Of course, back then the flooding wasn&#39;t so bad.&quot;

($gainSnippet: &quot;Graph&quot;, &quot;Rainfall stats&quot;)

[[&quot;How much financial damage has the flood caused?&quot;]]
[[&quot;Why was this flood so much worse than in 1957?&quot;-&gt;&quot;What do you mean, less places for the water to go?&quot;]]</tw-passagedata><tw-passagedata pid="207" name="&quot;What do you mean, less places for the water to go?&quot;" tags="" position="6350,325" size="100,100">&quot;The lakes are being kept extra high,&quot; he says. &quot;Plus, a lot of our wetlands have been covered up by new developments. Yesterday&#39;s rain was more than the area could handle.&quot;

[[&quot;How can we stop this from happening again?&quot;]]
[[&quot;Why are the lakes being kept so high?&quot;]]</tw-passagedata><tw-passagedata pid="208" name="&quot;Has Twin Lakes ever had a flood like this before?&quot;" tags="" position="6225,450" size="100,100">&quot;We deal with flash flooding all the time,&quot; he says, &quot;but it&#39;s never been this serious before. With climate change, it&#39;ll only keep getting worse unless we do something.&quot;

($gainSnippet: &quot;Quote&quot;, &quot;Impact of flood&quot;)

[[&quot;Can you give me the rainfall statistics?&quot;]]
[[&quot;How much financial damage has the flood caused?&quot;]]
[[&quot;How can we stop this from happening again?&quot;]]</tw-passagedata><tw-passagedata pid="209" name="&quot;How much financial damage has the flood caused?&quot;" tags="" position="6475,450" size="100,100">&quot;We&#39;re estimating $50 million in damages, just to Twin Lakes,&quot; he says. &quot;I&#39;m sure it&#39;ll be much more once we look at the damage to cherry farms outside of town.&quot; 

//Get great quote: flood impact//
//Get stats: flood damage//

[[&quot;Has Twin Lakes ever had a flood like this before?&quot;]]
[[&quot;How can we stop this from happening again?&quot;]]</tw-passagedata><tw-passagedata pid="210" name="&quot;How can we stop this from happening again?&quot;" tags="" position="6475,325" size="100,100">&quot;Hate to say it, but sandbags aren&#39;t going to be enough,&quot; he said. &quot;We need better policies if we want the town to survive.&quot;

//Get great quote: flood prevention//
//Get expert info: flood prevention//

[[&quot;What kind of policies?&quot;]]</tw-passagedata><tw-passagedata pid="211" name="&quot;What kind of policies?&quot;" tags="" position="6475,200" size="100,100">&quot;Lower lake levels,&quot; he says. &quot;Rules for developers to include rain gardens and other precautions. We probably need more wetland protections, too.&quot; 

($gainSnippet: &quot;Quote&quot;, &quot;Policies to prevent flooding&quot;)

[[Thank him for his time.-&gt;DNR Map]]</tw-passagedata><tw-passagedata pid="212" name="&quot;Why are the lakes being kept so high?&quot;" tags="" position="6600,450" size="100,100">&quot;People want to be able to use their docks,&quot; he says. &quot;Plus, our tourist season depends on beaches and water sports. It&#39;s hard to convince people to vote for lower lake levels when they feel like they&#39;d be losing money.&quot;

//Get expert quote: higher lake levels//
//Get detailed info: cause of flood//

[[&quot;How can we stop this from happening again?&quot;]]
[[&quot;How much financial damage has the flood caused?&quot;]]</tw-passagedata><tw-passagedata pid="213" name="&quot;What kind of new policies?&quot;" tags="" position="5643,1293" size="100,100">&quot;I&#39;ve been fighting for years to get those lake levels down,&quot; he tells you. &quot;A lot of people don&#39;t like the idea. They think it&#39;ll ruin tourist season, or ruin their docks. But we won&#39;t have ANY tourists if floods keep destroying the town every year!&quot;

($gainSnippet: &quot;Quote&quot;,&quot;Mayor - Policies&quot;)

[[Science Story Map]]</tw-passagedata><tw-passagedata pid="214" name="Read the bulletin board in the hallway" tags="" position="5775,450" size="100,100">There are articles and flyers taped up. A few of them catch your eye:  

TWIN LAKES COLLEGE GAZETTE:
&#39;&#39;Twin Lakes in danger of catastrophic flood!
by Sarah McCloud, climate researcher at the Dept. of Limnology&#39;&#39;

FLYER:
&#39;&#39;Why lower lake levels?
* Prevent shoreline erosion
* Stop flooding
* Prepare for extreme weather
Mayor Johnson is pushing to have the lake levels lowered! Hear more at this week&#39;s Town Hall meeting. 
&#39;&#39;
(text-colour:magenta)[//Gained new location: Department of Limnology//]

($gainSnippet: &quot;Fact&quot;, &quot;Lake level background&quot;)

[[Knock on the nearest office door]]
[[Look for your DNR Contact, Wynne D. Storme]]</tw-passagedata><tw-passagedata pid="215" name="Tell her you met her sister!" tags="" position="6875,775" size="100,100">&quot;I met your sister this morning,&quot; you say. &quot;Her cafe is amazing!&quot;

&quot;Aww! How&#39;s she doing? Did she make you her world-famous PB&amp;J? Sourdough and cherry preserves....it&#39;s the best in town.&quot;

When she hears that you helped out her sister, she&#39;s happy to do an in-depth interview!

($hubChoice: &quot;In-Depth Interview: Limnology Expert&quot;,&quot;Well, let&#39;s get started then!&quot;, 30)
[[...actually, I gotta get going!-&gt;Department of Limnology]]</tw-passagedata><tw-passagedata pid="216" name="Science Story 2: Wetlands" tags="" position="7700,475" size="100,100">You finally get home, exhausted from your first day on the science beat.

You&#39;re about to sit down to a frozen pizza and an epic Netflix marathon when your Squawker message notification chimes.

[[Check Squawker messages]]</tw-passagedata><tw-passagedata pid="217" name="&quot;Can you give me some examples?&quot;" tags="" position="7250,775" size="100,100">&quot;New policies to protect wetlands,&quot; she says. &quot;Taxing people to build flood walls and drains. Convincing the city that lower lake levels actually aren&#39;t the end of the world.&quot;

($gainSnippet: &quot;Quote&quot;, &quot;Policies to prevent flooding&quot;)

[[Ask if she has graphics you can use]]
[[Thank her for her help-&gt;Department of Limnology]]</tw-passagedata><tw-passagedata pid="218" name="Check Squawker messages" tags="" position="7825,475" size="100,100">It&#39;s from the director of the Conservation and Rewilding Area Nature Entity--CRANE for short.

//I saw your article about the flooding. Great piece, but not much about the wetlands. This is a serious issue that doesn&#39;t get much coverage. I&#39;d love the chance to talk.//

[[Respond to her message]]
[[Read up on CRANE]]
[[Block her and turn on some Webflix]]</tw-passagedata><tw-passagedata pid="219" name="Respond to her message" tags="Trust" position="8075,475" size="100,100">You message the wetland activist and agree to hear her out. 
($changeStat: $trustName, 1)

She&#39;s upset that you didn&#39;t cover the wetlands more in your story.

&quot;The lakes might be the heart of Twin Lakes, but the marshes are the arteries,&quot; she writes. &quot;Without its wetlands, Twin Lakes won&#39;t survive.&quot;

[[Agree to meet with her in the morning.]]
[[Check in with your editor]]

</tw-passagedata><tw-passagedata pid="220" name="Block her and turn on some Webflix" tags="Endurance Trust" position="7950,350" size="100,100">You&#39;ve been working alllll day. Everybody needs time to recharge, even reporters in the middle of a local crisis.

($changeStat: $enduranceName, 1)
($changeStat: $trustName, -1)

Your phone chimes again: a text from your editor this time.

[[Read your editor&#39;s message]]</tw-passagedata><tw-passagedata pid="221" name="Read up on CRANE" tags="Bookworm Techie" position="7950,600" size="100,100">You go online and do some digging. Looks like the Conservation and Rewilding...Area...Whatever-Else...is a non-profit group focused on saving wetlands in Twin Lakes.

Judging from their thousands of followers on Squawker, they have a lot of community support. 

Either that, or they post a lot of cute animal videos.

($changeStat: $bookwormName, 1)
($changeStat: $techieName, 1)

[[Respond to Squawker message-&gt;Respond to her message]]
[[Block her and turn on some Webflix]]</tw-passagedata><tw-passagedata pid="222" name="Agree to meet with her in the morning." tags="" position="8200,475" size="100,100">She asks if you can meet her at Snakebite Marsh tomorrow. You delete and rewrite your message three times:

//~~I&#39;m sure the marshes are very important but I was planning to sleep until noon tomorrow,

I&#39;m a brand new reporter, what do you want from me???~~

~~Soooo I don&#39;t really feel good about the name &quot;Snakebite Marsh.&quot;~~

Sure. What time?//

[[&quot;Tomorrow morning, 8 a.m.&quot;]]</tw-passagedata><tw-passagedata pid="223" name="Read your editor&#39;s message" tags="" position="8075,350" size="100,100">//Hey, I keep getting emails from CRANE. A big local non-profit. Can you chat with them? There might be another science story here.//

Welp, looks like the next episode of Streeterton is gonna have to wait.

[[Message the CRANE director]]</tw-passagedata><tw-passagedata pid="224" name="Message the CRANE director" tags="" position="8200,350" size="100,100">It&#39;s hard to read tone over private messages, but the CRANE director seems annoyed.

&quot;I saw you blocked me earlier,&quot; she says. &quot;Guess you changed your mind.&quot;

She asks if you&#39;d be interested in doing a story about floods and wetland preservation. &quot;If we don&#39;t protect the wetlands, Twin Lakes won&#39;t survive,&quot; she says. 

Part of you wants to pretend there&#39;s no story here, but the more she says, the more important this sounds. 

[[Agree to meet with her in the morning.]]</tw-passagedata><tw-passagedata pid="225" name="&quot;Tomorrow morning, 8 a.m.&quot;" tags="" position="8325,475" size="100,100">You wake up to your fifth snoozed alarm, approximately an hour later than planned.

Looks like no leisurely breakfast or long, relaxing shower today.

Though the chance of rain has gone up to 80%, so maybe nature will take care of that last part. 

You have time to do one thing before you head to the marsh.

[[Gather supplies]]
[[Meet some other reporters for coffee]]
[[Go for an early morning run]]
</tw-passagedata><tw-passagedata pid="226" name="Gather supplies" tags="Resourceful" position="8450,600" size="100,100">You&#39;ve never been to a marsh before. You&#39;re imagining thick mud and poison ivy and maybe some rattlesnakes. 

You stuff your bag with a raincoat, pepper spray, a compass, protein bars, and a hatchet and duct tape in case you end up getting lost and need to build a shelter to survive. 

Oh, and bug spray, of course. 

($changeStat:$resourcefulName, 1)

[[Head to the marsh-&gt;Head to Cherry Creek Marsh.]]</tw-passagedata><tw-passagedata pid="227" name="Meet some other reporters for coffee" tags="Social Trust" position="8450,475" size="100,100">(if:(history:) contains &quot;Help the baker&quot;)[You meet up with Khalisa and Ben at your new favorite cafe: the bakery where you helped stack sandbags! (Well, technically, they were sacks of flour.)

The baker is happy to see you. &quot;Thanks to your article, I was able to get some sandbags,&quot; she says, pointing outside. &quot;Hopefully it&#39;ll be enough!&quot;

You have some coffee and chat with Khalisa and Ben, feeling unusually social for an &quot;out-of-towner.&quot; ](elseif:(history:) contains &quot;Wait outside&quot;)[You meet up with Khalisa and Ben at a cafe a few blocks away.

Khalisa orders a yogurt parfait and asks what you said to her dad. &quot;He seemed super impressed by you,&quot; she says. 

Ben is very concerned with the safety of his jellyfish umbrella. 

&quot;Don&#39;t worry,&quot; you tell him, &quot;it&#39;s at home drying out.&quot;](elseif:(history:) contains &quot;Ask around for its owner&quot;)[&quot;I heard you raced after the mayor&#39;s pet chicken and saved it from drowning,&quot; Khalisa says, and Ben looks amazed. 

&quot;Actually, it was his niece&#39;s chicken, and it was just wandering around in a puddle,&quot; you say.

They don&#39;t seem to hear you. You wonder if this is how small-town myths get started.](else:)[You meet up with Khalisa and Ben at a cafe.

You have some coffee and chat, feeling unusually social for an &quot;out-of-towner.&quot; 

You hate to admit it, but this little town is starting to grow on you. You&#39;re even starting to get used to the cherry-infused coffee. ]

($changeStat: $socialName, 1)
($changeStat: $trustName, 1)
[[Head to Cherry Creek Marsh.]]</tw-passagedata><tw-passagedata pid="228" name="Go for an early morning run" tags="Endurance" position="8450,350" size="100,100">You jog through the neighborhood. A couple days ago, it would&#39;ve been an ordinary run.

Now there are underwater sidwealks, submerged bridges, and huge fallen branches in piles everywhere. 

You stop on a streetcorner and take some photos. 

($gainSnippet: &quot;Photo&quot;,&quot;Flooded neighborhood&quot;)
($changeStat: $enduranceName, 1)

[[Head to Cherry Creek Marsh.]]</tw-passagedata><tw-passagedata pid="229" name="Head to Cherry Creek Marsh." tags="" position="8600,475" size="100,100">When you arrive at the marsh, the CRANE director is waiting for you. 

Plus two or three volunteers, and about a thousand mosquitoes. 

[[Talk to CRANE Director]]</tw-passagedata><tw-passagedata pid="230" name="Check in with your editor" tags="" position="8125,600" size="100,100">Your editor is intrigued.

&quot;Sounds like it could be another science story,&quot; she says. &quot;I want you to meet with her and see what she has to say.&quot;

[[Message CRANE organizer to arrange a meet-up-&gt;Agree to meet with her in the morning.]]</tw-passagedata><tw-passagedata pid="231" name="Talk to CRANE Director" tags="" position="8725,475" size="100,100">The CRANE director introduces herself as Birdie--either it&#39;s a nickname, or her parents had amazing foresight. 

Birdie tells you about Cherry Creek Marsh, which is protected from urban development. 

&quot;This is one of the last marshes we&#39;ve got left,&quot; she says. &quot;Most of them have been filled in to make parking lots, buildings, and neighborhoods.&quot;

[[&quot;How is that related to the flooding?&quot;]]
</tw-passagedata><tw-passagedata pid="232" name="&quot;How is that related to the flooding?&quot;" tags="" position="8850,475" size="100,100">She tells you that wetlands soak up water and give it a place to go, but pavement and rooftops send it racing toward the rivers and lakes.

&quot;Our watershed can&#39;t handle the loss of any more marshes,&quot; she says. &quot;Especially with all the extreme weather we&#39;ve been getting. Without wetlands, we&#39;ll always be vulnerable to flooding.&quot;

($gainSnippet: &quot;Quote&quot;,&quot;Importance of wetlands&quot;)
($gainSnippet: &quot;Fact&quot;,&quot;Flood vulnerability&quot;)

[[&quot;Are there policies to protect wetlands?&quot;]]</tw-passagedata><tw-passagedata pid="233" name="Wetland statistics" tags="" position="7950,1400" size="100,100">She gives you the stats:
* Twin Lakes has lost nearly 50% of its original wetlands
* In some other parts of the region, up to 90% of the original wetlands are gone!

($gainSnippet:&quot;Graph&quot;,&quot;Wetland loss stats&quot;)

[[Ask her to confirm CRANE&#39;s information]]
[[Ask her if the wetlands are protected.]]
[[Thank her and end interview]]</tw-passagedata><tw-passagedata pid="234" name="&quot;Are there policies to protect wetlands?&quot;" tags="" position="8975,473" size="100,100">&quot;Not enough,&quot; Birdie says.

She explains the state policy that says developers have to create a new wetland if they want to build over one.

&quot;Sometimes they create a wetland in a totally different area, which doesn&#39;t help us here,&quot; she says. &quot;Plus, natural wetlands and human-made ones don&#39;t really compare.&quot;

($gainSnippet: &quot;Quote&quot;,&quot;Wetland policy&quot;)

[[&quot;Do you have sources for all this information?&quot;]]</tw-passagedata><tw-passagedata pid="235" name="Marsh Map" tags="" position="9225,400" size="100,200">&#39;&#39;Location: Snakebite Marsh&#39;&#39;
(if:visits is 1)[(set:$currentTime to 150)]
(if:$currentTime &gt; 30)[
Mosquitoes and dragonflies are buzzing around you, making it hard to think.

You&#39;ve got some great stuff, but you&#39;ll need to do more digging if you want this to be a science story.

You have (display:&quot;PRINT TIME&quot;) remaining to submit this story.

($hubChoice:&quot;Take photos of the marsh&quot;,&quot;Take photos of the marsh&quot;,15) 
($hubChoice:&quot;Talk to volunteer heading out onto the trail&quot;,&quot;Talk to volunteer heading out onto the trail&quot;,10) 
($hubChoice:&quot;Talk to volunteer with bag full of seed packets&quot;,&quot;Talk to volunteer with bag full of seed packets&quot;,15) 
($hubChoice:&quot;Go to the Department of Limnology&quot;,&quot;Go to the Department of Limnology&quot;,30)]
(else:)[(display:&quot;Wetlands Story Construction&quot;)]</tw-passagedata><tw-passagedata pid="236" name="Take photos of the marsh" tags="" position="9375,450" size="100,100">($statGate:$techieName, 5)
(if: $techie &gt;4)[You notice a pair of sandhill cranes in the distance, surrounded by marshy water--and litter that got swept here by the storm.

With your zoom lens, you get an amazing close-up photo!

//Get amazing wetland photos//](elseif: $trust &gt;4)[($statGate:$trustName, 5)
You ask the volunteers if it would be okay to take a few photos.

They all happily agree. Turns out they&#39;ve heard of you and your work. 

You get some great photos of the volunteers heading out to do some clean-up!

//Get good wetland photos//](else:)[($statGate:$trustName, 5)
The volunteers seem suspicious of your motives and ask not to be photographed. 

At least the plants and birds don&#39;t seem to mind.

Now if only you had a better camera lens...

//Get okay marsh photos//]

[[Marsh Map]]

</tw-passagedata><tw-passagedata pid="237" name="Talk to volunteer heading out onto the trail" tags="" position="9375,325" size="100,100">The volunteer is just getting ready to head out on the trail. 

You ask if he has time to answer a few questions. 

&quot;That depends,&quot; he says. &quot;You okay with getting your feet wet?&quot;

($hubChoice:&quot;Join him on the hike.&quot;,&quot;join him on the hike.&quot;,30)
[[Thanks, but no thanks.-&gt;Marsh Map]]</tw-passagedata><tw-passagedata pid="238" name="Return to the Department of Limnology" tags="" position="8075,875" size="200,100">&#39;&#39;Location: Department of Limnology&#39;&#39;
(if: $currentTime &gt;=30)[
You have (display:&quot;PRINT TIME&quot;) remaining to submit this story.

The Department of Limnology is right on the shoreline.

You look out at the lake and see someone who looks like they&#39;re standing, impossibly, on water. 

As you get closer, you realize that the dock is completely submerged!

($hubChoice: &quot;Take photos&quot;,&quot;Take photos&quot;,15)
[[Ask if they have time for an interview.]] 
($hubChoice: &quot;Call the Big Business Bureau&quot;,&quot;Call the Big Business Bureau&quot;, 15)]
($hubChoice:&quot;Marsh Map&quot;,&quot;Go back to the marsh&quot;,30)
(display:&quot;Wetlands Story Construction&quot;)</tw-passagedata><tw-passagedata pid="239" name="Join him on the hike." tags="" position="9373,201" size="100,100">You follow him on a narrow, soggy trail. 

($statGate: $enduranceName, 5)
(if: $endurance &gt;4)[He&#39;s a brisk walker, but thanks to your endurance, you keep up easily.

[[Ask why he&#39;s out here volunteering]]](elseif: $resourceful &gt;4)[($statGate: $resourcefulName, 5)
Thankfully, your updated flood gear keeps you dry and able to keep up!

[[Ask why he&#39;s out here volunteering]]](elseif: $social &gt;4)[($statGate: $socialName, 5)
You can barely keep up, but your charming personality comes to the rescue.

He slows down, enjoying your conversation, and shows you how to navigate the muck.

[[Ask why he&#39;s out here volunteering]]](else:)[($statGate: $resourcefulName, 5)
($statGate: $socialName, 5)
You can barely keep up with his lightning-fast pace, and water soaks through your apparently-not-waterproof hiking boots.

Within seconds, the volunteer has disappeared around a bend in the trail. 

You try to follow, but as you round the curve, you nearly walk into a sandhill crane.

A very large sandhill crane. With beady red eyes and a knife-like beak. 

It really is very beautiful, and probably incredibly gentle. (Which you tell yourself as you run for dear life, hoping the crane won&#39;t fly after you.)

[[Marsh Map]]]</tw-passagedata><tw-passagedata pid="240" name="Ask why he&#39;s out here volunteering" tags="" position="9225,200" size="100,100">&quot;The storm brought tons of urban runoff--chemicals, trash, stuff like that,&quot; he says. &quot;We&#39;re here doing clean-up.&quot;

He tells you that he remembers when there were wetlands all over town.

&quot;Most of it&#39;s gone now,&quot; he says. &quot;It&#39;s heartbreaking. Animals are losing their habitats, and there won&#39;t be any town left if Twin Lakes keeps flooding all the time!&quot;

($gainSnippet:&quot;Quote&quot;,&quot;Marsh loss&quot;)
($gainSnippet:&quot;Observation&quot;,&quot;Marsh pollution&quot;)

[[Marsh Map]]</tw-passagedata><tw-passagedata pid="241" name="&quot;Do you have sources for all this information?&quot;" tags="" position="9100,475" size="100,100">Birdie gives you the link to her website. &quot;Our sources are all listed here,&quot; she says. &quot;We use research from the limnology experts at the college. You should pay them a visit!&quot;

//Get Location: Department of Limnology//

[[Thank her for her help.-&gt;Marsh Map]]
</tw-passagedata><tw-passagedata pid="242" name="Take photos" tags="" position="7975,1000" size="100,100">You snap a few photos: two dark silouettes on the dock, surrounded by eerie, greenish water. 

($gainSnippet:&quot;Photo&quot;,&quot;Limnology docks&quot;)

[[Ask if they have time for an interview.]]</tw-passagedata><tw-passagedata pid="243" name="Ask if they have time for an interview." tags="" position="8125,1000" size="100,100">(if:(history:) contains &quot;Bookworm answer&quot;)[As the dark silouette walks closer, you recognize her: the lake studies researcher you met at the dam!

&quot;Hey!&quot; she says. &quot;You&#39;re the limnology-nerd reporter, right? I read your story yesterday!&quot;

She&#39;s happy to give you another interview. Looks like all that light reading on inland aquatic ecosystems and the local drainage basin is coming in handy!

($hubChoice: &quot;Ask her about the wetlands&quot;,&quot;Ask her about the wetlands&quot;,15)](elseif: $social &gt;4)[($statGate:$socialName, 5)
At first they don&#39;t seem thrilled about the idea. 

Then they notice the coffee and donuts you brought with you--your favorite social currency. 

&quot;I&#39;m guessing you&#39;re pretty swamped here,&quot; you say. &quot;Want to chat over donuts? Maybe you could tell me a little about the local wetlands?&quot;

One of the researchers grins. &quot;You had me at donuts.&quot;

($hubChoice: &quot;Ask her about the wetlands&quot;,&quot;Ask her about the wetlands&quot;,15)](elseif: $resourceful &gt;4)[
($statGate:$socialName, 5)
At first they don&#39;t seem thrilled about the idea. 
($statGate:$resourcefulName, 5)
Then they notice the coffee and donuts you brought with you. You&#39;re nothing if not resourceful.

&quot;I&#39;m guessing you&#39;re pretty swamped here,&quot; you say. &quot;Want to chat over donuts? Maybe you could tell me a little about the local wetlands?&quot;

One of the researchers grins. &quot;You had me at donuts.&quot;

($hubChoice: &quot;Ask her about the wetlands&quot;,&quot;Ask her about the wetlands&quot;,15)](else:)[($statGate:$socialName, 5)
($statGate:$resourcefulName, 5)
The researchers have been out here all morning--they&#39;re a little too hangry for a long chat.

They give you a quick, rushed-sounding statement: yes, a lot of the wetlands have been destroyed. Yes, that contributes to flooding.

&quot;Check our website,&quot; they say. &quot;You can find all our research there.&quot;

($gainSnippet: &quot;Quote&quot;,&quot;Annoyed limnologists&quot;)

($hubChoice: &quot;Check Limnology Department Website.&quot;,&quot;Check Limnology Department Website.&quot;,15)
($hubChoice: &quot;Look around for someone else to talk to.&quot;,&quot;Look around for someone else to talk to.&quot;,15)
]</tw-passagedata><tw-passagedata pid="244" name="Ask her about the wetlands" tags="" position="8025,1275" size="100,100">&quot;Wetlands stop flooding by giving water somewhere to go,&quot; she says. &quot;The problem is, our wetlands keep shrinking.&quot;

(link-reveal:&quot;\&quot;What do you mean, shrinking?\&quot;&quot;)[

&quot;The city keeps building over them. Yes, the city is growing, but we&#39;re losing wildlife AND putting ourselves at risk of more flooding.&quot; 

[[Ask her to confirm CRANE&#39;s information]]
[[Ask her if the wetlands are protected.]]
[[Ask what percentage of local wetlands have been lost.-&gt;Wetland statistics]]]</tw-passagedata><tw-passagedata pid="245" name="Check Limnology Department Website." tags="" position="8083,1400" size="100,100">($statGate: $bookwormName,4)  
(if: $bookworm &gt;3 or $techie &gt; 3)[You go online and search their website, moving quickly thanks to your speed-reading skills. 

It&#39;s full of great research and statistics!

You gather tons of stats for your article--the percentage of lost wetlands, the percent increase in rainfall, and a quote for your story.

It&#39;s not quite as exciting quoting a website, instead of a person, but youll take what you can get. 

($gainSnippet: &quot;Graph&quot;,&quot;Wetlands and rainfall&quot;)
($gainSnippet: &quot;Fact&quot;,&quot;Wetlands and flooding&quot;)]
(else:)[This website is absolutely impenetrable. Bright blue text on a grey background. They&#39;re using at least seven different fonts. This is like, Web 0.1. You don&#39;t think you can get anything useful here.]

[[Look around for someone else to talk to.]]
[[-&gt;Return to the Department of Limnology]]</tw-passagedata><tw-passagedata pid="246" name="Look around for someone else to talk to." tags="" position="8275,1000" size="100,100">You walk along the Limnology building, toward the dock.

At first it seems deserted. Then you notice a scientist loading up gear on a small research boat!

[[Ask to join him]]
[[Ask for a quick interview]]</tw-passagedata><tw-passagedata pid="247" name="Ask her to confirm CRANE&#39;s information" tags="" position="8100,1525" size="100,100">She looks over your notes. &quot;Yep,&quot; she says, &quot;that all looks right! And here&#39;s some more info, if you need a nice beach read.&quot;

She sends you a link to a long, complicated academic paper about wetlands and flooding.

($statGate: $bookwormName, 6)
(if: $bookworm &gt;5)[Thanks to your bookish tendencies, you should be able to knock this out by lunchtime.

($gainSnippet: &quot;Fact&quot;,&quot;Wetlands and flooding background&quot;)
($gainSnippet: &quot;Fact&quot;,&quot;Wetland loss confirmation&quot;)](else:)[Just the thought of reading this makes you want to crawl into a hole somewhere.

($gainSnippet: &quot;Fact&quot;,&quot;Wetland loss confirmation&quot;)]

[[Ask her if the wetlands are protected.]]
[[Ask what percentage of local wetlands have been lost.-&gt;Wetland statistics]]
[[Thank her and end interview]]</tw-passagedata><tw-passagedata pid="248" name="Ask her if the wetlands are protected." tags="" position="7951,1523" size="100,100">&quot;Some of them are,&quot; she says. &quot;But a few years ago, the Big Business Bureau fought to get rid of protections for smaller wetlands.&quot;

(link-reveal:&quot;\&quot;People were okay with that?\&quot;&quot;)[

&quot;Well, they wanted to build a community center on Sugar Marsh,&quot; she says. &quot;It&#39;s hard for a wet, buggy marsh to compete with a gym and an indoor pool.&quot;

[[Ask her to confirm CRANE&#39;s information]]
[[Ask what percentage of local wetlands have been lost.-&gt;Wetland statistics]]
[[Thank her and end interview]]]</tw-passagedata><tw-passagedata pid="249" name="Talk to volunteer with bag full of seed packets" tags="" position="9375,575" size="100,100">($statGate: $trustName, 5)
(if: $trust &gt;4)[The volunteer seems to trust you instantly. 

She tells you all about her volunteer work: planting native seeds to help restore the marsh.

&quot;People don&#39;t understand how important marshes are,&quot; she says. &quot;They stop flooding, stop erosion in the lakes and streams, and they&#39;re just so magical!&quot;

You&#39;re not sure about the magical part. You&#39;ve already gotten about a dozen mosquito bites. It is pretty beautiful, though.

($gainSnippet: &quot;Quote&quot;,&quot;Vital importance of wetlands&quot;)

[[Marsh Map]]](if: $resourceful &gt;4)[($statGate: $resourcefulName, 5)
The volunteer looks frustrated. &quot;Can&#39;t believe I forgot my waders,&quot; she mutters.

Luckily, you have an extra pair in your backpack! You pull them out, and she stares in amazement. &quot;You just carry those around with you??&quot;

While she puts them on, she tells you all about her volunteer work: planting native seeds to help restore the marsh.

&quot;People don&#39;t understand how important marshes are,&quot; she says. &quot;They stop flooding, stop erosion in the lakes and streams, and they&#39;re just so magical!&quot;

($gainSnippet: &quot;Quote&quot;,&quot;Vital importance of wetlands&quot;)

[[Marsh Map]]](else:)[($statGate: $resourcefulName, 5)
Unfortunately, the volunteer doesn&#39;t trust you enough to talk to you.

&quot;Sorry,&quot; she says, swatting a mosquito. &quot;No offense, Dear, but I think reporters are sort of pests.&quot;

Well, at least she said it nicely. 

[[Marsh Map]] ]</tw-passagedata><tw-passagedata pid="250" name="Go inside specialty cheese shop" tags="" position="4095,555" size="100,100">The street is flooded, but parts of the sidewalk are dry enough to make your way inside.

The panicked shop owner is packing up his merchandise: wheels of gouda, brie, cherry-infused Swiss.

You&#39;re about to ask a few questions when you get a text from your editor:

//Police scanner update: Main Street too dangerous. Evacuation order in progress. STAY SAFE!!//

[[Tell the shop owner to leave the cheese and run.]]</tw-passagedata><tw-passagedata pid="251" name="Tell the shop owner to leave the cheese and run." tags="" position="4225,550" size="100,100">He&#39;s beside himself. &quot;I can&#39;t just leave,&quot; he says. &quot;This is my life&#39;s work! Five year aged gouda! Seven year aged parmesan! How //curd// you ask me to leave them?? There&#39;s no //whey!//&quot;

For goodness sake. People will pun about anything in this town. 

Outside, the sirens are getting louder. 

[[Help him pack up his wares.]] (text-colour:purple)[(30 minutes)]
(if: (history:)contains &quot;Take photos of the street&quot;)[ [[Show him the photos you took outside, to help him understand this dire situation.]] (text-colour:purple)[(20 minutes)]]
[[Evacuate--you aren&#39;t willing to die over cheese!]] (text-colour:purple)[(10 minutes)]</tw-passagedata><tw-passagedata pid="252" name="Help him pack up his wares." tags="Resourceful" position="4363,550" size="100,100">This is stupid, but you can&#39;t leave this guy alone. 
(set: $currentTime to it - 30)
You grab armfuls of super-expensive local cheese. You&#39;re almost done when water rushes past you. The flood is inside, and rising fast!

Thankfully, the shop has a second floor. You race up the stairs, pulling the shopkeeper with you. 

From the window, you can see the street below, which has literally become a river.

You&#39;re soaked and you lost most of your gear, but at least you got a great anecdote and some amazing photos out of this disaster.

Plus, the shop owner has offered you free cheese for life! 

($gainSnippet: &quot;Observation&quot;,&quot;Cheese rescue&quot;)
($gainSnippet: &quot;Photo&quot;,&quot;Flooded street from above&quot;)

($changeStat: $resourcefulName, -2)

[[Get rescued and head back to the dam -&gt;Arrive at flood site]]
</tw-passagedata><tw-passagedata pid="253" name="Show him the photos you took outside, to help him understand this dire situation." tags="" position="4371,423" size="100,100">&quot;Look,&quot; you tell him. &quot;This is what Main Street looks like right now. We need to get out of here, or your parmesan will be parme//gone//!&quot;
(set: $currentTime to it - 20)
He finally seems to understand. You run for the door, but it&#39;s already too late. Waist-deep water is rushing past. 

If you step out the door, you&#39;ll be swept away!

Luckily, a firefighter sees you coming. He helps you and the shopkeeper into a rescue vehicle.

($gainSnippet:&quot;Observation&quot;,&quot;Firefighter rescue&quot;)

[[Get rescued and head back to the dam -&gt;Arrive at flood site]]</tw-passagedata><tw-passagedata pid="254" name="Evacuate--you aren&#39;t willing to die over cheese!" tags="" position="4370,670" size="100,100">You make a mad dash from the flooded store, shouting &quot;Sorry, I gouda go!&quot;
(set: $currentTime to it - 10)
Outside, you&#39;re nearly swept off your feet, until a firefighter helps you reach higher ground.
You tell them someone needs help inside the shop. 
You feel like a bit of a //muenster//, but at least you made it out alive. 

[[Return to the dam-&gt;Arrive at flood site]]</tw-passagedata><tw-passagedata pid="255" name="Wetlands Story Construction" tags="" position="8700,1055" size="100,100">(if: $currentTime &lt;=30)[Time to compile that big story on the wetlands!
(set: $storyType to &quot;Investigation&quot;)
(set: $snippetLimit to 6)
(set: $destination to &quot;TO BE CONTINUED&quot;)
(display: &quot;STORY EVALUATION&quot;)]
(else:)[There&#39;s still time to collect information for this story!

[[Return to the Department of Limnology]]
[[Call the Big Business Bureau]]
[[Marsh Map]]

[[Start compiling anyway.]]
]</tw-passagedata><tw-passagedata pid="256" name="Thank her and end interview" tags="" position="8225,1525" size="100,100">You could use one more perspective for your story.

What do you do? 

[[Look around for someone else to talk to.]]
[[Call the Big Business Bureau]]</tw-passagedata><tw-passagedata pid="257" name="Ask for a quick interview" tags="" position="8425,1075" size="100,100">[INTERVIEW MISSING HERE]

[[Return to the Department of Limnology]]</tw-passagedata><tw-passagedata pid="258" name="Ask to join him" tags="" position="8275,1150" size="100,100">($statGate:$bookwormName, 5)
(if: $bookworm&gt;4)[He almost says no, but then you tell him your credentials and his eyes light up.

&quot;You&#39;re the new reporter who wrote that great science story yesterday!&quot; he says. &quot;It&#39;s rare to find somebody around here who actually knows how to write about lake studies. Respect.&quot;

He agrees to let you tag along on the lake!

[[Climb aboard]]](if: $trust&gt;4)[($statGate: $trustName, 5)
He almost says no, but then he recognizes you. 

&quot;You&#39;re that new reporter who&#39;s always helping out around here!&quot; he says. &quot;I&#39;ve heard you&#39;re super trustworthy.&quot;

He agrees to let you tag along on the lake!

[[Climb aboard]]](else:)[($statGate: $trustName, 5)
&quot;Sorry,&quot; he says. &quot;You&#39;re not a scientist. You&#39;d probably just be bored out there.&quot; 

[[Ask for a quick interview]]]
</tw-passagedata><tw-passagedata pid="259" name="Climb aboard" tags="" position="8275,1275" size="100,100">The boat glides through the water. The scientist tells you he&#39;s heading out to survey the shoreline damage.

He shows you were the lake connects to the Sugar River.

&quot;If you keep going that way, you&#39;ll reach the Snakebite Marsh,&quot; he tells you. &quot;All the water around here is connected. If you lose one part, the watershed collapses.&quot;

From out here, it all looks pretty peaceful. Then you notice the houses on the shore--the water reaches right up to their back doors!

($gainSnippet: &quot;Photo&quot;,&quot;Shoreline damage&quot;)
($gainSnippet: &quot;Quote&quot;,&quot;Watershed connections&quot;)

[[Wetlands Story Construction]]</tw-passagedata><tw-passagedata pid="260" name="Call the Big Business Bureau" tags="" position="9225,850" size="200,100">(if: (history:) contains &quot;Tell them you&#39;re writing about how business is destroying the wetlands.&quot;)[ 
($statGate:$techieName, 3)
(if:$techie &gt;=3)[You remember a method to set yourself as a //private caller// and even install a subtle voice changer. Hopefully now they won&#39;t recognize you as that mudraking journalist from earlier.

&quot;How can I help you?&quot;

[[Tell them their name came up in a story and you want to get their perspective.]] ](else:)[You give the Big Business Bureau another call. This time it goes straight to voicemail. Figures.

[[Wetlands Story Construction]]
]

](else:)[You dig up the number of the Big Business Bureau. The first time you call, a cheerful-sounding receptionist picks up.

&quot;How can I help you?&quot;

[[Tell them you&#39;re writing about how business is destroying the wetlands.]]
[[Tell them their name came up in a story and you want to get their perspective.]] ]</tw-passagedata><tw-passagedata pid="261" name="Tell them their name came up in a story and you want to get their perspective." tags="" position="9345,973" size="100,100">It takes a few minutes, but she tracks down someone to talk with you: one of the lead organizers!

($hubChoice: &quot;Interview business organizer&quot;,&quot;Interview business organizer&quot;,30)</tw-passagedata><tw-passagedata pid="262" name="Interview business organizer" tags="" position="9350,1100" size="100,100">He&#39;s happy to talk with you. &quot;I&#39;ve worked hard to bring new businesses to Twin Lakes,&quot; he says. &quot;The changes here recently has been a dream come true!&quot;

[[Ask him why new businesses are so important.]]
[[Ask him why he pushed to get rid of wetland protections.]]</tw-passagedata><tw-passagedata pid="263" name="Ask him why new businesses are so important." tags="" position="9350,1225" size="100,100">&quot;New businesses are what&#39;s keeping this town alive and growing,&quot; he says. &quot;Just this year, we&#39;ve got a dozen new shops, new office buildings, and a brand new hospital!&quot;

($gainSnippet: &quot;Quote&quot;,&quot;New development&quot;)

[[&quot;Did you know that the hospital is flooded right now?&quot;]]
[[&quot;Where did you find enough land for all of that?&quot;]]
</tw-passagedata><tw-passagedata pid="264" name="Ask him why he pushed to get rid of wetland protections." tags="" position="9200,1225" size="100,100">&quot;Well, some of those restrictions were just ridiculous,&quot; he says. &quot;Did you know they define any low-lying area that floods in summer as a marsh?? Some of them hardly had any nature. Some were just full of garbage!&quot;

($gainSnippet: &quot;Quote&quot;,&quot;Business wetlands counterpoint&quot;)

[[&quot;What about the marshes that support nature? Do you support preserving those?&quot;]]
[[&quot;Did you know that those low-lying areas soak up water and help prevent flooding?&quot;]]</tw-passagedata><tw-passagedata pid="265" name="&quot;Did you know that the hospital is flooded right now?&quot;" tags="" position="9200,1350" size="100,100">&quot;Well, that&#39;s bound to happen,&quot; he says. &quot;It floods all the time around here. We&#39;re surrounded by lakes--it&#39;s not like that&#39;s my fault.&quot;

[[Ask him why he pushed to get rid of wetland protections.]]</tw-passagedata><tw-passagedata pid="266" name="&quot;Where did you find enough land for all of that?&quot;" tags="" position="9350,1350" size="100,100">&quot;There&#39;s a TON of undeveloped land around here,&quot; he says. &quot;We&#39;ve got a lot to work with. Farmers who are going under and need to sell their land. Big empty fields. And all the wetlands, of course!&quot; 

($gainSnippet: &quot;Quote&quot;,&quot;Empty land&quot;)

[[Ask him why he pushed to get rid of wetland protections.]]</tw-passagedata><tw-passagedata pid="267" name="&quot;What about the marshes that support nature? Do you support preserving those?&quot;" tags="" position="9050,1350" size="100,100">&quot;Well, those are great!&quot; he says. &quot;Obviously. But new development is great too. We built the north side community center on a marsh, and now people have a pool and a ball field! It&#39;s made the neighborhood more fun.&quot;

//And more likely to flood,// you add silently.

[[&quot;Did you do anything to reduce the flood risk?&quot;]]</tw-passagedata><tw-passagedata pid="268" name="&quot;Did you know that those low-lying areas soak up water and help prevent flooding?&quot;" tags="" position="9050,1100" size="100,100">&quot;Well, sure,&quot; he says. &quot;But there are other ways to prevent flooding. Ways that actually bring in jobs for our town! Better storm drains, storm walls, stuff like that. I&#39;m sure the city can handle it.&quot; </tw-passagedata><tw-passagedata pid="269" name="&quot;And more likely to flood.&quot;" tags="" position="9050,1225" size="100,100">He looks suspiciously at you. &quot;What kind of story is this, anyway?&quot;

You try to put him at ease, but he&#39;s done talking. Interview over. 

[[Wetlands Story Construction]]</tw-passagedata><tw-passagedata pid="270" name="&quot;Did you do anything to reduce the flood risk?&quot;" tags="" position="8925,1350" size="100,100">&quot;Well, not exactly,&quot; he says. &quot;Not there. But we followed the regluations and built a new marsh over in Apple Valley to replace the one we got rid of!&quot;

[[&quot;How does a marsh in Apple Valley help us here in Twin Lakes?&quot;]]</tw-passagedata><tw-passagedata pid="271" name="&quot;How does a marsh in Apple Valley help us here in Twin Lakes?&quot;" tags="" position="8800,1350" size="100,100">&quot;I don&#39;t know, I don&#39;t make the rules!&quot; He looks annoyed. &quot;I did what the laws told me to do. Don&#39;t make me out to be the bad guy.&quot;

($gainSnippet: &quot;Quote&quot;,&quot;Annoyed business&quot;)

You try to ask more questions, but he makes an excuse and hangs up.

[[Wetlands Story Construction]]</tw-passagedata><tw-passagedata pid="272" name="Tell them you&#39;re writing about how business is destroying the wetlands." tags="" position="9200,975" size="100,100">Suddenly, the receptionist seems super busy.

&quot;Sorry,&quot; she says, &quot;we&#39;re totally swamped here, there&#39;s not really anyone else to talk to, but I can take down your contact info, though!&quot;

She hangs up before you can even tell her your name. Come to think of it, maaaaybe you shouldn&#39;t have led with the evil-business angle.

[[Wetlands Story Construction]]</tw-passagedata><tw-passagedata pid="273" name="blankstart" tags="" position="50,675" size="100,100">(goto: &quot;START&quot;)</tw-passagedata><tw-passagedata pid="274" name="REFRESH STATS" tags="" position="300,300" size="100,100">{(set: $bookworm to $bookwormName of $stats)
(set: $resourceful to $resourcefulName of $stats)
(set: $endurance to $enduranceName of $stats)
(set: $techie to $techieName of $stats)
(set: $social to $socialName of $stats)
(set: $trust to $trustName of $stats)}</tw-passagedata><tw-passagedata pid="275" name="PRINT TIME" tags="" position="175,300" size="100,100">{(set: _hours to 0)
(set: _minutes to $currentTime)
(if: _minutes  &gt;= 60)[
	(set: _minutes to it - 60)
	(set: _hours to it + 1)
](if: _minutes  &gt;= 60)[
	(set: _minutes  to it - 60)
	(set: _hours to it + 1)
](if: _minutes  &gt;= 60)[
	(set: _minutes  to it - 60)
	(set: _hours to it + 1)
](if: _minutes  &gt;= 60)[
	(set: _minutes  to it - 60)
	(set: _hours to it + 1)
]

(text-style:&quot;buoy&quot;)+(text-style:&quot;bold&quot;)+(text-color:purple)[(if: _hours &gt; 1)[
	_hours hours&#96; &#96;
](elseif: _hours is 1)[
	1 hour&#96; &#96;
]
(if: _minutes  &gt; 0)[
(if: _hours &gt; 0)[
and&#96; &#96;
]
_minutes  minutes&#96; &#96;
]]}</tw-passagedata><tw-passagedata pid="276" name="Great flood photos" tags="Photo Great" position="3225,1175" size="100,100">Snippet text unimplemented.</tw-passagedata><tw-passagedata pid="277" name="Great flood quote" tags="Quote Great" position="3100,1175" size="100,100">Snippet text unimplemented.</tw-passagedata><tw-passagedata pid="278" name="Flood safety tips" tags="Fact Good" position="3100,1275" size="100,100">Snippet text unimplemented.</tw-passagedata><tw-passagedata pid="279" name="Blurry flood photos" tags="Photo Bad" position="3225,1375" size="100,100">Snippet text unimplemented.</tw-passagedata><tw-passagedata pid="280" name="Good flood photos" tags="Photo Good" position="3225,1275" size="100,100">Snippet text unimplemented.</tw-passagedata><tw-passagedata pid="281" name="Basic observations" tags="Observation Bad" position="3400,1375" size="100,100">Snippet text unimplemented.</tw-passagedata><tw-passagedata pid="282" name="Detailed observation" tags="Observation Good" position="3400,1275" size="100,100">Snippet text unimplemented.</tw-passagedata><tw-passagedata pid="283" name="Super detailed observation" tags="Observation Great" position="3400,1175" size="100,100">Snippet text unimplemented</tw-passagedata><tw-passagedata pid="284" name="Volunteer conversation" tags="Quote Good" position="3400,1500" size="100,100">Snippet text unimplemented.
</tw-passagedata><tw-passagedata pid="285" name="Sandbag quote" tags="Quote Great" position="3550,1175" size="100,100">Snippet text unimplemented.
</tw-passagedata><tw-passagedata pid="286" name="Volunteer info" tags="Fact Good" position="3550,1300" size="100,100">Snippet text unimplemented</tw-passagedata><tw-passagedata pid="287" name="Great volunteering quote" tags="Quote Great" position="3700,1175" size="100,100">Snippet text unimplemented.
</tw-passagedata><tw-passagedata pid="288" name="Houseboat photos" tags="Photo Great" position="3550,1425" size="100,100">Snippet text unimplemented.</tw-passagedata><tw-passagedata pid="289" name="Okay houseboat photos" tags="Photo Good" position="3550,1525" size="100,100">Snippet text unimplemented.</tw-passagedata><tw-passagedata pid="290" name="Blurry houseboat photos" tags="Photo Bad" position="3550,1625" size="100,100">Snippet text unimplemented.</tw-passagedata><tw-passagedata pid="291" name="Great houseboat story" tags="Quote Great" position="3700,1300" size="100,100">Snippet text unimplemented.</tw-passagedata><tw-passagedata pid="292" name="Houseboat story" tags="Quote Good" position="3700,1400" size="100,100">Snippet text unimplemented.</tw-passagedata><tw-passagedata pid="293" name="Lake levels" tags="Quote Good" position="3825,1175" size="100,100">Double-click this passage to edit it.</tw-passagedata><tw-passagedata pid="294" name="Flood cause" tags="Fact Good" position="3825,1275" size="100,100">Snippet text unimplemented.</tw-passagedata><tw-passagedata pid="295" name="Flood science" tags="Fact Good" position="3825,1400" size="100,100">Snippet text unimplemented.</tw-passagedata><tw-passagedata pid="296" name="Lakewater study" tags="Photo Good" position="3825,1500" size="100,100">Snippet text unimplemented.</tw-passagedata><tw-passagedata pid="297" name="Flood info" tags="Fact Good" position="3825,1625" size="100,100">Snippet text unimplemented.</tw-passagedata><tw-passagedata pid="298" name="DNR expectations" tags="Quote Great" position="3825,1825" size="100,100">Snippet text unimplemented.
</tw-passagedata><tw-passagedata pid="299" name="Sandbag location" tags="Fact Good" position="3825,1725" size="100,100">Snippet text unimplemented.</tw-passagedata><tw-passagedata pid="300" name="Sandbag troubles" tags="Quote Great" position="3825,1925" size="100,100">Snippet text unimplemented.</tw-passagedata><tw-passagedata pid="301" name="compile your story..." tags="" position="4100,100" size="100,100">Talk about a long day. Time to piece together story number two.
(set: $storyType to &quot;Human Interest&quot;)
(set: $snippetLimit to 6)
(set: $destination to &quot;Level 2, Story 3: The Science Story&quot;)
(display: &quot;STORY EVALUATION&quot;)</tw-passagedata><tw-passagedata pid="302" name="Dog rescue" tags="Observation Good" position="4125,1175" size="100,100">Snippet text unimplemented
</tw-passagedata><tw-passagedata pid="303" name="Dog rescue picture" tags="Photo Good" position="4125,1275" size="100,100">Insert picture of a rescue worker saving a dog from the flood.</tw-passagedata><tw-passagedata pid="304" name="Cheese rescue" tags="Observation Great" position="4375,1175" size="100,100">Snippet text unimplemented.</tw-passagedata><tw-passagedata pid="305" name="Flooded street from above" tags="Photo Great" position="4375,1375" size="100,100">Insert birds-eye view of flooded Cherry Festival main street.</tw-passagedata><tw-passagedata pid="306" name="Firefighter rescue" tags="Observation Good" position="4375,1275" size="100,100">Snippet text unimplemented.</tw-passagedata><tw-passagedata pid="307" name="test" tags="" position="200,825" size="100,100">($changeStat: $bookwormName, 1)</tw-passagedata><tw-passagedata pid="308" name="Time to assemble the science story..." tags="" position="5150,700" size="100,100">Well, here goes nothing. Your first science story!
(set: $storyType to &quot;Science&quot;)
(set: $snippetLimit to 6)
(set: $destination to &quot;Science Story 2: Wetlands&quot;)
(display: &quot;STORY EVALUATION&quot;)</tw-passagedata><tw-passagedata pid="309" name="Flood mumbo jumbo" tags="Observation Bad" position="5250,1175" size="100,100">Double-click this passage to edit it.</tw-passagedata><tw-passagedata pid="310" name="Science of flooding" tags="Fact Good" position="5250,1400" size="100,100">Snippet text unimplemented.</tw-passagedata><tw-passagedata pid="311" name="Confusing graphic" tags="Graph Bad" position="5250,1275" size="100,100">A squiggly misinterpreted graph.</tw-passagedata><tw-passagedata pid="312" name="Flood probability" tags="Graph Good" position="5250,1500" size="100,100">A clean graph of flood probability.</tw-passagedata><tw-passagedata pid="313" name="Art business impact" tags="Quote Great" position="5778,1408" size="100,100">Double-click this passage to edit it.</tw-passagedata><tw-passagedata pid="314" name="Detailed flood background" tags="Fact Great" position="5755,75" size="100,100">Snippet text unimplemented.</tw-passagedata><tw-passagedata pid="315" name="Floods and climate change" tags="Graph Good" position="5835,75" size="100,100">Snippet text unimplemented
</tw-passagedata><tw-passagedata pid="316" name="Cause of flood" tags="Quote Good" position="5953,75" size="100,100">Snippet text unimplemented</tw-passagedata><tw-passagedata pid="317" name="Basic flood background" tags="Fact Good" position="6075,75" size="100,100">Snippet text unimplemented.
</tw-passagedata><tw-passagedata pid="318" name="Lake level background" tags="Fact Good" position="5775,575" size="100,100">Snippet text unimplemented</tw-passagedata><tw-passagedata pid="319" name="Basic flood prevention" tags="Quote Good" position="6075,575" size="100,100">Snippet text unimplemented.</tw-passagedata><tw-passagedata pid="320" name="Impact of flood" tags="Quuote Good" position="6225,575" size="100,100">Snippet text unimplemented.</tw-passagedata><tw-passagedata pid="321" name="Rainfall stats" tags="Graph Good" position="6350,575" size="100,100">Snippet text unimplemented.</tw-passagedata><tw-passagedata pid="322" name="Policies to prevent flooding" tags="Quote Great" position="6475,75" size="100,100">Snippet text unimplemented.</tw-passagedata><tw-passagedata pid="323" name="Mayor - impact" tags="Quote Great" position="5526,1178" size="100,100">Snippet text unimplemented.</tw-passagedata><tw-passagedata pid="324" name="Mayor - Response" tags="Quote Great" position="5513,1548" size="100,100">Snippet text unimplemented.</tw-passagedata><tw-passagedata pid="325" name="Mayor - Policies" tags="Quote Great" position="5640,1415" size="100,100">Snippet text unimplemented.</tw-passagedata><tw-passagedata pid="326" name="Flooded neighborhood" tags="Photo Great" position="8550,350" size="100,100">insert picture of flooded neighborhood!</tw-passagedata><tw-passagedata pid="327" name="Importance of wetlands" tags="Quote Good" position="8850,600" size="100,100">Snippet text unimplemented</tw-passagedata><tw-passagedata pid="328" name="Flood vulnerability" tags="Fact Good" position="8850,700" size="100,100">Snippet text unimplemented</tw-passagedata><tw-passagedata pid="329" name="Wetland policy" tags="Quote Good" position="8975,600" size="100,100">Snippet text unimplemented</tw-passagedata><tw-passagedata pid="330" name="Beautiful wetland" tags="Photo Great" position="9500,450" size="100,100">A pretty wetland picture.</tw-passagedata><tw-passagedata pid="331" name="Pretty wetland" tags="Photo Good" position="9600,450" size="100,100">A pretty photo of Snakebite Marsh.</tw-passagedata><tw-passagedata pid="332" name="Blurry wetland" tags="Photo Bad" position="9700,450" size="100,100">A blurry photo of Snakebite Marsh.</tw-passagedata><tw-passagedata pid="333" name="Marsh pollution" tags="Observation Great" position="9100,200" size="100,100">Snippet text unimplemented</tw-passagedata><tw-passagedata pid="334" name="Marsh loss" tags="Quote Great" position="9000,200" size="100,100">Snippet text unimplemented.</tw-passagedata><tw-passagedata pid="335" name="Vital importance of wetlands" tags="Quote Great" position="9500,575" size="100,100">Snippet text unimplemented</tw-passagedata><tw-passagedata pid="336" name="Limnology docks" tags="Photo Great" position="7850,1000" size="100,100">Double-click this passage to edit it.</tw-passagedata><tw-passagedata pid="337" name="Annoyed limnologists" tags="Quote Bad" position="7850,1125" size="100,100">Snippet text unimplemented.</tw-passagedata><tw-passagedata pid="338" name="Shoreline damage" tags="Photo Great" position="8426,1271" size="100,100">Photos of shoreline damage and flooding</tw-passagedata><tw-passagedata pid="339" name="Watershed connections" tags="Quote Great" position="8553,1271" size="100,100">Snippet text unimplemented</tw-passagedata><tw-passagedata pid="340" name="Wetlands and rainfall" tags="Graph Good" position="8205,1400" size="100,100">Limnology graphs of wetland rainfall.</tw-passagedata><tw-passagedata pid="341" name="Wetlands and flooding" tags="Fact Good" position="8325,1400" size="100,100">Snippet text unimplemented.</tw-passagedata><tw-passagedata pid="342" name="Wetland loss stats" tags="Graph Good" position="7813,1398" size="100,100">Snippet text unimplemented</tw-passagedata><tw-passagedata pid="343" name="Wetlands and flooding background" tags="Fact Great" position="8100,1650" size="100,100">Snippet text unimplemented</tw-passagedata><tw-passagedata pid="344" name="Wetland loss confirmation" tags="Fact Great" position="8100,1750" size="100,100">Snippet text unimplemented.</tw-passagedata><tw-passagedata pid="345" name="Level 3 Intro" tags="" position="9814,686" size="200,100">One week later...

Twin Lakes is still working to recover before more rain hits.

Downtown streets are blocked off with barricades, while people in flood zones frantically sandbag their properties. 

It&#39;s not enough. One rainy day could plunge everything back into chaos.

The mayor has called an emergency Town Meeting. Judging by the excitement in the air, this is sort of a big deal. 

You have time to do one thing before the gathering starts.

[[Walk along the river and practice your photography skills. Could come in handy later.]]
[[Stop at Sophia&#39;s for coffee and a healthy breakfast]]</tw-passagedata><tw-passagedata pid="346" name="New development" tags="Quote Good" position="9475,1225" size="100,100">Snippet text unimplemented.</tw-passagedata><tw-passagedata pid="347" name="Empty land" tags="Quote Good" position="9475,1350" size="100,100">Snippet text unimplemented.</tw-passagedata><tw-passagedata pid="348" name="Business wetlands counterpoint" tags="Quote Good" position="9203,1100" size="100,100">Double-click this passage to edit it.</tw-passagedata><tw-passagedata pid="349" name="Annoyed business" tags="Quote Good" position="8798,1488" size="100,100">Snippet text unimplemented.</tw-passagedata><tw-passagedata pid="350" name="Personal mayor quote" tags="Quote Great" position="5125,50" size="100,100">Snippet text unimplemented.</tw-passagedata><tw-passagedata pid="351" name="Damage quote" tags="Quote Bad" position="5375,50" size="100,100">Snippet text unimplemented</tw-passagedata><tw-passagedata pid="352" name="Downtown recovery" tags="Photo Good" position="6375,725" size="100,100">Snippet text unimplemented.</tw-passagedata><tw-passagedata pid="353" name="Inspiring downtown recovery" tags="Photo Great" position="6275,725" size="100,100">Snippet text unimplemented.</tw-passagedata><tw-passagedata pid="354" name="Blurry downtown recovery" tags="Photo Bad" position="6475,725" size="100,100">Snippet text unimplemented.</tw-passagedata><tw-passagedata pid="355" name="Start compiling anyway." tags="" position="8700,1175" size="100,100">{(set: $storyType to &quot;Investigation&quot;)
(set: $snippetLimit to 6)
(set: $destination to &quot;TO BE CONTINUED&quot;)
(display: &quot;STORY EVALUATION&quot;)}</tw-passagedata><tw-passagedata pid="356" name="Town Meeting" tags="" position="10478,650" size="100,100">The town hall is buzzing with activity. You notice some familiar faces--your neighbors, the gallery owner, the limnology expert, the mayor&#39;s sister. And good old Fred Finkler, of course.

Thankfully, your editor has saved you a seat.

&quot;This is crazy,&quot; you say. &quot;The whole town must be here!&quot; 

&quot;Not the //whole// town,&quot; your editor says. &quot;Make sure you&#39;re paying attention. Who&#39;s missing? What stories aren&#39;t being told?&quot;

You&#39;re about to ask her what she means, but then the mayor calls the meeting to order. 

[[Take notes on meeting]]</tw-passagedata><tw-passagedata pid="357" name="Choose Assignment" tags="" position="10701,665" size="100,100">After the meeting, your editor pulls you aside.

&quot;There&#39;s a lot to cover here, Rookie.&quot; she says. &quot;I need you to choose an issue from the meeting and do a deep dive. Focus on what people need and where they&#39;re clashing.&quot;

You&#39;ll need:
* In-depth background on the situation
* Different perspectives from experts and ordinary townspeople
* Quotes and photos for color

Time to get to work. Which issue do you think Twin Lakes needs to know about?

[[Look into internet issues in rural areas.]]
[[Report on the controversy over lake levels.]]
[[Do some digging on Fred Finkler&#39;s impressive gardening skills.]]</tw-passagedata><tw-passagedata pid="358" name="Walk along the river and practice your photography skills. Could come in handy later." tags="" position="10091,768" size="100,100">The soccer fields and playgrounds of Black Cherry Park are completely swamped.

An otter is paddling through what was once the jungle gym, and the top of a park bench is sticking out from the water. 

You snap some photos with your new zoom lens, practicing with different exposures. 
//Get great photo of flooded park//
($changeStat:$techieName,1)

The houseboat lady waves from her floating home.

&quot;Yoohooo!! Nice article. My cats and I loved it! Though it could&#39;ve used more info about houseboats. Stop by any time. I&#39;ll give you all the details!&quot;

[[Talk to her about the flood.]]
[[Invite her to the town meeting.]]
[[Make an excuse and run for it.]]
</tw-passagedata><tw-passagedata pid="359" name="Stop at Sophia&#39;s for coffee and a healthy breakfast" tags="" position="10080,550" size="100,100">You stop by Sophia&#39;s bakery, which is mostly repaired and lined with sandbags. 

Sophia serves up your eggs and toast with cherry rhubarb jam.

($changeStat:$enduranceName,1)
($changeStat:$socialName, 1)

&quot;A few jars washed up during the flood,&quot; she says, shrugging. &quot;Figured I shouldn&#39;t let it go to waste. Lovely article, by the way.&quot; 

One of her customers, who is reading your article in the newspaper, looks disgruntled. &quot;You wrote this drivel?&quot; he says. &quot;Those sandbags outside are a real eyesore.&quot;

[[Ask if he&#39;d be willing to give an interview. ]]
[[Ask if he&#39;d rather have his coffee underwater.]]
[[Ignore him and do some research on your phone.]]</tw-passagedata><tw-passagedata pid="360" name="Ask if he&#39;d be willing to give an interview. " tags="" position="10253,455" size="100,100">He mumbles something about smug city folk and goes back to his coffee.

&quot;No, seriously,&quot; you say. &quot;What&#39;s so bad about sandbags?&quot;

He hesitates, and then explains. &quot;I own an inn by the water,&quot; he says. &quot;The sandbags are making people nervous and scaring them away. It&#39;s killing my business! I don&#39;t know how I&#39;m gonna scrape by.&quot; 

[[Ask if he sandbagged his property.]]
[[Invite him to the town meeting.]]</tw-passagedata><tw-passagedata pid="361" name="Ask if he&#39;d rather have his coffee underwater." tags="" position="10261,612" size="100,100">He sputters angrily. Something about I&#39;m-A-Paying-Customer and Are-We-Supposed-to-Live-In-Fear-of-Rain-Now? and Flooding-Is-A-Fact-of-Life. 

This guy might not be too happy with you, but Sophia seems grateful you spoke up. She refills the customer&#39;s coffee.

&quot;Feel free to take your coffee to go, if the sandbags are too much of an eyesore,&quot; she tells him. &quot;There&#39;s some scenic flooding along Black Cherry Park you might enjoy.&quot;

You&#39;re astonished. Seems that Sophia can dish out more than fritatta. 

//+1 Endurance//
//+1 Trust//
//-1 Social Butterfly//

[[Go to the Town Meeting-&gt;Town Meeting]]
</tw-passagedata><tw-passagedata pid="362" name="Look into internet issues in rural areas." tags="" position="10915,1066" size="100,100">You check your notes from the meeting: 
-Not enough broadband towers = awful internet in rural areas 
-Restrictions against building new towers

You look around for the orchardist who brought up the problem, but she must&#39;ve left early.  

The mayor is still up front, wearing a cherry-embroidered hat that looks vaguely familiar. 

Townspeople are hanging out near the doors, chattering over coffee and donuts. 

[[Ask to interview the mayor.]]
[[Talk to some of the townspeople.]]</tw-passagedata><tw-passagedata pid="363" name="Report on the controversy over lake levels." tags="" position="10774,389" size="100,100">You take a minute to look over your notes from the meeting: 
-The county, not Twin Lakes, controls the dam. 
-The mayor is pushing to lower the lakes, to prevent 100-year floods.
-Lakeshore homeowners are upset about how changing the lake levels will affect them. 

The mayor is still up front, answering questions. His cherry-embroidered hat looks vaguely familiar. 

Townspeople are hanging out near the doors, but the group that was arguing about the lake levels has already left.

[[Talk to the mayor about the lake level issue.]]
[[Ask some random townspeople about the lakes.]]</tw-passagedata><tw-passagedata pid="364" name="Drive to farmland outside Twin Lakes" tags="" position="11083,868" size="100,100">As you drive, it starts to rain--only a light drizzle, but still, not a good sign.

Conifer forest and rolling farmland blurs past your window.

When you moved here a few weeks ago, it all looked green and idyllic. Now, the fields are soggy and swamped.

You approach a fork in the road, with a &quot;Cherrific!&quot; sign pointing east and a &quot;U-Pick Blueberries&quot; sign pointing west. 

[[Head east, toward the cherry orchard-&gt;Head east, toward the cherry orchard]]
[[Head west for U-pick blueberries]]</tw-passagedata><tw-passagedata pid="365" name="Talk to the mayor about the lake level issue." tags="" position="10777,126" size="100,100">&quot;Excuse me,&quot; you say. &quot;Mayor Zingerman?&quot;

You hold up your press badge. It&#39;s water damaged, but your blurry face and blurry name should be good enough.

&quot;You must be our new reporter!&quot; the mayor says. &quot;I hope our little town doesn&#39;t seem too boring after New York City.&quot;

&quot;Oh, uh...&quot; You fumble a little. &quot;Not at all!&quot; The truth is, Twin Lakes hasn&#39;t been boring since it became a flood zone. &quot;Can I ask you a few questions?&quot; 

&quot;Of course,&quot; the mayor says. &quot;How can I help?&quot;

[[&quot;Can you tell me your thoughts about the lake level issue?&quot;-&gt;Mayor Lake Level Interview]]</tw-passagedata><tw-passagedata pid="366" name="Ask to interview the mayor." tags="" position="10913,1272" size="100,100">&quot;Excuse me,&quot; you say. &quot;Mayor Zingerman?&quot;

You hold up your press badge. It&#39;s water damaged, but your blurry face and blurry name should be good enough.

&quot;You must be our new reporter!&quot; the mayor says. &quot;I hope our little town doesn&#39;t seem too boring after New York City.&quot;

&quot;Oh, uh...&quot; You fumble a little. &quot;Not at all!&quot; The truth is, Twin Lakes hasn&#39;t been boring since it became a flood zone. &quot;Can I ask you a few questions?&quot; 

&quot;Of course,&quot; the mayor says. &quot;How can I help?&quot;

[[&quot;Is it true that people out in the country don&#39;t get reliable internet?&quot;]]
[[&quot;What do you know about the broadband tower regulations?&quot;]]

</tw-passagedata><tw-passagedata pid="367" name="Join the Tourism Committee Meeting" tags="" position="12127,1346" size="100,100">You arrive at the crumbling opera house. There&#39;s a sign on the door: Twin Lakes historic site, restored by the Tourism Committee!

[[Go inside-&gt;Go inside the opera house]]</tw-passagedata><tw-passagedata pid="368" name="Level 3, Story 2" tags="" position="14066,751" size="100,100">//Two weeks later...//

You wake up on Monday morning at 7:15 A.M.--only 45 minutes later than planned. 

The lake levels are coming down and some people have started removing the sandbags from their properties, though the mayor warns that one storm could undo all of this progress. 

You&#39;re not too worried. Outside, the sun is shining and Maureen&#39;s chickens are clucking happily. 

You have plans to grab breakfast with Khalisa before work. You have time to do one thing first.

[[Wander through the bookstore under your flat.]]
[[Stop by your upstairs neighbor&#39;s place for tea.]]
[[Go for a run at Cherry Creek Marsh.]]
[[Replenish your bag with food and supplies.]]
[[Get online and fix the latest glitch on the Gazette&#39;s website.]]</tw-passagedata><tw-passagedata pid="369" name="Ask if he sandbagged his property." tags="" position="10168,300" size="100,100">&quot;There&#39;s more rain in the forecast,&quot; you tell him. &quot;Did you put out sandbags at your inn?&quot;

&quot;Well, of course I did. I&#39;m not crazy. I&#39;m just saying, they&#39;re ugly as all get out. And where&#39;s the proof they actually stop floodwater, anyway?&quot;

You could cite your sources at the DNR, but you have a feeling that&#39;s not what he&#39;s looking for right now. 

[[Thank him for talking.]]
[[Invite him to the town meeting.]]</tw-passagedata><tw-passagedata pid="370" name="Invite him to the town meeting." tags="" position="10374,293" size="100,100">&quot;There&#39;s a town meeting this morning,&quot; you tell him. &quot;Maybe you should stop by.&quot;

&quot;Nah. Those meetings don&#39;t do a darn thing. Lots of talk and no action.&quot; He shrugs. &quot;Anyway, I&#39;m sure I&#39;ll read about it in the paper later.&quot; 

($changeStat:$trustName,1)
//Get Quote: The Impact on Tourism//

[[Go to Town Meeting -&gt;Town Meeting]]</tw-passagedata><tw-passagedata pid="371" name="Thank him for talking." tags="" position="10166,171" size="100,100">&quot;Well, thanks for the interview,&quot; you tell him cheerfully, as you finish your last bite of fritatta. &quot;Better go. Got more mindless drivel to write.&quot; 

($changeStat:$trustName,1)

//Get Quote: The Impact on Tourism//

[[Go to town meeting-&gt;Town Meeting]]</tw-passagedata><tw-passagedata pid="372" name="Talk to her about the flood." tags="" position="9929,912" size="100,100">&quot;People are saying this is the worst flood Twin Lakes has ever seen,&quot; you tell her. &quot;What do you think about that?&quot;

The houseboat lady shrugs. &quot;It&#39;s just a drop in the bucket.&quot; 

&quot;What do you mean?&quot;

She shakes her head sadly. &quot;Look at those gray clouds, Dear. This wasn&#39;t the real flood. It was only a practice run.&quot;

Well, on that cheery note...

($changeStat:$socialName,1)

[[Go to Town Meeting-&gt;Town Meeting]]</tw-passagedata><tw-passagedata pid="373" name="Invite her to the town meeting." tags="" position="10076,910" size="100,100">&quot;The mayor&#39;s holding an emergency meeting today,&quot; you tell her. &quot;You should stop by. Tell people your concerns. &quot;

She laughs. &quot;That&#39;s sweet, Dear. But most people don&#39;t want to hear about houseboats until it&#39;s too late. They&#39;re not like you and me. No imagination.&quot;

One of her cats is batting at her dangling Noah&#39;s Ark earring, which you take as a sign to move along.

($changeStat:$socialName,1)

[[Go to Town Meeting-&gt;Town Meeting]]</tw-passagedata><tw-passagedata pid="374" name="Make an excuse and run for it." tags="" position="10222,908" size="100,100">You don&#39;t have the energy for houseboat-stay-afloat speeches today. You haven&#39;t even had coffee yet. 

&quot;Gotta go,&quot; you say, &quot;um, chickens on the loose!&quot;

&quot;Again?&quot; she says, frowning. &quot;I know Leslie&#39;s quartet of quails is still missing, but I thought all the chickens had been rounded up!&quot; 

You can only look at her, baffled. What is it with this town and their chickens? Is there some kind of fowl-themed secret society you don&#39;t know about? 

[[Go to town meeting-&gt;Town Meeting]]



</tw-passagedata><tw-passagedata pid="375" name="Take notes on meeting" tags="" position="10478,783" size="100,100">The mayor stands up front, wearing a cherry-embroidered hat that looks vaguely familiar.

He explains that the dam is at capacity, with water lapping over the top. The county is slowly letting out water, which will cause more flooding, because the alternative would be letting the dam burst--a far greater disaster.

&quot;I know everybody wants this to be over,&quot; he says. &quot;But until we get the lakes back down, Twin Lakes will be on high alert. There is a chance that whole neighborhoods will need to be evacuated.&quot;

He talks about the importance of sandbagging, checking flood maps, and 

Then he opens the floor for questions.

[[Q and A Session]]</tw-passagedata><tw-passagedata pid="376" name="Do some digging on Fred Finkler&#39;s impressive gardening skills." tags="" position="10702,841" size="100,100">Ha. Good one. But seriously, what are you going to write about? 

[[Choose Assignment]]</tw-passagedata><tw-passagedata pid="377" name="Talk to some of the townspeople." tags="" position="10375,1258" size="100,100">A few of the townspeople are still hanging around, chattering over coffee and donuts.

[[Talk to Maureen, your chicken-loving neighbor.]]
[[Talk to Fred and hope you can steer the conversation away from gardening.]]
[[Talk to a man in a Twin Lakes High School T-shirt.]]</tw-passagedata><tw-passagedata pid="378" name="&quot;Is it true that people out in the country don&#39;t get reliable internet?&quot;" tags="" position="10757,1443" size="100,100">&quot;I&#39;m afraid so,&quot; he says. &quot;We get complaints from high school teachers and parents sometimes. Kids who bus in from rural areas can&#39;t access online assignments.&quot;

[[&quot;It&#39;s the 21st century. Why hasn&#39;t Twin Lakes done anything to fix this?&quot;]]
[[&quot;Do you know why the county voted against new broadband towers?&quot;]]</tw-passagedata><tw-passagedata pid="379" name="&quot;What do you know about the broadband tower regulations?&quot;" tags="" position="11078,1445" size="100,100">&quot;Basically, the county makes it so expensive to build broadband towers out in rural areas that nobody wants to do it,&quot; he says. &quot;Harry from over at McCloud Broadband has been complaining about it for years.&quot;

[[&quot;How does Twin Lakes keep people in rural areas informed during flood disasters?&quot;]]
[[&quot;What would it take to get some broadband towers built?&quot;]]</tw-passagedata><tw-passagedata pid="380" name="&quot;It&#39;s the 21st century. Why hasn&#39;t Twin Lakes done anything to fix this?&quot;" tags="" position="10670,1617" size="100,100">(if: $trust &lt;5)[The mayor looks a little miffed. You must not have sounded as friendly as the typical Twin Lakes-ian.

&quot;Rural areas are outside our jurisdiction,&quot; he says &quot;You&#39;ll need to take it up with the county. Now if you&#39;ll excuse me, I&#39;ve got a lot of work to do.&quot;

//-1 Trust//

[[Talk to some of the townspeople.]]]
(if: $trust &gt;=5)[It might not have been the friendliest question, but the mayor seems to trust you enough answer it.

&quot;I agree with you, &quot; he says. &quot;It&#39;s maddening. But rural areas are outside of Twin Lakes&#39;s jurisdiction. The county would need to change their regulations.&quot;

(if: $bookworm &gt;5)[Thanks to all the reading you&#39;ve been doing lately, you know all about the regulations: fees, permits, and paperwork.

[[&quot;What do you think it would take to get new towers built?&quot;]]](if: $bookworm &lt;5)[You wish you&#39;d read up more on the local ordinances, but you were too busy NOT dying of boredom. 

[[&quot;Can you tell me more about the tower regulations?&quot;]]]]




&quot;</tw-passagedata><tw-passagedata pid="381" name="&quot;Do you know why the county voted against new broadband towers?&quot;" tags="" position="10819,1619" size="100,100">&quot;I think it had something to do with the Tourism Committee,&quot; he said. &quot;People didn&#39;t want the scenic views spoiled.&quot;

[[&quot;Can you help me track down the Tourism Committee?&quot;]]
[[&quot;Do you know the name of the orchardist who brought up the internet issue?&quot;]]</tw-passagedata><tw-passagedata pid="382" name="&quot;How does Twin Lakes keep people in rural areas informed during flood disasters?&quot;" tags="" position="11085,1607" size="100,100">&quot;Well...&quot; He looks awkward, and not just because of the cherry-themed hat. &quot;Unfortunately, the most useful updates are all online. But Emergency Services is working on setting up text alerts! Of course, people need to sign up online for those...&quot;  

[[&quot;Do you know the name of the orchardist who brought up the internet issue?&quot;]]
[[&quot;Can you help me track down the Tourism Committee?&quot;]]</tw-passagedata><tw-passagedata pid="383" name="&quot;Can you help me track down the Tourism Committee?&quot;" tags="" position="10899,1865" size="100,100">&quot;Sure thing,&quot; he says. &quot;The Tourism Committee meets on Crumble Street, in the old opera house. If you hurry, you might still catch them.&quot; 

[[Thank him for his help.-&gt;Internet Issues: Step Two]]</tw-passagedata><tw-passagedata pid="384" name="Talk to Maureen, your chicken-loving neighbor." tags="" position="9851,1412" size="100,100">You ask Maureen about the broadband issues, but she doesn&#39;t seem to be in the mood to chat. 

&quot;Sorry, Dear, I&#39;ve gotta run,&quot; she says. &quot;Need to find a new book for my Feel-Good Book Club! Speaking of which... have you heard of Animal Farm? Sounds like a fun read. Talking chickens and everything!&quot; 

(if: $bookworm &gt;4)[As an avid reader, you can tell her that Animal Farm isn&#39;t exactly a &quot;Feel Good&quot; book. 

You recommend a few talking animals stories that don&#39;t include slaiughterhouses or anti-utopian allegories. Maureen seems grateful.

&quot;Thank you, Dear. I suppose I could do a quick interview, while I&#39;m here.&quot;

[[Ask her what she thinks about building new broadband towers.]]](if: $bookworm &lt;4)[&quot;That sounds great,&quot; you say, not really paying attention. Children&#39;s books aren&#39;t really your thing. &quot;If I could just ask you a few questions--&quot;

&quot;I really am sorry, Dear, but I don&#39;t know much about the issue, anyway,&quot; she says. &quot;See you around the neighborhood!&quot;

[[Talk to Fred and hope you can steer the conversation away from gardening.]]
[[Talk to a man in a Twin Lakes High School T-shirt.]]
[[Try to catch the mayor before he leaves.-&gt;Ask to interview the mayor.]]]
 
</tw-passagedata><tw-passagedata pid="385" name="Talk to Fred and hope you can steer the conversation away from gardening." tags="" position="10173,1399" size="100,100">Fred, as always, is delighted to see you.

&quot;I&#39;ve got your next story idea!&quot; he says. &quot;Did you know that deer sightings are up nearly 3% compared to last year? I saw a doe and two fawns eating my marigolds last night. Bit their petals clean off. It was a bloodbath!&quot;

[[&quot;I&#39;m so sorry to hear that, Fred. But if we could just talk about something else for a minute...&quot;]]
[[&quot;A...bloodbath? Of flowers? How does that work?&quot;]]

</tw-passagedata><tw-passagedata pid="386" name="Talk to a man in a Twin Lakes High School T-shirt." tags="" position="10433,1401" size="100,100">(if: $social &lt;5)[The man seems grumpy when he finds out who you are.

&quot;I teach journalism at the high school,&quot; he says. &quot;The paper shoulda hired somebody who grew up here. Somebody who cares about Twin Lakes.&quot;

You try to convince him that you do care. At least, you&#39;re starting to. You almost got washed away in a flood for this town! He shakes his head.

&quot;Sorry, kid. I&#39;m saving all my exclusive content for the high school paper.&quot;

Welllll, that could&#39;ve gone better.

[[Talk to Maureen, your chicken-loving neighbor.]]
[[Talk to Fred and hope you can steer the conversation away from gardening.]]
[[Try to catch the mayor before he leaves.-&gt;Ask to interview the mayor.]]]
(if: $social &gt;=5)[The man seems happy to see you.

&quot;You&#39;re that new reporter!&quot; he says. &quot;I&#39;ve heard you&#39;ve been helping out your neighbors. Gettin&#39; to know everybody. I&#39;m glad they found somebody like you.&quot;

&quot;Uh, thanks!&quot; He&#39;s a complete stranger, but somehow the external validation makes you feel like you just won the Twin Lakes local lottery jackpot. Which, admittedly, is only $279.  

&quot;I&#39;m Joe McCloud,&quot; he says. &quot;I teach journalism at the school. We&#39;d love to have you come in and talk to our class.&quot;

&quot;I&#39;d love to,&quot; you say. &quot;But for now I need to look into the internet issues.&quot;

&quot;Oh, I can tell you all about that! My brother runs McCloud Broadband. I&#39;m heading to his place for lunch, if you want to meet me there.&quot;

[[&quot;Sure! Sounds great.&quot;-&gt;Lunch with Broadband Company Owner]]
[[&quot;No thanks. I think I&#39;ll stick around the meeting.&quot;]]]
</tw-passagedata><tw-passagedata pid="387" name="Lunch with Broadband Company Owner" tags="" position="11533,1758" size="100,100">You meet Joe at a red-brick house, right on the edge of town.

Joe&#39;s brother, Bo McCloud, is grilling cherry-glazed chicken and sweet corn when you arrive. He seems thrilled that you want to talk with him. 

&quot;I&#39;ve been telling people that they need to ease up on those garbage restrictions for years!&quot; Bo says. &quot;Come on, have a seat. You&#39;re from the city, right? I bet you&#39;ve never had a decent ear of corn in your life!&quot;

[[Sit down for some lunch]]
[[Tell him you&#39;re not hungry--you&#39;d rather just talk.]]</tw-passagedata><tw-passagedata pid="388" name="&quot;No thanks. I think I&#39;ll stick around the meeting.&quot;" tags="" position="10435,1544" size="100,100">&quot;If you&#39;re sure,&quot; he says. &quot;Here&#39;s my brother&#39;s phone number, if you want to call him later for a quick interview.&quot;

//Get broadband company phone number//

&quot;Thanks,&quot; you say. &quot;Nice to meet you, John.&quot;

[[Talk to Maureen, your chicken-loving neighbor.]]
[[Talk to Fred and hope you can steer the conversation away from gardening.]]</tw-passagedata><tw-passagedata pid="389" name="Ignore him and do some research on your phone." tags="" position="10409,487" size="100,100">You&#39;re not going to let him bother you. Well, not much. 

You pull up the Twin Lakes city ordinances--a daunting 52 page document--and start reading. Zoning laws, broadband towers, a bunch of confusing stuff about the legal requirements for lemonade stands...  

&quot;Typical,&quot; the disgruntled customer mutters. &quot;Young people, always glued to Squawker. You could try reading a book, for a change.&quot;

($changeStat:$bookwormName,1)

[[Go to Town Meeting-&gt;Town Meeting]]</tw-passagedata><tw-passagedata pid="390" name="&quot;Do you know the name of the orchardist who brought up the internet issue?&quot;" tags="" position="11065,1863" size="100,100">&quot;That was Cora Pitt,&quot; he says. &quot;She lives at a farmhouse a few miles outside town. Just head down Highway 6 and look for her giant &quot;Cherrific&quot; sign! You can&#39;t miss it.&quot;

[[Thank him for his help.-&gt;Internet Issues: Step Two]]</tw-passagedata><tw-passagedata pid="391" name="Ask her what she thinks about building new broadband towers." tags="" position="9844,1539" size="100,100">&quot;I don&#39;t know,&quot; she says. &quot;It doesn&#39;t really affect me. But I&#39;ve heard they can be dangerous, right? And not very pretty to look at, either.&quot;

[[&quot;Dangerous how?&quot;]]
[[&quot;What about people who need Internet access?&quot;]]</tw-passagedata><tw-passagedata pid="392" name="&quot;Dangerous how?&quot;" tags="" position="9777,1685" size="100,100">&quot;They could fall over during a storm and smash somebody&#39;s house to smithereens!&quot; she says. &quot;Not to mention ruining the gorgeous scenery out there. At least, that&#39;s what the Tourism Committee said.&quot;

[[&quot;Do you know how I can contact the Tourism Committee?&quot;]]</tw-passagedata><tw-passagedata pid="393" name="&quot;What about people who need Internet access?&quot;" tags="" position="9907,1686" size="100,100">&quot;Well, I&#39;m sure the Internet can&#39;t be THAT bad out there,&quot; she says. &quot;If it was really awful, somebody would&#39;ve done something about it, don&#39;t you think?&quot;

&quot;Well, it sounds like people ARE trying to do something about it,&quot; you say, but Maureen is buttoning up her cardigan. 

&quot;I really better go, Dear. One more question, I suppose.&quot; 

[[&quot;Do you know how I can contact the Tourism Committee?&quot;]]</tw-passagedata><tw-passagedata pid="394" name="&quot;Do you know how I can contact the Tourism Committee?&quot;" tags="" position="9837,1828" size="100,100">&quot;They&#39;re based in the old opera house downtown,&quot; she says. &quot;You could see if they&#39;re around. They&#39;re always busy this time of year. But now I really better run, Dear. Good luck with your article!&quot; 

[[Thank Maureen for her time.-&gt;Internet Issues: Step Two]]</tw-passagedata><tw-passagedata pid="395" name="Internet Issues: Step Two" tags="" position="11312,1397" size="100,100">Ok, you&#39;ve got some of the basics. Now what? 

[[Head to farmland outside Twin Lakes and look for locals to interview-&gt;Drive to farmland outside Twin Lakes]]
[[Head to Cora Pitt&#39;s cherry orchard]]
[[Join the Tourism Committee Meeting]]
[[Call owner of broadband company]]</tw-passagedata><tw-passagedata pid="396" name="&quot;What do you think it would take to get new towers built?&quot;" tags="" position="10535,1862" size="100,100">&quot;Hmmm.&quot; He looks thoughtful. &quot;I think I spotted John McCloud over there. Twin Lakes High School T-shirt. His brother runs Cloudy Day Broadband. If you hurry, you might be able to catch him!&quot;

You choose to believe that the mayor is telling the truth, and not that he&#39;s trying to get rid of you. 

[[Head over to the dwindling group of townspeople near the door.-&gt;Talk to some of the townspeople.]]</tw-passagedata><tw-passagedata pid="397" name="&quot;Can you tell me more about the tower regulations?&quot;" tags="" position="10697,1858" size="100,100">The mayor frowns. &quot;I&#39;m not really the person to talk to about that. You should track down the Tourism Committee, or maybe somebody at McCloud Broadband.&quot; 

You want to ask another question, but the mayor checks his watch. &quot;Oh dear, look at the time! I&#39;ve got an appointment across town. Nice chatting with you.&quot;

[[Talk to some of the townspeople--they might have the inside scoop.-&gt;Talk to some of the townspeople.]]
[[Leave the meeting--you don&#39;t want to waste too much time.-&gt;Internet Issues: Step Two]]</tw-passagedata><tw-passagedata pid="398" name="&quot;A...bloodbath? Of flowers? How does that work?&quot;" tags="" position="10249,1561" size="100,100">Fred frowns. &quot;Well... okay, not a //blood//bath, I suppose. A chlorophyl bath? I&#39;ll have to Google it.&quot;

You seize the opportunity. &quot;Good plan,&quot; you agree. &quot;We&#39;re lucky to have reliable internet here in town. Did you know that some people out in the country don&#39;t have any broadband coverage?&quot;

Fred nods grimly. &quot;It&#39;s awful,&quot; he says. &quot;How do they order specialty fertilizer, or research ideal topsoil conditions?&quot;

[[Ask him what he thinks about the broadband tower regulations.]]</tw-passagedata><tw-passagedata pid="399" name="&quot;I&#39;m so sorry to hear that, Fred. But if we could just talk about something else for a minute...&quot;" tags="" position="10109,1565" size="100,100">&quot;Ah, yes! My prize-winning zinnias!&quot; He grins. &quot;//Thistle// be the best story you&#39;ll hear all day. I thought they were goners, but they //rose// to the occasion. I couldn&#39;t be-//leaf// my eyes!&quot;

Welp.... that&#39;s just about all the gardening puns you can handle within a ten-second window. This interview is over. Better luck next thyme. 

[[Talk to Maureen, your chicken-loving neighbor.]]
[[Talk to a man in a Twin Lakes High School T-shirt.]]
[[See if the mayor is still available to talk.-&gt;Ask to interview the mayor.]]</tw-passagedata><tw-passagedata pid="400" name="Ask him what he thinks about the broadband tower regulations." tags="" position="10189,1700" size="100,100">&quot;The regulations are absolute nonsense,&quot; he says. &quot;High-quality internet is a matter of public safety. How are people supposed to check the flood maps, or find out where to get sandbags, or know the storm is coming at all?&quot;

You stare at him. Can&#39;t help it. You had no idea he could speak so eloquently--especially about something other than horticulture. 

[[&quot;Why do you think some people support the regulations?&quot;]]
[[&quot;Do you think Twin Lakes should help pay for new broadband towers?&quot;]]</tw-passagedata><tw-passagedata pid="401" name="&quot;Why do you think some people support the regulations?&quot;" tags="" position="10102,1858" size="100,100">&quot;I&#39;m not sure,&quot; he says, &quot;but I suppose it must be some kind of misunderstanding. People act like there&#39;d be towers sprouting up every five feet. If you ask me, they need to get //clover// it and do what&#39;s best for the people who actually live out there.&quot;

Who would&#39;ve thought Fred Finkler would give you some killer quotes? (Though, to be fair, the puns might be a little distracting...)

[[Talk to someone else-&gt;Talk to some of the townspeople.]]
[[Head out from the meeting. You&#39;ve spent enough time here.-&gt;Internet Issues: Step Two]]</tw-passagedata><tw-passagedata pid="402" name="&quot;Do you think Twin Lakes should help pay for new broadband towers?&quot;" tags="" position="10262,1858" size="100,100">&quot;Seems like a mighty fine idea to me,&quot; Fred says. &quot;Spending a little money now would help prevent a ton of damage later. You know what they say. A peony saved is a peony earned.&quot;

That&#39;s... not exactly the saying, but beggars can&#39;t be choosers. 

[[Talk to someone else-&gt;Talk to some of the townspeople.]]
[[Head out from the meeting. You&#39;ve spent enough time here.-&gt;Internet Issues: Step Two]]</tw-passagedata><tw-passagedata pid="403" name="&quot;What would it take to get some broadband towers built?&quot;" tags="" position="11233,1603" size="100,100">&quot;The county would need to vote to get rid of those old regulations,&quot; the mayor says. &quot;I guess that means you&#39;d need to convince them that a few more broadband towers aren&#39;t the end of the world.&quot; 

&quot;That doesn&#39;t sound too hard,&quot; you say hopefully. 

He chuckles. &quot;Good luck, kid. I&#39;ve been tellin&#39; them to lower those lake levels for years. They don&#39;t even invite me to the Fourth of July barbecue anymore.&quot;

[[&quot;Can you help me track down the Tourism Committee?&quot;]]
[[&quot;Do you know the name of the orchardist who brought up the internet issue?&quot;]]</tw-passagedata><tw-passagedata pid="404" name="Head east, toward the cherry orchard" tags="" position="11269,649" size="100,100">The rain is getting heavier, huge raindrops pounding on your windshield.

You pull over for a few seconds to check the local flood map. Everything looks fine, so you keep driving.

Unfortunately, what you&#39;re seeing doesn&#39;t match what your phone told you. The country road is starting to pool with water. 

Then--just in time--you see the entrance to the orchard!

[[Pull into the parking lot, ASAP!]]</tw-passagedata><tw-passagedata pid="405" name="Head west for U-pick blueberries" tags="" position="11281,1004" size="100,100">You notice an overgrown sunflower field to your right.

There&#39;s a wooden sign with flaking paint: The World&#39;s Largest Sunflower Maze!

As you drive, the rain gets heavier. Water is starting to pool up on the road. 

[[Pull over and check the flood map on your phone.]]
[[Turn on the weather forecast while you drive.]]</tw-passagedata><tw-passagedata pid="406" name="Head to Cora Pitt&#39;s cherry orchard" tags="" position="11074,653" size="100,100">You head out to the countryside, where conifer forests are interspersed with farmland. 

As you drive, raindrops start to patter against the windshield. 

You notice a cherry-themed sign pointing east. You must be heading in the right direction!

[[Head east, toward the cherry orchard]]</tw-passagedata><tw-passagedata pid="407" name="Pull over and check the flood map on your phone." tags="" position="11438,1058" size="100,100">According to the map, everything around you is safe and not at risk of flooding.

So apparently the water rising all around you is nothing to worry about.

You open the car door, assessing the situation. The water only comes up to your ankles, but you&#39;re not sure driving through it is such a good idea.

[[Try to call someone for help.]]
[[Take photos of the washed out road.]]
[[Walk to the nearest farmhouse to wait out the storm.]]</tw-passagedata><tw-passagedata pid="408" name="Turn on the weather forecast while you drive." tags="" position="11435,927" size="100,100">You turn on the radio, windshield wipers at full blast. 

&quot;Thankfully, the rain seems to be hitting rural areas just north of town,&quot; the forecaster says. &quot;Twin Lakes can breathe a sigh of relief, for now.&quot;

Welp. Not super comforting for people who are currently north of town. Like you, for example.

As you drive, water rises fast around you. You&#39;re now plowing through a foot of water! 

[[Pull into a farmhouse driveway to wait out the rain.]]
[[Keep driving and hope for the best.]]</tw-passagedata><tw-passagedata pid="409" name="Take photos of the washed out road." tags="" position="11373,1204" size="100,100">Double-click this passage to edit it.</tw-passagedata><tw-passagedata pid="410" name="Pull into a farmhouse driveway to wait out the rain." tags="" position="11676,941" size="100,100">You were planning to wait in the driveway, but as soon as step out of your car, an elderly farmer in a plaid shirt comes walking up the driveway. 

&quot;I saw what happened!&quot; he says. &quot;What are you doing out in this weather, anyway? Don&#39;t you know there are flash flood warnings? It was in the paper and everything!&quot;

[[&quot;I&#39;m a reporter with the Twin Lakes Gazette. I&#39;m out here covering the broadband tower restrictions.&quot;]]</tw-passagedata><tw-passagedata pid="411" name="Go inside the opera house" tags="" position="12279,1340" size="100,100">The interior looks sort of like a dollhouse: blue wallpaper patterned with gold diamonds, frilly pink curtains, and ornate ceilings. Plus rows and rows of tiny chairs. 

A small group of people is sitting on the stage, putting what looks like birdseed and dried fruit in paper bags.  

The leader of the group, a man in a bird-patterned shirt and glasses, looks excited when he sees you. &quot;Ooh, you&#39;re the new reporter! Are you here to interview us about our latest initiative? I suppose word travels fast!&quot;

[[Ask if you can interview him about the broadband restrictions.]]
[[Offer to help with... whatever it is they&#39;re doing.]]</tw-passagedata><tw-passagedata pid="412" name="Offer to help with... whatever it is they&#39;re doing." tags="" position="12499,1279" size="100,100">The man beams at you.

&quot;That would be lovely! We could always use an extra set of hands.&quot;

[[&quot;So... what are you doing, exactly?&quot;]]</tw-passagedata><tw-passagedata pid="413" name="Ask if you can interview him about the broadband restrictions." tags="" position="12509,1457" size="100,100">(if: $trust&lt;5)[Immediately, he looks disappointed.

&quot;I&#39;m sorry, but I don&#39;t know if I can trust you. I don&#39;t want to end up looking like the bad guy, just because I care about this town.&quot;

[[&quot;I care about this town, too. I&#39;d like to get your side of the story.&quot;]]
[[&quot;What if I help out while we talk?&quot;-&gt;Offer to help with... whatever it is they&#39;re doing.]]]</tw-passagedata><tw-passagedata pid="414" name="&quot;So... what are you doing, exactly?&quot;" tags="" position="12656,1277" size="100,100">&quot;It&#39;s our latest project,&quot; he says. &quot;A little something for the tourists, since the cherry festival got canceled.&quot;

&quot;Bags of birdseed?&quot;

&quot;And trail mix,&quot; he says cheerfully. &quot;Feed the ducks, and yourself! The pink bags have food for the sparrows and the ducks, and the blue bags have snacks for visitors.&quot; He frowns slightly. &quot;Hmmm. Or was it the other way around...?&quot;

[[&quot;While I&#39;m here, can I ask you about the broadband restrictions?&quot;]]</tw-passagedata><tw-passagedata pid="415" name="&quot;I care about this town, too. I&#39;d like to get your side of the story.&quot;" tags="" position="12664,1459" size="100,100">He hesitates. &quot;Will you promise not to quote me?&quot;

[[&quot;Of course. I won&#39;t quote you or print your name without permission.&quot;]]</tw-passagedata><tw-passagedata pid="416" name="&quot;While I&#39;m here, can I ask you about the broadband restrictions?&quot;" tags="" position="12808,1277" size="100,100">&quot;Sure!&quot; he says cheerfully, handing you a sack of birdseed. &quot;What do you want to know?&quot;

[[&quot;I heard the Tourism Committee pushed for more restrictions. Can you tell me why?&quot;]]</tw-passagedata><tw-passagedata pid="417" name="&quot;I heard the Tourism Committee pushed for more restrictions. Can you tell me why?&quot;" tags="" position="12956,1282" size="100,100">&quot;Well, it&#39;s pretty simple,&quot; she says. &quot;About five years ago, they built a tower right down the road from the famous sunflower maze. It used to bring people from all over!&quot;

[[&quot;What&#39;s a sunflower maze?&quot;]]</tw-passagedata><tw-passagedata pid="418" name="&quot;What&#39;s a sunflower maze?&quot;" tags="" position="13094,1275" size="100,100">He chuckles. &quot;It&#39;s exactly what it sounds like! People used to come from all over to explore and take photos. Now it&#39;s hard to get a single picture without that awful tower in the background. The maze closed down last year, though some of the flowers are still growing out there.&quot;

[[&quot;Did you know that some people outside of town can&#39;t get internet access?]]
[[&quot;How do you know the tower is what caused the maze to shut down?&quot;]]</tw-passagedata><tw-passagedata pid="419" name="&quot;Did you know that some people outside of town can&#39;t get internet access?" tags="" position="13260,1214" size="100,100">She frowns. &quot;Well, IF that&#39;s true, I&#39;m sorry to hear it. But we&#39;re not against all broadband towers. We just want to stop the county from being able to build them wherever they want!&quot;

[[&quot;Do you have any statistics on tourism in Twin Lakes?&quot;]]</tw-passagedata><tw-passagedata pid="420" name="&quot;How do you know the tower is what caused the maze to shut down?&quot;" tags="" position="13261,1354" size="100,100">&quot;Well, what else would it be?&quot; he says. &quot;The sunflowers were thriving! There was food and live music every weekend! Then that tower went up.&quot;

[[&quot;Do you have any statistics on tourism in Twin Lakes?&quot;]]</tw-passagedata><tw-passagedata pid="421" name="&quot;Do you have any statistics on tourism in Twin Lakes?&quot;" tags="" position="13399,1285" size="100,100">You expect her to pull something up on her phone, but instead she digs into her purse and pulls out a folded up newspaper clipping. 

Looks like it ran in the Twin Lakes Gazette 5 years ago, written by Jenkins Something-or-Other. 

&quot;Have a look,&quot; she says. &quot;For farmers and small business owners in TWin Lakes, 40% of their yearly income comes during the summer tourist season. Our beautiful scenery and orchards bring tons of people out here.&quot;
</tw-passagedata><tw-passagedata pid="422" name="&quot;Of course. I won&#39;t quote you or print your name without permission.&quot;" tags="" position="12818,1460" size="100,100">&quot;Well,&quot; he says, &quot;the restrictions might not be perfect, but it&#39;s better than letting huge broadband towers ruin the scenery. We have such lovely forests and farmlands! It helps bring tourists from all over.&quot;

[[&quot;Do you have any statistics on the impact of tourist season?&quot;]]
</tw-passagedata><tw-passagedata pid="423" name="&quot;Do you have any statistics on the impact of tourist season?&quot;" tags="" position="12964,1457" size="100,100">&quot;I certainly do,&quot; she says.

She opens her pusre and pulls out an actual newspaper clipping, the first time you&#39;ve seen one of those since.... ever. 

Looks like the article was written by somebody named Jenkins, 5 years ago.

&quot;Look here,&quot; she says. &quot;Farmers and small business owners make 40% of their yearly income during tourist season! Those ugly towers, and now all this flooding... if not for all our hard work, I&#39;m afraid the town wouldn&#39;t pull through.&quot;

You&#39;ve got some decent background info now. If only you coudl quote her...

//Get decent quote about broadband towers and tourism//
//Get tourism statistics//

[[Ask one more time if it would be okay to quote him.]]
[[Thank him for him time and promise that you won&#39;t mention him by name.]]
</tw-passagedata><tw-passagedata pid="424" name="Ask one more time if it would be okay to quote him." tags="" position="13109,1455" size="100,100">The man shakes his head. &quot;Shameful. I knew you were just in to make me look bad.&quot;

Another person in the group looks awkward. &quot;Gary, I&#39;m sure she didn&#39; tmean to--&quot;

&quot;Shhh!&quot; the man hisses. &quot;Code names only. I should&#39;ve known better than to trust a reporter.&quot;

Yikes. That escalted quickly. </tw-passagedata><tw-passagedata pid="425" name="Thank him for him time and promise that you won&#39;t mention him by name." tags="" position="13109,1587" size="100,100">&quot;Thanks,&quot; he says warmly. &quot;Maybe I misjudged you. Here, take one of these birdseed bags to go. And the trail mix, too. Not sure which one is which, but you&#39;ll figure it out.&quot;

//+1 Trust//
//+1 Resourceful//</tw-passagedata><tw-passagedata pid="426" name="Keep driving and hope for the best." tags="" position="11677,815" size="100,100">Ahead of you, the road curves upward. You can make it, you&#39;re almost on dry land!!

[[Just a few more seconds...]]

</tw-passagedata><tw-passagedata pid="427" name="Try to call someone for help." tags="" position="11530,1207" size="100,100"></tw-passagedata><tw-passagedata pid="428" name="Pull into the parking lot, ASAP!" tags="" position="11424,646" size="100,100">You swerve into the dirt parking lot, which is muddy but not flooded.

You can&#39;t say the same thing about the road, which is covered in water. You&#39;re getting a serious senes of deja vu.

The difference: this time, there was no warning. The flood map said everything was fine. 

Up the hill, you see a red barn with cherry-themed string lights and an orchard stretching as far as you can see.

[[Head inside the barn]]
[[Check out the orchard]]</tw-passagedata><tw-passagedata pid="429" name="Walk to the nearest farmhouse to wait out the storm." tags="" position="11676,1072" size="100,100">(if: $endurance &gt;5)[You wade up the muddy dirt driveway. 

It feels like walking through quicksand. Good thing you&#39;ve been getting more exercise lately, because this is definitely a workout.](else:)[You wade up the muddy dirt driveway. 

You wish you&#39;d had a heartier breakfast today. The mud is thick as cement and your endurance is almost running out.]

As you reach dry ground, an elderly farmer comes running out of the farm house. 

&quot;I saw what happened!&quot; he says. &quot;What are you doing out in this weather, anyway? Don&#39;t you know there are flash flood warnings? It was in the paper and everything!&quot;

[[&quot;I&#39;m a reporter with the Twin Lakes Gazette. I&#39;m out here covering the broadband tower restrictions.&quot;]]</tw-passagedata><tw-passagedata pid="430" name="Just a few more seconds..." tags="" position="11827,816" size="100,100">....Until the flood lifts your tires off the road. Before you know it, you&#39;ve been swept into the sunflower field!

Fortunately, you&#39;re not hurt and the rain is already slowing down. 

Less fortunately: your car is stuck, and you can&#39;t find the road. You try to call for help, but your phone doesn&#39;t have a single bar. 

You choose a path and start walking. Surely you&#39;ll be out of here any minute now. How big can a sunflower maze be, anyway? 

GAME OVER 



</tw-passagedata><tw-passagedata pid="431" name="&quot;I&#39;m a reporter with the Twin Lakes Gazette. I&#39;m out here covering the broadband tower restrictions.&quot;" tags="" position="11824,937" size="100,100">His eyes widen. &quot;You&#39;re the new field reporter? Why didn&#39;t you say so? I&#39;m your biggest fan!&quot; 

[[&quot;....Really?&quot;]]</tw-passagedata><tw-passagedata pid="432" name="&quot;....Really?&quot;" tags="" position="11969,937" size="100,100">&quot;Oh, yah. I&#39;ve loved all your work so far. That story you wrote about the possom family under the school bleachers warmed my heart.&quot; For second, he seems to almost tear up. 

[[&quot;Would you be willing to do an interview?&quot;]]</tw-passagedata><tw-passagedata pid="433" name="&quot;Would you be willing to do an interview?&quot;" tags="" position="12112,936" size="100,100">&quot;Wish I could,&quot; he says. &quot;But I really need to get back to salvaging stuff from my basement. It&#39;s a heck of a job. I&#39;ve been workin&#39; all morning!&quot;

[[Ask if he&#39;d like some help.]]</tw-passagedata><tw-passagedata pid="434" name="Ask if he&#39;d like some help." tags="" position="12279,992" size="100,100">&quot;Well, if you&#39;re sure!&quot; he says. &quot;But it&#39;s a real mess down there.&quot;

[[Follow him inside.]]</tw-passagedata><tw-passagedata pid="435" name="Follow him inside." tags="" position="12432,987" size="100,100">For a second, all you can do is stare. 

His basement is flooded with three feet of water. Lamps and knick knacks are floating around, and the fuse box on the wall is partly submerged.

&quot;Had to turn off the power days ago,&quot; he says, splashing down into the mucky water. &quot;What a mess, huh?&quot;

[[Ask questions while you help clean.]]</tw-passagedata><tw-passagedata pid="436" name="Ask questions while you help clean." tags="" position="12564,987" size="100,100">&quot;Do you have any issues with internet out here?&quot; you ask him, scooping a floating leather boot out of the water.

&quot;Oh, I don&#39;t have internet,&quot; he says. &quot;The coverage is awful, and it costs an arm and a leg.&quot;

A frog hops out of the boot, and you narrowly avoid screaming. &quot;How... how did you find out about the flood emergency?&quot; you ask.

He chuckles, gesturing at the basement around him. &quot;How d&#39;you think? Look around. Didn&#39;t have a clue. Saw the rain, obviously. But then, for pete&#39;s sake.&quot;

[[Ask him to restate what happened, so that you can quote him.]]</tw-passagedata><tw-passagedata pid="437" name="Ask him to restate what happened, so that you can quote him." tags="" position="12722,987" size="100,100">(if: $social &lt;6)[He frowns.  &quot;Well, I just toldja, didn&#39;t I? Did ya forget to write it down?&quot;

&quot;I just...&quot; You stammer a little. &quot;I could use a better quote. For the article.&quot;

&quot;My quote wasn&#39;t good enough?&quot; he says, sounding wounded. &quot;I don&#39;t have time to be repeatin&#39; myself. I&#39;ve got work to do here.&quot;

Looks like you could use some brushing up on your social skills. Offending the source isn&#39;t usually the best idea. Nice try, though.

[[Ask to take photos of the flooded basement.]]](else)[He blinks. &quot;You want me to say it all again?&quot;

&quot;Well, I can write about what I saw here,&quot; you say, &quot;but I&#39;d love to hear how you&#39;d tell the story.&quot;

Nice recovery. He looks cheered. &quot;Well,&quot; he says, &quot;we don&#39;t get internet out there, so I saw the rain but didn&#39;t think it was any big deal. Just another storm. Then I heard a funny sound and came downstairs to check it out. There was water rushin&#39; in at all the windows! Didn&#39;t even know Twin Lakes flooded until the next day, when my paper copy of the Gazette turned up on the doorstep.&quot;

You didn&#39;t even realize that the Gazette still printed paper copies. &quot;That was great,&quot; you tell him. &quot;Thank you!&quot;

[[Ask to take photos of the flooded basement.]]]</tw-passagedata><tw-passagedata pid="438" name="Ask to take photos of the flooded basement." tags="" position="12721,839" size="100,100">&quot;Sure!&quot; he says. &quot;My kids will be tickled if I get my picture in the paper!&quot;

(if: $techie &gt;5)[Considering that you&#39;re in a basement, with the only light coming from the tiny square windows, the photos don&#39;t turn out the best.

You really should brush up on your technique in dim lighting.

Still, badly-lit photos are better than nothing.

//Get decent photos of flooded basement//](else:)[The lighting in the basement is awful.

Luckily, you&#39;ve been practicing your technique in dim lighting.

You get some amazing photos of the farmer, standing in water up above his knees.

//Get amazing photos of flooded basement//]

[[Thank the farmer for his time-&gt;Internet Issues: Step Three]]

</tw-passagedata><tw-passagedata pid="439" name="Internet Issues: Step Three" tags="" position="11453,1400" size="100,100">You&#39;ve still got some time left. What do you do next? 

[[Track down the Twin Lakes Tourism Committee-&gt;Join the Tourism Committee Meeting]]
[[Head to farmland outside Twin Lakes and look for locals to interview-&gt;Drive to farmland outside Twin Lakes]]
[[Call owner of broadband company]]
</tw-passagedata><tw-passagedata pid="440" name="Track down someone from the local broadband company" tags="" position="11700,1464" size="100,100">Double-click this passage to edit it.</tw-passagedata><tw-passagedata pid="441" name="Look up the phone number for the tourism committee" tags="" position="11700,1344" size="100,100">Double-click this passage to edit it.</tw-passagedata><tw-passagedata pid="442" name="Call owner of broadband company" tags="" position="11992,1912" size="100,100">Bo McCloud, the owner of Cloudy Day Broadband, sounds delighted to hear from you.

&quot;I&#39;ve been telling them to get rid of those garbage restrictions for years!&quot; he says. 

[[&quot;What makes the restrictions &#39;garbage?&#39;&quot;-&gt;Phone Interview with Broadband Owner]]</tw-passagedata><tw-passagedata pid="443" name="&quot;What would you say to the people who think broadband towers will ruin the scenery?&quot;" tags="" position="11762,2198" size="100,100">&quot;I&#39;d say the bigger threat to tourism is not having decent internet!&quot; he says. &quot;Who&#39;s gonna want to stay at a hotel without any wifi? Who&#39;s gonna buy a summer home if they&#39;ll have to drive fifteen minutes just to get online?&quot;

&quot;That&#39;s a very good point,&quot; you say, surprised that no one else has mentioned it.

&quot;Darn right it is,&quot; he says, sounding pleased. 

[[Thank him for his time (and take the rest of your cherry soda to go--it&#39;s too good to leave behind.-&gt;Internet Issues: Step Three]]</tw-passagedata><tw-passagedata pid="444" name="&quot;Is it true that broadband towers can be dangerous?&quot;" tags="" position="11601,2194" size="100,100">He looks confused. &quot;Dangerous? Well... I guess if you climb them?&quot;

You feel a little silly for asking, but you press on. &quot;Can they... I don&#39;t know, fall over?&quot;

&quot;I haven&#39;t heard of a single instance that happening in over 20 years in the business,&quot; he says, chuckling. &quot;Though please let me know if it turns out I&#39;m mistaken.&quot;

[[Thank him for his time (and take the rest of your cherry soda to go--it&#39;s too good to leave behind.-&gt;Internet Issues: Step Three]]</tw-passagedata><tw-passagedata pid="445" name="&quot;Why do you think they passed the restrictions at all?&quot;" tags="" position="11438,2042" size="100,100">&quot;A big cell tower went up around that time, and people all got in a tizzy,&quot; he says. &quot;Problem is, they lumped all types of towers together in those restrictions--even the smaller ones we use.&quot;

[[&quot;Can you tell me about the different types of towers?&quot;]]

</tw-passagedata><tw-passagedata pid="446" name="&quot;How do the broadband restrictions affect your company?&quot;" tags="" position="11608,2040" size="100,100">&quot;Well, first of all, the county charges ridiculous fees to build a tower,&quot; he says. &quot;And houses out in the country are so spaced out that I&#39;d hardly get any new customers. I wish I could help out, but I would go bankrupt!&quot; 

[[&quot;What would you say to the people who think broadband towers will ruin the scenery?&quot;]]
[[&quot;Is it true that broadband towers can be dangerous?&quot;]]</tw-passagedata><tw-passagedata pid="447" name="&quot;Can you tell me about the different types of towers?&quot;" tags="" position="11413,2193" size="100,100">&quot;Old-fashioned cellular towers are pretty obstructive, but we use fixed wireless towers,&quot; he says. &quot;Two feet wide, tops. I think people are just being dramatic.&quot;

[[&quot;What would you say to the people who think broadband towers will ruin the scenery?&quot;]]</tw-passagedata><tw-passagedata pid="448" name="Sit down for some lunch" tags="" position="11533,1908" size="100,100">You sit down at the picnic table. There&#39;s plenty of grilled corn and locally made cherry soda. Plus delicious-looking grilled chicken, but you decide to abstain--somehow, you haven&#39;t been in the mood for chicken this week. 

//+1 Endurance//

While you eat, you ask Bo a few questions about the tower restrictions.

[[&quot;Why do you think they passed the restrictions at all?&quot;]]
[[&quot;How do the broadband restrictions affect your company?&quot;]]</tw-passagedata><tw-passagedata pid="449" name="Tell him you&#39;re not hungry--you&#39;d rather just talk." tags="" position="11762,1913" size="100,100">As soon as the words are out of your mouth, the summer day goes from 80 degrees and sunny to cold and frigid within 1.2 seconds.

&quot;Not a problem,&quot; Bo says, his voice making it very clear that you can go right ahead and starve. &quot;It&#39;s not like I&#39;m sensitive about my cooking, or anything. I suppose we could still do a short interview.&quot;

[[&quot;Um, thanks. So what do you think is the problem with the county&#39;s restrictions?&quot;-&gt;Phone Interview with Broadband Owner]]</tw-passagedata><tw-passagedata pid="450" name="Phone Interview with Broadband Owner" tags="" position="11993,2043" size="100,100">Bo tells you the main problem: the restrictions group all towers together, preventing anyone from building anything without excessive fees.

&quot;Cell towers are the huge ones you might be thinking of,&quot; he says. &quot;Those are hard to miss. And pretty ugly, to be honest with ya. We use fixed wireless towers, which are a lot smaller. Only 18 to 24 inches across.&quot;

[[&quot;How do the tower restrictions affect your business?&quot;]]
[[&quot;What would you say to people who think new towers will cause issues for tourism?&quot;]]</tw-passagedata><tw-passagedata pid="451" name="&quot;How do the tower restrictions affect your business?&quot;" tags="" position="11936,2195" size="100,100">&quot;Well, first of all, the county charges ridiculous fees to build a tower,&quot; he says. &quot;And houses out in the country are so spaced out that I&#39;d hardly get any new customers. It&#39;s not worth the cost.&quot; 



&quot;I gotta run for now, but it was nice chattin&#39; with ya!&quot; </tw-passagedata><tw-passagedata pid="452" name="&quot;What would you say to people who think new towers will cause issues for tourism?&quot;" tags="" position="12079,2195" size="100,100">&quot;I&#39;d say the bigger threat to tourism is not having decent internet!&quot; he says. &quot;Who&#39;s gonna want to stay at a hotel without any wifi? Who&#39;s gonna buy a summer home if they&#39;ll have to drive fifteen minutes just to get online?&quot;

&quot;That&#39;s a very good point,&quot; you say, surprised that no one else has mentioned it.

&quot;Darn right it is,&quot; he says, sounding pleased. &quot;I gotta run for now, but it was nice chattin&#39; with ya!&quot; </tw-passagedata><tw-passagedata pid="453" name="Head inside the barn" tags="" position="11590,679" size="100,100">Inside, a woman you recognize from the meeting is setting out miniature cherry pies in a bakery case.

&quot;Welcome!&quot; she says cheerfully. &quot;Three-for-one hand pies today. Get them while they&#39;re hot!&quot;

[[&quot;Actually, I&#39;m a reporter with the Gazette. Can we talk?&quot;]]</tw-passagedata><tw-passagedata pid="454" name="Check out the orchard" tags="" position="11592,554" size="100,100">The storm has definitely left its mark here.

The aisles between the long rows of trees are soaked, your feet sinking deep into the muck.

(if: $resourceful &gt;5)[Luckily, you came prepared. Your knee-high boots keep you dry as you wade through the muck.

You snap some amazing photos along the way.
//Get great photos of flooded orchard//

Up ahead, you see a man in a baseballc ap and a kid, maybe eight or nine, gathering fallen cherries into large baskets. 

[[Ask to interview them-&gt;Interview orchard visitors]]](else:)[You make it halfway down one row and snap some photos...

Until your woefully-inadequate tennis shoe sticks in the mud and comes right off your foot. 

You&#39;ve had enough of this mess. You fish your shoe out of the muck and head back down toward the barn. 

[[Head inside the barn]]</tw-passagedata><tw-passagedata pid="455" name="Interview orchard visitors" tags="" position="11785,552" size="100,100">Double-click this passage to edit it.</tw-passagedata><tw-passagedata pid="456" name="&quot;Actually, I&#39;m a reporter with the Gazette. Can we talk?&quot;" tags="" position="11788,680" size="100,100">When she hears that, the woman&#39;s face lights up. &quot;I thought you looked familiar! I&#39;m Cora Pitt, the owner of this place.&quot;

You join her at a small table and she brings over a teapot and a cup of tea--to your surprise, Earl Grey. &quot;This isn&#39;t cherry-infused Earl Grey, is it?&quot; you ask.

Cora laughs. &quot;No. Thought you could use a break. You&#39;ve been in town for, what, three weeks? I figure your blood is 90% cherry juice by this point.&quot;

She&#39;s... not wrong.

[[Sip your non-cherry tea and interview the orchard owner.]]</tw-passagedata><tw-passagedata pid="457" name="Sip your non-cherry tea and interview the orchard owner." tags="" position="11951,682" size="100,100">&quot;Can you tell me more about what you said at the meeting?&quot; you ask. 

Cora nods. &quot;The county restrictions are dangerous. A few years ago, a big cell tower went up near a popular hiking trail, and people panicked. They passed an ordinance banning ALL towers, even the smaller ones. And now my family and all my neighbors can&#39;t get internet access.&quot;

[[&quot;How did this affect you during the flood?&quot;]]</tw-passagedata><tw-passagedata pid="458" name="&quot;How did this affect you during the flood?&quot;" tags="" position="12098,684" size="100,100">&quot;We heard there was rain in the forecast,&quot; she says. &quot;But we had no idea how serious it was. My spouse was driving into town for groceries. She nearly got swept off the road! And our entire basement flooded. I didn&#39;t have any warning.&quot;

[[&quot;What are you doing to prepare for another possible flood?&quot;]]
[[&quot;What do you think about the Tourism Committee supporting the restrictions?&quot;]] </tw-passagedata><tw-passagedata pid="459" name="&quot;What are you doing to prepare for another possible flood?&quot;" tags="" position="12256,788" size="100,100">&quot;Well... not much,&quot; Cora admits. &quot;I&#39;ve got a flooded orchard to deal with right now. I&#39;d like to stock up on sandbags, but I can&#39;t figure out where to get them.&quot;

&quot;The sandbag locations are all on the city website,&quot; you say, before realizing how unhelpful that statement was.

She nods. &quot;Exactly.&quot; 

[[&quot;What do you think about the Tourism Committee supporting the restrictions?&quot;]]</tw-passagedata><tw-passagedata pid="460" name="&quot;What do you think about the Tourism Committee supporting the restrictions?&quot;" tags="" position="12258,642" size="100,100">&quot;Actually, I think they&#39;re on the right track,&quot; she says. &quot;Sort of, at least.&quot;

[[&quot;Uh... can say that again? I think I misheard you.&quot;]]</tw-passagedata><tw-passagedata pid="461" name="&quot;Uh... can say that again? I think I misheard you.&quot;" tags="" position="12419,638" size="100,100">&quot;It&#39;s more complicated than people are making it sound,&quot; she says. &quot;Some regulations are a good idea. We can&#39;t just have them building towers anywhere! But the current restrictions are too... well, restrictive.&quot; 

[[&quot;So what do you think the solution is?&quot;]]</tw-passagedata><tw-passagedata pid="462" name="&quot;So what do you think the solution is?&quot;" tags="" position="12564,630" size="100,100">&quot;I think the county needs to do a better job listening to people,&quot; she says. &quot;They can keep some regulations. But we need internet. They need to find a way to make that happen.&quot;

[[Thank her for her time (and the refreshingly normal tea)-&gt;Internet Issues: Step Three]]</tw-passagedata><tw-passagedata pid="463" name="&quot;So basically, people need to actually listen to each other?&quot;" tags="" position="12711,635" size="100,100">Cora shrugs. &quot;That would help. 

[[Thank her for her time (and the refreshingly normal tea)-&gt;Internet Issues: Step Three]]</tw-passagedata><tw-passagedata pid="464" name="Mayor Lake Level Interview" tags="" position="11078,106" size="100,100">&quot;Well, you already know the problem,&quot; he says. &quot;We&#39;re dealing with catastrophic flooding. One practical solution is to lower our lakes. I&#39;ve been beating this drum for years, but nothing has changed.&quot;

[[&quot;Why not?&quot;]]</tw-passagedata><tw-passagedata pid="465" name="&quot;Why not?&quot;" tags="" position="11075,221" size="100,100">&quot;The county board would need to vote to lower the lakes,&quot; he says. &quot;But they&#39;re being pressured by wealthy homeowners. And the boating community, too.&quot;

[[&quot;But... aren&#39;t those people at risk of flooding, since they live by the water?&quot;]]
[[&quot;Do you know why people want the lakes so high?&quot;]]
[[&quot;What&#39;s the situation on the lakes right now?&quot;]]</tw-passagedata><tw-passagedata pid="466" name="&quot;What&#39;s the situation on the lakes right now?&quot;" tags="" position="10922,351" size="100,100">&quot;You mean today?&quot; he says. &quot;At this point, we&#39;re slowly letting water out at the dam. It&#39;ll take weeks to get back to normal levels, because the lake was already so high to begin with.&quot;

[[&quot;Has it been frustrating to try to convince people to change their minds?&quot;]]
</tw-passagedata><tw-passagedata pid="467" name="&quot;Has it been frustrating to try to convince people to change their minds?&quot;" tags="" position="11089,498" size="100,100">(if: $trust &gt;5)[The mayor sighs. &quot;I shouldn&#39;t be saying this, but you seem trustworthy,&quot; he says. &quot;It&#39;s been an absolute nightmare.&quot;

&quot;What do you mean?&quot; you ask.

&quot;All this stuff with the county,&quot; he says. &quot;It&#39;s nonsense. We need to act now. Things are only going to get worse.&quot;](elseif: $bookworm &gt;5)[The mayor hesitates. &quot;Well... I do my best to take everyone&#39;s concerns to heart.&quot;

It sounds noble, but you were just reading this morning about a bitter feud from a few years ago. &quot;You got into an argument with the county board a few years ago, didn&#39;t you?&quot;

He chuckles. &quot;You certainly did your research. I won&#39;t go into detail, but they may have sneaked into my office and put my coffee mug in jello.&quot;

You try not to laugh. Obstruction of coffee is a serious crime. &quot;What did you fight about?&quot;

&quot;I called the whole thing a charade,&quot; he says. &quot;The county never even considered changing the lake levels. It&#39;s time to take this seriously.&quot;](else:)[The mayor hesitates. It seems he doesn&#39;t trust you enough to really speak his mind. 

&quot;Um, well,&quot; he says. &quot;Part of my job is to listen to my constituents and their needs, even if I don&#39;t agree. But I sure hope we can find some common ground before the next storm comes through.&quot;

A typical paint-by-numbers reply. You wish you could pry a little deeper, but he&#39;s giving you nothing.]

[[&quot;Do you know who else I can talk to about this?&quot;]]

</tw-passagedata><tw-passagedata pid="468" name="&quot;But... aren&#39;t those people at risk of flooding, since they live by the water?&quot;" tags="" position="11205,349" size="100,100">&quot;Not as much as you&#39;d think,&quot; he says. &quot;The worst flooding happens down by the dam and in low-lying neighborhoods. Most of them low-income. That&#39;s where the water from the lake ends up.&quot;

[[&quot;Has it been frustrating to try to convince people to change their minds?&quot;]]</tw-passagedata><tw-passagedata pid="469" name="&quot;Do you know who else I can talk to about this?&quot;" tags="" position="11235,498" size="100,100">&quot;The Lakeshore Bluff neighborhood would be a good place to do interviews,&quot; he says. &quot;You can see firsthand how stubborn these people are. And the urban planning department knows all about this issue.&quot;

You thank him for his help. &quot;Nice hat, by the way,&quot; you say.

He chuckles. &quot;

[[Thank him for his time.-&gt;Lake Level Controversy - Step Two]]

</tw-passagedata><tw-passagedata pid="470" name="Lake Level Controversy - Step Two" tags="" position="11407,356" size="100,100">You need to find out more about this issue, and you need some quotes and photos for color. What do you do next? 

[[Head to the lakeshore.]]
[[Call the urban planning department.]]</tw-passagedata><tw-passagedata pid="471" name="&quot;Do you know why people want the lakes so high?&quot;" tags="" position="11063,355" size="100,100">&quot;People want to be able to use their docks and beaches,&quot; he says. &quot;They talk about tourism, water sports, stuff like that. But lower lakes would be a minor headache compared to what we&#39;re seeing now. A million dollars in damages. People forced out of their homes.&quot;

[[&quot;Has it been frustrating to try to convince people to change their minds?&quot;]]</tw-passagedata><tw-passagedata pid="472" name="Ask some random townspeople about the lakes." tags="" position="10594,128" size="100,100">You join the refreshments table, where you pour youself a cup of cherry-infused coffee. As soon as you bring up the topic of lake levels, people start chiming in.

&quot;The dam has been flooding since I was a kid,&quot; an old lady says. &quot;It&#39;s just a fact of life here!&quot;

&quot;Whose idea was it to build a town between two giant lakes, anyway?&quot; a guy says, tucking powdered donuts into his backpack.

&quot;I&#39;ve heard there&#39;s a houseboat movement,&quot; a man adds. &quot;Could be the next trend. Like tiny houses, or glamping!&quot;

[[Try to steer the conversation back to lake levels.]]
[[Thank them and try to catch the mayor before he leaves.-&gt;Talk to the mayor about the lake level issue.]]</tw-passagedata><tw-passagedata pid="473" name="Try to steer the conversation back to lake levels." tags="" position="10596,279" size="100,100">&quot;Do you think the lakes should be lowered?&quot; you ask.

&quot;Oh, yeah,&quot; the houseboat-curious guy says. &quot;Absolutely. I mean, as long as it doesn&#39;t affect my favorite beach. Or that spot where my kid and I like to fish. But other than that, yes, definitely.&quot;

You take a second to digest that one. &quot;Um... I&#39;m pretty sure it would affect the whole lake.&quot;

&quot;Oh.&quot; He blinks. &quot;Well, then, no. I think we better keep things the way they are. Just to be safe.&quot;

[[Talk to the mayor about the lake level issue.]]</tw-passagedata><tw-passagedata pid="474" name="Head to the lakeshore." tags="" position="11696,402" size="100,100">(if: $bookworm &gt;6)[You&#39;re starting to get used to the blocked-off roads. Probably thanks to all your perusing of the flood maps. 

You weave around the barricaded areas and make it to the lakeshore in record time.](elseif: $resourceful &gt;6)[You weave through the maze of downtown streets, half of them closed off.

You almost make it, but you get stuck at the intersection of Ruby and Maraschino. The water is deep here, too deep to wade through.

Luckily, you notice an abandoned swan inner tube floating along the road. 

You dig into your pocket for a bungee cord and just manage to snag the float, which fits you perfectly. You are nothing if not resourceful.](else:)[You drive through the maze of flooded, debris-strewn streets. Several areas are still flooded. 

At Maraschino Street, you wade through knee-deep water to reach your destination. Not a big deal, you tell yoursef firmly, trying to ignore everything the experts have told you about bacteria and contaminated water. 

Maybe you should&#39;ve brushed up on how to use the flood map, or packed some knee-high waders, but it&#39;s about as useful as remembering to pre-bake your crust after the whole pie is done.

(Look what this town has done to your inner monologue--next thing you know, you&#39;ll be speaking in cherry-themed puns.)]

[[Arrive at lakeshore neighborhood.]]</tw-passagedata><tw-passagedata pid="475" name="Call the urban planning department." tags="" position="11289,97" size="100,100">The man who answers the phone introduces himself as a city engineer, Bill Dean-Bridges. &quot;I&#39;d be happy to help you out,&quot; he says. &quot;I only have a few minutes, though.&quot;

[[&quot;What do you think about the mayor&#39;s push to lower the lake levels?&quot;]]</tw-passagedata><tw-passagedata pid="476" name="Arrive at lakeshore neighborhood." tags="" position="11832,396" size="100,100">After driving through the wreckage of downtown, the Lakeshore Bluff neighborhood is an eerie sight:

Lovely, clean streets, except for a few puddles and fallen tree branches piled near the curb. 

Most of the houses are made of brick and stone. Behind them, you can see the vast blue of the lake.

[[Knock at the nearest house, with a &quot;Homeowners for Higher Lakes&quot; sign in the window.]]
[[Talk to a mom and toddler playing in their front yard.]] 
[[Follow a narrow stone path down to the water.]]</tw-passagedata><tw-passagedata pid="477" name="Knock at the nearest house, with a &quot;Homeowners for Higher Lakes&quot; sign in the window." tags="" position="13194,455" size="100,100">When the door opens, you recognize the man inside: one of the homeowners who spoke up at the town meeting.

You ask if he&#39;d be willing to do an interview about his concerns.

&quot;That depends,&quot; he says. &quot;Have you been doing your research, or just listening to the mayor? How do I know I can trust you?&quot;

(if: $bookworm &gt; 5)[Luckily, you&#39;ve gotten into the habit of reading old news archives and city ordinances with your morning coffee! 

&quot;I did talk to the mayor,&quot; you say, &quot;but I also read the county advisory board&#39;s report from five years ago. They suggested keeping the lake levels high and looking for other ways to prevent flooding.&quot;

He looks begrudgingly impressed. &quot;Yes, that&#39;s true.&quot;

[[&quot;Do you still think the lake levels should stay how they are?&quot;]]
[[&quot;How would lower lake levels affect your life?&quot;]]](elseif: $trust &gt; 5)[You can tell he thinks you&#39;ve already pegged him as the bad guy.

&quot;Yes, I talked to the mayor,&quot; you say. &quot;But I want to hear your story, too. You&#39;re the one who lives here. You&#39;re the expert on how this will affect you.&quot;

Something in your voice must convince him you&#39;re being sincere. 

&quot;Okay,&quot; he says. &quot;What do you want to know?&quot;

[[&quot;Do you still think the lake levels should stay how they are?&quot;]]
[[&quot;How would lower lake levels affect your life?&quot;]]](elseif: $social &gt;5)[You&#39;re about to answer when he notices the cherry-embroidered hat poking out of your bag. 

&quot;Wait a sec!&quot; he says. &quot;Where did you get one of Imojean&#39;s limited-edition cherry berets? My wife wants one, but all the shops in town are sold out!&quot;

&quot;Oh... uh, my upstairs neighbor Jeanie gave it to me,&quot; you say. You consider giving him this one, but to your susprise, you&#39;ve started to get attached to it. &quot;I can bring you one when she makes more,&quot; you offer. 

From the look on his face, you&#39;ve just made his entire week. &quot;Thank you!&quot; he says. &quot;I guess an interview couldn&#39;t hurt, since you came all this way. What do you want to know?&quot;

[[&quot;Do you still think the lake levels should stay how they are?&quot;]]
[[&quot;How would lower lake levels affect your life?&quot;]]](else:)[You try to think of some way to convince him to trust you, but you don&#39;t have any statistics to impress him with or local connections to ease his mind.

&quot;I... helped rescue some chickens once?&quot; you say. 

&quot;Sorry,&quot; he says. &quot;No comment. But here&#39;s a flyer.&quot;

He tosses a &quot;Homeowners for Higher Lakes&quot; poster at you and shuts the door.

[[Look for someone else to talk to.-&gt;Lakeshore Neighborhood Hub]]]
</tw-passagedata><tw-passagedata pid="478" name="Talk to a mom and toddler playing in their front yard." tags="" position="12086,380" size="100,100">The toddler is playing in a sandbox. It&#39;s full of child-sized buckets and shovels, though she seems more interested in playing with rocks and dead bugs.

You ask if the mom would be willing to talk. 

&quot;Sure!&quot; she says cheerfully, as she plucks a ladybug out of her daughter&#39;s mouth. &quot;I might be a little distracted, though. She&#39;s teething.&quot;

[[Look in your bag for something to entertain the toddler.]]
[[Tell her it&#39;s no problem, you&#39;re sure it&#39;ll be fine.]]


</tw-passagedata><tw-passagedata pid="479" name="Follow a narrow stone path down to the water." tags="" position="12119,146" size="100,100">You walk between two red-brick, A-frame houses and find your way to the lakeshore.

You&#39;re surprised to see that the damage isn&#39;t bad here--the docks are covered in water, but the houses are built on high ground. The flood hasn&#39;t touched them. A pontoon boat is bobbing on the water, full of people fishing and sipping drinks.

Down the lakeshore, you can see a scenic view of downtown--complete with barricades and debris.

(if: $techie &gt;5)[You&#39;re elated to have brought your zoom lens.

You snap a picture of the peaceful-looking pontoon boat in the foreground, with the wreckage of downtown in the background.](else:)[You wish you could an evocative shot of the wreckage of downtown, with the idyllic lakeside docks in the foreground. 

Unfortunately, you must&#39;ve left your zoom lens at home with all the boxes you still haven&#39;t unpacked. You settle for a mediocore image of the lakeshore.

//Get decent photo of lakeshore properties//]

[[Plan your next move-&gt;Lakeshore Neighborhood Hub]]</tw-passagedata><tw-passagedata pid="480" name="Look in your bag for something to entertain the toddler." tags="" position="12261,486" size="100,100">(if: $resourceful &gt;5)[You dig thorugh your bag and find a protein bar, a package of mixed nuts, and a stick of cinnamon gum. Then--voila!--an applesauce pouch! That seems kid-friendly. Probably. You hand it over, and the toddler eats happily while you talk.

[[&quot;What are your thoughts about lowering the lakes?&quot;]]](else:)[You dig through your bag for something to entertain the toddler. but all you find is some chapstick, your phone, and a bunch of soy sauce packets. 

You&#39;re not a baby expert, but it doesn&#39;t seem toddler friendly.

[[&quot;I&#39;d still love to chat, if you&#39;re up for it,&quot; you say. &quot;Whatever you have time for.&quot;-&gt;Tell her it&#39;s no problem, you&#39;re sure it&#39;ll be fine.]]</tw-passagedata><tw-passagedata pid="481" name="Tell her it&#39;s no problem, you&#39;re sure it&#39;ll be fine." tags="" position="12255,350" size="100,100">&quot;Okay,&quot; she says, &quot;what do you want to know?&quot;

[[&quot;What are your thoughts about lowering the lakes?&quot;-&gt;&quot;What are thoughts about lowering the lakes?&quot; Option 2]]</tw-passagedata><tw-passagedata pid="482" name="&quot;What are your thoughts about lowering the lakes?&quot;" tags="" position="12405,485" size="100,100">&quot;I&#39;ve heard it might happen,&quot; she says. &quot;I&#39;m pretty nervous about it, though.&quot;

[[&quot;Can you tell me why?&quot;]]</tw-passagedata><tw-passagedata pid="483" name="&quot;Can you tell me why?&quot;" tags="" position="12546,486" size="100,100">&quot;I know it sounds selfish,&quot; she says, &quot;but my husband and I worked overtime and saved up for ten years to afford this neighborhood. We love being able to take our boat out. Our daughter loves the little beach down the street. Though, if they lower the lakes, I don&#39;t kow how long it&#39;ll be there....&quot;

[[&quot;How would lower lake levels affect you?&quot;]]</tw-passagedata><tw-passagedata pid="484" name="&quot;How would lower lake levels affect you?&quot;" tags="" position="12682,484" size="100,100">&quot;We bought this place thinking that we could sell it someday and earn something back,&quot; she said. &quot;But the lake is what makes these houses valuable. If the lake levels go down, we could lose everything we put into this place.&quot;

[[&quot;What about the flooding? Experts think lower lake levels would help.&quot;]]
[[&quot;Do all of your neighbors feel the same way?&quot;]]
</tw-passagedata><tw-passagedata pid="485" name="&quot;What about the flooding? Experts think lower lake levels would help.&quot;" tags="" position="12851,549" size="100,100">&quot;That might be one solution,&quot; she says. &quot;But there are others, too. I feel like the mayor is making this all about the lakes so that he doesn&#39;t have to deal with more serious engineering problems.&quot; 

You want to ask her more, but her daughter has finished the applesauce and is starting to whimper.

&quot;Nap time,&quot; the woman says. &quot;I&#39;d better get her inside.&quot; 

She gives you her name, Sheryl (or Cheryl?) Farsakian, and agrees to be quoted in your article. You try to ask her how to spell it, but she&#39;s already carrying her wailing toddler inside. 

[[Head back to the sidewalk.-&gt;Lakeshore Neighborhood Hub]] </tw-passagedata><tw-passagedata pid="486" name="&quot;Do all of your neighbors feel the same way?&quot;" tags="" position="12848,421" size="100,100">&quot;Most of them,&quot; she says. &quot;None of us had any warning when we moved in that the lake weren&#39;t naturally be this high. It&#39;s like we got tricked. If I&#39;d known this would all happen, I might&#39;ve bought somewhere else. I feel so stuck.&quot;

You want to ask her more, but her daughter has finished the applesauce and is starting to whimper.

&quot;Nap time,&quot; the woman says. &quot;I&#39;d better get her inside.&quot; 

She gives you her name, Sheryl (or Cheryl?) Farsakian, and agrees to be quoted in your article. You try to ask her how to spell it, but she&#39;s already carrying her wailing toddler inside. 

[[Head back to the sidewalk.-&gt;Lakeshore Neighborhood Hub]] </tw-passagedata><tw-passagedata pid="487" name="&quot;What are thoughts about lowering the lakes?&quot; Option 2" tags="" position="12401,346" size="100,100">&quot;I&#39;ve heard it might happen,&quot; she says. &quot;I&#39;m pretty nervous about it, though.&quot;

[[&quot;Can you tell me why?&quot;-&gt;&quot;Can you tell me why?&quot; Option 2]]</tw-passagedata><tw-passagedata pid="488" name="&quot;Can you tell me why?&quot; Option 2" tags="" position="12539,346" size="100,100">&quot;I know it sounds selfish,&quot; she says, &quot;but my husband and I worked overtime and saved up for ten years to afford this neighborhood. We love being able to take our boat out. Our daughter loves the little beach down the street--&quot;

&quot;Beach!!&quot; the little girl says, crawling into her mom&#39;s lap.

&quot;Not now, sweetie. It&#39;s flooded down there, remember?&quot;

[[&quot;How would lower lake levels affect you?&quot;-&gt;&quot;How would lower lake levels affect you?&quot; Option 2]]</tw-passagedata><tw-passagedata pid="489" name="&quot;How would lower lake levels affect you?&quot; Option 2" tags="" position="12679,344" size="100,100">The woman starts to answer, but it&#39;s hard to hear over the toddler&#39;s crying. Something about the beaches and docks and home values being destroyed?

[[&quot;Sorry, can you say that again?&quot;]]</tw-passagedata><tw-passagedata pid="490" name="&quot;Sorry, can you say that again?&quot;" tags="" position="12802,235" size="100,100">&quot;Oh, sure,&quot; she says, gathering the toddler into her lap. &quot;I was just saying that the lakes are the biggest draw for this neighborhood. If we can&#39;t use our beaches and docks, the value of our home would go way down--&quot;

&quot;Wayyyy down,&quot; the toddler echoed, looking heartbroken.

[[&quot;</tw-passagedata><tw-passagedata pid="491" name="Lakeshore Neighborhood Hub" tags="" position="13034,116" size="100,100">Time is ticking. What do you want to do next? 

[[Knock at the nearest house, with a &quot;Homeowners for Higher Lakes&quot; sign in the window.]]
[[Talk to a mom and toddler playing in their front yard.]] 
[[Follow a narrow stone path down to the water.]]
[[Walk down to the beach that Cheryl/Sheryl mentioned.]]
[[Call the urban planning department.]]

To skip forward: [[Level 3, Story 2]]</tw-passagedata><tw-passagedata pid="492" name="&quot;Do you still think the lake levels should stay how they are?&quot;" tags="" position="13352,508" size="100,100">&quot;Of course I do,&quot; he says, impatient. &quot;Do you think I showed up at that meeting with a megaphone and a picket sign just for kicks?&quot;

He&#39;s got a point there.

[[&quot;How would lower lake levels affect your life?&quot;]]
[[&quot;What about all the flooding across town?&quot;]]</tw-passagedata><tw-passagedata pid="493" name="&quot;How would lower lake levels affect your life?&quot;" tags="" position="13346,380" size="100,100">&quot;I&#39;ve got a dock out back,&quot; he says. &quot;If they lower the lake levels even a few feet, the bottom of my boat will scrape against the lake bottom. Any more than that, and all the docks in the neighborhood will become unusable!&quot;  

[[&quot;What about all the flooding across town?&quot;]]
</tw-passagedata><tw-passagedata pid="494" name="Walk down to the beach that Cheryl/Sheryl mentioned." tags="" position="13064,841" size="100,100">You head down the street, stepping around puddles, until you reach an open, flooded area on the water. Floating ropes mark off the usual swimming zone. 

You&#39;re starting to see the problem that Cheryl/Sheryl was talking about. Beyond the ropes, the water is full of weeds and jagged rocks. If the lakes were lowered five feet, there would be no swimming area left!

On the other hand... the beach isn&#39;t exactly usable now, either. Though the mostly-submerged lifeguard&#39;s chair does make for a great photo.

//Get great photos of flooded beach//

[[Head back to the street.-&gt;Lakeshore Neighborhood Hub]]
[[Keep looking around.]]
</tw-passagedata><tw-passagedata pid="495" name="Keep looking around." tags="" position="13198,847" size="100,100">As you keep walking down the flooded beach, you notice a small wooden shop with an &quot;Open&quot; sign in the window. There are colorful canoes and pedal boats stacked up outside.

[[Check out the shop.]]
[[Head back to the street.-&gt;Lakeshore Neighborhood Hub]]</tw-passagedata><tw-passagedata pid="496" name="&quot;What about all the flooding across town?&quot;" tags="" position="13492,468" size="100,100">He grimaces. &quot;I can tell you&#39;ve been talking to the mayor. Listen, kid. This is a complex problem. Lowering the lakes isn&#39;t going to magically fix everything.&quot;

It&#39;s a fair point. On the other hand, the fact that he just called you &quot;kid&quot; is making you slightly less sympathetic. 

[[&quot;What solutions do you propose?&quot;]]
[[&quot;Why do you think the mayor is pushing for lower lake levels?&quot;]]
</tw-passagedata><tw-passagedata pid="497" name="&quot;What solutions do you propose?&quot;" tags="" position="13651,533" size="100,100">He shrugs. &quot;What about putting money toward better storm drains? Or clearing all the debris and algae growth out of the river, so the water can flow faster? Talk to someone at the urban planning committee. They&#39;ll agree with me.&quot;

&quot;Thanks for talking,&quot; you say. &quot;I can see why this issue is so frustrating.&quot;

His eyes light up. &quot;Great! So you&#39;ll put one of these in your yard, then?&quot;

He grabs a sign from inside his doorway: Homeowners for Higher Lakes! 

&quot;Um, sorry,&quot; you say. &quot;I don&#39;t have a yard. Just a bunch of giant metal birds.&quot;

You hurry away while he&#39;s still puzzling over that one. 

[[Plan out what to do next.-&gt;Lakeshore Neighborhood Hub]]
</tw-passagedata><tw-passagedata pid="498" name="&quot;Why do you think the mayor is pushing for lower lake levels?&quot;" tags="" position="13642,390" size="100,100">&quot;In my eyes, it&#39;s pretty simple,&quot; he says. &quot;He&#39;s trying to pin the blame on us, so he doesn&#39;t have to admit that the city should&#39;ve made infrastructure changes years ago.&quot;

[[&quot;What kind of infrastructure changes?&quot;-&gt;&quot;What solutions do you propose?&quot;]]</tw-passagedata><tw-passagedata pid="499" name="&quot;What do you think about the mayor&#39;s push to lower the lake levels?&quot;" tags="" position="11437,94" size="100,100">&quot;Well, I agree with it,&quot; he say. &quot;But in full transparency, that&#39;s because my team and I are the ones who suggested it.&quot;

[[&quot;What about other solutions, like better storm drains?&quot;]]
[[&quot;Would lower lake levels have any negative impact on Twin Lakes?&quot;]]</tw-passagedata><tw-passagedata pid="500" name="&quot;What about other solutions, like better storm drains?&quot;" tags="" position="11710,221" size="100,100">&quot;Storm drains are important, too,&quot; he says. &quot;It&#39;s not an either-or-thing. Climate change is bringing more extreme weather. We&#39;re going to need better drain pipes AND lower lake level if we want to save our town.&quot;

[[&quot;Do you mean... the floods could destroy Twin Lakes?&quot;]]

</tw-passagedata><tw-passagedata pid="501" name="&quot;Would lower lake levels have any negative impact on Twin Lakes?&quot;" tags="" position="11582,24" size="100,100">&quot;It&#39;s a complicated issue,&quot; he says. &quot;Home values would go down by the lake. And some of the swimming areas and docks would end up on dry land. But the benefits outweigh the drawbacks.&quot;

[[&quot;Are there any solutions to these problems?&quot;]]</tw-passagedata><tw-passagedata pid="502" name="&quot;Are there any solutions to these problems?&quot;" tags="" position="11732,24" size="100,100">&quot;Of course,&quot; he says. &quot;We could extend docks farther into the lake and do some work at beaches. Add more sand, expand the swimming area. The same solutions could help homeowners maintain their property values, too.&quot;

&quot;Sounds expensive,&quot; you say.

&quot;Not as expensive as rebuilding from 100-year floods every year,&quot; he says. &quot;Or losing our town altogether.&quot;

[[&quot;Do you mean... the floods could destroy Twin Lakes?&quot;]]</tw-passagedata><tw-passagedata pid="503" name="&quot;Do you mean... the floods could destroy Twin Lakes?&quot;" tags="" position="11879,159" size="100,100">&quot;Let me put it this way,&quot; he says. &quot;Imagine that homes and businesses flood ever summer, like this, or worse. The whole city needs to rebuild. Maybe people even end up dying. Would //you// want to live here?&quot;

A few weeks ago, you wouldn&#39;t have wanted to live here anyway. But at this point, the cherry pie and coffee at Sophia&#39;s has become one of your five main food groups. 

&quot;Anyway, I need to run,&quot; Bill says, before you can answer. &quot;Good luck with your story. I hope it helps people come around.&quot;

[[Plan your next move.-&gt;Lakeshore Neighborhood Hub]]

</tw-passagedata><tw-passagedata pid="504" name="Check out the shop." tags="" position="13196,981" size="100,100">Inside, a woman about your age is dozing with her head on the counter. 

The place is full of water sports equipment--life jackets, fishing poles, enormous swan rafts. Plus little blue tubs in a small fridge, the lids covered in dark-brown specks--maybe cookie crumbs? You grab one and bring it to the counter. A snack for later. 

As soon as the fridge door shuts, the woman at the counter startles awake. &quot;Ahh! Get back!!&quot;

&quot;Um... sorry,&quot; you say, inching away from her. &quot;I&#39;ll leave you alone.&quot;

&quot;No, no, please stay!&quot; She fluffs her rumpled hair. &quot;I was just dreaming of giant rabid swans. Same old thing. What brings you in? Everything is 75% off today! I&#39;ll even throw in that tub of nightcrawlers, free of charge.&quot;

Now it&#39;s your turn to scream. You drop the blue tub, spilling earthworms and dirt everywhere.

[[&quot;Oops. Um...sorry about that.&quot;]]</tw-passagedata><tw-passagedata pid="505" name="&quot;Oops. Um...sorry about that.&quot;" tags="" position="13323,977" size="100,100">&quot;No problem,&quot; she says cheerfully, scooping the worms and dirt back into the tub with both hands. &quot;City girl, huh?&quot;

&quot;Guilty,&quot; you say, embarrassed to find yourself blushing. &quot;I&#39;m the new reporter at the Gazette. Do you have a few minute for an interview?&quot;

&quot;Oh, sure! I&#39;m an open book.&quot;

[[&quot;Can you tell me about your shop?&quot;]]
[[&quot;Have you heard about the mayor&#39;s push to lower the lakes?&quot;]]</tw-passagedata><tw-passagedata pid="506" name="&quot;Can you tell me about your shop?&quot;" tags="" position="13464,907" size="100,100">&quot;This is my dad&#39;s place,&quot; she says. &quot;I just work here. He&#39;s been renting out stuff to locals and tourists for years. Kayaks, paddleboards, stuff like that. This is usually his busiest month. It&#39;s really depressing, to be honest with you.&quot;

[[&quot;Does your dad support the push for lower lake levels?&quot;]]</tw-passagedata><tw-passagedata pid="507" name="&quot;Have you heard about the mayor&#39;s push to lower the lakes?&quot;" tags="" position="13461,1029" size="100,100">She grimaces. &quot;Of course I&#39;ve heard of it. My dad went down to the town meeting to protest. This is his shop. I just work here.&quot;

[[&quot;Why was your dad protesting?&quot;]]</tw-passagedata><tw-passagedata pid="508" name="&quot;Why was your dad protesting?&quot;" tags="" position="13583,1034" size="100,100">&quot;He&#39;s really worried,&quot; she says. &quot;If they vote lower the lakes, that&#39;ll kill a lot of his business. Less convenient spaces to swim and fish, less tourists coming... he&#39;s stressed about it. I suggested yoga, but he thought yelling at the mayor with a megaphone sounded like more fun.&quot;

[[&quot;Are you worried about lower lake levels, too?&quot;]]
[[</tw-passagedata><tw-passagedata pid="509" name="&quot;Does your dad support the push for lower lake levels?&quot;" tags="" position="13586,904" size="100,100">She laughs, and keeps laughing. &quot;Ha! That&#39;s a good one. My dad was the loudest guy with a megaphone at that town meeting. He&#39;s terrified about what&#39;ll happen if the levels go down. It could kill the business it took him 20 years to build.&quot;

[[&quot;Are you worried about lower lake levels, too?&quot;]]</tw-passagedata><tw-passagedata pid="510" name="&quot;Are you worried about lower lake levels, too?&quot;" tags="" position="13743,987" size="100,100">&quot;Well, yeah,&quot; she says. &quot;But look at this mess. The whole town is flooded! Obviously something needs to change. I just wish they could fix it without acting like people like my dad don&#39;t matter. He&#39;s put his whole life into this business. This is a nightmare for him.&quot;

&quot;I&#39;m so sorry,&quot; you say, feeling genuinely bad for the guy. &quot;I can&#39;t imagine how stressed out he must be.&quot;

She smiles. &quot;Don&#39;t worry too much. I&#39;m sure he&#39;ll land on his feet.&quot;</tw-passagedata><tw-passagedata pid="511" name="Wander through the bookstore under your flat." tags="" position="14244,1024" size="100,100">You walk through the &quot;local authors&quot; section and choose a thick volume about the uses and classifications of native plants, by F. J. Finkler, PhD.

&quot;Go ahead,&quot; the bookseller says cheerfully, &quot;just bring it back in when you&#39;re done.&quot;

You curl up on the bench outside, surrounded by the enormous, gleaming metal bird sculptures, and read Fred Finkler&#39;s thoughts on delphinium and foxglove, feeling vaguely amused by how strange your life has become. 

($changeStat:$bookwormName,1)

[[Head to Sophia&#39;s Cafe for breakfast.]]
</tw-passagedata><tw-passagedata pid="512" name="Stop by your upstairs neighbor&#39;s place for tea." tags="" position="14239,883" size="100,100">As usual, Jeanie is happy to see you. &quot;Good morning to the best reporter in Twin Lakes!&quot; she says. &quot;Kettle&#39;s on. While you&#39;re here, why don&#39;t you take a look at my new designs?&quot;

She shows you a stack of knitted hats.She&#39;s started to add new patterns--tiny cats, tiny cherry pies, and one that you suggested, tiny sandhill cranes.

&quot;Wow, Jeanie,&quot; you say. &quot;You really outdid yourself!&quot;

&quot;It&#39;s all thanks to your //purls// of wisdom, Dear,&quot; she says, and you actually get the joke. Maybe you need to hang out with more people your own age.

On the other hand, this hat is impossibly soft.

($changeStat:$socialName,2)

[[Head to Sophia&#39;s Cafe for breakfast.]]</tw-passagedata><tw-passagedata pid="513" name="Go for a run at Cherry Creek Marsh." tags="" position="14249,616" size="100,100">You could use a nice burst of endorphins. You grab your running shoes and drive to your favorite trailhead.

Some of the trails are still muddy, but you know which areas to avoid. As you round a curve, you see Birdie gazing up into the treetops through binoculars.

&quot;Hey again!&quot; she says, smiling. &quot;You might see some unusual birds today. They&#39;re all stirred up, for some reason. Maybe a change in the air pressure.&quot;

She&#39;s right--you see a kingfisher, a heron, the usual pair of sandhill cranes, and several chickadees before you&#39;ve even finished the loop.

($changeStat:$enduranceName,2)

[[Head to Sophia&#39;s Cafe for breakfast.]]</tw-passagedata><tw-passagedata pid="514" name="Replenish your bag with food and supplies." tags="" position="14251,481" size="100,100">You&#39;ve been a reporter in Twin Lakes for more than a month now. You&#39;re an old pro at this.

You stuff your bag with things you feel like you might end up needing:

* Your notebook and pens/pencils
* Camera gear
* A folded-up poncho
* A flashlight and batteries
* Gauze
* Protein bars
* Dried cherries
* Bungee cords
* Anti-venom
* Dog treats
* Snow shoes 

It&#39;s not an exhaustive list, but at least you won&#39;t be caught totally empty-handed. 

($changeStat:$resourcefulName, 1)

[[Head to Sophia&#39;s Cafe for breakfast.]]</tw-passagedata><tw-passagedata pid="515" name="Get online and fix the latest glitch on the Gazette&#39;s website." tags="" position="14242,748" size="100,100">Larry from accounting was poking around on the website, trying to add an advertisement for a local pizza place, The Cherry Tomato.

Which means now the entire screen is swallowed up by an enormous cherry and arugula goat cheese pizza. 

You resize the ad and put it at the bottom of the page, wondering if you might be able to convince The Cherry Tomato to put some new, innovative pizzas on their menu. Like--just for example--pepperoni.

($changeStat:$techieName,2)

[[Head to Sophia&#39;s Cafe for breakfast.]]</tw-passagedata><tw-passagedata pid="516" name="Head to Sophia&#39;s Cafe for breakfast." tags="" position="14429,749" size="100,100">Khalisa is already there, sipping coffee. &quot;Hey, rookie! Only five minutes late. Impressive.&quot;

Sophia brings over a slice of cherry almond coffee cake for Khalisa and your usual: spinach fritatta and coffee with milk, no sugar. Turns out you&#39;ve accidentally become a &quot;regular.&quot;  

You and Khalisa are just starting to eat when both of your phones buzz in unison.

[[Check text message]]


</tw-passagedata><tw-passagedata pid="517" name="Q and A Session" tags="" position="10474,926" size="100,100">The rest of the meeting is a blur of &quot;neighborly debate.&quot;

The mayor is pushing the county to lower lake levels in the future, but shoreline homeowners are worried that their concerns aren&#39;t being heard--which all 30 of them attest to, with picket signs and megaphones.  

An orchardist who lives outside of town is upset about her awful internet, but the county has restrictions against building broadband towers in rural areas. 

Fred Finkler&#39;s zinnias, he is happy to report, soaked up all the water and appear to be thriving.

[[Choose Assignment]]
</tw-passagedata><tw-passagedata pid="518" name="Check text message" tags="" position="14429,901" size="100,100">It&#39;s your editor, texting in all caps:

CHECK CITY WEBSITE ASAP

You exchange a glance with Khalisa. This whole thing feels strangely familiar. 

[[Pull up city website on your phone.]]</tw-passagedata><tw-passagedata pid="519" name="Pull up city website on your phone." tags="" position="14422,1049" size="100,100">Uh oh. All that red and caps-lock is definitely not a good sign.

ALERT: UNEXPECTED SUMMER STORM APPROACHING TWIN LAKES.
12 INCHES RAIN EXPECTED TO START WITHIN 48 HOURS
SEVERE FLOODING EXPECTED
EVACUATIONS EXPECTED

Underneath, there is a list of sandbagging stations, at-risk areas, and neighborhoods in need of evacuation. 

You look outside. Already, the sun is still shining. The whole thing feels so hard to believe. 

[[Call your editor]]</tw-passagedata><tw-passagedata pid="520" name="Call your editor" tags="" position="14424,1189" size="100,100">She picks up on the first ring. You put it on speaker, so Khalisa can hear.

&quot;We need to get ahead of this story,&quot; she says. &quot;It&#39;s not like last time. We know what we&#39;re dealing with here. Khalisa, you cover the breaking news update.&quot;

&quot;On it,&quot; says Khalisa, looking determined.

&quot;Rookie,&quot; your editor says, &quot;you get down to the high school. They&#39;ve got a shelter and sandbagging station set up there.&quot;

[[&quot;Okay, got it. What should I write about?&quot; ]]</tw-passagedata><tw-passagedata pid="521" name="&quot;Okay, got it. What should I write about?&quot; " tags="" position="14423,1332" size="100,100">&quot;I&#39;ll leave it up to you this time,&quot; she says. &quot;Follow your instincts. Where do you see equity issues? Who needs the most help before the storm hits?&quot;

You&#39;ll need:
* A description of whose needs aren&#39;t being met and why.
* Expert advice about possible solutions.
* Anecdotes, photos, and quotes for color.

Khalisa is looking a little sadly at her coffee cake. &quot;We better get out there.&quot;

&quot;Rain check?&quot; you say, and she laughs.

&quot;Count on it.&quot; 

[[Head to the evacuation shelter.]]</tw-passagedata><tw-passagedata pid="522" name="Head to the evacuation shelter." tags="" position="14638,755" size="100,100">At the high school, there&#39;s a sign posted at the school doors: Shelter Entrance. Service Animals OK. No Pets. 

In the parking lot, you see a dump truck dropping off a load of sand and city workers stacking sandbags that need to be filled.

[[Go inside the shelter.]]
[[Check out the sandbagging station.]]</tw-passagedata><tw-passagedata pid="523" name="Go inside the shelter." tags="" position="14768,585" size="100,100">The high school gym is full of cots, folding chairs, and blankets, with a handful of Twin Lakesians scattered around. 

You notice an elderly man holding tight to his dog&#39;s leash, arguing with the intake volunteer.

The shelter coordinator is walking around the gym with a clipboard, counting cots one by one. 

[[Check on the old man and dog.]]
[[Ask to interview the shelter coordinator.]]</tw-passagedata><tw-passagedata pid="524" name="Check out the sandbagging station." tags="" position="14770,1057" size="100,100">At the sandbagging station, people from the neighborhood are just beginning to show up and scoop sand into sandbags.

The DNR official recognizes you from the city dam, three weeks ago.

&quot;Nice to see you again!&quot; she says. A drastic change in tone from last time you talked, but you&#39;re not complaining. &quot;Great work with that breaking news update. How can I help you this time?&quot;

[[Ask her how the city is preparing for the approaching storm.]]</tw-passagedata><tw-passagedata pid="525" name="Check on the old man and dog." tags="" position="14926,557" size="100,100">The old man is slumping toward the exit when you catch up with him. He&#39;s holding a cup of coffee from a downtown bagel shop and dragging an old-fashioned suitcase. Plus his dog&#39;s leash. Guy&#39;s got his hands full. 

&quot;Hi,&quot; you say. &quot;I&#39;m a reporter with the Twin Lakes Gazette. Are you... okay?&quot;

He looks forlorn. &quot;Don&#39;t wanna talk about it.&quot;

[[Look in your bag for something helpful to offer him.]]
[[Reassure him that he can trust you.]]
[[Offer to carry his suitcase--it looks pretty heavy.]]
[[Use your social connections to try to find common ground.]]

</tw-passagedata><tw-passagedata pid="526" name="Ask to interview the shelter coordinator." tags="" position="14937,401" size="100,100">The woman in charge looks frazzled as she counts the cots throughout the room.

&quot;I know who you are,&quot; she says. &quot;I&#39;ve enjoyed your coverage in the Gazette, but I&#39;m afraid I don&#39;t have much time. I suppose I could answer two or three questions.&quot;

[[Ask about the situation with the man and dog who were just turned away.]]
[[Ask about what problems the shelter is experiencing.]]
[[Ask about what the shelter is able to provide.]]</tw-passagedata><tw-passagedata pid="527" name="Look in your bag for something helpful to offer him." tags="" position="14773,715" size="100,100">(if: $resourceful &gt;6)[Score! You knew you packed those dog treats for a reason.

You offer one to the man&#39;s dog, and both of them immediately warm up to you.

&quot;Thanks,&quot; the man says. &quot;At least somebody appreciates my boy here.&quot;

[[&quot;Can you tell me what happened?&quot;-&gt;Interview old man]]](else:)[You dig through your bag, but only find your usual gear, cherry granola bars, and some crumbs.

You offer the man a granola bar, but he shakes his head. &quot;Already ate. Don&#39;t you have somebody else to hassle?&quot;

[[Reassure him that he can trust you.]]
[[Offer to carry his suitcase--it looks pretty heavy.]]
[[Use your social connections to try to find common ground.]]
[[Leave him alone and go interview the shelter coordinator.-&gt;Ask to interview the shelter coordinator.]]


</tw-passagedata><tw-passagedata pid="528" name="Reassure him that he can trust you." tags="" position="14898,717" size="100,100">&quot;I&#39;m on your side,&quot; you tell him. &quot;Whatever&#39;s going on, I want to get the story out there. Maybe we can work together to help other people who are in the same boat.&quot;

(if: $trust &gt;6)[He looks more closely at you and suddenly his eyes light up.

&quot;You&#39;re that new reporter!&quot; he says. &quot;I read your article a couple weeks ago. You&#39;re really lookin&#39; out for people around here.&quot;

[[&quot;Can you tell me more about what&#39;s going on here?&quot;-&gt;Interview old man]]](else:)[He looks more closely at you, then shakes his head.

&quot;I don&#39;t know nothin&#39; about you,&quot; he says. &quot;Sorry, but I don&#39;t trust easy.&quot;

[[Look in your bag for something helpful to offer him.]]
[[Offer to carry his suitcase--it looks pretty heavy.]]
[[Use your social connections to try to find common ground.]]
[[Leave him alone and go interview the shelter coordinator.-&gt;Ask to interview the shelter coordinator.]]</tw-passagedata><tw-passagedata pid="529" name="Offer to carry his suitcase--it looks pretty heavy." tags="" position="15021,719" size="100,100">You ask if he&#39;d like help with his suitcase.

&quot;Aw, don&#39;t worry &#39;bout that,&quot; he says. &quot;It&#39;s probably too heavy for ya.&quot;

(if: $endurance &gt;6)[You surprise him by lifting the suitcase easily.

It&#39;s not exactly a picnic--the thing feels like it&#39;s full of bricks--but you tell him you&#39;d be happy to carry it out to his car for him, and maybe interview him along the way.

&quot;Well, color me impressed,&quot; he says. &quot;Okay, kid. What do you want to ask me about?&quot;

[[&quot;Can you tell me about what&#39;s going on here?&quot;-&gt;Interview old man]]](else:)[You try to lift the suitcase, but you can hardly budge it an inch.

You set it back down, defeated. &quot;Wow. What&#39;ve you got in there, bricks?&quot;

&quot;Books,&quot; he says. &quot;So... pretty much.&quot;

(if: $bookworm &gt;6)[To his surprise, you launch into a discussion of your latest reads, ranging from a mystery novel and Fred Finkler&#39;s guide to native to plants to a detailed, annotated history of Twin Lakes. 

&quot;Didn&#39;t realize you were a bookish type, too,&quot; he says. &quot;Guess I could help you out. We bookworms gotta stick together. What do you want to know?&quot;

[[&quot;Can you tell me more about what&#39;s happening here?&quot;-&gt;Interview old man]]](else:)[You don&#39;t have much to say about that. You haven&#39;t had much time to read lately.

[[Look in your bag for something helpful to offer him.]]
[[Reassure him that he can trust you.]]
[[Use your social connections to try to find common ground.]]
[[Leave him alone and go interview the shelter coordinator.-&gt;Ask to interview the shelter coordinator.]]]]
</tw-passagedata><tw-passagedata pid="530" name="Use your social connections to try to find common ground." tags="" position="15154,715" size="100,100">[[Look in your bag for something helpful to offer him.]]
[[Reassure him that he can trust you.]]
[[Offer to carry his suitcase--it looks pretty heavy.]]
[[Leave him alone and go interview the shelter coordinator.-&gt;Ask to interview the shelter coordinator.]]
</tw-passagedata><tw-passagedata pid="531" name="Interview old man" tags="" position="15151,551" size="100,100">&quot;I&#39;ve been lookin&#39; for a place to live since the first flood happened,&quot; he says. &quot;I thought they might take me in here, but they don&#39;t allow pets. There&#39;s no way I could leave Bruno somewhere, just to get myself a bed. He&#39;s my best friend.&quot;

[[&quot;Where did you live before? What happened to it?&quot;]]</tw-passagedata><tw-passagedata pid="532" name="&quot;Where did you live before? What happened to it?&quot;" tags="" position="15273,549" size="100,100">&quot;I was happy as a clam at Picnic Place Apartments, over in the Marmalade neighborhood,&quot; he says. &quot;It&#39;s a nice place for seniors. But we&#39;ve all been kicked out of there for weeks now.&quot;

[[&quot;The building kicked everyone out?? Why?&quot;]]
</tw-passagedata><tw-passagedata pid="533" name="&quot;The building kicked everyone out?? Why?&quot;" tags="" position="15412,554" size="100,100">&quot;We got hit hard by the flood,&quot; he says. &quot;Apparently the building&#39;s not safe, so we were evacuated without notice. Though I&#39;d rather be in a soggy apartment with no power than out on the street.&quot;

[[&quot;Where have you been living?&quot;]]
[[&quot;Have the building owners done anything to help you?&quot;]]

</tw-passagedata><tw-passagedata pid="534" name="&quot;Where have you been living?&quot;" tags="" position="15539,552" size="100,100">&quot;I&#39;ve been renting a motel room,&quot; he says. &quot;The building owners gave us all $300 for temporary, but I burned through that in the first week.&quot;

[[&quot;Do you have any idea when you&#39;ll be allowed back into your place?&quot;]]
[[&quot;Were you able to salvage anything from your apartment?&quot;]]</tw-passagedata><tw-passagedata pid="535" name="&quot;Have the building owners done anything to help you?&quot;" tags="" position="15537,401" size="100,100">&quot;They stopped requiring rent payments,&quot; he says. &quot;And they gave everybody $300. But I&#39;ve been staying at a motel that costs $30 a night. That money is long gone--I&#39;m digging myself deep into debt.&quot;

[[&quot;Do you have any idea when you&#39;ll be allowed back into your place?&quot;]]
[[&quot;Were you able to salvage anything from your apartment?&quot;]]
[[&quot;Did you tell the people here at the shelter what&#39;s going on?&quot;]]</tw-passagedata><tw-passagedata pid="536" name="&quot;Do you have any idea when you&#39;ll be allowed back into your place?&quot;" tags="" position="15746,522" size="100,100">&quot;Not a clue,&quot; he says. &quot;They haven&#39;t been keepin&#39; us in the loop. Last week, they said it could be 4 to 6 days. Now, nothin&#39;.&quot;

[[Ask for the address of his apartment building.]]</tw-passagedata><tw-passagedata pid="537" name="&quot;Were you able to salvage anything from your apartment?&quot;" tags="" position="15751,401" size="100,100">&quot;Well, there&#39;s all my books in here,&quot; he says, patting his suitcase. &quot;And a few pairs of clothes, but only what could fit. Gotta keep your priorities straight. It was hard to convince them to let me in to salvage anything.&quot;

[[Ask for the address of his apartment building.]]</tw-passagedata><tw-passagedata pid="538" name="&quot;Did you tell the people here at the shelter what&#39;s going on?&quot;" tags="" position="15747,647" size="100,100">&quot;Yep,&quot; he says. &quot;They said they can&#39;t break the no pets rule, but if I can get rid of Bruno here, I&#39;m welcome to stay. I tried pretendin&#39; he was an emotional support dog, but they didn&#39;t buy it.&quot;

[[Ask for the address of his apartment building.]]

</tw-passagedata><tw-passagedata pid="539" name="Ask for the address of his apartment building." tags="" position="15944,509" size="100,100">He rattles it off: 8925 Compote Lane. 

You thank him for the interview and ask if you can take a picture of him and his dog, which he agrees to. 

//Get photo: elderly man and dog outside evacuation shelter//

Time to choose your next step. Do you want to head to the man&#39;s apartment, or talk to the shelter coordinator about the situation here?

[[Head to Picnic Place Apartments.]]
[[Ask to interview the shelter coordinator.]]



</tw-passagedata><tw-passagedata pid="540" name="Head to Picnic Place Apartments." tags="" position="16279,494" size="100,100">When you arrive, you find a sprawling two-story apartment building blocked off by caution tape. 

A few people who appear to be in their seventies and eighties are waiting outside, while an official-looking woman in a suit--probably the apartment&#39;s manager--is talking to an electrical worker near the entrance.

[[Talk to an elderly woman sitting on a park bench, holding a pet bird on her lap.]]
[[Talk to an older couple near the entrance, who look anxious to get inside.]] 
[[Talk to the building manager.]]
[[Talk to the electrical worker.]]

</tw-passagedata><tw-passagedata pid="541" name="Ask about the situation with the man and dog who were just turned away." tags="" position="14786,408" size="100,100">&quot;He wanted to bring in his dog,&quot; she says. &quot;We&#39;re not allowed to take in pets. Only service animals. There are reasons for it. Safety, pests, potential allergies. But still. I feel terrible.&quot;

She tells you that the man was coming from Picnic Place, a senior citizen apartment building.

&quot;The situation has been awful over there,&quot; she says. &quot;You might want to check it out.&quot;

[[Head to Picnic Place Apartments.]]</tw-passagedata><tw-passagedata pid="542" name="Ask about what problems the shelter is experiencing." tags="" position="14785,263" size="100,100">&quot;We need more supplies and volunteers to make this shelter more accessible,&quot; she says. &quot;We need different sleeping options, not just these little cots. And we need some way to accomodate pets, so I don&#39;t have to keep turning people away.&quot;

[[&quot;Why wasn&#39;t this all planned out ahead of time?&quot;]]
[[&quot;What happened with that older gentleman I saw you talking to?&quot;-&gt;Ask about the situation with the man and dog who were just turned away.]]</tw-passagedata><tw-passagedata pid="543" name="Ask about what the shelter is able to provide." tags="" position="14948,263" size="100,100">&quot;Well, we&#39;ve got people volunteering to prepare meals in the cafeteria,&quot; she says. &quot;And there are lots of cots and blankets. But it might not be enough.&quot;

[[Ask about what problems the shelter is experiencing.]]</tw-passagedata><tw-passagedata pid="544" name="Talk to an elderly woman sitting on a park bench, holding a pet bird on her lap." tags="" position="16291,806" size="100,100">The woman is happy to chat with you. &quot;I&#39;ve been waiting so long,&quot; she says. &quot;I&#39;m bored out of my mind!&quot;

[[Ask what she&#39;s waiting for.]]</tw-passagedata><tw-passagedata pid="545" name="Talk to an older couple near the entrance, who look anxious to get inside." tags="" position="16439,515" size="100,100">Just as you approach, the old couple is about to be led inside by a building employee.

&quot;Sorry,&quot; the elderly lady says. &quot;I recognize you and I would love to chat, but we finally get to go inside to fetch some of our things!&quot;

[[Ask if they&#39;d like an extra set of hands.]]</tw-passagedata><tw-passagedata pid="546" name="Talk to the building manager." tags="" position="16431,364" size="100,100">The building&#39;s manager--at least, you assume that&#39;s who she is--looks annoyed when she sees you.

&quot;I&#39;ve got enough going on here,&quot; she says. &quot;No press.&quot;

[[Tell her you&#39;re writing this story anyway--she might as well get her two cents in.]]
[[Tell her you understand she&#39;s in a difficult spot and you want to know how the city can help.]]</tw-passagedata><tw-passagedata pid="547" name="Talk to the electrical worker." tags="" position="16282,221" size="100,100">You try to catch the electrical worker, but he&#39;s already on his way inside.

&quot;Sorry,&quot; he says. &quot;I&#39;m literally swamped here.&quot;

[[&quot;Can you tell me what you&#39;re working on?&quot;]]</tw-passagedata><tw-passagedata pid="548" name="Ask what she&#39;s waiting for." tags="" position="16437,811" size="100,100">&quot;The building owners said they would decide today if we&#39;re allowed to move back in,&quot; she says. &quot;I live on the first floor, so I feel like I&#39;ve got a good chance.&quot;

[[&quot;Can you tell me about why you had to leave your apartment?&quot;]]
[[&quot;How long has it been since you had to leave?&quot;]]</tw-passagedata><tw-passagedata pid="549" name="&quot;Can you tell me about why you had to leave your apartment?&quot;" tags="" position="16601,926" size="100,100">&quot;It was that awful flood, of course,&quot; she says. &quot;That morning, I looked out the window and saw three feet of water rushing past! Thank goodness that&#39;s over.&quot;

[[&quot;How were you rescued?&quot;]]
[[&quot;Where have you been staying?&quot;]]</tw-passagedata><tw-passagedata pid="550" name="&quot;How long has it been since you had to leave?&quot;" tags="" position="16599,799" size="100,100">&quot;It&#39;s been 21 days now,&quot; she says. &quot;Since the day of the flood. It&#39;s the kind of thing you never expect to happen to you.&quot;

[[&quot;What do you think about how your building has handled the situation?&quot;]]
[[&quot;Where have you been staying?&quot;]]</tw-passagedata><tw-passagedata pid="551" name="&quot;How were you rescued?&quot;" tags="" position="16737,931" size="100,100">&quot;Firefighters came and gathered us into rescue vehicles and boats,&quot; she said. &quot;There was no time to grab anything. I haven&#39;t been allowed back inside since then. I&#39;m running out of food for poor Quigley, here.&quot;

[[&quot;What do you think about how your building has handled the situation?&quot;]]</tw-passagedata><tw-passagedata pid="552" name="&quot;What do you think about how your building has handled the situation?&quot;" tags="" position="16902,801" size="100,100">Her cheerful face darkens like the clouds overhead. &quot;Dreadful,&quot; she says. &quot;Terrible. Shameful.&quot;

Wow.... for a sweet old lady, that was a quick 180.

[[&quot;Can you tell me more about that?&quot;]]</tw-passagedata><tw-passagedata pid="553" name="&quot;Where have you been staying?&quot;" tags="" position="16743,800" size="100,100">&quot;I moved in with my daughter and her family,&quot; she says. &quot;I&#39;ve heard the city opened a shelter at the high school, but what would I do with Quigley? And besides, I have arthritis in my back. Those little cots are impossible for me.&quot;

[[&quot;What do you think about how your building has handled the situation?&quot;]]</tw-passagedata><tw-passagedata pid="554" name="&quot;Can you tell me more about that?&quot;" tags="" position="17024,801" size="100,100">&quot;I&#39;ve had no clear communication from them,&quot; she says. &quot;No idea when I&#39;d be allowed to move back in. And it&#39;s nearly impossible to get inside and gather my things. They say it&#39;s a safety concern, but I think they&#39;re afraid I&#39;ll try to move out.&quot;

[[&quot;Can you tell me what would help you the most right now? Money? Shelter?&quot;]]</tw-passagedata><tw-passagedata pid="555" name="&quot;Can you tell me what would help you the most right now? Money? Shelter?&quot;" tags="" position="17024,951" size="100,100">&quot;I just want to be home,&quot; she says, petting the plump, feathered quail on her lap. &quot;But at least I&#39;m not alone. I&#39;ve got a good friend who&#39;s gonna help me get financial aid. She&#39;s brilliant at working within the system, finding loopholes, things like that.&quot;

[[&quot;Can you share her contact information?&quot;]]</tw-passagedata><tw-passagedata pid="556" name="Senior Citizen Apt Hub" tags="" position="16274,368" size="100,100">[[Talk to an elderly woman sitting on a park bench, holding a pet bird on her lap.]]
[[Talk to an older couple near the entrance, who look anxious to get inside.]] 
[[Talk to the building manager.]]
[[Talk to the electrical worker.]]
[[Call Twin Lakes Fire Marshal.]]
[[Head to the river to interview Nora about flood relief.]]</tw-passagedata><tw-passagedata pid="557" name="Tell her you&#39;re writing this story anyway--she might as well get her two cents in." tags="" position="16571,363" size="100,100">If she was mad before, she&#39;s furious now.

&quot;Fine,&quot; she says. &quot;Here&#39;s my official statement: I&#39;ve been trying to get the building repaired for weeks. I&#39;m losing money with each day the residents don&#39;t pay their rent. All these sweet old grandmas and grandpas keep acting like I&#39;m Cruella DeVille. And I just read at the Gazette that there&#39;s ANOTHER flood on its way and the same thing&#39;s gonna happen all over again. So forgive me if I seem tense.&quot;

Whoa. That was... something. 

[[Empathize with how incredibly frustrating all of that sounds.-&gt;Tell her you understand she&#39;s in a difficult spot and you want to know how the city can help.]]
[[Tell her if she doesn&#39;t want to be treated like a monster, she probably shouldn&#39;t act like one.]]</tw-passagedata><tw-passagedata pid="558" name="Tell her you understand she&#39;s in a difficult spot and you want to know how the city can help." tags="" position="16844,308" size="100,100">The woman&#39;s face softens. &quot;You have no idea,&quot; she says. &quot;I&#39;ve been waiting weeks to get this place repaired. I have no idea when the residents will be allowed back inside.&quot;

[[&quot;Have you done anything to help the residents?&quot;]]
[[&quot;Can you tell me why it&#39;s taking so long?&quot;]]</tw-passagedata><tw-passagedata pid="559" name="Tell her if she doesn&#39;t want to be treated like a monster, she probably shouldn&#39;t act like one." tags="" position="16839,174" size="100,100">The woman&#39;s eyes flash. &quot;Get off my property,&quot; she says. &quot;Now. This is harassment. You&#39;re lucky I haven&#39;t already called security.&quot;

</tw-passagedata><tw-passagedata pid="560" name="&quot;Have you done anything to help the residents?&quot;" tags="" position="17006,411" size="100,100">&quot;Of course I have,&quot; she says. &quot;What did they tell you?&quot;

&quot;Just that the situation has been... challenging.&quot;

&quot;We gave them $300,&quot; she says. &quot;It was the most we could offer. We told them they could stop paying rent for as long as this goes on. We paid for taxi rides to hotels. What more do these people want from me?&quot;

[[&quot;Can you tell me why it&#39;s taking so long to get people moved back in?&quot;-&gt;&quot;Can you tell me why it&#39;s taking so long?&quot;]]
[[&quot;Was $300 the most you could offer? That&#39;s not much, compared to the cost of hotels.&quot;]]</tw-passagedata><tw-passagedata pid="561" name="&quot;Can you tell me why it&#39;s taking so long?&quot;" tags="" position="17001,288" size="100,100">&quot;I don&#39;t know all the technical stuff,&quot; she says. &quot;But the fire marshal said it&#39;s not safe. And they&#39;ve been so busy with other damaged properties--I guess it&#39;s taking a while to get to us.&quot;

[[&quot;Have you done anything to help the residents?&quot;]]
[[&quot;How would you respond to residents who say that you haven&#39;t been keeping them informed?&quot;]]</tw-passagedata><tw-passagedata pid="562" name="&quot;Was $300 the most you could offer? That&#39;s not much, compared to the cost of hotels.&quot;" tags="" position="17154,409" size="100,100">She bristles at that. &quot;Well, there&#39;s a free shelter now,&quot; she says. &quot;What else am I supposed to do? That&#39;s the most that the central business office woudl let me give them. I&#39;m not in charge here.&quot;</tw-passagedata><tw-passagedata pid="563" name="&quot;How would you respond to residents who say that you haven&#39;t been keeping them informed?&quot;" tags="" position="17149,284" size="100,100">She rubs her tired eyes. &quot;Look,&quot; she says. &quot;My basement at home flooded too. Three feet of water. I&#39;m exhausted. No, I haven&#39;t been calling each person individually, but I&#39;m posting updates on the building website. They should just check there. Now, if you&#39;ll excuse me...&quot;

[[&quot;Did you consider that elderly people staying at motels, with all their belongings left behind, might not have internet access?&quot;]]
[[&quot;Is there anything else you want to tell me?&quot;]]</tw-passagedata><tw-passagedata pid="564" name="&quot;Did you consider that elderly people staying at motels, with all their belongings left behind, might not have internet access?&quot;" tags="" position="17284,353" size="100,100">&quot;No comment,&quot; she says flatly. &quot;I really need to get back to work.&quot;

She storms away before you can thank her.

[[Plan your next move.-&gt;Senior Citizen Apt Hub]]</tw-passagedata><tw-passagedata pid="565" name="&quot;Is there anything else you want to tell me?&quot;" tags="" position="17282,229" size="100,100">She sighs. &quot;Just that we&#39;re doing our best, and that if the city has any financial aid to give out, these people could sure use it.&quot;

[[Thank her for her time.-&gt;Senior Citizen Apt Hub]]</tw-passagedata><tw-passagedata pid="566" name="&quot;Can you tell me what you&#39;re working on?&quot;" tags="" position="16422,218" size="100,100">&quot;Interviews aren&#39;t my job,&quot; he says, his voice friendly, but also firm. &quot;I&#39;ve got three more jobs this afternoon and I still need to sandbag my own house.&quot;

&quot;Do you know who else I could talk to?&quot;

He thinks about it. &quot;You can call the building inspector who referred me, if you want.&quot;

//Get building inspector contact info//

&quot;Thanks,&quot; you say, as he disappears inside.

[[Call building inspector]]</tw-passagedata><tw-passagedata pid="567" name="Call building inspector" tags="" position="16557,219" size="100,100">Like almost everybody else you&#39;ve talked to today, the building inspector sounds rushed and stressed out. 

&quot;I&#39;d be happy to help,&quot; they tell you. &quot;Only got a few minutes, though. What do you need to know?&quot;

[[&quot;Can you tell me more about your job entails?&quot;]]
[[&quot;Can you give me a summary of the situation at Picnic Place Apartments?&quot;]]
</tw-passagedata><tw-passagedata pid="568" name="Call Twin Lakes Fire Marshal." tags="" position="16587,488" size="100,100">The fire marshal picks up on the second ring. &quot;Hello?&quot;

Oops... you must&#39;ve called the wrong number. It&#39;s Khalisa&#39;s dad, Joe Bridges.

&quot;Sorry to bother you, Joe,&quot; you say, &quot;meant to call the Fire Marshal.&quot;

&quot;Oh, that&#39;s me! Didn&#39;t I ever tell you that? How&#39;d breakfast go, by the way? Khali said I should leave you alone, but you know how I am. Nosy as an anteater.&quot;

[[&quot;Um... wait a sec. You&#39;re the Twin Lakes Fire Marshal?? Seriously?&quot;]]

&quot;</tw-passagedata><tw-passagedata pid="569" name="&quot;Can you tell me more about your job entails?&quot;" tags="" position="16684,214" size="100,100">They chuckle. &quot;Really? You couldn&#39;t just google it? Okay, well, my job is basically to inspect buildings and construction projects. I make sure they&#39;re up to code and that things are safe and structurally sound.&quot;

You try to ask another question but they clear their throat. &quot;Sorry, kid, don&#39;t mean to cut you off, but I&#39;ve got an emergency call from downtown. Good luck with your story! I&#39;m a big fan of your work.&quot;

They hang up, before you can get a single word in.

[[Plan your next move.-&gt;Senior Citizen Apt Hub]]</tw-passagedata><tw-passagedata pid="570" name="&quot;Can you give me a summary of the situation at Picnic Place Apartments?&quot;" tags="" position="16684,78" size="100,100">&quot;Sure,&quot; they say. &quot;I&#39;ll pull up my notes here.... yeah, it looks like there were a lot of issues. The electrical panel ended up submerged in water, none of the elevators work, and the fire panel is inoperable. That means no alarms or sprinklers in case of a fire. Until those things are fixed, I can&#39;t see any way to get those people moved in back in safely.&quot;

You try to ask another question, but they cut you off. &quot;Sorry, kid. Getting an emergency call from downtown. Good luck with your story. It was an honor to chat with you!&quot;

He hangs up. You&#39;re relieved--you got all the info you needed, just in time.

[[Plan your next move-&gt;Senior Citizen Apt Hub]]</tw-passagedata><tw-passagedata pid="571" name="&quot;Um... wait a sec. You&#39;re the Twin Lakes Fire Marshal?? Seriously?&quot;" tags="" position="16719,490" size="100,100">&quot;I speak the truth,&quot; he says cheerfully. &quot;What do you need to know, kiddo?&quot;

[[&quot;I&#39;m investigating the situation at Picnic Place Apartments. Can you tell me what you know?&quot;]]</tw-passagedata><tw-passagedata pid="572" name="&quot;I&#39;m investigating the situation at Picnic Place Apartments. Can you tell me what you know?&quot;" tags="" position="16849,488" size="100,100">&quot;Ooh, yeah, that was a bad one,&quot; he says. &quot;Can&#39;t believe those poor people are still out of a home, but the fire panel was totally down. No sprinkler systems or smoke detcters functioning.

[[&quot;Did you get the sense that the building manager was handling it well?&quot;]]
[[&quot;Do you have any suggestions for how to get these people back into their homes faster?&quot;]]</tw-passagedata><tw-passagedata pid="573" name="&quot;Did you get the sense that the building manager was handling it well?&quot;" tags="" position="17182,578" size="100,100">&quot;Not sure if I can comment on that,&quot; he says. &quot;But I can say that she hasn&#39;t called me again in more than two weeks. I don&#39;t have any fire panel inspection scheduled.&quot;

[[&quot;Do you have any suggestions for how to get these people back into their homes faster?&quot;]]
[[Thank him for his help.]]</tw-passagedata><tw-passagedata pid="574" name="&quot;Do you have any suggestions for how to get these people back into their homes faster?&quot;" tags="" position="17029,573" size="100,100">&quot;Actually, I might be able to suggest something,&quot; he says. &quot;I believe the city would allow for a &#39;fire watch&#39;--in other words, the building could hire someone to patrol the building continuously and monitor for fires. Or a few someones, because, you know, lunch breaks. Bathroom breaks. Let&#39;s not be unreasonable.&quot;

&quot;Did you get the sense that the building manager was handling it well?&quot;
[[Thank him for his help.]]</tw-passagedata><tw-passagedata pid="575" name="Thank him for his help." tags="" position="17317,574" size="100,100">&quot;Oh, not a problem,&quot; he says cheerfully. &quot;You should come around for dinner on Thursday. You haven&#39;t tasted my wife&#39;s cherry pie!&quot;

[[&quot;Thanks, Joe. I&#39;d love to. If, you know, the whole town isn&#39;t underwater.&quot;]]</tw-passagedata><tw-passagedata pid="576" name="&quot;Thanks, Joe. I&#39;d love to. If, you know, the whole town isn&#39;t underwater.&quot;" tags="" position="17447,573" size="100,100">&quot;I&#39;ve got a flood rescue vehicle,&quot; he reminds you. &quot;I bet we could work it out. And good luck with your story!&quot;

[[Decide on your next move.-&gt;Senior Citizen Apt Hub]]
</tw-passagedata><tw-passagedata pid="577" name="Ask if they&#39;d like an extra set of hands." tags="" position="16439,638" size="100,100">(if: $social &gt;6)[Her husband looks doubtful about inviting a stranger inside his home, but the woman pats his arm. 

&quot;Don&#39;t you know who this is, Ray? You&#39;re talking to the new reporter from--&quot; Her voice hushes. &quot;--New York City! I&#39;ve heard all about her from Maureen, Sophia, Imojean...&quot;

&quot;You know all of them?&quot; you ask, startled.

&quot;We&#39;re in a book club together,&quot; she says. &quot;You should join us next time, Dear!&quot;

[[Follow them inside.]]</tw-passagedata><tw-passagedata pid="578" name="Follow them inside." tags="" position="16589,636" size="100,100">The lobby is full of chairs and rugs and couches in various floral patterns. 

Thanks to your new friends, you get a great view of the water-damaged hallway carpets and Out of Order elevators. 

You snap a few pictures, then help the couple carry out some of their belongings.

//Get apartment building photos//

[[Plan your next step.-&gt;Senior Citizen Apt Hub]]
</tw-passagedata><tw-passagedata pid="579" name="&quot;Why wasn&#39;t this all planned out ahead of time?&quot;" tags="" position="14633,271" size="100,100">&quot;I&#39;m not sure,&quot; she says. &quot;I think the city has had its hands full with flood recovery. They created rushed plans for a shelter without considering accessiblity. And now here we are.&quot;

[[Ask about the situation with the man and dog who were just turned away.]]</tw-passagedata><tw-passagedata pid="580" name="Ask her how the city is preparing for the approaching storm." tags="" position="14905,1056" size="100,100">&quot;We&#39;ve got sandbagging stations set up in the most at-risk neighborhoods, according to the government flood risk map,&quot; she says. &quot;People can feel free to show up and take whatever they need.&quot;

You&#39;re about to ask another question when a thirty-something Black woman next to you chimes in.

&quot;Couldn&#39;t help overhearing,&quot; she says. &quot;There&#39;s no sandbag station in my neighborhood. And we got hit hard last time.&quot;

[[Ask her where she lives and what the situation is there.]]</tw-passagedata><tw-passagedata pid="581" name="Ask her where she lives and what the situation is there." tags="" position="14855,1222" size="100,100">&quot;I own a house in the Royal Hazel neighborhood,&quot; she says. &quot;Last time, the streets flooded and our basement filled up with two feet of water. I&#39;m a nursing assistant at the Royal Hazel Medical Center, and I can&#39;t get enough time off to deal with the damage.&quot; 

[[Ask the city worker if there are plans to put a sandbag station in the Royal Hazel neighborhood.]]
[[Ask the nurse if her neighborhood is listed as an evacuation zone.]]</tw-passagedata><tw-passagedata pid="582" name="Ask the city worker if there are plans to put a sandbag station in the Royal Hazel neighborhood." tags="" position="14772,1372" size="100,100">&quot;No, but sounds like there should be,&quot; she says. &quot;I&#39;ll call headquarters and see if we can get one set up. According to the flood-risk maps, that neighborhood shouldn&#39;t have been affected.&quot;

The nurse sighs. &quot;Well, looks like the neighborhood didn&#39;t get the memo.&quot;

[[Ask the city worker if the flood risk maps have been updated recently.]]
[[Ask the nurse what she needs to prepare for the flood.]]</tw-passagedata><tw-passagedata pid="583" name="Ask the nurse if her neighborhood is listed as an evacuation zone." tags="" position="14930,1372" size="100,100">&quot;No,&quot; she says, &quot;but I&#39;m not sure I trust those maps anymore. Here, take a look.&quot;

She holds up her phone and shows you a screenshot comparison of two flood maps from three weeks ago.

The city&#39;s flood risk map--which shows the most likely area at risk--shows Royal Hazel in a safe zone.

The live flood map--showing ACTUAL flooding--shows Royal Hazel covered in water.

[[Ask the city worker if the flood risk maps have been updated recently.]]
</tw-passagedata><tw-passagedata pid="584" name="Ask the city worker if the flood risk maps have been updated recently." tags="" position="14925,1522" size="100,100">&quot;I&#39;m not sure,&quot; she says. &quot;You&#39;d have to talk to our DNR person in charge of water monitoring. And I know somebody who lives by the lakeshore who&#39;s an expert in future flood projections. I can give you their information.&quot;

[[&quot;Thanks. That would be great.&quot;-&gt;Sandbag Station: Hub]]</tw-passagedata><tw-passagedata pid="585" name="Ask the nurse what she needs to prepare for the flood." tags="" position="14762,1517" size="100,100">&quot;We need help right in our neighborhood,&quot; she says. &quot;My car was destroyed during the flood, so I&#39;ve been hustling back and forth on the bus, carrying sandbags one at a time. And we need updated flood risk maps, because obviously the ones we&#39;ve got aren&#39;t accurate.&quot;

[[Ask the city worker if the flood risk maps have been updated recently.]]




</tw-passagedata><tw-passagedata pid="586" name="Sandbag Station: Hub" tags="" position="15150,1464" size="100,100">You&#39;ve got some leads. Time to choose your next move.

[[Call the DNR about out-of-date flood maps.]]
[[Visit flood projection expert, Nora Rhodes.]]
[[Offer the nurse a ride back to her neighborhood and check out the situation there.]]</tw-passagedata><tw-passagedata pid="587" name="Call the DNR about out-of-date flood maps." tags="" position="15293,1467" size="100,100">It takes a few minutes to reach the right person, but you finally get connected with the person in charge of monitoring at-risk areas.

As soon as he hears why you&#39;re calling, he agrees to talk.

&quot;We need to make the city aware of this issue,&quot; he says. &quot;What do you need to know?&quot;

[[&quot;Is it true that the flood risk maps are outdated?&quot;]]</tw-passagedata><tw-passagedata pid="588" name="Offer the nurse a ride back to her neighborhood and check out the situation there." tags="" position="15293,1281" size="100,100">The nurse gratefully accepts. She&#39;s had enough of lugging sandbags on and off the bus.

(if: $endurance &gt;6)[You help her load as many sandbag as you can fit into your trunk. 

She thanks you, but it&#39;s still clearly not enough to protect an entire household. One person isn&#39;t going to be able to solve this. It&#39;ll take government action to help.](else:)[You try to help her load up sandbags, but somehow they feel even heavier than last time.

She smiles at your sheepish expression. &quot;It&#39;s okay, Honey. I&#39;m turning patients and doing hoyer lifts five days a week. I&#39;m sure you&#39;ve got plenty of other skills.&quot;]

[[Arrive at Royal Hazel neighborhood.]]</tw-passagedata><tw-passagedata pid="589" name="&quot;Is it true that the flood risk maps are outdated?&quot;" tags="" position="15300,1614" size="100,100">&quot;&#39;Fraid so,&quot; he says. &quot;The official government maps are based on old data. My team is trying to create more accurate local maps, but it&#39;s a big project.&quot;

[[&quot;How did the maps end up so outdated?&quot;]]
[[&quot;If the maps are outdated, how do people know if they need to evacuate?&quot;]]</tw-passagedata><tw-passagedata pid="590" name="&quot;How did the maps end up so outdated?&quot;" tags="" position="15213,1764" size="100,100">&quot;Climate change is a big part of it,&quot; he says. &quot;The maps were built with rainfall data from more than a decade ago. Thing are changing fast around here. More rainfall and higher lakes has made the at-risk zones a lot larger.&quot;

[[&quot;If the maps are outdated, how do people know if they need to evacuate?&quot;]]
[[&quot;How can people in the Royal Hazel neighborhood stay safe?&quot;]]</tw-passagedata><tw-passagedata pid="591" name="&quot;If the maps are outdated, how do people know if they need to evacuate?&quot;" tags="" position="15382,1767" size="100,100">&quot;We used our latest data from last week&#39;s flood to figure out the evacuation zones,&quot; he says. &quot;The Royal Hazel neighborhood should be safe from real danger. But judging from our live maps, it&#39;s probably at risk for more flood damage.&quot;

[[&quot;How did the maps end up so outdated?&quot;]]
[[&quot;How can people in the Royal Hazel neighborhood stay safe?&quot;]]</tw-passagedata><tw-passagedata pid="592" name="&quot;How can people in the Royal Hazel neighborhood stay safe?&quot;" tags="" position="15498,1909" size="100,100">&quot;Pretty much the same advice,&quot; he says. &quot;Sandbag properties. Move anything valuable out of the basement. Stay off the roads.&quot; 

You want to ask him about people who--just for example--are required to be at work and can&#39;t stay off the roads. Or bring up the fact that the Royal Hazel neighborhood doesnt currently have a sandbag station.

But you hear a loud beep, and notice your phone battery hovering at 3%.

&quot;Uh oh.&quot; 

(if: $techie &gt;7)[Thankfully, you came prepared! You dig into your bag for your wireless charger. Just in time.

[[&quot;Are you aware that the neighborhood doesn&#39;t have a sandbag station?&quot;]]
[[&quot;How would you advise people who can&#39;t stay off the roads, because they need to work?&quot;]]](else:)[You dig into your backback for tech gear, but looks like you forgot your wireless charger.

Before you can say another word, your phone goes black.

Ugh. Rookie mistake. 

[[Find somewhere to charge your phone.]]]</tw-passagedata><tw-passagedata pid="593" name="&quot;Are you aware that the neighborhood doesn&#39;t have a sandbag station?&quot;" tags="" position="15412,2066" size="100,100">&quot;Yes,&quot; he says, &quot;I just got a text from my coworker at the high school station. I&#39;m hoping we can get something set up out there. It&#39;s next on our list.&quot;

[[Thank him for the interview.-&gt;Sandbag Station: Hub]]</tw-passagedata><tw-passagedata pid="594" name="&quot;How would you advise people who can&#39;t stay off the roads, because they need to work?&quot;" tags="" position="15578,2067" size="100,100">&quot;That&#39;s not an easy question,&quot; he says. &quot;I&#39;m not sure I have an answer for you. I guess I would say that city hall needs to do something about this, to make sure people can stay safe.&quot;

Your editor was talking for equity issue. Looks like you found one.

[[Thank him for the interview.-&gt;Sandbag Station: Hub]]

</tw-passagedata><tw-passagedata pid="595" name="Find somewhere to charge your phone." tags="" position="15163,2059" size="100,100">You head inside the high school. Luckily, there&#39;s an open outlet in the main hallway.

Unfortunately, this little break wastes you 15 minutes. By the time you call the DNR back, the expert you were talking to is out of the office. 

At least you&#39;re up to 20% battery. It&#39;ll have to do. 

[[Plan your next move.-&gt;Sandbag Station: Hub]]</tw-passagedata><tw-passagedata pid="596" name="Arrive at Royal Hazel neighborhood." tags="" position="15680,1282" size="100,100">You help the nurse unload her sandbag, then take a look around. 

Compared to your own neighborhood, which has mostly recovered, Royal Hazel is looking rough around the edges. The tree branches and debris piled along the sidewalks still haven&#39;t been picked up by the city. 

A dad and a teenage boy are lugging damaged furniture and rolled-up carpets to the curb, while a few people stack sandbags in front of their house. 

Everyone here (except for you) is Black and glancing at you with confusion, like maybe you&#39;ve wandered into the wrong neighborhood, or are about to start handing out pamphlets. You have a feeling whatever trust points you&#39;ve gained won&#39;t translate the same way here. 

[[Call Khalisa and ask if she has time to join you.]]
[[Start talking to people and hope for the best.]]</tw-passagedata><tw-passagedata pid="597" name="Call Khalisa and ask if she has time to join you." tags="" position="15677,1557" size="100,100">Khalisa has just finished her breaking news article! &quot;I&#39;d love to,&quot; she says. &quot;I&#39;ll meet you out there.&quot;

It takes extra time to wait for her, but you have a feeling you need her voice and her expertise here. 

[[Greet Khalisa when she drives up.]]</tw-passagedata><tw-passagedata pid="598" name="Start talking to people and hope for the best." tags="" position="15798,1127" size="100,100">You knock at a few doors, your press badge ready. 

You hear rustling sounds inside, but nobody answers--totally understandable. You tend to hide behind furniture and play dead when somebody you don&#39;t know buzzes your apartment. 

At the fourth house, a elementary-age girl opens the door. &quot;Hi,&quot; she says. &quot;Who&#39;re you?&quot;

The her mom comes over, wearing rubber gloves and a dust mask. &quot;Sorry,&quot; she says. &quot;Whatver you&#39;re selling, it&#39;s not a good time. We&#39;re in damage control mode here.&quot;

[[&quot;Actually, that&#39;s why I&#39;m here. I&#39;m a reporter with the Gazette, reporting on how the flood has affected the neighborhood.&quot;]]

</tw-passagedata><tw-passagedata pid="599" name="&quot;Actually, that&#39;s why I&#39;m here. I&#39;m a reporter with the Gazette, reporting on how the flood has affected the neighborhood.&quot;" tags="" position="15925,1117" size="100,100">The woman considers this. &quot;Okay. I can answer a couple a&#39; questions. Then I better get back to work.&quot;

[[&quot;Can you tell me about the biggest problem the neighborhood is facing?&quot;]]</tw-passagedata><tw-passagedata pid="600" name="&quot;Can you tell me about the biggest problem the neighborhood is facing?&quot;" tags="" position="15923,1256" size="100,100">&quot;Just one?&quot; she says dryly. &quot;Let&#39;s see. The debris in the street that&#39;ll clog up the storm drains when the next storm comes. The nearest sandbagging station located ten blocks away. The fact that it&#39;s taken three weeks for somebody from the paper to get out here.&quot;

Ouch.  

&quot;Um... yeah, you&#39;re right,&quot; you say, wishing Fred Finkler was around to offer some locally-grown aloe vera for that burn. &quot;We should&#39;ve come out here sooner.&quot;

&quot;I understand there&#39;s been a lot going on,&quot; the woman says. &quot;But you might&#39;ve noticed that there&#39;s been a lot of attention on downtown. Businesses, shops, the festival, things like that. Nobody was really taking notice of what was going on out here.&quot;

[[Ask her how the flood has affected her family.]]
[[Ask if she had any warning that her home was in a flood zone.]]</tw-passagedata><tw-passagedata pid="601" name="Ask her how the flood has affected her family." tags="" position="16048,1252" size="100,100">&quot;I&#39;ve been working my usual shifts all week, because I don&#39;t get paid sick leave,&quot; she says. &quot;It&#39;s the only way to keep up with bills. But that means the damage in the basement has gotten worse. It&#39;s a mess down there. I&#39;m worried about mold. I want to keep my kids healthy, but we also have to make our mortgage payments.&quot;

[[Ask if she&#39;d be okay with you taking photos of the water damage.]]</tw-passagedata><tw-passagedata pid="602" name="Ask if she had any warning that her home was in a flood zone." tags="" position="16055,1117" size="100,100">&quot;None,&quot; she says. &quot;I did my research when we moved in. I was told that this house wasn&#39;t in any danger, and that we didn&#39;t need flood insurance. Funny, huh?&quot;

[[Ask if she&#39;d be okay with you taking photos of the water damage.]]</tw-passagedata><tw-passagedata pid="603" name="Ask if she&#39;d be okay with you taking photos of the water damage." tags="" position="16205,1206" size="100,100">&quot;Sorry, honey,&quot; she says. &quot;I don&#39;t even know you. And I&#39;ve got work in an hour. You better head out.&quot;

[[Thank her for talking.-&gt;Royal Hazel Neighborhood: Hub]]</tw-passagedata><tw-passagedata pid="604" name="Greet Khalisa when she drives up." tags="" position="15818,1561" size="100,100">&quot;Hey, Rookie,&quot; she says. &quot;You know, you might want to think about officially changing your last name.&quot;

You laugh. &quot;Maybe someday, when there&#39;s not a huge storm headed our way.&quot;

Already, the sky is cloudy and darkening. 

[[Knock at the first door.]]
</tw-passagedata><tw-passagedata pid="605" name="Knock at the first door." tags="" position="15958,1561" size="100,100">The door swings open, revealing an elderly man with a walker. Behind him, the dad and teenage boy from earlier are carrying a trombone case and a piano keyboard up from the basement. 

&quot;How can I help you?&quot; the man says politely, looking from you to Khalisa.

&quot;We&#39;re from the Gazette,&quot; Khalisa says. &quot;This is my friend, Ella Rookie. She&#39;s new around here. Can we talk with you for a few minutes?&quot;

&quot;I suppose so. How can I help you two?&quot;

[[Ask the elderly man what would help him prepare for the next storm.]]</tw-passagedata><tw-passagedata pid="606" name="Ask the elderly man what would help him prepare for the next storm." tags="" position="15958,1699" size="100,100">&quot;My neighbors already got it covered,&quot; he says, pointing to the father-son duo walking past. &quot;They&#39;ve been clearing out the basement. I&#39;ve played in a lot of bands over the years, and fortunately most of my instruments could be salvaged. I just hope this place doesn&#39;t flood again.&quot;

[[&quot;Is there anything you feel the neighborhood needs?&quot;]]</tw-passagedata><tw-passagedata pid="607" name="&quot;Is there anything you feel the neighborhood needs?&quot;" tags="" position="15958,1839" size="100,100">&quot;There are a lot of working and single-parent families out here,&quot; he says. &quot;And older folks, like me. We could use more helpers out here. My neighbors here can&#39;t do everything on their own.&quot;

&quot;Sure we can, Dez,&quot; the dad says, grinning. &quot;Don&#39;t worry. Just go put your feet up.&quot;

[[Thank Dezi for his help and head back outside.]]</tw-passagedata><tw-passagedata pid="608" name="Thank Dezi for his help and head back outside." tags="" position="16103,1562" size="100,100">You knock at the next house, a red-brick bungalow.

You see the curtains rustle. Then a woman opens the door, a little girl hugging her legs.

&quot;Khalisa,&quot; she says, &quot;my God, is that you? And who&#39;s your friend? Come on in!&quot;

[[Receive a warm welcome--and a slice of cake.]]</tw-passagedata><tw-passagedata pid="609" name="Receive a warm welcome--and a slice of cake." tags="" position="16230,1562" size="100,100">You find yourself feeling extremely glad that you called Khalisa. Turns out the woman, Misty, used to volunteer at the cherry festival with Khalisa&#39;s mom.

You end up at the table with her three kids--plus a glass of milk and a slice of cherry cheesecake. 

&quot;We&#39;re clearing out the fridge,&quot; the woman explains. &quot;Lost power last time--don&#39;t want to risk losing a buch of food again. What can I do for you two?&quot;

[[Tell her about the story you&#39;re writing.]] </tw-passagedata><tw-passagedata pid="610" name="Tell her about the story you&#39;re writing." tags="" position="16228,1712" size="100,100">&quot;I&#39;m writing a story about how the city can help people before the next flood hits,&quot; you say. &quot;Can you tell us about the situation in your neighborhood?&quot; 

&quot;It&#39;s been a disaster,&quot; she says. &quot;That mess in the street is gonna block the storm drains. Nobody has had time to recover from last time. And with all the attention on downtown, it feels like nobody has really noticed.&quot;

[[&quot;What would be the most helpful for you?&quot;]]</tw-passagedata><tw-passagedata pid="611" name="&quot;What would be the most helpful for you?&quot;" tags="" position="16227,1856" size="100,100">&quot;Honestly?&quot; she says. &quot;Money. Disaster aid, I mean. I can&#39;t get enough time off work to deal with the damaage, and I don&#39;t have thousands of dollars laying around for repairs. But I know that&#39;s not gonna happen. I&#39;d settle with being on the city&#39;s radar. We need sandbags here in the neighborhood. And some volunteers to help stack them up for families and elderly folks.&quot;

[[Ask if she&#39;d be okay with you taking photos of the water damage in her basement.]]</tw-passagedata><tw-passagedata pid="612" name="Ask if she&#39;d be okay with you taking photos of the water damage in her basement." tags="" position="16227,2006" size="100,100">&quot;Of course,&quot; she says. &quot;I trust you, Honey. Especially if you&#39;re with Khalisa. Glad you both found somebody special.&quot; 

&quot;Oh--um, we&#39;re not--I mean, I don&#39;t think--&quot; 

You trail off, not sure what to say, and Khalisa laughs.

&quot;How about thoe photos, Rookie?&quot;

//Get photos of flood damaged basement//

[[Go back outside.-&gt;Royal Hazel Neighborhood: Hub]]</tw-passagedata><tw-passagedata pid="613" name="Royal Hazel Neighborhood: Hub" tags="" position="15680,1404" size="100,100">Looks like you have some time left. Do you want to make any phone calls before your deadline?

[[Visit flood projection expert, Nora Rhodes.]]
[[Call the DNR about out-of-date flood maps.]]
[[Call the mayor&#39;s office to ask about disaster aid payments for Twin Lakesians.]]</tw-passagedata><tw-passagedata pid="614" name="Call the mayor&#39;s office to ask about disaster aid payments for Twin Lakesians." tags="" position="16435,1412" size="100,100">Still need to write this part! (Ran out of time.) Talk to the mayor or city representative about the possibility for payments to individuals to help them recover from the disaster (like with covid stimulus package). 

[[Hang up.-&gt;Royal Hazel Neighborhood: Hub]]</tw-passagedata><tw-passagedata pid="615" name="Visit flood projection expert, Nora Rhodes." tags="" position="14355,1799" size="100,100">You follow the directions that the city official gave you.

But when you reach the lakeshore, you don&#39;t see any blue houses--only Nora&#39;s Arc, bobbing a few meters off shore.

&quot;Hello there, Dear!&quot; she calls from across the water, sipping tea from an enormous cat-shaped mug. &quot;Come back to talk?&quot;

[[Try to get rid of her.-&gt;Try to get rid of her2]]</tw-passagedata><tw-passagedata pid="616" name="&quot;Can you share her contact information?&quot;" tags="" position="17026,1078" size="100,100">&quot;Of course! Her name is Nora, and she lives down by the river. Bright blue place. You can&#39;t miss it!&quot;

[[Thank her for her help.-&gt;Senior Citizen Apt Hub]]</tw-passagedata><tw-passagedata pid="617" name="Head to the river to interview Nora about flood relief." tags="" position="15227,856" size="100,100">You follow the directions that the woman gave you. The place is only a few blocks away.

When you reach the river, you don&#39;t see any blue houses--only the houseboat lady&#39;s blue-painted boat, bobbing on the river.

&quot;Hello there, Dear!&quot; she calls from across the water, a cat resting on her arm. &quot;Come back to talk?&quot;

[[Try to get rid of her.]]</tw-passagedata><tw-passagedata pid="618" name="Board the houseboat." tags="" position="15497,856" size="100,100">You&#39;re amazed at what you find. A bed and armchair, a small kitchen space with a microwave and hot plate, lacy curtains...and yes, lots and lots of cat hair.

&quot;Sorry,&quot; she says cheerfully, &quot;they shed a lot in the summer. How can I help you?&quot;

[[&quot;How...how did you end up here?&quot;]]</tw-passagedata><tw-passagedata pid="619" name="&quot;How...how did you end up here?&quot;" tags="" position="15632,855" size="100,100">&quot;On my houseboat?&quot; she says. &quot;It&#39;s quite a long story. But I suppose the simple version is that an awful flood hit Twin Lakes about a decade ago. Not as bad as this one, but it was for my neighborhood.&quot;

[[&quot;How did the flood affect you?&quot;]]</tw-passagedata><tw-passagedata pid="620" name="&quot;How did the flood affect you?&quot;" tags="" position="15758,852" size="100,100">&quot;I lost everything,&quot; she says calmly. &quot;No one warned me I might need flood insurance. My home was destroyed. I looked into shelters, but they didn&#39;t allow cats. And I couldn&#39;t part with my fur babies.&quot;

[[&quot;But why houseboats?&quot;]]</tw-passagedata><tw-passagedata pid="621" name="&quot;But why houseboats?&quot;" tags="" position="15885,852" size="100,100">&quot;I was able to find a loophole and get financial aid from the Twin Lakes government,&quot; she explains. &quot;Not enough for a home. But it was enough for my houseboat here. Now every day is an adventure!&quot; 

[[&quot;Can you tell me how people can apply for disaster aid?&quot;]]
</tw-passagedata><tw-passagedata pid="622" name="&quot;Can you tell me how people can apply for disaster aid?&quot;" tags="" position="16023,857" size="100,100">&quot;Here,&quot; she says, pulling a thick sheet of papers out from under Houseboat: Stay Afloat flyers. &quot;Read this. I offered to help people with the process, but no one was interested. People don&#39;t usually listen to me. Not like you, though, Dear. You&#39;ve been kind to me from day one.&quot;

&quot;Um...&quot; You&#39;re definitely feeling more than a little awkward. &quot;Thank you so much, Nora. I appreciate your help.&quot;

&quot;Of course, Dear. Stop by anytime.&quot;

[[Return to the senior citizen apartments.-&gt;Senior Citizen Apt Hub]]</tw-passagedata><tw-passagedata pid="623" name="Try to get rid of her." tags="" position="15366,856" size="100,100">&quot;No, sorry,&quot; you say, distracted. &quot;I&#39;m looking for an expert named Nora--&quot;

That&#39;s when you make the connection. Holy cherries jubilee. 

[[Board the houseboat.]]</tw-passagedata><tw-passagedata pid="624" name="Try to get rid of her2" tags="" position="14493,1802" size="100,100">&quot;No, sorry,&quot; you say, distracted. &quot;I&#39;m looking for an expert named Nora--&quot;

That&#39;s when you make the connection. Holy cherry-glazed donut. 

[[Board the houseboat.-&gt;Board the houseboat2]]</tw-passagedata><tw-passagedata pid="625" name="Board the houseboat2" tags="" position="14628,1799" size="100,100">You&#39;re amazed at what you find. A bed and armchair, a small kitchen space with a microwave and hot plate, lacy curtains...and a lint roller covered in cat hair.

&quot;I heared about the storm,&quot; she says cheerfully. &quot;You&#39;re welcome to stay here, if you&#39;d like.&quot;

[[&quot;How did you end up here, Nora?&quot;]]</tw-passagedata><tw-passagedata pid="626" name="&quot;How did you end up here, Nora?&quot;" tags="" position="14767,1797" size="100,100">&quot;On my houseboat?&quot; she says. &quot;It&#39;s quite a long story. But I suppose the simple version is that an awful flood hit Twin Lakes about a decade ago. Not as bad as this one, but it was for my neighborhood.&quot;

[[&quot;How did the flood affect you?&quot;-&gt;&quot;How did the flood affect you?&quot;2]]</tw-passagedata><tw-passagedata pid="627" name="&quot;How did the flood affect you?&quot;2" tags="" position="14765,1934" size="100,100">&quot;I lost everything,&quot; she says calmly. &quot;No one warned me I might need flood insurance. My home was destroyed. I looked into shelters, but they didn&#39;t allow cats. And I couldn&#39;t part with my fur babies.&quot;

[[&quot;But...why houseboats?&quot;]]</tw-passagedata><tw-passagedata pid="628" name="&quot;But...why houseboats?&quot;" tags="" position="14767,2057" size="100,100">&quot;I used to be a research assistant at the Department of Limnology,&quot; she says. &quot;I did the flood projections. It&#39;s true that the entire town won&#39;t end up underwater... but the flooding will get worse every year, unless the city does something about it. There&#39;s nowhere that&#39;s sure to be safe.&quot;

[[&quot;But what if you didn&#39;t need to move to a houseboat? What if the city does something to fix the problem?&quot;]]
</tw-passagedata><tw-passagedata pid="629" name="&quot;But what if you didn&#39;t need to move to a houseboat? What if the city does something to fix the problem?&quot;" tags="" position="14767,2187" size="100,100">She smiles, as though she finds your naivete charming. &quot;How likely do you think that is?&quot;

&quot;I... don&#39;t know.&quot;

&quot;Well,&quot; she says, &quot;at least out on my houseboat, I don&#39;t have to wonder. But I do hope the city of Twin Lakes surprises me. And please, Dear, come back anytime.&quot;

[[Thank Nora for her help.-&gt;Sandbag Station: Hub]]</tw-passagedata></tw-storydata>
<script title="Twine engine code" data-main="harlowe">"use strict";var _slicedToArray=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,a=!1,i=void 0;try{for(var o,s=e[Symbol.iterator]();!(r=(o=s.next()).done)&&(n.push(o.value),!t||n.length!==t);r=!0);}catch(e){a=!0,i=e}finally{try{!r&&s.return&&s.return()}finally{if(a)throw i}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function _defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _toConsumableArray(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}!function(){
/**
 * @license almond 0.3.3 Copyright jQuery Foundation and other contributors.
 * Released under MIT license, http://github.com/requirejs/almond/LICENSE
 */var requirejs,require,define,root,factory;!function(e){var t,n,r,a,i={},o={},s={},c={},u=Object.prototype.hasOwnProperty,l=[].slice,p=/\.js$/;function f(e,t){return u.call(e,t)}function d(e,t){var n,r,a,i,o,c,u,l,f,d,h,y=t&&t.split("/"),m=s.map,g=m&&m["*"]||{};if(e){for(o=(e=e.split("/")).length-1,s.nodeIdCompat&&p.test(e[o])&&(e[o]=e[o].replace(p,"")),"."===e[0].charAt(0)&&y&&(e=y.slice(0,y.length-1).concat(e)),f=0;f<e.length;f++)if("."===(h=e[f]))e.splice(f,1),f-=1;else if(".."===h){if(0===f||1===f&&".."===e[2]||".."===e[f-1])continue;f>0&&(e.splice(f-1,2),f-=2)}e=e.join("/")}if((y||g)&&m){for(f=(n=e.split("/")).length;f>0;f-=1){if(r=n.slice(0,f).join("/"),y)for(d=y.length;d>0;d-=1)if((a=m[y.slice(0,d).join("/")])&&(a=a[r])){i=a,c=f;break}if(i)break;!u&&g&&g[r]&&(u=g[r],l=f)}!i&&u&&(i=u,c=l),i&&(n.splice(0,c,i),e=n.join("/"))}return e}function h(t,r){return function(){var a=l.call(arguments,0);return"string"!=typeof a[0]&&1===a.length&&a.push(null),n.apply(e,a.concat([t,r]))}}function y(e){return function(t){i[e]=t}}function m(n){if(f(o,n)){var r=o[n];delete o[n],c[n]=!0,t.apply(e,r)}if(!f(i,n)&&!f(c,n))throw new Error("No "+n);return i[n]}function g(e){var t,n=e?e.indexOf("!"):-1;return n>-1&&(t=e.substring(0,n),e=e.substring(n+1,e.length)),[t,e]}function v(e){return e?g(e):[]}r=function(e,t){var n,r,a=g(e),i=a[0],o=t[1];return e=a[1],i&&(n=m(i=d(i,o))),i?e=n&&n.normalize?n.normalize(e,(r=o,function(e){return d(e,r)})):d(e,o):(i=(a=g(e=d(e,o)))[0],e=a[1],i&&(n=m(i))),{f:i?i+"!"+e:e,n:e,pr:i,p:n}},a={require:function(e){return h(e)},exports:function(e){var t=i[e];return void 0!==t?t:i[e]={}},module:function(e){return{id:e,uri:"",exports:i[e],config:function(e){return function(){return s&&s.config&&s.config[e]||{}}}(e)}}},t=function(t,n,s,u){var l,p,d,g,b,w,T,S=[],x=void 0===s?"undefined":_typeof(s);if(w=v(u=u||t),"undefined"===x||"function"===x){for(n=!n.length&&s.length?["require","exports","module"]:n,b=0;b<n.length;b+=1)if("require"===(p=(g=r(n[b],w)).f))S[b]=a.require(t);else if("exports"===p)S[b]=a.exports(t),T=!0;else if("module"===p)l=S[b]=a.module(t);else if(f(i,p)||f(o,p)||f(c,p))S[b]=m(p);else{if(!g.p)throw new Error(t+" missing "+p);g.p.load(g.n,h(u,!0),y(p),{}),S[b]=i[p]}d=s?s.apply(i[t],S):void 0,t&&(l&&l.exports!==e&&l.exports!==i[t]?i[t]=l.exports:d===e&&T||(i[t]=d))}else t&&(i[t]=s)},requirejs=require=n=function(i,o,c,u,l){if("string"==typeof i)return a[i]?a[i](o):m(r(i,v(o)).f);if(!i.splice){if((s=i).deps&&n(s.deps,s.callback),!o)return;o.splice?(i=o,o=c,c=null):i=e}return o=o||function(){},"function"==typeof c&&(c=u,u=l),u?t(e,i,o,c):setTimeout(function(){t(e,i,o,c)},4),n},n.config=function(e){return n(e)},requirejs._defined=i,(define=function(e,t,n){if("string"!=typeof e)throw new Error("See almond README: incorrect module build, no module name");t.splice||(n=t,t=[]),f(i,e)||f(o,e)||(o[e]=[e,t,n])}).amd={jQuery:!0}}(),define("almond",function(){}),
/*!
 * https://github.com/paulmillr/es6-shim
 * @license es6-shim Copyright 2013-2016 by Paul Miller (http://paulmillr.com)
 *   and contributors,  MIT License
 * es6-shim: v0.35.4
 * see https://github.com/paulmillr/es6-shim/blob/0.35.3/LICENSE
 * Details and documentation:
 * https://github.com/paulmillr/es6-shim/
 */
root=this,factory=function(){var e,t,n=Function.call.bind(Function.apply),r=Function.call.bind(Function.call),a=Array.isArray,i=Object.keys,o=function(e){try{return e(),!1}catch(e){return!0}},s=function(e){try{return e()}catch(e){return!1}},c=(e=o,function(){return!n(e,this,arguments)}),u=!!Object.defineProperty&&!o(function(){return Object.defineProperty({},"x",{get:function(){}})}),l="foo"===function(){}.name,p=Function.call.bind(Array.prototype.forEach),f=Function.call.bind(Array.prototype.reduce),d=Function.call.bind(Array.prototype.filter),h=Function.call.bind(Array.prototype.some),y=function(e,t,n,r){!r&&t in e||(u?Object.defineProperty(e,t,{configurable:!0,enumerable:!1,writable:!0,value:n}):e[t]=n)},m=function(e,t,n){p(i(t),function(r){var a=t[r];y(e,r,a,!!n)})},g=Function.call.bind(Object.prototype.toString),v="function"==typeof/abc/?function(e){return"function"==typeof e&&"[object Function]"===g(e)}:function(e){return"function"==typeof e},b=function(e,t,n){if(!u)throw new TypeError("getters require true ES5 support");Object.defineProperty(e,t,{configurable:!0,enumerable:!1,get:n})},w=function(e,t,n){if(!u)throw new TypeError("getters require true ES5 support");var r=Object.getOwnPropertyDescriptor(e,t);Object.defineProperty(n,t,{configurable:r.configurable,enumerable:r.enumerable,get:function(){return e[t]},set:function(n){e[t]=n}})},T=function(e,t,n){if(u){var r=Object.getOwnPropertyDescriptor(e,t);r.value=n,Object.defineProperty(e,t,r)}else e[t]=n},S=function(e,t,n){u?Object.defineProperty(e,t,n):"value"in n&&(e[t]=n.value)},x=function(e,t){t&&v(t.toString)&&y(e,"toString",t.toString.bind(t),!0)},k=Object.create||function(e,t){var n=function(){};n.prototype=e;var r=new n;return void 0!==t&&i(t).forEach(function(e){S(r,e,t[e])}),r},O=function(e,t){return!!Object.setPrototypeOf&&s(function(){var n=function t(n){var r=new e(n);return Object.setPrototypeOf(r,t.prototype),r};return Object.setPrototypeOf(n,e),n.prototype=k(e.prototype,{constructor:{value:n}}),t(n)})},j=function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if("undefined"!=typeof global)return global;throw new Error("unable to locate global object")}(),A=j.isFinite,C=Function.call.bind(String.prototype.indexOf),E=Function.apply.bind(Array.prototype.indexOf),_=Function.call.bind(Array.prototype.concat),N=Function.call.bind(String.prototype.slice),P=Function.call.bind(Array.prototype.push),I=Function.apply.bind(Array.prototype.push),M=Function.call.bind(Array.prototype.shift),D=Math.max,R=Math.min,L=Math.floor,q=Math.abs,F=Math.exp,V=Math.log,H=Math.sqrt,z=Function.call.bind(Object.prototype.hasOwnProperty),$=function(){},B=j.Map,W=B&&B.prototype.delete,U=B&&B.prototype.get,G=B&&B.prototype.has,X=B&&B.prototype.set,Y=j.Symbol||{},J=Y.species||"@@species",K=Number.isNaN||function(e){return e!=e},Z=Number.isFinite||function(e){return"number"==typeof e&&A(e)},Q=v(Math.sign)?Math.sign:function(e){var t=Number(e);return 0===t?t:K(t)?t:t<0?-1:1},ee=function(e){var t=Number(e);return t<-1||K(t)?NaN:0===t||t===1/0?t:-1===t?-1/0:1+t-1==0?t:t*(V(1+t)/(1+t-1))},te=function(e){return"[object Arguments]"===g(e)},ne=te(arguments)?te:function(e){return null!==e&&"object"===(void 0===e?"undefined":_typeof(e))&&"number"==typeof e.length&&e.length>=0&&"[object Array]"!==g(e)&&"[object Function]"===g(e.callee)},re=function(e){return null===e||"function"!=typeof e&&"object"!==(void 0===e?"undefined":_typeof(e))},ae=function(e){return"[object String]"===g(e)},ie=function(e){return"[object RegExp]"===g(e)},oe=function(e){return"function"==typeof j.Symbol&&"symbol"===(void 0===e?"undefined":_typeof(e))},se=function(e,t,n){var r=e[t];y(e,t,n,!0),x(e[t],r)},ce="function"==typeof Y&&"function"==typeof Y.for&&oe(Y()),ue=oe(Y.iterator)?Y.iterator:"_es6-shim iterator_";j.Set&&"function"==typeof(new j.Set)["@@iterator"]&&(ue="@@iterator"),j.Reflect||y(j,"Reflect",{},!0);var le,pe=j.Reflect,fe=String,de="undefined"!=typeof document&&document?document.all:null,he=null==de?function(e){return null==e}:function(e){return null==e&&e!==de},ye={Call:function(e,t){var r=arguments.length>2?arguments[2]:[];if(!ye.IsCallable(e))throw new TypeError(e+" is not a function");return n(e,t,r)},RequireObjectCoercible:function(e,t){if(he(e))throw new TypeError(t||"Cannot call method on "+e);return e},TypeIsObject:function(e){return null!=e&&!0!==e&&!1!==e&&("function"==typeof e||"object"===(void 0===e?"undefined":_typeof(e))||e===de)},ToObject:function(e,t){return Object(ye.RequireObjectCoercible(e,t))},IsCallable:v,IsConstructor:function(e){return ye.IsCallable(e)},ToInt32:function(e){return ye.ToNumber(e)>>0},ToUint32:function(e){return ye.ToNumber(e)>>>0},ToNumber:function(e){if("[object Symbol]"===g(e))throw new TypeError("Cannot convert a Symbol value to a number");return+e},ToInteger:function(e){var t=ye.ToNumber(e);return K(t)?0:0!==t&&Z(t)?(t>0?1:-1)*L(q(t)):t},ToLength:function(e){var t=ye.ToInteger(e);return t<=0?0:t>Number.MAX_SAFE_INTEGER?Number.MAX_SAFE_INTEGER:t},SameValue:function(e,t){return e===t?0!==e||1/e==1/t:K(e)&&K(t)},SameValueZero:function(e,t){return e===t||K(e)&&K(t)},IsIterable:function(e){return ye.TypeIsObject(e)&&(void 0!==e[ue]||ne(e))},GetIterator:function(e){if(ne(e))return new t(e,"value");var n=ye.GetMethod(e,ue);if(!ye.IsCallable(n))throw new TypeError("value is not an iterable");var r=ye.Call(n,e);if(!ye.TypeIsObject(r))throw new TypeError("bad iterator");return r},GetMethod:function(e,t){var n=ye.ToObject(e)[t];if(!he(n)){if(!ye.IsCallable(n))throw new TypeError("Method not callable: "+t);return n}},IteratorComplete:function(e){return!!e.done},IteratorClose:function(e,t){var n=ye.GetMethod(e,"return");if(void 0!==n){var r,a;try{r=ye.Call(n,e)}catch(e){a=e}if(!t){if(a)throw a;if(!ye.TypeIsObject(r))throw new TypeError("Iterator's return method returned a non-object.")}}},IteratorNext:function(e){var t=arguments.length>1?e.next(arguments[1]):e.next();if(!ye.TypeIsObject(t))throw new TypeError("bad iterator");return t},IteratorStep:function(e){var t=ye.IteratorNext(e);return!ye.IteratorComplete(t)&&t},Construct:function(e,t,n,r){var a=void 0===n?e:n;if(!r&&pe.construct)return pe.construct(e,t,a);var i=a.prototype;ye.TypeIsObject(i)||(i=Object.prototype);var o=k(i),s=ye.Call(e,o,t);return ye.TypeIsObject(s)?s:o},SpeciesConstructor:function(e,t){var n=e.constructor;if(void 0===n)return t;if(!ye.TypeIsObject(n))throw new TypeError("Bad constructor");var r=n[J];if(he(r))return t;if(!ye.IsConstructor(r))throw new TypeError("Bad @@species");return r},CreateHTML:function(e,t,n,r){var a=ye.ToString(e),i="<"+t;""!==n&&(i+=" "+n+'="'+ye.ToString(r).replace(/"/g,"&quot;")+'"');return i+">"+a+"</"+t+">"},IsRegExp:function(e){if(!ye.TypeIsObject(e))return!1;var t=e[Y.match];return void 0!==t?!!t:ie(e)},ToString:function(e){return fe(e)}};if(u&&ce){var me=function(e){if(oe(Y[e]))return Y[e];var t=Y.for("Symbol."+e);return Object.defineProperty(Y,e,{configurable:!1,enumerable:!1,writable:!1,value:t}),t};if(!oe(Y.search)){var ge=me("search"),ve=String.prototype.search;y(RegExp.prototype,ge,function(e){return ye.Call(ve,e,[this])});se(String.prototype,"search",function(e){var t=ye.RequireObjectCoercible(this);if(!he(e)){var n=ye.GetMethod(e,ge);if(void 0!==n)return ye.Call(n,e,[t])}return ye.Call(ve,t,[ye.ToString(e)])})}if(!oe(Y.replace)){var be=me("replace"),we=String.prototype.replace;y(RegExp.prototype,be,function(e,t){return ye.Call(we,e,[this,t])});se(String.prototype,"replace",function(e,t){var n=ye.RequireObjectCoercible(this);if(!he(e)){var r=ye.GetMethod(e,be);if(void 0!==r)return ye.Call(r,e,[n,t])}return ye.Call(we,n,[ye.ToString(e),t])})}if(!oe(Y.split)){var Te=me("split"),Se=String.prototype.split;y(RegExp.prototype,Te,function(e,t){return ye.Call(Se,e,[this,t])});se(String.prototype,"split",function(e,t){var n=ye.RequireObjectCoercible(this);if(!he(e)){var r=ye.GetMethod(e,Te);if(void 0!==r)return ye.Call(r,e,[n,t])}return ye.Call(Se,n,[ye.ToString(e),t])})}var xe=oe(Y.match),ke=xe&&((le={})[Y.match]=function(){return 42},42!=="a".match(le));if(!xe||ke){var Oe=me("match"),je=String.prototype.match;y(RegExp.prototype,Oe,function(e){return ye.Call(je,e,[this])});se(String.prototype,"match",function(e){var t=ye.RequireObjectCoercible(this);if(!he(e)){var n=ye.GetMethod(e,Oe);if(void 0!==n)return ye.Call(n,e,[t])}return ye.Call(je,t,[ye.ToString(e)])})}}var Ae=function(e,t,n){x(t,e),Object.setPrototypeOf&&Object.setPrototypeOf(e,t),u?p(Object.getOwnPropertyNames(e),function(r){r in $||n[r]||w(e,r,t)}):p(Object.keys(e),function(r){r in $||n[r]||(t[r]=e[r])}),t.prototype=e.prototype,T(e.prototype,"constructor",t)},Ce=function(){return this},Ee=function(e){u&&!z(e,J)&&b(e,J,Ce)},_e=function(e,t){var n=t||function(){return this};y(e,ue,n),!e[ue]&&oe(ue)&&(e[ue]=n)},Ne=function(e,t,n){if(function(e,t,n){u?Object.defineProperty(e,t,{configurable:!0,enumerable:!0,writable:!0,value:n}):e[t]=n}(e,t,n),!ye.SameValue(e[t],n))throw new TypeError("property is nonconfigurable")},Pe=function(e,t,n,r){if(!ye.TypeIsObject(e))throw new TypeError("Constructor requires `new`: "+t.name);var a=t.prototype;ye.TypeIsObject(a)||(a=n);var i=k(a);for(var o in r)if(z(r,o)){var s=r[o];y(i,o,s,!0)}return i};if(String.fromCodePoint&&1!==String.fromCodePoint.length){var Ie=String.fromCodePoint;se(String,"fromCodePoint",function(e){return ye.Call(Ie,this,arguments)})}var Me={fromCodePoint:function(e){for(var t,n=[],r=0,a=arguments.length;r<a;r++){if(t=Number(arguments[r]),!ye.SameValue(t,ye.ToInteger(t))||t<0||t>1114111)throw new RangeError("Invalid code point "+t);t<65536?P(n,String.fromCharCode(t)):(t-=65536,P(n,String.fromCharCode(55296+(t>>10))),P(n,String.fromCharCode(t%1024+56320)))}return n.join("")},raw:function(e){var t=ye.ToObject(e,"bad callSite"),n=ye.ToObject(t.raw,"bad raw value"),r=n.length,a=ye.ToLength(r);if(a<=0)return"";for(var i,o,s,c,u=[],l=0;l<a&&(i=ye.ToString(l),s=ye.ToString(n[i]),P(u,s),!(l+1>=a));)o=l+1<arguments.length?arguments[l+1]:"",c=ye.ToString(o),P(u,c),l+=1;return u.join("")}};String.raw&&"xy"!==String.raw({raw:{0:"x",1:"y",length:2}})&&se(String,"raw",Me.raw),m(String,Me);var De={repeat:function(e){var t=ye.ToString(ye.RequireObjectCoercible(this)),n=ye.ToInteger(e);if(n<0||n>=1/0)throw new RangeError("repeat count must be less than infinity and not overflow maximum string size");return function e(t,n){if(n<1)return"";if(n%2)return e(t,n-1)+t;var r=e(t,n/2);return r+r}(t,n)},startsWith:function(e){var t=ye.ToString(ye.RequireObjectCoercible(this));if(ye.IsRegExp(e))throw new TypeError('Cannot call method "startsWith" with a regex');var n,r=ye.ToString(e);arguments.length>1&&(n=arguments[1]);var a=D(ye.ToInteger(n),0);return N(t,a,a+r.length)===r},endsWith:function(e){var t=ye.ToString(ye.RequireObjectCoercible(this));if(ye.IsRegExp(e))throw new TypeError('Cannot call method "endsWith" with a regex');var n,r=ye.ToString(e),a=t.length;arguments.length>1&&(n=arguments[1]);var i=void 0===n?a:ye.ToInteger(n),o=R(D(i,0),a);return N(t,o-r.length,o)===r},includes:function(e){if(ye.IsRegExp(e))throw new TypeError('"includes" does not accept a RegExp');var t,n=ye.ToString(e);return arguments.length>1&&(t=arguments[1]),-1!==C(this,n,t)},codePointAt:function(e){var t=ye.ToString(ye.RequireObjectCoercible(this)),n=ye.ToInteger(e),r=t.length;if(n>=0&&n<r){var a=t.charCodeAt(n);if(a<55296||a>56319||n+1===r)return a;var i=t.charCodeAt(n+1);return i<56320||i>57343?a:1024*(a-55296)+(i-56320)+65536}}};if(String.prototype.includes&&!1!=="a".includes("a",1/0)&&se(String.prototype,"includes",De.includes),String.prototype.startsWith&&String.prototype.endsWith){var Re=o(function(){return"/a/".startsWith(/a/)}),Le=s(function(){return!1==="abc".startsWith("a",1/0)});Re&&Le||(se(String.prototype,"startsWith",De.startsWith),se(String.prototype,"endsWith",De.endsWith))}ce&&(s(function(){var e=/a/;return e[Y.match]=!1,"/a/".startsWith(e)})||se(String.prototype,"startsWith",De.startsWith),s(function(){var e=/a/;return e[Y.match]=!1,"/a/".endsWith(e)})||se(String.prototype,"endsWith",De.endsWith),s(function(){var e=/a/;return e[Y.match]=!1,"/a/".includes(e)})||se(String.prototype,"includes",De.includes));m(String.prototype,De);var qe=["\t\n\v\f\r \xa0\u1680\u180e\u2000\u2001\u2002\u2003","\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028","\u2029\ufeff"].join(""),Fe=new RegExp("(^["+qe+"]+)|(["+qe+"]+$)","g"),Ve=function(){return ye.ToString(ye.RequireObjectCoercible(this)).replace(Fe,"")},He=["\x85","\u200b","\ufffe"].join(""),ze=new RegExp("["+He+"]","g"),$e=/^[-+]0x[0-9a-f]+$/i,Be=He.trim().length!==He.length;y(String.prototype,"trim",Ve,Be);var We=function(e){return{value:e,done:0===arguments.length}},Ue=function(e){ye.RequireObjectCoercible(e),this._s=ye.ToString(e),this._i=0};Ue.prototype.next=function(){var e=this._s,t=this._i;if(void 0===e||t>=e.length)return this._s=void 0,We();var n,r,a=e.charCodeAt(t);return r=a<55296||a>56319||t+1===e.length?1:(n=e.charCodeAt(t+1))<56320||n>57343?1:2,this._i=t+r,We(e.substr(t,r))},_e(Ue.prototype),_e(String.prototype,function(){return new Ue(this)});var Ge={from:function(e){var t,n,a,i,o,s,c=this;if(arguments.length>1&&(t=arguments[1]),void 0===t)n=!1;else{if(!ye.IsCallable(t))throw new TypeError("Array.from: when provided, the second argument must be a function");arguments.length>2&&(a=arguments[2]),n=!0}if(void 0!==(ne(e)||ye.GetMethod(e,ue))){o=ye.IsConstructor(c)?Object(new c):[];var u,l,p=ye.GetIterator(e);for(s=0;!1!==(u=ye.IteratorStep(p));){l=u.value;try{n&&(l=void 0===a?t(l,s):r(t,a,l,s)),o[s]=l}catch(e){throw ye.IteratorClose(p,!0),e}s+=1}i=s}else{var f,d=ye.ToObject(e);for(i=ye.ToLength(d.length),o=ye.IsConstructor(c)?Object(new c(i)):new Array(i),s=0;s<i;++s)f=d[s],n&&(f=void 0===a?t(f,s):r(t,a,f,s)),Ne(o,s,f)}return o.length=i,o},of:function(){for(var e=arguments.length,t=this,n=a(t)||!ye.IsCallable(t)?new Array(e):ye.Construct(t,[e]),r=0;r<e;++r)Ne(n,r,arguments[r]);return n.length=e,n}};m(Array,Ge),Ee(Array),m((t=function(e,t){this.i=0,this.array=e,this.kind=t}).prototype,{next:function(){var e=this.i,n=this.array;if(!(this instanceof t))throw new TypeError("Not an ArrayIterator");if(void 0!==n)for(var r=ye.ToLength(n.length);e<r;e++){var a,i=this.kind;return"key"===i?a=e:"value"===i?a=n[e]:"entry"===i&&(a=[e,n[e]]),this.i=e+1,We(a)}return this.array=void 0,We()}}),_e(t.prototype),Array.of===Ge.of||function(){var e=function(e){this.length=e};e.prototype=[];var t=Array.of.apply(e,[1,2]);return t instanceof e&&2===t.length}()||se(Array,"of",Ge.of);var Xe={copyWithin:function(e,t){var n,r=ye.ToObject(this),a=ye.ToLength(r.length),i=ye.ToInteger(e),o=ye.ToInteger(t),s=i<0?D(a+i,0):R(i,a),c=o<0?D(a+o,0):R(o,a);arguments.length>2&&(n=arguments[2]);var u=void 0===n?a:ye.ToInteger(n),l=u<0?D(a+u,0):R(u,a),p=R(l-c,a-s),f=1;for(c<s&&s<c+p&&(f=-1,c+=p-1,s+=p-1);p>0;)c in r?r[s]=r[c]:delete r[s],c+=f,s+=f,p-=1;return r},fill:function(e){var t,n;arguments.length>1&&(t=arguments[1]),arguments.length>2&&(n=arguments[2]);var r=ye.ToObject(this),a=ye.ToLength(r.length);t=ye.ToInteger(void 0===t?0:t);for(var i=(n=ye.ToInteger(void 0===n?a:n))<0?a+n:n,o=t<0?D(a+t,0):R(t,a);o<a&&o<i;++o)r[o]=e;return r},find:function(e){var t=ye.ToObject(this),n=ye.ToLength(t.length);if(!ye.IsCallable(e))throw new TypeError("Array#find: predicate must be a function");for(var a,i=arguments.length>1?arguments[1]:null,o=0;o<n;o++)if(a=t[o],i){if(r(e,i,a,o,t))return a}else if(e(a,o,t))return a},findIndex:function(e){var t=ye.ToObject(this),n=ye.ToLength(t.length);if(!ye.IsCallable(e))throw new TypeError("Array#findIndex: predicate must be a function");for(var a=arguments.length>1?arguments[1]:null,i=0;i<n;i++)if(a){if(r(e,a,t[i],i,t))return i}else if(e(t[i],i,t))return i;return-1},keys:function(){return new t(this,"key")},values:function(){return new t(this,"value")},entries:function(){return new t(this,"entry")}};if(Array.prototype.keys&&!ye.IsCallable([1].keys().next)&&delete Array.prototype.keys,Array.prototype.entries&&!ye.IsCallable([1].entries().next)&&delete Array.prototype.entries,Array.prototype.keys&&Array.prototype.entries&&!Array.prototype.values&&Array.prototype[ue]&&(m(Array.prototype,{values:Array.prototype[ue]}),oe(Y.unscopables)&&(Array.prototype[Y.unscopables].values=!0)),l&&Array.prototype.values&&"values"!==Array.prototype.values.name){var Ye=Array.prototype.values;se(Array.prototype,"values",function(){return ye.Call(Ye,this,arguments)}),y(Array.prototype,ue,Array.prototype.values,!0)}m(Array.prototype,Xe),1/[!0].indexOf(!0,-0)<0&&y(Array.prototype,"indexOf",function(e){var t=E(this,arguments);return 0===t&&1/t<0?0:t},!0),_e(Array.prototype,function(){return this.values()}),Object.getPrototypeOf&&_e(Object.getPrototypeOf([].values()));var Je,Ke=s(function(){return 0===Array.from({length:-1}).length}),Ze=1===(Je=Array.from([0].entries())).length&&a(Je[0])&&0===Je[0][0]&&0===Je[0][1];if(Ke&&Ze||se(Array,"from",Ge.from),!s(function(){return Array.from([0],void 0)})){var Qe=Array.from;se(Array,"from",function(e){return arguments.length>1&&void 0!==arguments[1]?ye.Call(Qe,this,arguments):r(Qe,this,e)})}var et=-(Math.pow(2,32)-1),tt=function(e,t){var n={length:et};return n[t?(n.length>>>0)-1:0]=!0,s(function(){return r(e,n,function(){throw new RangeError("should not reach here")},[]),!0})};if(!tt(Array.prototype.forEach)){var nt=Array.prototype.forEach;se(Array.prototype,"forEach",function(e){return ye.Call(nt,this.length>=0?this:[],arguments)})}if(!tt(Array.prototype.map)){var rt=Array.prototype.map;se(Array.prototype,"map",function(e){return ye.Call(rt,this.length>=0?this:[],arguments)})}if(!tt(Array.prototype.filter)){var at=Array.prototype.filter;se(Array.prototype,"filter",function(e){return ye.Call(at,this.length>=0?this:[],arguments)})}if(!tt(Array.prototype.some)){var it=Array.prototype.some;se(Array.prototype,"some",function(e){return ye.Call(it,this.length>=0?this:[],arguments)})}if(!tt(Array.prototype.every)){var ot=Array.prototype.every;se(Array.prototype,"every",function(e){return ye.Call(ot,this.length>=0?this:[],arguments)})}if(!tt(Array.prototype.reduce)){var st=Array.prototype.reduce;se(Array.prototype,"reduce",function(e){return ye.Call(st,this.length>=0?this:[],arguments)})}if(!tt(Array.prototype.reduceRight,!0)){var ct=Array.prototype.reduceRight;se(Array.prototype,"reduceRight",function(e){return ye.Call(ct,this.length>=0?this:[],arguments)})}var ut=8!==Number("0o10"),lt=2!==Number("0b10"),pt=h(He,function(e){return 0===Number(e+0+e)});if(ut||lt||pt){var ft=Number,dt=/^0b[01]+$/i,ht=/^0o[0-7]+$/i,yt=dt.test.bind(dt),mt=ht.test.bind(ht),gt=ze.test.bind(ze),vt=$e.test.bind($e),bt=function(){var e=function(t){var n;"string"==typeof(n=arguments.length>0?re(t)?t:function(e){var t;if("function"==typeof e.valueOf&&(t=e.valueOf(),re(t)))return t;if("function"==typeof e.toString&&(t=e.toString(),re(t)))return t;throw new TypeError("No default value")}(t):0)&&(n=ye.Call(Ve,n),yt(n)?n=parseInt(N(n,2),2):mt(n)?n=parseInt(N(n,2),8):(gt(n)||vt(n))&&(n=NaN));var r=this,a=s(function(){return ft.prototype.valueOf.call(r),!0});return r instanceof e&&!a?new ft(n):ft(n)};return e}();Ae(ft,bt,{}),m(bt,{NaN:ft.NaN,MAX_VALUE:ft.MAX_VALUE,MIN_VALUE:ft.MIN_VALUE,NEGATIVE_INFINITY:ft.NEGATIVE_INFINITY,POSITIVE_INFINITY:ft.POSITIVE_INFINITY}),Number=bt,T(j,"Number",bt)}var wt=Math.pow(2,53)-1;m(Number,{MAX_SAFE_INTEGER:wt,MIN_SAFE_INTEGER:-wt,EPSILON:2.220446049250313e-16,parseInt:j.parseInt,parseFloat:j.parseFloat,isFinite:Z,isInteger:function(e){return Z(e)&&ye.ToInteger(e)===e},isSafeInteger:function(e){return Number.isInteger(e)&&q(e)<=Number.MAX_SAFE_INTEGER},isNaN:K}),y(Number,"parseInt",j.parseInt,Number.parseInt!==j.parseInt),1===[,1].find(function(){return!0})&&se(Array.prototype,"find",Xe.find),0!==[,1].findIndex(function(){return!0})&&se(Array.prototype,"findIndex",Xe.findIndex);var Tt,St,xt,kt=Function.bind.call(Function.bind,Object.prototype.propertyIsEnumerable),Ot=function(e,t){u&&kt(e,t)&&Object.defineProperty(e,t,{enumerable:!1})},jt=function(){for(var e=Number(this),t=arguments.length,n=t-e,r=new Array(n<0?0:n),a=e;a<t;++a)r[a-e]=arguments[a];return r},At=function(e){return function(t,n){return t[n]=e[n],t}},Ct=function(e,t){var n,r=i(Object(t));return ye.IsCallable(Object.getOwnPropertySymbols)&&(n=d(Object.getOwnPropertySymbols(Object(t)),kt(t))),f(_(r,n||[]),At(t),e)},Et={assign:function(e,t){var n=ye.ToObject(e,"Cannot convert undefined or null to object");return f(ye.Call(jt,1,arguments),Ct,n)},is:function(e,t){return ye.SameValue(e,t)}};if(Object.assign&&Object.preventExtensions&&function(){var e=Object.preventExtensions({1:2});try{Object.assign(e,"xy")}catch(t){return"y"===e[1]}}()&&se(Object,"assign",Et.assign),m(Object,Et),u){var _t={setPrototypeOf:function(e,t){var n,a=function(e,t){return function(e,t){if(!ye.TypeIsObject(e))throw new TypeError("cannot set prototype on a non-object");if(null!==t&&!ye.TypeIsObject(t))throw new TypeError("can only set prototype to an object or null"+t)}(e,t),r(n,e,t),e};try{n=e.getOwnPropertyDescriptor(e.prototype,"__proto__").set,r(n,{},null)}catch(t){if(e.prototype!=={}.__proto__)return;n=function(e){this.__proto__=e},a.polyfill=a(a({},null),e.prototype)instanceof e}return a}(Object)};m(Object,_t)}if(Object.setPrototypeOf&&Object.getPrototypeOf&&null!==Object.getPrototypeOf(Object.setPrototypeOf({},null))&&null===Object.getPrototypeOf(Object.create(null))&&(Tt=Object.create(null),St=Object.getPrototypeOf,xt=Object.setPrototypeOf,Object.getPrototypeOf=function(e){var t=St(e);return t===Tt?null:t},Object.setPrototypeOf=function(e,t){return xt(e,null===t?Tt:t)},Object.setPrototypeOf.polyfill=!1),!!o(function(){return Object.keys("foo")})){var Nt=Object.keys;se(Object,"keys",function(e){return Nt(ye.ToObject(e))}),i=Object.keys}if(o(function(){return Object.keys(/a/g)})){var Pt=Object.keys;se(Object,"keys",function(e){if(ie(e)){var t=[];for(var n in e)z(e,n)&&P(t,n);return t}return Pt(e)}),i=Object.keys}if(Object.getOwnPropertyNames&&!!o(function(){return Object.getOwnPropertyNames("foo")})){var It="object"===("undefined"==typeof window?"undefined":_typeof(window))?Object.getOwnPropertyNames(window):[],Mt=Object.getOwnPropertyNames;se(Object,"getOwnPropertyNames",function(e){var t=ye.ToObject(e);if("[object Window]"===g(t))try{return Mt(t)}catch(e){return _([],It)}return Mt(t)})}if(Object.getOwnPropertyDescriptor&&!!o(function(){return Object.getOwnPropertyDescriptor("foo","bar")})){var Dt=Object.getOwnPropertyDescriptor;se(Object,"getOwnPropertyDescriptor",function(e,t){return Dt(ye.ToObject(e),t)})}if(Object.seal&&!!o(function(){return Object.seal("foo")})){var Rt=Object.seal;se(Object,"seal",function(e){return ye.TypeIsObject(e)?Rt(e):e})}if(Object.isSealed&&!!o(function(){return Object.isSealed("foo")})){var Lt=Object.isSealed;se(Object,"isSealed",function(e){return!ye.TypeIsObject(e)||Lt(e)})}if(Object.freeze&&!!o(function(){return Object.freeze("foo")})){var qt=Object.freeze;se(Object,"freeze",function(e){return ye.TypeIsObject(e)?qt(e):e})}if(Object.isFrozen&&!!o(function(){return Object.isFrozen("foo")})){var Ft=Object.isFrozen;se(Object,"isFrozen",function(e){return!ye.TypeIsObject(e)||Ft(e)})}if(Object.preventExtensions&&!!o(function(){return Object.preventExtensions("foo")})){var Vt=Object.preventExtensions;se(Object,"preventExtensions",function(e){return ye.TypeIsObject(e)?Vt(e):e})}if(Object.isExtensible&&!!o(function(){return Object.isExtensible("foo")})){var Ht=Object.isExtensible;se(Object,"isExtensible",function(e){return!!ye.TypeIsObject(e)&&Ht(e)})}if(Object.getPrototypeOf&&!!o(function(){return Object.getPrototypeOf("foo")})){var zt=Object.getPrototypeOf;se(Object,"getPrototypeOf",function(e){return zt(ye.ToObject(e))})}var $t,Bt=u&&(($t=Object.getOwnPropertyDescriptor(RegExp.prototype,"flags"))&&ye.IsCallable($t.get));if(u&&!Bt){b(RegExp.prototype,"flags",function(){if(!ye.TypeIsObject(this))throw new TypeError("Method called on incompatible type: must be an object.");var e="";return this.global&&(e+="g"),this.ignoreCase&&(e+="i"),this.multiline&&(e+="m"),this.unicode&&(e+="u"),this.sticky&&(e+="y"),e})}var Wt,Ut=u&&s(function(){return"/a/i"===String(new RegExp(/a/g,"i"))}),Gt=ce&&u&&((Wt=/./)[Y.match]=!1,RegExp(Wt)===Wt),Xt=s(function(){return"/abc/"===RegExp.prototype.toString.call({source:"abc"})}),Yt=Xt&&s(function(){return"/a/b"===RegExp.prototype.toString.call({source:"a",flags:"b"})});if(!Xt||!Yt){var Jt=RegExp.prototype.toString;y(RegExp.prototype,"toString",function(){var e=ye.RequireObjectCoercible(this);return ie(e)?r(Jt,e):"/"+fe(e.source)+"/"+fe(e.flags)},!0),x(RegExp.prototype.toString,Jt)}if(u&&(!Ut||Gt)){var Kt=Object.getOwnPropertyDescriptor(RegExp.prototype,"flags").get,Zt=Object.getOwnPropertyDescriptor(RegExp.prototype,"source")||{},Qt=ye.IsCallable(Zt.get)?Zt.get:function(){return this.source},en=RegExp,tn=function e(t,n){var r=ye.IsRegExp(t);return this instanceof e||!r||void 0!==n||t.constructor!==e?ie(t)?new e(ye.Call(Qt,t),void 0===n?ye.Call(Kt,t):n):(r&&(t.source,void 0===n&&t.flags),new en(t,n)):t};Ae(en,tn,{$input:!0}),RegExp=tn,T(j,"RegExp",tn)}if(u){var nn={input:"$_",lastMatch:"$&",lastParen:"$+",leftContext:"$`",rightContext:"$'"};p(i(nn),function(e){e in RegExp&&!(nn[e]in RegExp)&&b(RegExp,nn[e],function(){return RegExp[e]})})}Ee(RegExp);var rn=1/Number.EPSILON,an=Math.pow(2,-23),on=Math.pow(2,127)*(2-an),sn=Math.pow(2,-126),cn=Math.E,un=Math.LOG2E,ln=Math.LOG10E,pn=Number.prototype.clz;delete Number.prototype.clz;var fn={acosh:function(e){var t=Number(e);if(K(t)||e<1)return NaN;if(1===t)return 0;if(t===1/0)return t;var n=1/(t*t);if(t<2)return ee(t-1+H(1-n)*t);var r=t/2;return ee(r+H(1-n)*r-1)+1/un},asinh:function(e){var t=Number(e);if(0===t||!A(t))return t;var n=q(t),r=n*n,a=Q(t);return n<1?a*ee(n+r/(H(r+1)+1)):a*(ee(n/2+H(1+1/r)*n/2-1)+1/un)},atanh:function(e){var t=Number(e);if(0===t)return t;if(-1===t)return-1/0;if(1===t)return 1/0;if(K(t)||t<-1||t>1)return NaN;var n=q(t);return Q(t)*ee(2*n/(1-n))/2},cbrt:function(e){var t=Number(e);if(0===t)return t;var n,r=t<0;return r&&(t=-t),n=t===1/0?1/0:(t/((n=F(V(t)/3))*n)+2*n)/3,r?-n:n},clz32:function(e){var t=Number(e),n=ye.ToUint32(t);return 0===n?32:pn?ye.Call(pn,n):31-L(V(n+.5)*un)},cosh:function(e){var t=Number(e);if(0===t)return 1;if(K(t))return NaN;if(!A(t))return 1/0;var n=F(q(t)-1);return(n+1/(n*cn*cn))*(cn/2)},expm1:function(e){var t=Number(e);if(t===-1/0)return-1;if(!A(t)||0===t)return t;if(q(t)>.5)return F(t)-1;for(var n=t,r=0,a=1;r+n!==r;)r+=n,n*=t/(a+=1);return r},hypot:function(e,t){for(var n=0,r=0,a=0;a<arguments.length;++a){var i=q(Number(arguments[a]));r<i?(n*=r/i*(r/i),n+=1,r=i):n+=i>0?i/r*(i/r):i}return r===1/0?1/0:r*H(n)},log2:function(e){return V(e)*un},log10:function(e){return V(e)*ln},log1p:ee,sign:Q,sinh:function(e){var t=Number(e);if(!A(t)||0===t)return t;var n=q(t);if(n<1){var r=Math.expm1(n);return Q(t)*r*(1+1/(r+1))/2}var a=F(n-1);return Q(t)*(a-1/(a*cn*cn))*(cn/2)},tanh:function(e){var t=Number(e);return K(t)||0===t?t:t>=20?1:t<=-20?-1:(Math.expm1(t)-Math.expm1(-t))/(F(t)+F(-t))},trunc:function(e){var t=Number(e);return t<0?-L(-t):L(t)},imul:function(e,t){var n=ye.ToUint32(e),r=ye.ToUint32(t),a=65535&n,i=65535&r;return a*i+((n>>>16&65535)*i+a*(r>>>16&65535)<<16>>>0)|0},fround:function(e){var t=Number(e);if(0===t||t===1/0||t===-1/0||K(t))return t;var n=Q(t),r=q(t);if(r<sn)return n*(r/sn/an+rn-rn)*sn*an;var a=(1+an/Number.EPSILON)*r,i=a-(a-r);return i>on||K(i)?n*(1/0):n*i}},dn=function(e,t,n){return q(1-e/t)/Number.EPSILON<(n||8)};m(Math,fn),y(Math,"sinh",fn.sinh,Math.sinh(710)===1/0),y(Math,"cosh",fn.cosh,Math.cosh(710)===1/0),y(Math,"log1p",fn.log1p,-1e-17!==Math.log1p(-1e-17)),y(Math,"asinh",fn.asinh,Math.asinh(-1e7)!==-Math.asinh(1e7)),y(Math,"asinh",fn.asinh,Math.asinh(1e300)===1/0),y(Math,"atanh",fn.atanh,0===Math.atanh(1e-300)),y(Math,"tanh",fn.tanh,-2e-17!==Math.tanh(-2e-17)),y(Math,"acosh",fn.acosh,Math.acosh(Number.MAX_VALUE)===1/0),y(Math,"acosh",fn.acosh,!dn(Math.acosh(1+Number.EPSILON),Math.sqrt(2*Number.EPSILON))),y(Math,"cbrt",fn.cbrt,!dn(Math.cbrt(1e-300),1e-100)),y(Math,"sinh",fn.sinh,-2e-17!==Math.sinh(-2e-17));var hn=Math.expm1(10);y(Math,"expm1",fn.expm1,hn>22025.465794806718||hn<22025.465794806718);var yn=Math.round,mn=0===Math.round(.5-Number.EPSILON/4)&&1===Math.round(Number.EPSILON/3.99-.5),gn=[rn+1,2*rn-1].every(function(e){return Math.round(e)===e});y(Math,"round",function(e){var t=L(e);return e-t<.5?t:-1===t?-0:t+1},!mn||!gn),x(Math.round,yn);var vn=Math.imul;-5!==Math.imul(4294967295,5)&&(Math.imul=fn.imul,x(Math.imul,vn)),2!==Math.imul.length&&se(Math,"imul",function(e,t){return ye.Call(vn,Math,arguments)});var bn,wn,Tn=function(){var e=j.setTimeout;if("function"==typeof e||"object"===(void 0===e?"undefined":_typeof(e))){ye.IsPromise=function(e){return!!ye.TypeIsObject(e)&&void 0!==e._promise};var t,n=function(e){if(!ye.IsConstructor(e))throw new TypeError("Bad promise constructor");var t=this;if(t.resolve=void 0,t.reject=void 0,t.promise=new e(function(e,n){if(void 0!==t.resolve||void 0!==t.reject)throw new TypeError("Bad Promise implementation!");t.resolve=e,t.reject=n}),!ye.IsCallable(t.resolve)||!ye.IsCallable(t.reject))throw new TypeError("Bad promise constructor")};"undefined"!=typeof window&&ye.IsCallable(window.postMessage)&&(t=function(){var e=[];return window.addEventListener("message",function(t){if(t.source===window&&"zero-timeout-message"===t.data){if(t.stopPropagation(),0===e.length)return;M(e)()}},!0),function(t){P(e,t),window.postMessage("zero-timeout-message","*")}});var a,i,o,s,c,u=ye.IsCallable(j.setImmediate)?j.setImmediate:"object"===("undefined"==typeof process?"undefined":_typeof(process))&&process.nextTick?process.nextTick:(a=j.Promise,(i=a&&a.resolve&&a.resolve())&&function(e){return i.then(e)}||(ye.IsCallable(t)?t():function(t){e(t,0)})),l=function(e){return e},p=function(e){throw e},f={},d=function(e,t,n){u(function(){h(e,t,n)})},h=function(e,t,n){var r,a;if(t===f)return e(n);try{r=e(n),a=t.resolve}catch(e){r=e,a=t.reject}a(r)},y=function(e,t){var n=e._promise,r=n.reactionLength;if(r>0&&(d(n.fulfillReactionHandler0,n.reactionCapability0,t),n.fulfillReactionHandler0=void 0,n.rejectReactions0=void 0,n.reactionCapability0=void 0,r>1))for(var a=1,i=0;a<r;a++,i+=3)d(n[i+0],n[i+2],t),e[i+0]=void 0,e[i+1]=void 0,e[i+2]=void 0;n.result=t,n.state=1,n.reactionLength=0},g=function(e,t){var n=e._promise,r=n.reactionLength;if(r>0&&(d(n.rejectReactionHandler0,n.reactionCapability0,t),n.fulfillReactionHandler0=void 0,n.rejectReactions0=void 0,n.reactionCapability0=void 0,r>1))for(var a=1,i=0;a<r;a++,i+=3)d(n[i+1],n[i+2],t),e[i+0]=void 0,e[i+1]=void 0,e[i+2]=void 0;n.result=t,n.state=2,n.reactionLength=0},v=function(e){var t=!1;return{resolve:function(n){var r;if(!t){if(t=!0,n===e)return g(e,new TypeError("Self resolution"));if(!ye.TypeIsObject(n))return y(e,n);try{r=n.then}catch(t){return g(e,t)}if(!ye.IsCallable(r))return y(e,n);u(function(){w(e,n,r)})}},reject:function(n){if(!t)return t=!0,g(e,n)}}},b=function(e,t,n,a){e===s?r(e,t,n,a,f):r(e,t,n,a)},w=function(e,t,n){var r=v(e),a=r.resolve,i=r.reject;try{b(n,t,a,i)}catch(e){i(e)}},T=c=function(e){if(!(this instanceof c))throw new TypeError('Constructor Promise requires "new"');if(this&&this._promise)throw new TypeError("Bad construction");if(!ye.IsCallable(e))throw new TypeError("not a valid resolver");var t=Pe(this,c,o,{_promise:{result:void 0,state:0,reactionLength:0,fulfillReactionHandler0:void 0,rejectReactionHandler0:void 0,reactionCapability0:void 0}}),n=v(t),r=n.reject;try{e(n.resolve,r)}catch(e){r(e)}return t};o=T.prototype;var S=function(e,t,n,r){var a=!1;return function(i){a||(a=!0,t[e]=i,0==--r.count&&(0,n.resolve)(t))}};return m(T,{all:function(e){var t=this;if(!ye.TypeIsObject(t))throw new TypeError("Promise is not object");var r,a,i=new n(t);try{return function(e,t,n){for(var r,a,i=e.iterator,o=[],s={count:1},c=0;;){try{if(!1===(r=ye.IteratorStep(i))){e.done=!0;break}a=r.value}catch(t){throw e.done=!0,t}o[c]=void 0;var u=t.resolve(a),l=S(c,o,n,s);s.count+=1,b(u.then,u,l,n.reject),c+=1}0==--s.count&&(0,n.resolve)(o);return n.promise}(a={iterator:r=ye.GetIterator(e),done:!1},t,i)}catch(e){var o=e;if(a&&!a.done)try{ye.IteratorClose(r,!0)}catch(e){o=e}return(0,i.reject)(o),i.promise}},race:function(e){var t=this;if(!ye.TypeIsObject(t))throw new TypeError("Promise is not object");var r,a,i=new n(t);try{return function(e,t,n){for(var r,a,i,o=e.iterator;;){try{if(!1===(r=ye.IteratorStep(o))){e.done=!0;break}a=r.value}catch(t){throw e.done=!0,t}i=t.resolve(a),b(i.then,i,n.resolve,n.reject)}return n.promise}(a={iterator:r=ye.GetIterator(e),done:!1},t,i)}catch(e){var o=e;if(a&&!a.done)try{ye.IteratorClose(r,!0)}catch(e){o=e}return(0,i.reject)(o),i.promise}},reject:function(e){if(!ye.TypeIsObject(this))throw new TypeError("Bad promise constructor");var t=new n(this);return(0,t.reject)(e),t.promise},resolve:function(e){var t=this;if(!ye.TypeIsObject(t))throw new TypeError("Bad promise constructor");if(ye.IsPromise(e)&&e.constructor===t)return e;var r=new n(t);return(0,r.resolve)(e),r.promise}}),m(o,{catch:function(e){return this.then(null,e)},then:function(e,t){if(!ye.IsPromise(this))throw new TypeError("not a promise");var r,a=ye.SpeciesConstructor(this,T);r=arguments.length>2&&arguments[2]===f&&a===T?f:new n(a);var i,o=ye.IsCallable(e)?e:l,s=ye.IsCallable(t)?t:p,c=this._promise;if(0===c.state){if(0===c.reactionLength)c.fulfillReactionHandler0=o,c.rejectReactionHandler0=s,c.reactionCapability0=r;else{var u=3*(c.reactionLength-1);c[u+0]=o,c[u+1]=s,c[u+2]=r}c.reactionLength+=1}else if(1===c.state)i=c.result,d(o,r,i);else{if(2!==c.state)throw new TypeError("unexpected Promise state");i=c.result,d(s,r,i)}return r.promise}}),f=new n(T),s=o.then,T}}();if(j.Promise&&(delete j.Promise.accept,delete j.Promise.defer,delete j.Promise.prototype.chain),"function"==typeof Tn){m(j,{Promise:Tn});var Sn=O(j.Promise,function(e){return e.resolve(42).then(function(){})instanceof e}),xn=!o(function(){return j.Promise.reject(42).then(null,5).then(null,$)}),kn=o(function(){return j.Promise.call(3,$)}),On=function(e){var t=e.resolve(5);t.constructor={};var n=e.resolve(t);try{n.then(null,$).then(null,$)}catch(e){return!0}return t===n}(j.Promise),jn=u&&(bn=0,wn=Object.defineProperty({},"then",{get:function(){bn+=1}}),Promise.resolve(wn),1===bn),An=function e(t){var n=new Promise(t);t(3,function(){}),this.then=n.then,this.constructor=e};An.prototype=Promise.prototype,An.all=Promise.all;var Cn=s(function(){return!!An.all([1,2])});if(Sn&&xn&&kn&&!On&&jn&&!Cn||(Promise=Tn,se(j,"Promise",Tn)),1!==Promise.all.length){var En=Promise.all;se(Promise,"all",function(e){return ye.Call(En,this,arguments)})}if(1!==Promise.race.length){var _n=Promise.race;se(Promise,"race",function(e){return ye.Call(_n,this,arguments)})}if(1!==Promise.resolve.length){var Nn=Promise.resolve;se(Promise,"resolve",function(e){return ye.Call(Nn,this,arguments)})}if(1!==Promise.reject.length){var Pn=Promise.reject;se(Promise,"reject",function(e){return ye.Call(Pn,this,arguments)})}Ot(Promise,"all"),Ot(Promise,"race"),Ot(Promise,"resolve"),Ot(Promise,"reject"),Ee(Promise)}var In,Mn,Dn=function(e){var t=i(f(e,function(e,t){return e[t]=!0,e},{}));return e.join(":")===t.join(":")},Rn=Dn(["z","a","bb"]),Ln=Dn(["z",1,"a","3",2]);if(u){var qn=function(e,t){return t||Rn?he(e)?"^"+ye.ToString(e):"string"==typeof e?"$"+e:"number"==typeof e?Ln?e:"n"+e:"boolean"==typeof e?"b"+e:null:null},Fn=function(){return Object.create?Object.create(null):{}},Vn=function(e,t,n){if(a(n)||ae(n))p(n,function(e){if(!ye.TypeIsObject(e))throw new TypeError("Iterator value "+e+" is not an entry object");t.set(e[0],e[1])});else if(n instanceof e)r(e.prototype.forEach,n,function(e,n){t.set(n,e)});else{var i,o;if(!he(n)){if(o=t.set,!ye.IsCallable(o))throw new TypeError("bad map");i=ye.GetIterator(n)}if(void 0!==i)for(;;){var s=ye.IteratorStep(i);if(!1===s)break;var c=s.value;try{if(!ye.TypeIsObject(c))throw new TypeError("Iterator value "+c+" is not an entry object");r(o,t,c[0],c[1])}catch(e){throw ye.IteratorClose(i,!0),e}}}},Hn=function(e,t,n){if(a(n)||ae(n))p(n,function(e){t.add(e)});else if(n instanceof e)r(e.prototype.forEach,n,function(e){t.add(e)});else{var i,o;if(!he(n)){if(o=t.add,!ye.IsCallable(o))throw new TypeError("bad set");i=ye.GetIterator(n)}if(void 0!==i)for(;;){var s=ye.IteratorStep(i);if(!1===s)break;var c=s.value;try{r(o,t,c)}catch(e){throw ye.IteratorClose(i,!0),e}}}},zn={Map:function(){var e={},t=function(e,t){this.key=e,this.value=t,this.next=null,this.prev=null};t.prototype.isRemoved=function(){return this.key===e};var n,a=function(e,t){if(!ye.TypeIsObject(e)||!function(e){return!!e._es6map}(e))throw new TypeError("Method Map.prototype."+t+" called on incompatible receiver "+ye.ToString(e))},i=function(e,t){a(e,"[[MapIterator]]"),this.head=e._head,this.i=this.head,this.kind=t};_e(i.prototype={isMapIterator:!0,next:function(){if(!this.isMapIterator)throw new TypeError("Not a MapIterator");var e,t=this.i,n=this.kind,r=this.head;if(void 0===this.i)return We();for(;t.isRemoved()&&t!==r;)t=t.prev;for(;t.next!==r;)if(!(t=t.next).isRemoved())return e="key"===n?t.key:"value"===n?t.value:[t.key,t.value],this.i=t,We(e);return this.i=void 0,We()}});var o=function e(){if(!(this instanceof e))throw new TypeError('Constructor Map requires "new"');if(this&&this._es6map)throw new TypeError("Bad construction");var r=Pe(this,e,n,{_es6map:!0,_head:null,_map:B?new B:null,_size:0,_storage:Fn()}),a=new t(null,null);return a.next=a.prev=a,r._head=a,arguments.length>0&&Vn(e,r,arguments[0]),r};return b(n=o.prototype,"size",function(){if(void 0===this._size)throw new TypeError("size method called on incompatible Map");return this._size}),m(n,{get:function(e){var t;a(this,"get");var n=qn(e,!0);if(null!==n)return(t=this._storage[n])?t.value:void 0;if(this._map)return(t=U.call(this._map,e))?t.value:void 0;for(var r=this._head,i=r;(i=i.next)!==r;)if(ye.SameValueZero(i.key,e))return i.value},has:function(e){a(this,"has");var t=qn(e,!0);if(null!==t)return void 0!==this._storage[t];if(this._map)return G.call(this._map,e);for(var n=this._head,r=n;(r=r.next)!==n;)if(ye.SameValueZero(r.key,e))return!0;return!1},set:function(e,n){a(this,"set");var r,i=this._head,o=i,s=qn(e,!0);if(null!==s){if(void 0!==this._storage[s])return this._storage[s].value=n,this;r=this._storage[s]=new t(e,n),o=i.prev}else this._map&&(G.call(this._map,e)?U.call(this._map,e).value=n:(r=new t(e,n),X.call(this._map,e,r),o=i.prev));for(;(o=o.next)!==i;)if(ye.SameValueZero(o.key,e))return o.value=n,this;return r=r||new t(e,n),ye.SameValue(-0,e)&&(r.key=0),r.next=this._head,r.prev=this._head.prev,r.prev.next=r,r.next.prev=r,this._size+=1,this},delete:function(t){a(this,"delete");var n=this._head,r=n,i=qn(t,!0);if(null!==i){if(void 0===this._storage[i])return!1;r=this._storage[i].prev,delete this._storage[i]}else if(this._map){if(!G.call(this._map,t))return!1;r=U.call(this._map,t).prev,W.call(this._map,t)}for(;(r=r.next)!==n;)if(ye.SameValueZero(r.key,t))return r.key=e,r.value=e,r.prev.next=r.next,r.next.prev=r.prev,this._size-=1,!0;return!1},clear:function(){a(this,"clear"),this._map=B?new B:null,this._size=0,this._storage=Fn();for(var t=this._head,n=t,r=n.next;(n=r)!==t;)n.key=e,n.value=e,r=n.next,n.next=n.prev=t;t.next=t.prev=t},keys:function(){return a(this,"keys"),new i(this,"key")},values:function(){return a(this,"values"),new i(this,"value")},entries:function(){return a(this,"entries"),new i(this,"key+value")},forEach:function(e){a(this,"forEach");for(var t=arguments.length>1?arguments[1]:null,n=this.entries(),i=n.next();!i.done;i=n.next())t?r(e,t,i.value[1],i.value[0],this):e(i.value[1],i.value[0],this)}}),_e(n,n.entries),o}(),Set:function(){var e,t=function(e,t){if(!ye.TypeIsObject(e)||!function(e){return e._es6set&&void 0!==e._storage}(e))throw new TypeError("Set.prototype."+t+" called on incompatible receiver "+ye.ToString(e))},n=function t(){if(!(this instanceof t))throw new TypeError('Constructor Set requires "new"');if(this&&this._es6set)throw new TypeError("Bad construction");var n=Pe(this,t,e,{_es6set:!0,"[[SetData]]":null,_storage:Fn()});if(!n._es6set)throw new TypeError("bad set");return arguments.length>0&&Hn(t,n,arguments[0]),n};e=n.prototype;var a=function(e){if(!e["[[SetData]]"]){var t=new zn.Map;e["[[SetData]]"]=t,p(i(e._storage),function(e){var n=function(e){var t=e;if("^null"===t)return null;if("^undefined"!==t){var n=t.charAt(0);return"$"===n?N(t,1):"n"===n?+N(t,1):"b"===n?"btrue"===t:+t}}(e);t.set(n,n)}),e["[[SetData]]"]=t}e._storage=null};b(n.prototype,"size",function(){return t(this,"size"),this._storage?i(this._storage).length:(a(this),this["[[SetData]]"].size)}),m(n.prototype,{has:function(e){var n;return t(this,"has"),this._storage&&null!==(n=qn(e))?!!this._storage[n]:(a(this),this["[[SetData]]"].has(e))},add:function(e){var n;return t(this,"add"),this._storage&&null!==(n=qn(e))?(this._storage[n]=!0,this):(a(this),this["[[SetData]]"].set(e,e),this)},delete:function(e){var n;if(t(this,"delete"),this._storage&&null!==(n=qn(e))){var r=z(this._storage,n);return delete this._storage[n]&&r}return a(this),this["[[SetData]]"].delete(e)},clear:function(){t(this,"clear"),this._storage&&(this._storage=Fn()),this["[[SetData]]"]&&this["[[SetData]]"].clear()},values:function(){return t(this,"values"),a(this),new o(this["[[SetData]]"].values())},entries:function(){return t(this,"entries"),a(this),new o(this["[[SetData]]"].entries())},forEach:function(e){t(this,"forEach");var n=arguments.length>1?arguments[1]:null,i=this;a(i),this["[[SetData]]"].forEach(function(t,a){n?r(e,n,a,a,i):e(a,a,i)})}}),y(n.prototype,"keys",n.prototype.values,!0),_e(n.prototype,n.prototype.values);var o=function(e){this.it=e};return o.prototype={isSetIterator:!0,next:function(){if(!this.isSetIterator)throw new TypeError("Not a SetIterator");return this.it.next()}},_e(o.prototype),n}()};if(j.Set&&!Set.prototype.delete&&Set.prototype.remove&&Set.prototype.items&&Set.prototype.map&&Array.isArray((new Set).keys)&&(j.Set=zn.Set),j.Map||j.Set){s(function(){return 2===new Map([[1,2]]).get(1)})||(j.Map=function e(){if(!(this instanceof e))throw new TypeError('Constructor Map requires "new"');var t=new B;return arguments.length>0&&Vn(e,t,arguments[0]),delete t.constructor,Object.setPrototypeOf(t,j.Map.prototype),t},j.Map.prototype=k(B.prototype),y(j.Map.prototype,"constructor",j.Map,!0),x(j.Map,B));var $n=new Map,Bn=((Mn=new Map([[1,0],[2,0],[3,0],[4,0]])).set(-0,Mn),Mn.get(0)===Mn&&Mn.get(-0)===Mn&&Mn.has(0)&&Mn.has(-0)),Wn=$n.set(1,2)===$n;Bn&&Wn||se(Map.prototype,"set",function(e,t){return r(X,this,0===e?0:e,t),this}),Bn||(m(Map.prototype,{get:function(e){return r(U,this,0===e?0:e)},has:function(e){return r(G,this,0===e?0:e)}},!0),x(Map.prototype.get,U),x(Map.prototype.has,G));var Un=new Set,Gn=Set.prototype.delete&&Set.prototype.add&&Set.prototype.has&&((In=Un).delete(0),In.add(-0),!In.has(0)),Xn=Un.add(1)===Un;if(!Gn||!Xn){var Yn=Set.prototype.add;Set.prototype.add=function(e){return r(Yn,this,0===e?0:e),this},x(Set.prototype.add,Yn)}if(!Gn){var Jn=Set.prototype.has;Set.prototype.has=function(e){return r(Jn,this,0===e?0:e)},x(Set.prototype.has,Jn);var Kn=Set.prototype.delete;Set.prototype.delete=function(e){return r(Kn,this,0===e?0:e)},x(Set.prototype.delete,Kn)}var Zn=O(j.Map,function(e){var t=new e([]);return t.set(42,42),t instanceof e}),Qn=Object.setPrototypeOf&&!Zn,er=function(){try{return!(j.Map()instanceof j.Map)}catch(e){return e instanceof TypeError}}();0===j.Map.length&&!Qn&&er||(j.Map=function e(){if(!(this instanceof e))throw new TypeError('Constructor Map requires "new"');var t=new B;return arguments.length>0&&Vn(e,t,arguments[0]),delete t.constructor,Object.setPrototypeOf(t,e.prototype),t},j.Map.prototype=B.prototype,y(j.Map.prototype,"constructor",j.Map,!0),x(j.Map,B));var tr=O(j.Set,function(e){var t=new e([]);return t.add(42,42),t instanceof e}),nr=Object.setPrototypeOf&&!tr,rr=function(){try{return!(j.Set()instanceof j.Set)}catch(e){return e instanceof TypeError}}();if(0!==j.Set.length||nr||!rr){var ar=j.Set;j.Set=function e(){if(!(this instanceof e))throw new TypeError('Constructor Set requires "new"');var t=new ar;return arguments.length>0&&Hn(e,t,arguments[0]),delete t.constructor,Object.setPrototypeOf(t,e.prototype),t},j.Set.prototype=ar.prototype,y(j.Set.prototype,"constructor",j.Set,!0),x(j.Set,ar)}var ir=new j.Map,or=!s(function(){return ir.keys().next().done});if(("function"!=typeof j.Map.prototype.clear||0!==(new j.Set).size||0!==ir.size||"function"!=typeof j.Map.prototype.keys||"function"!=typeof j.Set.prototype.keys||"function"!=typeof j.Map.prototype.forEach||"function"!=typeof j.Set.prototype.forEach||c(j.Map)||c(j.Set)||"function"!=typeof ir.keys().next||or||!Zn)&&m(j,{Map:zn.Map,Set:zn.Set},!0),j.Set.prototype.keys!==j.Set.prototype.values&&y(j.Set.prototype,"keys",j.Set.prototype.values,!0),_e(Object.getPrototypeOf((new j.Map).keys())),_e(Object.getPrototypeOf((new j.Set).keys())),l&&"has"!==j.Set.prototype.has.name){var sr=j.Set.prototype.has;se(j.Set.prototype,"has",function(e){return r(sr,this,e)})}}m(j,zn),Ee(j.Map),Ee(j.Set)}var cr=function(e){if(!ye.TypeIsObject(e))throw new TypeError("target must be an object")},ur={apply:function(){return ye.Call(ye.Call,null,arguments)},construct:function(e,t){if(!ye.IsConstructor(e))throw new TypeError("First argument must be a constructor.");var n=arguments.length>2?arguments[2]:e;if(!ye.IsConstructor(n))throw new TypeError("new.target must be a constructor.");return ye.Construct(e,t,n,"internal")},deleteProperty:function(e,t){if(cr(e),u){var n=Object.getOwnPropertyDescriptor(e,t);if(n&&!n.configurable)return!1}return delete e[t]},has:function(e,t){return cr(e),t in e}};Object.getOwnPropertyNames&&Object.assign(ur,{ownKeys:function(e){cr(e);var t=Object.getOwnPropertyNames(e);return ye.IsCallable(Object.getOwnPropertySymbols)&&I(t,Object.getOwnPropertySymbols(e)),t}});var lr=function(e){return!o(e)};if(Object.preventExtensions&&Object.assign(ur,{isExtensible:function(e){return cr(e),Object.isExtensible(e)},preventExtensions:function(e){return cr(e),lr(function(){return Object.preventExtensions(e)})}}),u){var pr=function(e,t,n){var r=Object.getOwnPropertyDescriptor(e,t);if(!r){var a=Object.getPrototypeOf(e);if(null===a)return;return pr(a,t,n)}return"value"in r?r.value:r.get?ye.Call(r.get,n):void 0},fr=function(e,t,n,a){var i=Object.getOwnPropertyDescriptor(e,t);if(!i){var o=Object.getPrototypeOf(e);if(null!==o)return fr(o,t,n,a);i={value:void 0,writable:!0,enumerable:!0,configurable:!0}}return"value"in i?!!i.writable&&(!!ye.TypeIsObject(a)&&(Object.getOwnPropertyDescriptor(a,t)?pe.defineProperty(a,t,{value:n}):pe.defineProperty(a,t,{value:n,writable:!0,enumerable:!0,configurable:!0}))):!!i.set&&(r(i.set,a,n),!0)};Object.assign(ur,{defineProperty:function(e,t,n){return cr(e),lr(function(){return Object.defineProperty(e,t,n)})},getOwnPropertyDescriptor:function(e,t){return cr(e),Object.getOwnPropertyDescriptor(e,t)},get:function(e,t){cr(e);var n=arguments.length>2?arguments[2]:e;return pr(e,t,n)},set:function(e,t,n){cr(e);var r=arguments.length>3?arguments[3]:e;return fr(e,t,n,r)}})}if(Object.getPrototypeOf){var dr=Object.getPrototypeOf;ur.getPrototypeOf=function(e){return cr(e),dr(e)}}if(Object.setPrototypeOf&&ur.getPrototypeOf){Object.assign(ur,{setPrototypeOf:function(e,t){if(cr(e),null!==t&&!ye.TypeIsObject(t))throw new TypeError("proto must be an object or null");return t===pe.getPrototypeOf(e)||!(pe.isExtensible&&!pe.isExtensible(e))&&(!function(e,t){for(var n=t;n;){if(e===n)return!0;n=ur.getPrototypeOf(n)}return!1}(e,t)&&(Object.setPrototypeOf(e,t),!0))}})}Object.keys(ur).forEach(function(e){!function(e,t){ye.IsCallable(j.Reflect[e])?s(function(){return j.Reflect[e](1),j.Reflect[e](NaN),j.Reflect[e](!0),!0})&&se(j.Reflect,e,t):y(j.Reflect,e,t)}(e,ur[e])});var hr=j.Reflect.getPrototypeOf;if(l&&hr&&"getPrototypeOf"!==hr.name&&se(j.Reflect,"getPrototypeOf",function(e){return r(hr,j.Reflect,e)}),j.Reflect.setPrototypeOf&&s(function(){return j.Reflect.setPrototypeOf(1,{}),!0})&&se(j.Reflect,"setPrototypeOf",ur.setPrototypeOf),j.Reflect.defineProperty&&(s(function(){var e=!j.Reflect.defineProperty(1,"test",{value:1}),t="function"!=typeof Object.preventExtensions||!j.Reflect.defineProperty(Object.preventExtensions({}),"test",{});return e&&t})||se(j.Reflect,"defineProperty",ur.defineProperty)),j.Reflect.construct&&(s(function(){var e=function(){};return j.Reflect.construct(function(){},[],e)instanceof e})||se(j.Reflect,"construct",ur.construct)),"Invalid Date"!==String(new Date(NaN))){var yr=Date.prototype.toString;se(Date.prototype,"toString",function(){var e=+this;return e!=e?"Invalid Date":ye.Call(yr,this)})}var mr={anchor:function(e){return ye.CreateHTML(this,"a","name",e)},big:function(){return ye.CreateHTML(this,"big","","")},blink:function(){return ye.CreateHTML(this,"blink","","")},bold:function(){return ye.CreateHTML(this,"b","","")},fixed:function(){return ye.CreateHTML(this,"tt","","")},fontcolor:function(e){return ye.CreateHTML(this,"font","color",e)},fontsize:function(e){return ye.CreateHTML(this,"font","size",e)},italics:function(){return ye.CreateHTML(this,"i","","")},link:function(e){return ye.CreateHTML(this,"a","href",e)},small:function(){return ye.CreateHTML(this,"small","","")},strike:function(){return ye.CreateHTML(this,"strike","","")},sub:function(){return ye.CreateHTML(this,"sub","","")},sup:function(){return ye.CreateHTML(this,"sup","","")}};p(Object.keys(mr),function(e){var t=String.prototype[e],n=!1;if(ye.IsCallable(t)){var a=r(t,"",' " '),i=_([],a.match(/"/g)).length;n=a!==a.toLowerCase()||i>2}else n=!0;n&&se(String.prototype,e,mr[e])});var gr=function(){if(!ce)return!1;var e="object"===("undefined"==typeof JSON?"undefined":_typeof(JSON))&&"function"==typeof JSON.stringify?JSON.stringify:null;if(!e)return!1;if(void 0!==e(Y()))return!0;if("[null]"!==e([Y()]))return!0;var t={a:Y()};return t[Y()]=!0,"{}"!==e(t)}(),vr=s(function(){return!ce||"{}"===JSON.stringify(Object(Y()))&&"[{}]"===JSON.stringify([Object(Y())])});if(gr||!vr){var br=JSON.stringify;se(JSON,"stringify",function(e){if("symbol"!==(void 0===e?"undefined":_typeof(e))){var t;arguments.length>1&&(t=arguments[1]);var n=[e];if(a(t))n.push(t);else{var i=ye.IsCallable(t)?t:null;n.push(function(e,t){var n=i?r(i,this,e,t):t;if("symbol"!==(void 0===n?"undefined":_typeof(n)))return oe(n)?At({})(n):n})}return arguments.length>2&&n.push(arguments[2]),br.apply(this,n)}})}return j},"function"==typeof define&&define.amd?define("es6-shim",factory):"object"===("undefined"==typeof exports?"undefined":_typeof(exports))?module.exports=factory():root.returnExports=factory(),function(e,t){"object"===("undefined"==typeof module?"undefined":_typeof(module))&&"object"===_typeof(module.exports)?module.exports=e.document?t(e,!0):function(e){if(!e.document)throw new Error("jQuery requires a window with a document");return t(e)}:t(e)}("undefined"!=typeof window?window:this,function(e,t){var n=[],r=Object.getPrototypeOf,a=n.slice,i=n.flat?function(e){return n.flat.call(e)}:function(e){return n.concat.apply([],e)},o=n.push,s=n.indexOf,c={},u=c.toString,l=c.hasOwnProperty,p=l.toString,f=p.call(Object),d={},h=function(e){return"function"==typeof e&&"number"!=typeof e.nodeType},y=function(e){return null!=e&&e===e.window},m=e.document,g={type:!0,src:!0,nonce:!0,noModule:!0};function v(e,t,n){var r,a,i=(n=n||m).createElement("script");if(i.text=e,t)for(r in g)(a=t[r]||t.getAttribute&&t.getAttribute(r))&&i.setAttribute(r,a);n.head.appendChild(i).parentNode.removeChild(i)}function b(e){return null==e?e+"":"object"===(void 0===e?"undefined":_typeof(e))||"function"==typeof e?c[u.call(e)]||"object":void 0===e?"undefined":_typeof(e)}var w=function e(t,n){return new e.fn.init(t,n)};function T(e){var t=!!e&&"length"in e&&e.length,n=b(e);return!h(e)&&!y(e)&&("array"===n||0===t||"number"==typeof t&&t>0&&t-1 in e)}w.fn=w.prototype={jquery:"3.5.1",constructor:w,length:0,toArray:function(){return a.call(this)},get:function(e){return null==e?a.call(this):e<0?this[e+this.length]:this[e]},pushStack:function(e){var t=w.merge(this.constructor(),e);return t.prevObject=this,t},each:function(e){return w.each(this,e)},map:function(e){return this.pushStack(w.map(this,function(t,n){return e.call(t,n,t)}))},slice:function(){return this.pushStack(a.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},even:function(){return this.pushStack(w.grep(this,function(e,t){return(t+1)%2}))},odd:function(){return this.pushStack(w.grep(this,function(e,t){return t%2}))},eq:function(e){var t=this.length,n=+e+(e<0?t:0);return this.pushStack(n>=0&&n<t?[this[n]]:[])},end:function(){return this.prevObject||this.constructor()},push:o,sort:n.sort,splice:n.splice},w.extend=w.fn.extend=function(){var e,t,n,r,a,i,o=arguments[0]||{},s=1,c=arguments.length,u=!1;for("boolean"==typeof o&&(u=o,o=arguments[s]||{},s++),"object"===(void 0===o?"undefined":_typeof(o))||h(o)||(o={}),s===c&&(o=this,s--);s<c;s++)if(null!=(e=arguments[s]))for(t in e)r=e[t],"__proto__"!==t&&o!==r&&(u&&r&&(w.isPlainObject(r)||(a=Array.isArray(r)))?(n=o[t],i=a&&!Array.isArray(n)?[]:a||w.isPlainObject(n)?n:{},a=!1,o[t]=w.extend(u,i,r)):void 0!==r&&(o[t]=r));return o},w.extend({expando:"jQuery"+("3.5.1"+Math.random()).replace(/\D/g,""),isReady:!0,error:function(e){throw new Error(e)},noop:function(){},isPlainObject:function(e){var t,n;return!(!e||"[object Object]"!==u.call(e))&&(!(t=r(e))||"function"==typeof(n=l.call(t,"constructor")&&t.constructor)&&p.call(n)===f)},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},globalEval:function(e,t,n){v(e,{nonce:t&&t.nonce},n)},each:function(e,t){var n,r=0;if(T(e))for(n=e.length;r<n&&!1!==t.call(e[r],r,e[r]);r++);else for(r in e)if(!1===t.call(e[r],r,e[r]))break;return e},makeArray:function(e,t){var n=t||[];return null!=e&&(T(Object(e))?w.merge(n,"string"==typeof e?[e]:e):o.call(n,e)),n},inArray:function(e,t,n){return null==t?-1:s.call(t,e,n)},merge:function(e,t){for(var n=+t.length,r=0,a=e.length;r<n;r++)e[a++]=t[r];return e.length=a,e},grep:function(e,t,n){for(var r=[],a=0,i=e.length,o=!n;a<i;a++)!t(e[a],a)!==o&&r.push(e[a]);return r},map:function(e,t,n){var r,a,o=0,s=[];if(T(e))for(r=e.length;o<r;o++)null!=(a=t(e[o],o,n))&&s.push(a);else for(o in e)null!=(a=t(e[o],o,n))&&s.push(a);return i(s)},guid:1,support:d}),"function"==typeof Symbol&&(w.fn[Symbol.iterator]=n[Symbol.iterator]),w.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(e,t){c["[object "+t+"]"]=t.toLowerCase()});var S=function(e){var t,n,r,a,i,o,s,c,u,l,p,f,d,h,y,m,g,v,b,w="sizzle"+1*new Date,T=e.document,S=0,x=0,k=ce(),O=ce(),j=ce(),A=ce(),C=function(e,t){return e===t&&(p=!0),0},E={}.hasOwnProperty,_=[],N=_.pop,P=_.push,I=_.push,M=_.slice,D=function(e,t){for(var n=0,r=e.length;n<r;n++)if(e[n]===t)return n;return-1},R="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",L="[\\x20\\t\\r\\n\\f]",q="(?:\\\\[\\da-fA-F]{1,6}"+L+"?|\\\\[^\\r\\n\\f]|[\\w-]|[^\0-\\x7f])+",F="\\["+L+"*("+q+")(?:"+L+"*([*^$|!~]?=)"+L+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+q+"))|)"+L+"*\\]",V=":("+q+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+F+")*)|.*)\\)|)",H=new RegExp(L+"+","g"),z=new RegExp("^"+L+"+|((?:^|[^\\\\])(?:\\\\.)*)"+L+"+$","g"),$=new RegExp("^"+L+"*,"+L+"*"),B=new RegExp("^"+L+"*([>+~]|"+L+")"+L+"*"),W=new RegExp(L+"|>"),U=new RegExp(V),G=new RegExp("^"+q+"$"),X={ID:new RegExp("^#("+q+")"),CLASS:new RegExp("^\\.("+q+")"),TAG:new RegExp("^("+q+"|[*])"),ATTR:new RegExp("^"+F),PSEUDO:new RegExp("^"+V),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+L+"*(even|odd|(([+-]|)(\\d*)n|)"+L+"*(?:([+-]|)"+L+"*(\\d+)|))"+L+"*\\)|)","i"),bool:new RegExp("^(?:"+R+")$","i"),needsContext:new RegExp("^"+L+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+L+"*((?:-\\d)?\\d*)"+L+"*\\)|)(?=[^-]|$)","i")},Y=/HTML$/i,J=/^(?:input|select|textarea|button)$/i,K=/^h\d$/i,Z=/^[^{]+\{\s*\[native \w/,Q=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,ee=/[+~]/,te=new RegExp("\\\\[\\da-fA-F]{1,6}"+L+"?|\\\\([^\\r\\n\\f])","g"),ne=function(e,t){var n="0x"+e.slice(1)-65536;return t||(n<0?String.fromCharCode(n+65536):String.fromCharCode(n>>10|55296,1023&n|56320))},re=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g,ae=function(e,t){return t?"\0"===e?"\ufffd":e.slice(0,-1)+"\\"+e.charCodeAt(e.length-1).toString(16)+" ":"\\"+e},ie=function(){f()},oe=we(function(e){return!0===e.disabled&&"fieldset"===e.nodeName.toLowerCase()},{dir:"parentNode",next:"legend"});try{I.apply(_=M.call(T.childNodes),T.childNodes),_[T.childNodes.length].nodeType}catch(e){I={apply:_.length?function(e,t){P.apply(e,M.call(t))}:function(e,t){for(var n=e.length,r=0;e[n++]=t[r++];);e.length=n-1}}}function se(e,t,r,a){var i,s,u,l,p,h,g,v=t&&t.ownerDocument,T=t?t.nodeType:9;if(r=r||[],"string"!=typeof e||!e||1!==T&&9!==T&&11!==T)return r;if(!a&&(f(t),t=t||d,y)){if(11!==T&&(p=Q.exec(e)))if(i=p[1]){if(9===T){if(!(u=t.getElementById(i)))return r;if(u.id===i)return r.push(u),r}else if(v&&(u=v.getElementById(i))&&b(t,u)&&u.id===i)return r.push(u),r}else{if(p[2])return I.apply(r,t.getElementsByTagName(e)),r;if((i=p[3])&&n.getElementsByClassName&&t.getElementsByClassName)return I.apply(r,t.getElementsByClassName(i)),r}if(n.qsa&&!A[e+" "]&&(!m||!m.test(e))&&(1!==T||"object"!==t.nodeName.toLowerCase())){if(g=e,v=t,1===T&&(W.test(e)||B.test(e))){for((v=ee.test(e)&&ge(t.parentNode)||t)===t&&n.scope||((l=t.getAttribute("id"))?l=l.replace(re,ae):t.setAttribute("id",l=w)),s=(h=o(e)).length;s--;)h[s]=(l?"#"+l:":scope")+" "+be(h[s]);g=h.join(",")}try{return I.apply(r,v.querySelectorAll(g)),r}catch(t){A(e,!0)}finally{l===w&&t.removeAttribute("id")}}}return c(e.replace(z,"$1"),t,r,a)}function ce(){var e=[];return function t(n,a){return e.push(n+" ")>r.cacheLength&&delete t[e.shift()],t[n+" "]=a}}function ue(e){return e[w]=!0,e}function le(e){var t=d.createElement("fieldset");try{return!!e(t)}catch(e){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function pe(e,t){for(var n=e.split("|"),a=n.length;a--;)r.attrHandle[n[a]]=t}function fe(e,t){var n=t&&e,r=n&&1===e.nodeType&&1===t.nodeType&&e.sourceIndex-t.sourceIndex;if(r)return r;if(n)for(;n=n.nextSibling;)if(n===t)return-1;return e?1:-1}function de(e){return function(t){return"input"===t.nodeName.toLowerCase()&&t.type===e}}function he(e){return function(t){var n=t.nodeName.toLowerCase();return("input"===n||"button"===n)&&t.type===e}}function ye(e){return function(t){return"form"in t?t.parentNode&&!1===t.disabled?"label"in t?"label"in t.parentNode?t.parentNode.disabled===e:t.disabled===e:t.isDisabled===e||t.isDisabled!==!e&&oe(t)===e:t.disabled===e:"label"in t&&t.disabled===e}}function me(e){return ue(function(t){return t=+t,ue(function(n,r){for(var a,i=e([],n.length,t),o=i.length;o--;)n[a=i[o]]&&(n[a]=!(r[a]=n[a]))})})}function ge(e){return e&&void 0!==e.getElementsByTagName&&e}for(t in n=se.support={},i=se.isXML=function(e){var t=e.namespaceURI,n=(e.ownerDocument||e).documentElement;return!Y.test(t||n&&n.nodeName||"HTML")},f=se.setDocument=function(e){var t,a,o=e?e.ownerDocument||e:T;return o!=d&&9===o.nodeType&&o.documentElement?(h=(d=o).documentElement,y=!i(d),T!=d&&(a=d.defaultView)&&a.top!==a&&(a.addEventListener?a.addEventListener("unload",ie,!1):a.attachEvent&&a.attachEvent("onunload",ie)),n.scope=le(function(e){return h.appendChild(e).appendChild(d.createElement("div")),void 0!==e.querySelectorAll&&!e.querySelectorAll(":scope fieldset div").length}),n.attributes=le(function(e){return e.className="i",!e.getAttribute("className")}),n.getElementsByTagName=le(function(e){return e.appendChild(d.createComment("")),!e.getElementsByTagName("*").length}),n.getElementsByClassName=Z.test(d.getElementsByClassName),n.getById=le(function(e){return h.appendChild(e).id=w,!d.getElementsByName||!d.getElementsByName(w).length}),n.getById?(r.filter.ID=function(e){var t=e.replace(te,ne);return function(e){return e.getAttribute("id")===t}},r.find.ID=function(e,t){if(void 0!==t.getElementById&&y){var n=t.getElementById(e);return n?[n]:[]}}):(r.filter.ID=function(e){var t=e.replace(te,ne);return function(e){var n=void 0!==e.getAttributeNode&&e.getAttributeNode("id");return n&&n.value===t}},r.find.ID=function(e,t){if(void 0!==t.getElementById&&y){var n,r,a,i=t.getElementById(e);if(i){if((n=i.getAttributeNode("id"))&&n.value===e)return[i];for(a=t.getElementsByName(e),r=0;i=a[r++];)if((n=i.getAttributeNode("id"))&&n.value===e)return[i]}return[]}}),r.find.TAG=n.getElementsByTagName?function(e,t){return void 0!==t.getElementsByTagName?t.getElementsByTagName(e):n.qsa?t.querySelectorAll(e):void 0}:function(e,t){var n,r=[],a=0,i=t.getElementsByTagName(e);if("*"===e){for(;n=i[a++];)1===n.nodeType&&r.push(n);return r}return i},r.find.CLASS=n.getElementsByClassName&&function(e,t){if(void 0!==t.getElementsByClassName&&y)return t.getElementsByClassName(e)},g=[],m=[],(n.qsa=Z.test(d.querySelectorAll))&&(le(function(e){var t;h.appendChild(e).innerHTML="<a id='"+w+"'></a><select id='"+w+"-\r\\' msallowcapture=''><option selected=''></option></select>",e.querySelectorAll("[msallowcapture^='']").length&&m.push("[*^$]="+L+"*(?:''|\"\")"),e.querySelectorAll("[selected]").length||m.push("\\["+L+"*(?:value|"+R+")"),e.querySelectorAll("[id~="+w+"-]").length||m.push("~="),(t=d.createElement("input")).setAttribute("name",""),e.appendChild(t),e.querySelectorAll("[name='']").length||m.push("\\["+L+"*name"+L+"*="+L+"*(?:''|\"\")"),e.querySelectorAll(":checked").length||m.push(":checked"),e.querySelectorAll("a#"+w+"+*").length||m.push(".#.+[+~]"),e.querySelectorAll("\\\f"),m.push("[\\r\\n\\f]")}),le(function(e){e.innerHTML="<a href='' disabled='disabled'></a><select disabled='disabled'><option/></select>";var t=d.createElement("input");t.setAttribute("type","hidden"),e.appendChild(t).setAttribute("name","D"),e.querySelectorAll("[name=d]").length&&m.push("name"+L+"*[*^$|!~]?="),2!==e.querySelectorAll(":enabled").length&&m.push(":enabled",":disabled"),h.appendChild(e).disabled=!0,2!==e.querySelectorAll(":disabled").length&&m.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),m.push(",.*:")})),(n.matchesSelector=Z.test(v=h.matches||h.webkitMatchesSelector||h.mozMatchesSelector||h.oMatchesSelector||h.msMatchesSelector))&&le(function(e){n.disconnectedMatch=v.call(e,"*"),v.call(e,"[s!='']:x"),g.push("!=",V)}),m=m.length&&new RegExp(m.join("|")),g=g.length&&new RegExp(g.join("|")),t=Z.test(h.compareDocumentPosition),b=t||Z.test(h.contains)?function(e,t){var n=9===e.nodeType?e.documentElement:e,r=t&&t.parentNode;return e===r||!(!r||1!==r.nodeType||!(n.contains?n.contains(r):e.compareDocumentPosition&&16&e.compareDocumentPosition(r)))}:function(e,t){if(t)for(;t=t.parentNode;)if(t===e)return!0;return!1},C=t?function(e,t){if(e===t)return p=!0,0;var r=!e.compareDocumentPosition-!t.compareDocumentPosition;return r||(1&(r=(e.ownerDocument||e)==(t.ownerDocument||t)?e.compareDocumentPosition(t):1)||!n.sortDetached&&t.compareDocumentPosition(e)===r?e==d||e.ownerDocument==T&&b(T,e)?-1:t==d||t.ownerDocument==T&&b(T,t)?1:l?D(l,e)-D(l,t):0:4&r?-1:1)}:function(e,t){if(e===t)return p=!0,0;var n,r=0,a=e.parentNode,i=t.parentNode,o=[e],s=[t];if(!a||!i)return e==d?-1:t==d?1:a?-1:i?1:l?D(l,e)-D(l,t):0;if(a===i)return fe(e,t);for(n=e;n=n.parentNode;)o.unshift(n);for(n=t;n=n.parentNode;)s.unshift(n);for(;o[r]===s[r];)r++;return r?fe(o[r],s[r]):o[r]==T?-1:s[r]==T?1:0},d):d},se.matches=function(e,t){return se(e,null,null,t)},se.matchesSelector=function(e,t){if(f(e),n.matchesSelector&&y&&!A[t+" "]&&(!g||!g.test(t))&&(!m||!m.test(t)))try{var r=v.call(e,t);if(r||n.disconnectedMatch||e.document&&11!==e.document.nodeType)return r}catch(e){A(t,!0)}return se(t,d,null,[e]).length>0},se.contains=function(e,t){return(e.ownerDocument||e)!=d&&f(e),b(e,t)},se.attr=function(e,t){(e.ownerDocument||e)!=d&&f(e);var a=r.attrHandle[t.toLowerCase()],i=a&&E.call(r.attrHandle,t.toLowerCase())?a(e,t,!y):void 0;return void 0!==i?i:n.attributes||!y?e.getAttribute(t):(i=e.getAttributeNode(t))&&i.specified?i.value:null},se.escape=function(e){return(e+"").replace(re,ae)},se.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},se.uniqueSort=function(e){var t,r=[],a=0,i=0;if(p=!n.detectDuplicates,l=!n.sortStable&&e.slice(0),e.sort(C),p){for(;t=e[i++];)t===e[i]&&(a=r.push(i));for(;a--;)e.splice(r[a],1)}return l=null,e},a=se.getText=function(e){var t,n="",r=0,i=e.nodeType;if(i){if(1===i||9===i||11===i){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)n+=a(e)}else if(3===i||4===i)return e.nodeValue}else for(;t=e[r++];)n+=a(t);return n},(r=se.selectors={cacheLength:50,createPseudo:ue,match:X,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(te,ne),e[3]=(e[3]||e[4]||e[5]||"").replace(te,ne),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||se.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&se.error(e[0]),e},PSEUDO:function(e){var t,n=!e[6]&&e[2];return X.CHILD.test(e[0])?null:(e[3]?e[2]=e[4]||e[5]||"":n&&U.test(n)&&(t=o(n,!0))&&(t=n.indexOf(")",n.length-t)-n.length)&&(e[0]=e[0].slice(0,t),e[2]=n.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(te,ne).toLowerCase();return"*"===e?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=k[e+" "];return t||(t=new RegExp("(^|"+L+")"+e+"("+L+"|$)"))&&k(e,function(e){return t.test("string"==typeof e.className&&e.className||void 0!==e.getAttribute&&e.getAttribute("class")||"")})},ATTR:function(e,t,n){return function(r){var a=se.attr(r,e);return null==a?"!="===t:!t||(a+="","="===t?a===n:"!="===t?a!==n:"^="===t?n&&0===a.indexOf(n):"*="===t?n&&a.indexOf(n)>-1:"$="===t?n&&a.slice(-n.length)===n:"~="===t?(" "+a.replace(H," ")+" ").indexOf(n)>-1:"|="===t&&(a===n||a.slice(0,n.length+1)===n+"-"))}},CHILD:function(e,t,n,r,a){var i="nth"!==e.slice(0,3),o="last"!==e.slice(-4),s="of-type"===t;return 1===r&&0===a?function(e){return!!e.parentNode}:function(t,n,c){var u,l,p,f,d,h,y=i!==o?"nextSibling":"previousSibling",m=t.parentNode,g=s&&t.nodeName.toLowerCase(),v=!c&&!s,b=!1;if(m){if(i){for(;y;){for(f=t;f=f[y];)if(s?f.nodeName.toLowerCase()===g:1===f.nodeType)return!1;h=y="only"===e&&!h&&"nextSibling"}return!0}if(h=[o?m.firstChild:m.lastChild],o&&v){for(b=(d=(u=(l=(p=(f=m)[w]||(f[w]={}))[f.uniqueID]||(p[f.uniqueID]={}))[e]||[])[0]===S&&u[1])&&u[2],f=d&&m.childNodes[d];f=++d&&f&&f[y]||(b=d=0)||h.pop();)if(1===f.nodeType&&++b&&f===t){l[e]=[S,d,b];break}}else if(v&&(b=d=(u=(l=(p=(f=t)[w]||(f[w]={}))[f.uniqueID]||(p[f.uniqueID]={}))[e]||[])[0]===S&&u[1]),!1===b)for(;(f=++d&&f&&f[y]||(b=d=0)||h.pop())&&((s?f.nodeName.toLowerCase()!==g:1!==f.nodeType)||!++b||(v&&((l=(p=f[w]||(f[w]={}))[f.uniqueID]||(p[f.uniqueID]={}))[e]=[S,b]),f!==t)););return(b-=a)===r||b%r==0&&b/r>=0}}},PSEUDO:function(e,t){var n,a=r.pseudos[e]||r.setFilters[e.toLowerCase()]||se.error("unsupported pseudo: "+e);return a[w]?a(t):a.length>1?(n=[e,e,"",t],r.setFilters.hasOwnProperty(e.toLowerCase())?ue(function(e,n){for(var r,i=a(e,t),o=i.length;o--;)e[r=D(e,i[o])]=!(n[r]=i[o])}):function(e){return a(e,0,n)}):a}},pseudos:{not:ue(function(e){var t=[],n=[],r=s(e.replace(z,"$1"));return r[w]?ue(function(e,t,n,a){for(var i,o=r(e,null,a,[]),s=e.length;s--;)(i=o[s])&&(e[s]=!(t[s]=i))}):function(e,a,i){return t[0]=e,r(t,null,i,n),t[0]=null,!n.pop()}}),has:ue(function(e){return function(t){return se(e,t).length>0}}),contains:ue(function(e){return e=e.replace(te,ne),function(t){return(t.textContent||a(t)).indexOf(e)>-1}}),lang:ue(function(e){return G.test(e||"")||se.error("unsupported lang: "+e),e=e.replace(te,ne).toLowerCase(),function(t){var n;do{if(n=y?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return(n=n.toLowerCase())===e||0===n.indexOf(e+"-")}while((t=t.parentNode)&&1===t.nodeType);return!1}}),target:function(t){var n=e.location&&e.location.hash;return n&&n.slice(1)===t.id},root:function(e){return e===h},focus:function(e){return e===d.activeElement&&(!d.hasFocus||d.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:ye(!1),disabled:ye(!0),checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,!0===e.selected},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeType<6)return!1;return!0},parent:function(e){return!r.pseudos.empty(e)},header:function(e){return K.test(e.nodeName)},input:function(e){return J.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||"text"===t.toLowerCase())},first:me(function(){return[0]}),last:me(function(e,t){return[t-1]}),eq:me(function(e,t,n){return[n<0?n+t:n]}),even:me(function(e,t){for(var n=0;n<t;n+=2)e.push(n);return e}),odd:me(function(e,t){for(var n=1;n<t;n+=2)e.push(n);return e}),lt:me(function(e,t,n){for(var r=n<0?n+t:n>t?t:n;--r>=0;)e.push(r);return e}),gt:me(function(e,t,n){for(var r=n<0?n+t:n;++r<t;)e.push(r);return e})}}).pseudos.nth=r.pseudos.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})r.pseudos[t]=de(t);for(t in{submit:!0,reset:!0})r.pseudos[t]=he(t);function ve(){}function be(e){for(var t=0,n=e.length,r="";t<n;t++)r+=e[t].value;return r}function we(e,t,n){var r=t.dir,a=t.next,i=a||r,o=n&&"parentNode"===i,s=x++;return t.first?function(t,n,a){for(;t=t[r];)if(1===t.nodeType||o)return e(t,n,a);return!1}:function(t,n,c){var u,l,p,f=[S,s];if(c){for(;t=t[r];)if((1===t.nodeType||o)&&e(t,n,c))return!0}else for(;t=t[r];)if(1===t.nodeType||o)if(l=(p=t[w]||(t[w]={}))[t.uniqueID]||(p[t.uniqueID]={}),a&&a===t.nodeName.toLowerCase())t=t[r]||t;else{if((u=l[i])&&u[0]===S&&u[1]===s)return f[2]=u[2];if(l[i]=f,f[2]=e(t,n,c))return!0}return!1}}function Te(e){return e.length>1?function(t,n,r){for(var a=e.length;a--;)if(!e[a](t,n,r))return!1;return!0}:e[0]}function Se(e,t,n,r,a){for(var i,o=[],s=0,c=e.length,u=null!=t;s<c;s++)(i=e[s])&&(n&&!n(i,r,a)||(o.push(i),u&&t.push(s)));return o}function xe(e,t,n,r,a,i){return r&&!r[w]&&(r=xe(r)),a&&!a[w]&&(a=xe(a,i)),ue(function(i,o,s,c){var u,l,p,f=[],d=[],h=o.length,y=i||function(e,t,n){for(var r=0,a=t.length;r<a;r++)se(e,t[r],n);return n}(t||"*",s.nodeType?[s]:s,[]),m=!e||!i&&t?y:Se(y,f,e,s,c),g=n?a||(i?e:h||r)?[]:o:m;if(n&&n(m,g,s,c),r)for(u=Se(g,d),r(u,[],s,c),l=u.length;l--;)(p=u[l])&&(g[d[l]]=!(m[d[l]]=p));if(i){if(a||e){if(a){for(u=[],l=g.length;l--;)(p=g[l])&&u.push(m[l]=p);a(null,g=[],u,c)}for(l=g.length;l--;)(p=g[l])&&(u=a?D(i,p):f[l])>-1&&(i[u]=!(o[u]=p))}}else g=Se(g===o?g.splice(h,g.length):g),a?a(null,o,g,c):I.apply(o,g)})}function ke(e){for(var t,n,a,i=e.length,o=r.relative[e[0].type],s=o||r.relative[" "],c=o?1:0,l=we(function(e){return e===t},s,!0),p=we(function(e){return D(t,e)>-1},s,!0),f=[function(e,n,r){var a=!o&&(r||n!==u)||((t=n).nodeType?l(e,n,r):p(e,n,r));return t=null,a}];c<i;c++)if(n=r.relative[e[c].type])f=[we(Te(f),n)];else{if((n=r.filter[e[c].type].apply(null,e[c].matches))[w]){for(a=++c;a<i&&!r.relative[e[a].type];a++);return xe(c>1&&Te(f),c>1&&be(e.slice(0,c-1).concat({value:" "===e[c-2].type?"*":""})).replace(z,"$1"),n,c<a&&ke(e.slice(c,a)),a<i&&ke(e=e.slice(a)),a<i&&be(e))}f.push(n)}return Te(f)}return ve.prototype=r.filters=r.pseudos,r.setFilters=new ve,o=se.tokenize=function(e,t){var n,a,i,o,s,c,u,l=O[e+" "];if(l)return t?0:l.slice(0);for(s=e,c=[],u=r.preFilter;s;){for(o in n&&!(a=$.exec(s))||(a&&(s=s.slice(a[0].length)||s),c.push(i=[])),n=!1,(a=B.exec(s))&&(n=a.shift(),i.push({value:n,type:a[0].replace(z," ")}),s=s.slice(n.length)),r.filter)!(a=X[o].exec(s))||u[o]&&!(a=u[o](a))||(n=a.shift(),i.push({value:n,type:o,matches:a}),s=s.slice(n.length));if(!n)break}return t?s.length:s?se.error(e):O(e,c).slice(0)},s=se.compile=function(e,t){var n,a=[],i=[],s=j[e+" "];if(!s){for(t||(t=o(e)),n=t.length;n--;)(s=ke(t[n]))[w]?a.push(s):i.push(s);(s=j(e,function(e,t){var n=t.length>0,a=e.length>0,i=function(i,o,s,c,l){var p,h,m,g=0,v="0",b=i&&[],w=[],T=u,x=i||a&&r.find.TAG("*",l),k=S+=null==T?1:Math.random()||.1,O=x.length;for(l&&(u=o==d||o||l);v!==O&&null!=(p=x[v]);v++){if(a&&p){for(h=0,o||p.ownerDocument==d||(f(p),s=!y);m=e[h++];)if(m(p,o||d,s)){c.push(p);break}l&&(S=k)}n&&((p=!m&&p)&&g--,i&&b.push(p))}if(g+=v,n&&v!==g){for(h=0;m=t[h++];)m(b,w,o,s);if(i){if(g>0)for(;v--;)b[v]||w[v]||(w[v]=N.call(c));w=Se(w)}I.apply(c,w),l&&!i&&w.length>0&&g+t.length>1&&se.uniqueSort(c)}return l&&(S=k,u=T),b};return n?ue(i):i}(i,a))).selector=e}return s},c=se.select=function(e,t,n,a){var i,c,u,l,p,f="function"==typeof e&&e,d=!a&&o(e=f.selector||e);if(n=n||[],1===d.length){if((c=d[0]=d[0].slice(0)).length>2&&"ID"===(u=c[0]).type&&9===t.nodeType&&y&&r.relative[c[1].type]){if(!(t=(r.find.ID(u.matches[0].replace(te,ne),t)||[])[0]))return n;f&&(t=t.parentNode),e=e.slice(c.shift().value.length)}for(i=X.needsContext.test(e)?0:c.length;i--&&(u=c[i],!r.relative[l=u.type]);)if((p=r.find[l])&&(a=p(u.matches[0].replace(te,ne),ee.test(c[0].type)&&ge(t.parentNode)||t))){if(c.splice(i,1),!(e=a.length&&be(c)))return I.apply(n,a),n;break}}return(f||s(e,d))(a,t,!y,n,!t||ee.test(e)&&ge(t.parentNode)||t),n},n.sortStable=w.split("").sort(C).join("")===w,n.detectDuplicates=!!p,f(),n.sortDetached=le(function(e){return 1&e.compareDocumentPosition(d.createElement("fieldset"))}),le(function(e){return e.innerHTML="<a href='#'></a>","#"===e.firstChild.getAttribute("href")})||pe("type|href|height|width",function(e,t,n){if(!n)return e.getAttribute(t,"type"===t.toLowerCase()?1:2)}),n.attributes&&le(function(e){return e.innerHTML="<input/>",e.firstChild.setAttribute("value",""),""===e.firstChild.getAttribute("value")})||pe("value",function(e,t,n){if(!n&&"input"===e.nodeName.toLowerCase())return e.defaultValue}),le(function(e){return null==e.getAttribute("disabled")})||pe(R,function(e,t,n){var r;if(!n)return!0===e[t]?t.toLowerCase():(r=e.getAttributeNode(t))&&r.specified?r.value:null}),se}(e);w.find=S,w.expr=S.selectors,w.expr[":"]=w.expr.pseudos,w.uniqueSort=w.unique=S.uniqueSort,w.text=S.getText,w.isXMLDoc=S.isXML,w.contains=S.contains,w.escapeSelector=S.escape;var x=function(e,t,n){for(var r=[],a=void 0!==n;(e=e[t])&&9!==e.nodeType;)if(1===e.nodeType){if(a&&w(e).is(n))break;r.push(e)}return r},k=function(e,t){for(var n=[];e;e=e.nextSibling)1===e.nodeType&&e!==t&&n.push(e);return n},O=w.expr.match.needsContext;function j(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()}var A=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i;function C(e,t,n){return h(t)?w.grep(e,function(e,r){return!!t.call(e,r,e)!==n}):t.nodeType?w.grep(e,function(e){return e===t!==n}):"string"!=typeof t?w.grep(e,function(e){return s.call(t,e)>-1!==n}):w.filter(t,e,n)}w.filter=function(e,t,n){var r=t[0];return n&&(e=":not("+e+")"),1===t.length&&1===r.nodeType?w.find.matchesSelector(r,e)?[r]:[]:w.find.matches(e,w.grep(t,function(e){return 1===e.nodeType}))},w.fn.extend({find:function(e){var t,n,r=this.length,a=this;if("string"!=typeof e)return this.pushStack(w(e).filter(function(){for(t=0;t<r;t++)if(w.contains(a[t],this))return!0}));for(n=this.pushStack([]),t=0;t<r;t++)w.find(e,a[t],n);return r>1?w.uniqueSort(n):n},filter:function(e){return this.pushStack(C(this,e||[],!1))},not:function(e){return this.pushStack(C(this,e||[],!0))},is:function(e){return!!C(this,"string"==typeof e&&O.test(e)?w(e):e||[],!1).length}});var E,_=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/;(w.fn.init=function(e,t,n){var r,a;if(!e)return this;if(n=n||E,"string"==typeof e){if(!(r="<"===e[0]&&">"===e[e.length-1]&&e.length>=3?[null,e,null]:_.exec(e))||!r[1]&&t)return!t||t.jquery?(t||n).find(e):this.constructor(t).find(e);if(r[1]){if(t=t instanceof w?t[0]:t,w.merge(this,w.parseHTML(r[1],t&&t.nodeType?t.ownerDocument||t:m,!0)),A.test(r[1])&&w.isPlainObject(t))for(r in t)h(this[r])?this[r](t[r]):this.attr(r,t[r]);return this}return(a=m.getElementById(r[2]))&&(this[0]=a,this.length=1),this}return e.nodeType?(this[0]=e,this.length=1,this):h(e)?void 0!==n.ready?n.ready(e):e(w):w.makeArray(e,this)}).prototype=w.fn,E=w(m);var N=/^(?:parents|prev(?:Until|All))/,P={children:!0,contents:!0,next:!0,prev:!0};function I(e,t){for(;(e=e[t])&&1!==e.nodeType;);return e}w.fn.extend({has:function(e){var t=w(e,this),n=t.length;return this.filter(function(){for(var e=0;e<n;e++)if(w.contains(this,t[e]))return!0})},closest:function(e,t){var n,r=0,a=this.length,i=[],o="string"!=typeof e&&w(e);if(!O.test(e))for(;r<a;r++)for(n=this[r];n&&n!==t;n=n.parentNode)if(n.nodeType<11&&(o?o.index(n)>-1:1===n.nodeType&&w.find.matchesSelector(n,e))){i.push(n);break}return this.pushStack(i.length>1?w.uniqueSort(i):i)},index:function(e){return e?"string"==typeof e?s.call(w(e),this[0]):s.call(this,e.jquery?e[0]:e):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){return this.pushStack(w.uniqueSort(w.merge(this.get(),w(e,t))))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),w.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return x(e,"parentNode")},parentsUntil:function(e,t,n){return x(e,"parentNode",n)},next:function(e){return I(e,"nextSibling")},prev:function(e){return I(e,"previousSibling")},nextAll:function(e){return x(e,"nextSibling")},prevAll:function(e){return x(e,"previousSibling")},nextUntil:function(e,t,n){return x(e,"nextSibling",n)},prevUntil:function(e,t,n){return x(e,"previousSibling",n)},siblings:function(e){return k((e.parentNode||{}).firstChild,e)},children:function(e){return k(e.firstChild)},contents:function(e){return null!=e.contentDocument&&r(e.contentDocument)?e.contentDocument:(j(e,"template")&&(e=e.content||e),w.merge([],e.childNodes))}},function(e,t){w.fn[e]=function(n,r){var a=w.map(this,t,n);return"Until"!==e.slice(-5)&&(r=n),r&&"string"==typeof r&&(a=w.filter(r,a)),this.length>1&&(P[e]||w.uniqueSort(a),N.test(e)&&a.reverse()),this.pushStack(a)}});var M=/[^\x20\t\r\n\f]+/g;function D(e){return e}function R(e){throw e}function L(e,t,n,r){var a;try{e&&h(a=e.promise)?a.call(e).done(t).fail(n):e&&h(a=e.then)?a.call(e,t,n):t.apply(void 0,[e].slice(r))}catch(e){n.apply(void 0,[e])}}w.Callbacks=function(e){e="string"==typeof e?function(e){var t={};return w.each(e.match(M)||[],function(e,n){t[n]=!0}),t}(e):w.extend({},e);var t,n,r,a,i=[],o=[],s=-1,c=function(){for(a=a||e.once,r=t=!0;o.length;s=-1)for(n=o.shift();++s<i.length;)!1===i[s].apply(n[0],n[1])&&e.stopOnFalse&&(s=i.length,n=!1);e.memory||(n=!1),t=!1,a&&(i=n?[]:"")},u={add:function(){return i&&(n&&!t&&(s=i.length-1,o.push(n)),function t(n){w.each(n,function(n,r){h(r)?e.unique&&u.has(r)||i.push(r):r&&r.length&&"string"!==b(r)&&t(r)})}(arguments),n&&!t&&c()),this},remove:function(){return w.each(arguments,function(e,t){for(var n;(n=w.inArray(t,i,n))>-1;)i.splice(n,1),n<=s&&s--}),this},has:function(e){return e?w.inArray(e,i)>-1:i.length>0},empty:function(){return i&&(i=[]),this},disable:function(){return a=o=[],i=n="",this},disabled:function(){return!i},lock:function(){return a=o=[],n||t||(i=n=""),this},locked:function(){return!!a},fireWith:function(e,n){return a||(n=[e,(n=n||[]).slice?n.slice():n],o.push(n),t||c()),this},fire:function(){return u.fireWith(this,arguments),this},fired:function(){return!!r}};return u},w.extend({Deferred:function(t){var n=[["notify","progress",w.Callbacks("memory"),w.Callbacks("memory"),2],["resolve","done",w.Callbacks("once memory"),w.Callbacks("once memory"),0,"resolved"],["reject","fail",w.Callbacks("once memory"),w.Callbacks("once memory"),1,"rejected"]],r="pending",a={state:function(){return r},always:function(){return i.done(arguments).fail(arguments),this},catch:function(e){return a.then(null,e)},pipe:function(){var e=arguments;return w.Deferred(function(t){w.each(n,function(n,r){var a=h(e[r[4]])&&e[r[4]];i[r[1]](function(){var e=a&&a.apply(this,arguments);e&&h(e.promise)?e.promise().progress(t.notify).done(t.resolve).fail(t.reject):t[r[0]+"With"](this,a?[e]:arguments)})}),e=null}).promise()},then:function(t,r,a){var i=0;function o(t,n,r,a){return function(){var s=this,c=arguments,u=function(){var e,u;if(!(t<i)){if((e=r.apply(s,c))===n.promise())throw new TypeError("Thenable self-resolution");u=e&&("object"===(void 0===e?"undefined":_typeof(e))||"function"==typeof e)&&e.then,h(u)?a?u.call(e,o(i,n,D,a),o(i,n,R,a)):(i++,u.call(e,o(i,n,D,a),o(i,n,R,a),o(i,n,D,n.notifyWith))):(r!==D&&(s=void 0,c=[e]),(a||n.resolveWith)(s,c))}},l=a?u:function(){try{u()}catch(e){w.Deferred.exceptionHook&&w.Deferred.exceptionHook(e,l.stackTrace),t+1>=i&&(r!==R&&(s=void 0,c=[e]),n.rejectWith(s,c))}};t?l():(w.Deferred.getStackHook&&(l.stackTrace=w.Deferred.getStackHook()),e.setTimeout(l))}}return w.Deferred(function(e){n[0][3].add(o(0,e,h(a)?a:D,e.notifyWith)),n[1][3].add(o(0,e,h(t)?t:D)),n[2][3].add(o(0,e,h(r)?r:R))}).promise()},promise:function(e){return null!=e?w.extend(e,a):a}},i={};return w.each(n,function(e,t){var o=t[2],s=t[5];a[t[1]]=o.add,s&&o.add(function(){r=s},n[3-e][2].disable,n[3-e][3].disable,n[0][2].lock,n[0][3].lock),o.add(t[3].fire),i[t[0]]=function(){return i[t[0]+"With"](this===i?void 0:this,arguments),this},i[t[0]+"With"]=o.fireWith}),a.promise(i),t&&t.call(i,i),i},when:function(e){var t=arguments.length,n=t,r=Array(n),i=a.call(arguments),o=w.Deferred(),s=function(e){return function(n){r[e]=this,i[e]=arguments.length>1?a.call(arguments):n,--t||o.resolveWith(r,i)}};if(t<=1&&(L(e,o.done(s(n)).resolve,o.reject,!t),"pending"===o.state()||h(i[n]&&i[n].then)))return o.then();for(;n--;)L(i[n],s(n),o.reject);return o.promise()}});var q=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;w.Deferred.exceptionHook=function(t,n){e.console&&e.console.warn&&t&&q.test(t.name)&&e.console.warn("jQuery.Deferred exception: "+t.message,t.stack,n)},w.readyException=function(t){e.setTimeout(function(){throw t})};var F=w.Deferred();function V(){m.removeEventListener("DOMContentLoaded",V),e.removeEventListener("load",V),w.ready()}w.fn.ready=function(e){return F.then(e).catch(function(e){w.readyException(e)}),this},w.extend({isReady:!1,readyWait:1,ready:function(e){(!0===e?--w.readyWait:w.isReady)||(w.isReady=!0,!0!==e&&--w.readyWait>0||F.resolveWith(m,[w]))}}),w.ready.then=F.then,"complete"===m.readyState||"loading"!==m.readyState&&!m.documentElement.doScroll?e.setTimeout(w.ready):(m.addEventListener("DOMContentLoaded",V),e.addEventListener("load",V));var H=function e(t,n,r,a,i,o,s){var c=0,u=t.length,l=null==r;if("object"===b(r))for(c in i=!0,r)e(t,n,c,r[c],!0,o,s);else if(void 0!==a&&(i=!0,h(a)||(s=!0),l&&(s?(n.call(t,a),n=null):(l=n,n=function(e,t,n){return l.call(w(e),n)})),n))for(;c<u;c++)n(t[c],r,s?a:a.call(t[c],c,n(t[c],r)));return i?t:l?n.call(t):u?n(t[0],r):o},z=/^-ms-/,$=/-([a-z])/g;function B(e,t){return t.toUpperCase()}function W(e){return e.replace(z,"ms-").replace($,B)}var U=function(e){return 1===e.nodeType||9===e.nodeType||!+e.nodeType};function G(){this.expando=w.expando+G.uid++}G.uid=1,G.prototype={cache:function(e){var t=e[this.expando];return t||(t={},U(e)&&(e.nodeType?e[this.expando]=t:Object.defineProperty(e,this.expando,{value:t,configurable:!0}))),t},set:function(e,t,n){var r,a=this.cache(e);if("string"==typeof t)a[W(t)]=n;else for(r in t)a[W(r)]=t[r];return a},get:function(e,t){return void 0===t?this.cache(e):e[this.expando]&&e[this.expando][W(t)]},access:function(e,t,n){return void 0===t||t&&"string"==typeof t&&void 0===n?this.get(e,t):(this.set(e,t,n),void 0!==n?n:t)},remove:function(e,t){var n,r=e[this.expando];if(void 0!==r){if(void 0!==t){n=(t=Array.isArray(t)?t.map(W):(t=W(t))in r?[t]:t.match(M)||[]).length;for(;n--;)delete r[t[n]]}(void 0===t||w.isEmptyObject(r))&&(e.nodeType?e[this.expando]=void 0:delete e[this.expando])}},hasData:function(e){var t=e[this.expando];return void 0!==t&&!w.isEmptyObject(t)}};var X=new G,Y=new G,J=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,K=/[A-Z]/g;function Z(e,t,n){var r;if(void 0===n&&1===e.nodeType)if(r="data-"+t.replace(K,"-$&").toLowerCase(),"string"==typeof(n=e.getAttribute(r))){try{n=function(e){return"true"===e||"false"!==e&&("null"===e?null:e===+e+""?+e:J.test(e)?JSON.parse(e):e)}(n)}catch(e){}Y.set(e,t,n)}else n=void 0;return n}w.extend({hasData:function(e){return Y.hasData(e)||X.hasData(e)},data:function(e,t,n){return Y.access(e,t,n)},removeData:function(e,t){Y.remove(e,t)},_data:function(e,t,n){return X.access(e,t,n)},_removeData:function(e,t){X.remove(e,t)}}),w.fn.extend({data:function(e,t){var n,r,a,i=this[0],o=i&&i.attributes;if(void 0===e){if(this.length&&(a=Y.get(i),1===i.nodeType&&!X.get(i,"hasDataAttrs"))){for(n=o.length;n--;)o[n]&&0===(r=o[n].name).indexOf("data-")&&(r=W(r.slice(5)),Z(i,r,a[r]));X.set(i,"hasDataAttrs",!0)}return a}return"object"===(void 0===e?"undefined":_typeof(e))?this.each(function(){Y.set(this,e)}):H(this,function(t){var n;if(i&&void 0===t)return void 0!==(n=Y.get(i,e))?n:void 0!==(n=Z(i,e))?n:void 0;this.each(function(){Y.set(this,e,t)})},null,t,arguments.length>1,null,!0)},removeData:function(e){return this.each(function(){Y.remove(this,e)})}}),w.extend({queue:function(e,t,n){var r;if(e)return t=(t||"fx")+"queue",r=X.get(e,t),n&&(!r||Array.isArray(n)?r=X.access(e,t,w.makeArray(n)):r.push(n)),r||[]},dequeue:function(e,t){t=t||"fx";var n=w.queue(e,t),r=n.length,a=n.shift(),i=w._queueHooks(e,t);"inprogress"===a&&(a=n.shift(),r--),a&&("fx"===t&&n.unshift("inprogress"),delete i.stop,a.call(e,function(){w.dequeue(e,t)},i)),!r&&i&&i.empty.fire()},_queueHooks:function(e,t){var n=t+"queueHooks";return X.get(e,n)||X.access(e,n,{empty:w.Callbacks("once memory").add(function(){X.remove(e,[t+"queue",n])})})}}),w.fn.extend({queue:function(e,t){var n=2;return"string"!=typeof e&&(t=e,e="fx",n--),arguments.length<n?w.queue(this[0],e):void 0===t?this:this.each(function(){var n=w.queue(this,e,t);w._queueHooks(this,e),"fx"===e&&"inprogress"!==n[0]&&w.dequeue(this,e)})},dequeue:function(e){return this.each(function(){w.dequeue(this,e)})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,t){var n,r=1,a=w.Deferred(),i=this,o=this.length,s=function(){--r||a.resolveWith(i,[i])};for("string"!=typeof e&&(t=e,e=void 0),e=e||"fx";o--;)(n=X.get(i[o],e+"queueHooks"))&&n.empty&&(r++,n.empty.add(s));return s(),a.promise(t)}});var Q=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,ee=new RegExp("^(?:([+-])=|)("+Q+")([a-z%]*)$","i"),te=["Top","Right","Bottom","Left"],ne=m.documentElement,re=function(e){return w.contains(e.ownerDocument,e)},ae={composed:!0};ne.getRootNode&&(re=function(e){return w.contains(e.ownerDocument,e)||e.getRootNode(ae)===e.ownerDocument});var ie=function(e,t){return"none"===(e=t||e).style.display||""===e.style.display&&re(e)&&"none"===w.css(e,"display")};function oe(e,t,n,r){var a,i,o=20,s=r?function(){return r.cur()}:function(){return w.css(e,t,"")},c=s(),u=n&&n[3]||(w.cssNumber[t]?"":"px"),l=e.nodeType&&(w.cssNumber[t]||"px"!==u&&+c)&&ee.exec(w.css(e,t));if(l&&l[3]!==u){for(c/=2,u=u||l[3],l=+c||1;o--;)w.style(e,t,l+u),(1-i)*(1-(i=s()/c||.5))<=0&&(o=0),l/=i;l*=2,w.style(e,t,l+u),n=n||[]}return n&&(l=+l||+c||0,a=n[1]?l+(n[1]+1)*n[2]:+n[2],r&&(r.unit=u,r.start=l,r.end=a)),a}var se={};function ce(e){var t,n=e.ownerDocument,r=e.nodeName,a=se[r];return a||(t=n.body.appendChild(n.createElement(r)),a=w.css(t,"display"),t.parentNode.removeChild(t),"none"===a&&(a="block"),se[r]=a,a)}function ue(e,t){for(var n,r,a=[],i=0,o=e.length;i<o;i++)(r=e[i]).style&&(n=r.style.display,t?("none"===n&&(a[i]=X.get(r,"display")||null,a[i]||(r.style.display="")),""===r.style.display&&ie(r)&&(a[i]=ce(r))):"none"!==n&&(a[i]="none",X.set(r,"display",n)));for(i=0;i<o;i++)null!=a[i]&&(e[i].style.display=a[i]);return e}w.fn.extend({show:function(){return ue(this,!0)},hide:function(){return ue(this)},toggle:function(e){return"boolean"==typeof e?e?this.show():this.hide():this.each(function(){ie(this)?w(this).show():w(this).hide()})}});var le,pe,fe=/^(?:checkbox|radio)$/i,de=/<([a-z][^\/\0>\x20\t\r\n\f]*)/i,he=/^$|^module$|\/(?:java|ecma)script/i;le=m.createDocumentFragment().appendChild(m.createElement("div")),(pe=m.createElement("input")).setAttribute("type","radio"),pe.setAttribute("checked","checked"),pe.setAttribute("name","t"),le.appendChild(pe),d.checkClone=le.cloneNode(!0).cloneNode(!0).lastChild.checked,le.innerHTML="<textarea>x</textarea>",d.noCloneChecked=!!le.cloneNode(!0).lastChild.defaultValue,le.innerHTML="<option></option>",d.option=!!le.lastChild;var ye={thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};function me(e,t){var n;return n=void 0!==e.getElementsByTagName?e.getElementsByTagName(t||"*"):void 0!==e.querySelectorAll?e.querySelectorAll(t||"*"):[],void 0===t||t&&j(e,t)?w.merge([e],n):n}function ge(e,t){for(var n=0,r=e.length;n<r;n++)X.set(e[n],"globalEval",!t||X.get(t[n],"globalEval"))}ye.tbody=ye.tfoot=ye.colgroup=ye.caption=ye.thead,ye.th=ye.td,d.option||(ye.optgroup=ye.option=[1,"<select multiple='multiple'>","</select>"]);var ve=/<|&#?\w+;/;function be(e,t,n,r,a){for(var i,o,s,c,u,l,p=t.createDocumentFragment(),f=[],d=0,h=e.length;d<h;d++)if((i=e[d])||0===i)if("object"===b(i))w.merge(f,i.nodeType?[i]:i);else if(ve.test(i)){for(o=o||p.appendChild(t.createElement("div")),s=(de.exec(i)||["",""])[1].toLowerCase(),c=ye[s]||ye._default,o.innerHTML=c[1]+w.htmlPrefilter(i)+c[2],l=c[0];l--;)o=o.lastChild;w.merge(f,o.childNodes),(o=p.firstChild).textContent=""}else f.push(t.createTextNode(i));for(p.textContent="",d=0;i=f[d++];)if(r&&w.inArray(i,r)>-1)a&&a.push(i);else if(u=re(i),o=me(p.appendChild(i),"script"),u&&ge(o),n)for(l=0;i=o[l++];)he.test(i.type||"")&&n.push(i);return p}var we=/^key/,Te=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,Se=/^([^.]*)(?:\.(.+)|)/;function xe(){return!0}function ke(){return!1}function Oe(e,t){return e===function(){try{return m.activeElement}catch(e){}}()==("focus"===t)}function je(e,t,n,r,a,i){var o,s;if("object"===(void 0===t?"undefined":_typeof(t))){for(s in"string"!=typeof n&&(r=r||n,n=void 0),t)je(e,s,n,r,t[s],i);return e}if(null==r&&null==a?(a=n,r=n=void 0):null==a&&("string"==typeof n?(a=r,r=void 0):(a=r,r=n,n=void 0)),!1===a)a=ke;else if(!a)return e;return 1===i&&(o=a,(a=function(e){return w().off(e),o.apply(this,arguments)}).guid=o.guid||(o.guid=w.guid++)),e.each(function(){w.event.add(this,t,a,r,n)})}function Ae(e,t,n){n?(X.set(e,t,!1),w.event.add(e,t,{namespace:!1,handler:function(e){var r,i,o=X.get(this,t);if(1&e.isTrigger&&this[t]){if(o.length)(w.event.special[t]||{}).delegateType&&e.stopPropagation();else if(o=a.call(arguments),X.set(this,t,o),r=n(this,t),this[t](),o!==(i=X.get(this,t))||r?X.set(this,t,!1):i={},o!==i)return e.stopImmediatePropagation(),e.preventDefault(),i.value}else o.length&&(X.set(this,t,{value:w.event.trigger(w.extend(o[0],w.Event.prototype),o.slice(1),this)}),e.stopImmediatePropagation())}})):void 0===X.get(e,t)&&w.event.add(e,t,xe)}w.event={global:{},add:function(e,t,n,r,a){var i,o,s,c,u,l,p,f,d,h,y,m=X.get(e);if(U(e))for(n.handler&&(n=(i=n).handler,a=i.selector),a&&w.find.matchesSelector(ne,a),n.guid||(n.guid=w.guid++),(c=m.events)||(c=m.events=Object.create(null)),(o=m.handle)||(o=m.handle=function(t){return void 0!==w&&w.event.triggered!==t.type?w.event.dispatch.apply(e,arguments):void 0}),u=(t=(t||"").match(M)||[""]).length;u--;)d=y=(s=Se.exec(t[u])||[])[1],h=(s[2]||"").split(".").sort(),d&&(p=w.event.special[d]||{},d=(a?p.delegateType:p.bindType)||d,p=w.event.special[d]||{},l=w.extend({type:d,origType:y,data:r,handler:n,guid:n.guid,selector:a,needsContext:a&&w.expr.match.needsContext.test(a),namespace:h.join(".")},i),(f=c[d])||((f=c[d]=[]).delegateCount=0,p.setup&&!1!==p.setup.call(e,r,h,o)||e.addEventListener&&e.addEventListener(d,o)),p.add&&(p.add.call(e,l),l.handler.guid||(l.handler.guid=n.guid)),a?f.splice(f.delegateCount++,0,l):f.push(l),w.event.global[d]=!0)},remove:function(e,t,n,r,a){var i,o,s,c,u,l,p,f,d,h,y,m=X.hasData(e)&&X.get(e);if(m&&(c=m.events)){for(u=(t=(t||"").match(M)||[""]).length;u--;)if(d=y=(s=Se.exec(t[u])||[])[1],h=(s[2]||"").split(".").sort(),d){for(p=w.event.special[d]||{},f=c[d=(r?p.delegateType:p.bindType)||d]||[],s=s[2]&&new RegExp("(^|\\.)"+h.join("\\.(?:.*\\.|)")+"(\\.|$)"),o=i=f.length;i--;)l=f[i],!a&&y!==l.origType||n&&n.guid!==l.guid||s&&!s.test(l.namespace)||r&&r!==l.selector&&("**"!==r||!l.selector)||(f.splice(i,1),l.selector&&f.delegateCount--,p.remove&&p.remove.call(e,l));o&&!f.length&&(p.teardown&&!1!==p.teardown.call(e,h,m.handle)||w.removeEvent(e,d,m.handle),delete c[d])}else for(d in c)w.event.remove(e,d+t[u],n,r,!0);w.isEmptyObject(c)&&X.remove(e,"handle events")}},dispatch:function(e){var t,n,r,a,i,o,s=new Array(arguments.length),c=w.event.fix(e),u=(X.get(this,"events")||Object.create(null))[c.type]||[],l=w.event.special[c.type]||{};for(s[0]=c,t=1;t<arguments.length;t++)s[t]=arguments[t];if(c.delegateTarget=this,!l.preDispatch||!1!==l.preDispatch.call(this,c)){for(o=w.event.handlers.call(this,c,u),t=0;(a=o[t++])&&!c.isPropagationStopped();)for(c.currentTarget=a.elem,n=0;(i=a.handlers[n++])&&!c.isImmediatePropagationStopped();)c.rnamespace&&!1!==i.namespace&&!c.rnamespace.test(i.namespace)||(c.handleObj=i,c.data=i.data,void 0!==(r=((w.event.special[i.origType]||{}).handle||i.handler).apply(a.elem,s))&&!1===(c.result=r)&&(c.preventDefault(),c.stopPropagation()));return l.postDispatch&&l.postDispatch.call(this,c),c.result}},handlers:function(e,t){var n,r,a,i,o,s=[],c=t.delegateCount,u=e.target;if(c&&u.nodeType&&!("click"===e.type&&e.button>=1))for(;u!==this;u=u.parentNode||this)if(1===u.nodeType&&("click"!==e.type||!0!==u.disabled)){for(i=[],o={},n=0;n<c;n++)void 0===o[a=(r=t[n]).selector+" "]&&(o[a]=r.needsContext?w(a,this).index(u)>-1:w.find(a,this,null,[u]).length),o[a]&&i.push(r);i.length&&s.push({elem:u,handlers:i})}return u=this,c<t.length&&s.push({elem:u,handlers:t.slice(c)}),s},addProp:function(e,t){Object.defineProperty(w.Event.prototype,e,{enumerable:!0,configurable:!0,get:h(t)?function(){if(this.originalEvent)return t(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[e]},set:function(t){Object.defineProperty(this,e,{enumerable:!0,configurable:!0,writable:!0,value:t})}})},fix:function(e){return e[w.expando]?e:new w.Event(e)},special:{load:{noBubble:!0},click:{setup:function(e){var t=this||e;return fe.test(t.type)&&t.click&&j(t,"input")&&Ae(t,"click",xe),!1},trigger:function(e){var t=this||e;return fe.test(t.type)&&t.click&&j(t,"input")&&Ae(t,"click"),!0},_default:function(e){var t=e.target;return fe.test(t.type)&&t.click&&j(t,"input")&&X.get(t,"click")||j(t,"a")}},beforeunload:{postDispatch:function(e){void 0!==e.result&&e.originalEvent&&(e.originalEvent.returnValue=e.result)}}}},w.removeEvent=function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n)},w.Event=function(e,t){if(!(this instanceof w.Event))return new w.Event(e,t);e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||void 0===e.defaultPrevented&&!1===e.returnValue?xe:ke,this.target=e.target&&3===e.target.nodeType?e.target.parentNode:e.target,this.currentTarget=e.currentTarget,this.relatedTarget=e.relatedTarget):this.type=e,t&&w.extend(this,t),this.timeStamp=e&&e.timeStamp||Date.now(),this[w.expando]=!0},w.Event.prototype={constructor:w.Event,isDefaultPrevented:ke,isPropagationStopped:ke,isImmediatePropagationStopped:ke,isSimulated:!1,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=xe,e&&!this.isSimulated&&e.preventDefault()},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=xe,e&&!this.isSimulated&&e.stopPropagation()},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=xe,e&&!this.isSimulated&&e.stopImmediatePropagation(),this.stopPropagation()}},w.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,char:!0,code:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:function(e){var t=e.button;return null==e.which&&we.test(e.type)?null!=e.charCode?e.charCode:e.keyCode:!e.which&&void 0!==t&&Te.test(e.type)?1&t?1:2&t?3:4&t?2:0:e.which}},w.event.addProp),w.each({focus:"focusin",blur:"focusout"},function(e,t){w.event.special[e]={setup:function(){return Ae(this,e,Oe),!1},trigger:function(){return Ae(this,e),!0},delegateType:t}}),w.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(e,t){w.event.special[e]={delegateType:t,bindType:t,handle:function(e){var n,r=e.relatedTarget,a=e.handleObj;return r&&(r===this||w.contains(this,r))||(e.type=a.origType,n=a.handler.apply(this,arguments),e.type=t),n}}}),w.fn.extend({on:function(e,t,n,r){return je(this,e,t,n,r)},one:function(e,t,n,r){return je(this,e,t,n,r,1)},off:function(e,t,n){var r,a;if(e&&e.preventDefault&&e.handleObj)return r=e.handleObj,w(e.delegateTarget).off(r.namespace?r.origType+"."+r.namespace:r.origType,r.selector,r.handler),this;if("object"===(void 0===e?"undefined":_typeof(e))){for(a in e)this.off(a,t,e[a]);return this}return!1!==t&&"function"!=typeof t||(n=t,t=void 0),!1===n&&(n=ke),this.each(function(){w.event.remove(this,e,n,t)})}});var Ce=/<script|<style|<link/i,Ee=/checked\s*(?:[^=]|=\s*.checked.)/i,_e=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g;function Ne(e,t){return j(e,"table")&&j(11!==t.nodeType?t:t.firstChild,"tr")&&w(e).children("tbody")[0]||e}function Pe(e){return e.type=(null!==e.getAttribute("type"))+"/"+e.type,e}function Ie(e){return"true/"===(e.type||"").slice(0,5)?e.type=e.type.slice(5):e.removeAttribute("type"),e}function Me(e,t){var n,r,a,i,o,s;if(1===t.nodeType){if(X.hasData(e)&&(s=X.get(e).events))for(a in X.remove(t,"handle events"),s)for(n=0,r=s[a].length;n<r;n++)w.event.add(t,a,s[a][n]);Y.hasData(e)&&(i=Y.access(e),o=w.extend({},i),Y.set(t,o))}}function De(e,t,n,r){t=i(t);var a,o,s,c,u,l,p=0,f=e.length,y=f-1,m=t[0],g=h(m);if(g||f>1&&"string"==typeof m&&!d.checkClone&&Ee.test(m))return e.each(function(a){var i=e.eq(a);g&&(t[0]=m.call(this,a,i.html())),De(i,t,n,r)});if(f&&(o=(a=be(t,e[0].ownerDocument,!1,e,r)).firstChild,1===a.childNodes.length&&(a=o),o||r)){for(c=(s=w.map(me(a,"script"),Pe)).length;p<f;p++)u=a,p!==y&&(u=w.clone(u,!0,!0),c&&w.merge(s,me(u,"script"))),n.call(e[p],u,p);if(c)for(l=s[s.length-1].ownerDocument,w.map(s,Ie),p=0;p<c;p++)u=s[p],he.test(u.type||"")&&!X.access(u,"globalEval")&&w.contains(l,u)&&(u.src&&"module"!==(u.type||"").toLowerCase()?w._evalUrl&&!u.noModule&&w._evalUrl(u.src,{nonce:u.nonce||u.getAttribute("nonce")},l):v(u.textContent.replace(_e,""),u,l))}return e}function Re(e,t,n){for(var r,a=t?w.filter(t,e):e,i=0;null!=(r=a[i]);i++)n||1!==r.nodeType||w.cleanData(me(r)),r.parentNode&&(n&&re(r)&&ge(me(r,"script")),r.parentNode.removeChild(r));return e}w.extend({htmlPrefilter:function(e){return e},clone:function(e,t,n){var r,a,i,o,s,c,u,l=e.cloneNode(!0),p=re(e);if(!(d.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||w.isXMLDoc(e)))for(o=me(l),r=0,a=(i=me(e)).length;r<a;r++)s=i[r],c=o[r],void 0,"input"===(u=c.nodeName.toLowerCase())&&fe.test(s.type)?c.checked=s.checked:"input"!==u&&"textarea"!==u||(c.defaultValue=s.defaultValue);if(t)if(n)for(i=i||me(e),o=o||me(l),r=0,a=i.length;r<a;r++)Me(i[r],o[r]);else Me(e,l);return(o=me(l,"script")).length>0&&ge(o,!p&&me(e,"script")),l},cleanData:function(e){for(var t,n,r,a=w.event.special,i=0;void 0!==(n=e[i]);i++)if(U(n)){if(t=n[X.expando]){if(t.events)for(r in t.events)a[r]?w.event.remove(n,r):w.removeEvent(n,r,t.handle);n[X.expando]=void 0}n[Y.expando]&&(n[Y.expando]=void 0)}}}),w.fn.extend({detach:function(e){return Re(this,e,!0)},remove:function(e){return Re(this,e)},text:function(e){return H(this,function(e){return void 0===e?w.text(this):this.empty().each(function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=e)})},null,e,arguments.length)},append:function(){return De(this,arguments,function(e){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||Ne(this,e).appendChild(e)})},prepend:function(){return De(this,arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=Ne(this,e);t.insertBefore(e,t.firstChild)}})},before:function(){return De(this,arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return De(this,arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)})},empty:function(){for(var e,t=0;null!=(e=this[t]);t++)1===e.nodeType&&(w.cleanData(me(e,!1)),e.textContent="");return this},clone:function(e,t){return e=null!=e&&e,t=null==t?e:t,this.map(function(){return w.clone(this,e,t)})},html:function(e){return H(this,function(e){var t=this[0]||{},n=0,r=this.length;if(void 0===e&&1===t.nodeType)return t.innerHTML;if("string"==typeof e&&!Ce.test(e)&&!ye[(de.exec(e)||["",""])[1].toLowerCase()]){e=w.htmlPrefilter(e);try{for(;n<r;n++)1===(t=this[n]||{}).nodeType&&(w.cleanData(me(t,!1)),t.innerHTML=e);t=0}catch(e){}}t&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(){var e=[];return De(this,arguments,function(t){var n=this.parentNode;w.inArray(this,e)<0&&(w.cleanData(me(this)),n&&n.replaceChild(t,this))},e)}}),w.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,t){w.fn[e]=function(e){for(var n,r=[],a=w(e),i=a.length-1,s=0;s<=i;s++)n=s===i?this:this.clone(!0),w(a[s])[t](n),o.apply(r,n.get());return this.pushStack(r)}});var Le=new RegExp("^("+Q+")(?!px)[a-z%]+$","i"),qe=function(t){var n=t.ownerDocument.defaultView;return n&&n.opener||(n=e),n.getComputedStyle(t)},Fe=function(e,t,n){var r,a,i={};for(a in t)i[a]=e.style[a],e.style[a]=t[a];for(a in r=n.call(e),t)e.style[a]=i[a];return r},Ve=new RegExp(te.join("|"),"i");function He(e,t,n){var r,a,i,o,s=e.style;return(n=n||qe(e))&&(""!==(o=n.getPropertyValue(t)||n[t])||re(e)||(o=w.style(e,t)),!d.pixelBoxStyles()&&Le.test(o)&&Ve.test(t)&&(r=s.width,a=s.minWidth,i=s.maxWidth,s.minWidth=s.maxWidth=s.width=o,o=n.width,s.width=r,s.minWidth=a,s.maxWidth=i)),void 0!==o?o+"":o}function ze(e,t){return{get:function(){if(!e())return(this.get=t).apply(this,arguments);delete this.get}}}!function(){function t(){if(l){u.style.cssText="position:absolute;left:-11111px;width:60px;margin-top:1px;padding:0;border:0",l.style.cssText="position:relative;display:block;box-sizing:border-box;overflow:scroll;margin:auto;border:1px;padding:1px;width:60%;top:1%",ne.appendChild(u).appendChild(l);var t=e.getComputedStyle(l);r="1%"!==t.top,c=12===n(t.marginLeft),l.style.right="60%",o=36===n(t.right),a=36===n(t.width),l.style.position="absolute",i=12===n(l.offsetWidth/3),ne.removeChild(u),l=null}}function n(e){return Math.round(parseFloat(e))}var r,a,i,o,s,c,u=m.createElement("div"),l=m.createElement("div");l.style&&(l.style.backgroundClip="content-box",l.cloneNode(!0).style.backgroundClip="",d.clearCloneStyle="content-box"===l.style.backgroundClip,w.extend(d,{boxSizingReliable:function(){return t(),a},pixelBoxStyles:function(){return t(),o},pixelPosition:function(){return t(),r},reliableMarginLeft:function(){return t(),c},scrollboxSize:function(){return t(),i},reliableTrDimensions:function(){var t,n,r,a;return null==s&&(t=m.createElement("table"),n=m.createElement("tr"),r=m.createElement("div"),t.style.cssText="position:absolute;left:-11111px",n.style.height="1px",r.style.height="9px",ne.appendChild(t).appendChild(n).appendChild(r),a=e.getComputedStyle(n),s=parseInt(a.height)>3,ne.removeChild(t)),s}}))}();var $e=["Webkit","Moz","ms"],Be=m.createElement("div").style,We={};function Ue(e){var t=w.cssProps[e]||We[e];return t||(e in Be?e:We[e]=function(e){for(var t=e[0].toUpperCase()+e.slice(1),n=$e.length;n--;)if((e=$e[n]+t)in Be)return e}(e)||e)}var Ge=/^(none|table(?!-c[ea]).+)/,Xe=/^--/,Ye={position:"absolute",visibility:"hidden",display:"block"},Je={letterSpacing:"0",fontWeight:"400"};function Ke(e,t,n){var r=ee.exec(t);return r?Math.max(0,r[2]-(n||0))+(r[3]||"px"):t}function Ze(e,t,n,r,a,i){var o="width"===t?1:0,s=0,c=0;if(n===(r?"border":"content"))return 0;for(;o<4;o+=2)"margin"===n&&(c+=w.css(e,n+te[o],!0,a)),r?("content"===n&&(c-=w.css(e,"padding"+te[o],!0,a)),"margin"!==n&&(c-=w.css(e,"border"+te[o]+"Width",!0,a))):(c+=w.css(e,"padding"+te[o],!0,a),"padding"!==n?c+=w.css(e,"border"+te[o]+"Width",!0,a):s+=w.css(e,"border"+te[o]+"Width",!0,a));return!r&&i>=0&&(c+=Math.max(0,Math.ceil(e["offset"+t[0].toUpperCase()+t.slice(1)]-i-c-s-.5))||0),c}function Qe(e,t,n){var r=qe(e),a=(!d.boxSizingReliable()||n)&&"border-box"===w.css(e,"boxSizing",!1,r),i=a,o=He(e,t,r),s="offset"+t[0].toUpperCase()+t.slice(1);if(Le.test(o)){if(!n)return o;o="auto"}return(!d.boxSizingReliable()&&a||!d.reliableTrDimensions()&&j(e,"tr")||"auto"===o||!parseFloat(o)&&"inline"===w.css(e,"display",!1,r))&&e.getClientRects().length&&(a="border-box"===w.css(e,"boxSizing",!1,r),(i=s in e)&&(o=e[s])),(o=parseFloat(o)||0)+Ze(e,t,n||(a?"border":"content"),i,r,o)+"px"}function et(e,t,n,r,a){return new et.prototype.init(e,t,n,r,a)}w.extend({cssHooks:{opacity:{get:function(e,t){if(t){var n=He(e,"opacity");return""===n?"1":n}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,gridArea:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnStart:!0,gridRow:!0,gridRowEnd:!0,gridRowStart:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{},style:function(e,t,n,r){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var a,i,o,s=W(t),c=Xe.test(t),u=e.style;if(c||(t=Ue(s)),o=w.cssHooks[t]||w.cssHooks[s],void 0===n)return o&&"get"in o&&void 0!==(a=o.get(e,!1,r))?a:u[t];"string"===(i=void 0===n?"undefined":_typeof(n))&&(a=ee.exec(n))&&a[1]&&(n=oe(e,t,a),i="number"),null!=n&&n==n&&("number"!==i||c||(n+=a&&a[3]||(w.cssNumber[s]?"":"px")),d.clearCloneStyle||""!==n||0!==t.indexOf("background")||(u[t]="inherit"),o&&"set"in o&&void 0===(n=o.set(e,n,r))||(c?u.setProperty(t,n):u[t]=n))}},css:function(e,t,n,r){var a,i,o,s=W(t);return Xe.test(t)||(t=Ue(s)),(o=w.cssHooks[t]||w.cssHooks[s])&&"get"in o&&(a=o.get(e,!0,n)),void 0===a&&(a=He(e,t,r)),"normal"===a&&t in Je&&(a=Je[t]),""===n||n?(i=parseFloat(a),!0===n||isFinite(i)?i||0:a):a}}),w.each(["height","width"],function(e,t){w.cssHooks[t]={get:function(e,n,r){if(n)return!Ge.test(w.css(e,"display"))||e.getClientRects().length&&e.getBoundingClientRect().width?Qe(e,t,r):Fe(e,Ye,function(){return Qe(e,t,r)})},set:function(e,n,r){var a,i=qe(e),o=!d.scrollboxSize()&&"absolute"===i.position,s=(o||r)&&"border-box"===w.css(e,"boxSizing",!1,i),c=r?Ze(e,t,r,s,i):0;return s&&o&&(c-=Math.ceil(e["offset"+t[0].toUpperCase()+t.slice(1)]-parseFloat(i[t])-Ze(e,t,"border",!1,i)-.5)),c&&(a=ee.exec(n))&&"px"!==(a[3]||"px")&&(e.style[t]=n,n=w.css(e,t)),Ke(0,n,c)}}}),w.cssHooks.marginLeft=ze(d.reliableMarginLeft,function(e,t){if(t)return(parseFloat(He(e,"marginLeft"))||e.getBoundingClientRect().left-Fe(e,{marginLeft:0},function(){return e.getBoundingClientRect().left}))+"px"}),w.each({margin:"",padding:"",border:"Width"},function(e,t){w.cssHooks[e+t]={expand:function(n){for(var r=0,a={},i="string"==typeof n?n.split(" "):[n];r<4;r++)a[e+te[r]+t]=i[r]||i[r-2]||i[0];return a}},"margin"!==e&&(w.cssHooks[e+t].set=Ke)}),w.fn.extend({css:function(e,t){return H(this,function(e,t,n){var r,a,i={},o=0;if(Array.isArray(t)){for(r=qe(e),a=t.length;o<a;o++)i[t[o]]=w.css(e,t[o],!1,r);return i}return void 0!==n?w.style(e,t,n):w.css(e,t)},e,t,arguments.length>1)}}),w.Tween=et,et.prototype={constructor:et,init:function(e,t,n,r,a,i){this.elem=e,this.prop=n,this.easing=a||w.easing._default,this.options=t,this.start=this.now=this.cur(),this.end=r,this.unit=i||(w.cssNumber[n]?"":"px")},cur:function(){var e=et.propHooks[this.prop];return e&&e.get?e.get(this):et.propHooks._default.get(this)},run:function(e){var t,n=et.propHooks[this.prop];return this.options.duration?this.pos=t=w.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):this.pos=t=e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):et.propHooks._default.set(this),this}},et.prototype.init.prototype=et.prototype,et.propHooks={_default:{get:function(e){var t;return 1!==e.elem.nodeType||null!=e.elem[e.prop]&&null==e.elem.style[e.prop]?e.elem[e.prop]:(t=w.css(e.elem,e.prop,""))&&"auto"!==t?t:0},set:function(e){w.fx.step[e.prop]?w.fx.step[e.prop](e):1!==e.elem.nodeType||!w.cssHooks[e.prop]&&null==e.elem.style[Ue(e.prop)]?e.elem[e.prop]=e.now:w.style(e.elem,e.prop,e.now+e.unit)}}},et.propHooks.scrollTop=et.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},w.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2},_default:"swing"},w.fx=et.prototype.init,w.fx.step={};var tt,nt,rt=/^(?:toggle|show|hide)$/,at=/queueHooks$/;function it(){nt&&(!1===m.hidden&&e.requestAnimationFrame?e.requestAnimationFrame(it):e.setTimeout(it,w.fx.interval),w.fx.tick())}function ot(){return e.setTimeout(function(){tt=void 0}),tt=Date.now()}function st(e,t){var n,r=0,a={height:e};for(t=t?1:0;r<4;r+=2-t)a["margin"+(n=te[r])]=a["padding"+n]=e;return t&&(a.opacity=a.width=e),a}function ct(e,t,n){for(var r,a=(ut.tweeners[t]||[]).concat(ut.tweeners["*"]),i=0,o=a.length;i<o;i++)if(r=a[i].call(n,t,e))return r}function ut(e,t,n){var r,a,i=0,o=ut.prefilters.length,s=w.Deferred().always(function(){delete c.elem}),c=function(){if(a)return!1;for(var t=tt||ot(),n=Math.max(0,u.startTime+u.duration-t),r=1-(n/u.duration||0),i=0,o=u.tweens.length;i<o;i++)u.tweens[i].run(r);return s.notifyWith(e,[u,r,n]),r<1&&o?n:(o||s.notifyWith(e,[u,1,0]),s.resolveWith(e,[u]),!1)},u=s.promise({elem:e,props:w.extend({},t),opts:w.extend(!0,{specialEasing:{},easing:w.easing._default},n),originalProperties:t,originalOptions:n,startTime:tt||ot(),duration:n.duration,tweens:[],createTween:function(t,n){var r=w.Tween(e,u.opts,t,n,u.opts.specialEasing[t]||u.opts.easing);return u.tweens.push(r),r},stop:function(t){var n=0,r=t?u.tweens.length:0;if(a)return this;for(a=!0;n<r;n++)u.tweens[n].run(1);return t?(s.notifyWith(e,[u,1,0]),s.resolveWith(e,[u,t])):s.rejectWith(e,[u,t]),this}}),l=u.props;for(!function(e,t){var n,r,a,i,o;for(n in e)if(a=t[r=W(n)],i=e[n],Array.isArray(i)&&(a=i[1],i=e[n]=i[0]),n!==r&&(e[r]=i,delete e[n]),(o=w.cssHooks[r])&&"expand"in o)for(n in i=o.expand(i),delete e[r],i)n in e||(e[n]=i[n],t[n]=a);else t[r]=a}(l,u.opts.specialEasing);i<o;i++)if(r=ut.prefilters[i].call(u,e,l,u.opts))return h(r.stop)&&(w._queueHooks(u.elem,u.opts.queue).stop=r.stop.bind(r)),r;return w.map(l,ct,u),h(u.opts.start)&&u.opts.start.call(e,u),u.progress(u.opts.progress).done(u.opts.done,u.opts.complete).fail(u.opts.fail).always(u.opts.always),w.fx.timer(w.extend(c,{elem:e,anim:u,queue:u.opts.queue})),u}w.Animation=w.extend(ut,{tweeners:{"*":[function(e,t){var n=this.createTween(e,t);return oe(n.elem,e,ee.exec(t),n),n}]},tweener:function(e,t){h(e)?(t=e,e=["*"]):e=e.match(M);for(var n,r=0,a=e.length;r<a;r++)n=e[r],ut.tweeners[n]=ut.tweeners[n]||[],ut.tweeners[n].unshift(t)},prefilters:[function(e,t,n){var r,a,i,o,s,c,u,l,p="width"in t||"height"in t,f=this,d={},h=e.style,y=e.nodeType&&ie(e),m=X.get(e,"fxshow");for(r in n.queue||(null==(o=w._queueHooks(e,"fx")).unqueued&&(o.unqueued=0,s=o.empty.fire,o.empty.fire=function(){o.unqueued||s()}),o.unqueued++,f.always(function(){f.always(function(){o.unqueued--,w.queue(e,"fx").length||o.empty.fire()})})),t)if(a=t[r],rt.test(a)){if(delete t[r],i=i||"toggle"===a,a===(y?"hide":"show")){if("show"!==a||!m||void 0===m[r])continue;y=!0}d[r]=m&&m[r]||w.style(e,r)}if((c=!w.isEmptyObject(t))||!w.isEmptyObject(d))for(r in p&&1===e.nodeType&&(n.overflow=[h.overflow,h.overflowX,h.overflowY],null==(u=m&&m.display)&&(u=X.get(e,"display")),"none"===(l=w.css(e,"display"))&&(u?l=u:(ue([e],!0),u=e.style.display||u,l=w.css(e,"display"),ue([e]))),("inline"===l||"inline-block"===l&&null!=u)&&"none"===w.css(e,"float")&&(c||(f.done(function(){h.display=u}),null==u&&(l=h.display,u="none"===l?"":l)),h.display="inline-block")),n.overflow&&(h.overflow="hidden",f.always(function(){h.overflow=n.overflow[0],h.overflowX=n.overflow[1],h.overflowY=n.overflow[2]})),c=!1,d)c||(m?"hidden"in m&&(y=m.hidden):m=X.access(e,"fxshow",{display:u}),i&&(m.hidden=!y),y&&ue([e],!0),f.done(function(){for(r in y||ue([e]),X.remove(e,"fxshow"),d)w.style(e,r,d[r])})),c=ct(y?m[r]:0,r,f),r in m||(m[r]=c.start,y&&(c.end=c.start,c.start=0))}],prefilter:function(e,t){t?ut.prefilters.unshift(e):ut.prefilters.push(e)}}),w.speed=function(e,t,n){var r=e&&"object"===(void 0===e?"undefined":_typeof(e))?w.extend({},e):{complete:n||!n&&t||h(e)&&e,duration:e,easing:n&&t||t&&!h(t)&&t};return w.fx.off?r.duration=0:"number"!=typeof r.duration&&(r.duration in w.fx.speeds?r.duration=w.fx.speeds[r.duration]:r.duration=w.fx.speeds._default),null!=r.queue&&!0!==r.queue||(r.queue="fx"),r.old=r.complete,r.complete=function(){h(r.old)&&r.old.call(this),r.queue&&w.dequeue(this,r.queue)},r},w.fn.extend({fadeTo:function(e,t,n,r){return this.filter(ie).css("opacity",0).show().end().animate({opacity:t},e,n,r)},animate:function(e,t,n,r){var a=w.isEmptyObject(e),i=w.speed(t,n,r),o=function(){var t=ut(this,w.extend({},e),i);(a||X.get(this,"finish"))&&t.stop(!0)};return o.finish=o,a||!1===i.queue?this.each(o):this.queue(i.queue,o)},stop:function(e,t,n){var r=function(e){var t=e.stop;delete e.stop,t(n)};return"string"!=typeof e&&(n=t,t=e,e=void 0),t&&this.queue(e||"fx",[]),this.each(function(){var t=!0,a=null!=e&&e+"queueHooks",i=w.timers,o=X.get(this);if(a)o[a]&&o[a].stop&&r(o[a]);else for(a in o)o[a]&&o[a].stop&&at.test(a)&&r(o[a]);for(a=i.length;a--;)i[a].elem!==this||null!=e&&i[a].queue!==e||(i[a].anim.stop(n),t=!1,i.splice(a,1));!t&&n||w.dequeue(this,e)})},finish:function(e){return!1!==e&&(e=e||"fx"),this.each(function(){var t,n=X.get(this),r=n[e+"queue"],a=n[e+"queueHooks"],i=w.timers,o=r?r.length:0;for(n.finish=!0,w.queue(this,e,[]),a&&a.stop&&a.stop.call(this,!0),t=i.length;t--;)i[t].elem===this&&i[t].queue===e&&(i[t].anim.stop(!0),i.splice(t,1));for(t=0;t<o;t++)r[t]&&r[t].finish&&r[t].finish.call(this);delete n.finish})}}),w.each(["toggle","show","hide"],function(e,t){var n=w.fn[t];w.fn[t]=function(e,r,a){return null==e||"boolean"==typeof e?n.apply(this,arguments):this.animate(st(t,!0),e,r,a)}}),w.each({slideDown:st("show"),slideUp:st("hide"),slideToggle:st("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,t){w.fn[e]=function(e,n,r){return this.animate(t,e,n,r)}}),w.timers=[],w.fx.tick=function(){var e,t=0,n=w.timers;for(tt=Date.now();t<n.length;t++)(e=n[t])()||n[t]!==e||n.splice(t--,1);n.length||w.fx.stop(),tt=void 0},w.fx.timer=function(e){w.timers.push(e),w.fx.start()},w.fx.interval=13,w.fx.start=function(){nt||(nt=!0,it())},w.fx.stop=function(){nt=null},w.fx.speeds={slow:600,fast:200,_default:400},w.fn.delay=function(t,n){return t=w.fx&&w.fx.speeds[t]||t,n=n||"fx",this.queue(n,function(n,r){var a=e.setTimeout(n,t);r.stop=function(){e.clearTimeout(a)}})},function(){var e=m.createElement("input"),t=m.createElement("select").appendChild(m.createElement("option"));e.type="checkbox",d.checkOn=""!==e.value,d.optSelected=t.selected,(e=m.createElement("input")).value="t",e.type="radio",d.radioValue="t"===e.value}();var lt,pt=w.expr.attrHandle;w.fn.extend({attr:function(e,t){return H(this,w.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each(function(){w.removeAttr(this,e)})}}),w.extend({attr:function(e,t,n){var r,a,i=e.nodeType;if(3!==i&&8!==i&&2!==i)return void 0===e.getAttribute?w.prop(e,t,n):(1===i&&w.isXMLDoc(e)||(a=w.attrHooks[t.toLowerCase()]||(w.expr.match.bool.test(t)?lt:void 0)),void 0!==n?null===n?void w.removeAttr(e,t):a&&"set"in a&&void 0!==(r=a.set(e,n,t))?r:(e.setAttribute(t,n+""),n):a&&"get"in a&&null!==(r=a.get(e,t))?r:null==(r=w.find.attr(e,t))?void 0:r)},attrHooks:{type:{set:function(e,t){if(!d.radioValue&&"radio"===t&&j(e,"input")){var n=e.value;return e.setAttribute("type",t),n&&(e.value=n),t}}}},removeAttr:function(e,t){var n,r=0,a=t&&t.match(M);if(a&&1===e.nodeType)for(;n=a[r++];)e.removeAttribute(n)}}),lt={set:function(e,t,n){return!1===t?w.removeAttr(e,n):e.setAttribute(n,n),n}},w.each(w.expr.match.bool.source.match(/\w+/g),function(e,t){var n=pt[t]||w.find.attr;pt[t]=function(e,t,r){var a,i,o=t.toLowerCase();return r||(i=pt[o],pt[o]=a,a=null!=n(e,t,r)?o:null,pt[o]=i),a}});var ft=/^(?:input|select|textarea|button)$/i,dt=/^(?:a|area)$/i;function ht(e){return(e.match(M)||[]).join(" ")}function yt(e){return e.getAttribute&&e.getAttribute("class")||""}function mt(e){return Array.isArray(e)?e:"string"==typeof e&&e.match(M)||[]}w.fn.extend({prop:function(e,t){return H(this,w.prop,e,t,arguments.length>1)},removeProp:function(e){return this.each(function(){delete this[w.propFix[e]||e]})}}),w.extend({prop:function(e,t,n){var r,a,i=e.nodeType;if(3!==i&&8!==i&&2!==i)return 1===i&&w.isXMLDoc(e)||(t=w.propFix[t]||t,a=w.propHooks[t]),void 0!==n?a&&"set"in a&&void 0!==(r=a.set(e,n,t))?r:e[t]=n:a&&"get"in a&&null!==(r=a.get(e,t))?r:e[t]},propHooks:{tabIndex:{get:function(e){var t=w.find.attr(e,"tabindex");return t?parseInt(t,10):ft.test(e.nodeName)||dt.test(e.nodeName)&&e.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}}),d.optSelected||(w.propHooks.selected={get:function(e){var t=e.parentNode;return t&&t.parentNode&&t.parentNode.selectedIndex,null},set:function(e){var t=e.parentNode;t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex)}}),w.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){w.propFix[this.toLowerCase()]=this}),w.fn.extend({addClass:function(e){var t,n,r,a,i,o,s,c=0;if(h(e))return this.each(function(t){w(this).addClass(e.call(this,t,yt(this)))});if((t=mt(e)).length)for(;n=this[c++];)if(a=yt(n),r=1===n.nodeType&&" "+ht(a)+" "){for(o=0;i=t[o++];)r.indexOf(" "+i+" ")<0&&(r+=i+" ");a!==(s=ht(r))&&n.setAttribute("class",s)}return this},removeClass:function(e){var t,n,r,a,i,o,s,c=0;if(h(e))return this.each(function(t){w(this).removeClass(e.call(this,t,yt(this)))});if(!arguments.length)return this.attr("class","");if((t=mt(e)).length)for(;n=this[c++];)if(a=yt(n),r=1===n.nodeType&&" "+ht(a)+" "){for(o=0;i=t[o++];)for(;r.indexOf(" "+i+" ")>-1;)r=r.replace(" "+i+" "," ");a!==(s=ht(r))&&n.setAttribute("class",s)}return this},toggleClass:function(e,t){var n=void 0===e?"undefined":_typeof(e),r="string"===n||Array.isArray(e);return"boolean"==typeof t&&r?t?this.addClass(e):this.removeClass(e):h(e)?this.each(function(n){w(this).toggleClass(e.call(this,n,yt(this),t),t)}):this.each(function(){var t,a,i,o;if(r)for(a=0,i=w(this),o=mt(e);t=o[a++];)i.hasClass(t)?i.removeClass(t):i.addClass(t);else void 0!==e&&"boolean"!==n||((t=yt(this))&&X.set(this,"__className__",t),this.setAttribute&&this.setAttribute("class",t||!1===e?"":X.get(this,"__className__")||""))})},hasClass:function(e){var t,n,r=0;for(t=" "+e+" ";n=this[r++];)if(1===n.nodeType&&(" "+ht(yt(n))+" ").indexOf(t)>-1)return!0;return!1}});var gt=/\r/g;w.fn.extend({val:function(e){var t,n,r,a=this[0];return arguments.length?(r=h(e),this.each(function(n){var a;1===this.nodeType&&(null==(a=r?e.call(this,n,w(this).val()):e)?a="":"number"==typeof a?a+="":Array.isArray(a)&&(a=w.map(a,function(e){return null==e?"":e+""})),(t=w.valHooks[this.type]||w.valHooks[this.nodeName.toLowerCase()])&&"set"in t&&void 0!==t.set(this,a,"value")||(this.value=a))})):a?(t=w.valHooks[a.type]||w.valHooks[a.nodeName.toLowerCase()])&&"get"in t&&void 0!==(n=t.get(a,"value"))?n:"string"==typeof(n=a.value)?n.replace(gt,""):null==n?"":n:void 0}}),w.extend({valHooks:{option:{get:function(e){var t=w.find.attr(e,"value");return null!=t?t:ht(w.text(e))}},select:{get:function(e){var t,n,r,a=e.options,i=e.selectedIndex,o="select-one"===e.type,s=o?null:[],c=o?i+1:a.length;for(r=i<0?c:o?i:0;r<c;r++)if(((n=a[r]).selected||r===i)&&!n.disabled&&(!n.parentNode.disabled||!j(n.parentNode,"optgroup"))){if(t=w(n).val(),o)return t;s.push(t)}return s},set:function(e,t){for(var n,r,a=e.options,i=w.makeArray(t),o=a.length;o--;)((r=a[o]).selected=w.inArray(w.valHooks.option.get(r),i)>-1)&&(n=!0);return n||(e.selectedIndex=-1),i}}}}),w.each(["radio","checkbox"],function(){w.valHooks[this]={set:function(e,t){if(Array.isArray(t))return e.checked=w.inArray(w(e).val(),t)>-1}},d.checkOn||(w.valHooks[this].get=function(e){return null===e.getAttribute("value")?"on":e.value})}),d.focusin="onfocusin"in e;var vt=/^(?:focusinfocus|focusoutblur)$/,bt=function(e){e.stopPropagation()};w.extend(w.event,{trigger:function(t,n,r,a){var i,o,s,c,u,p,f,d,g=[r||m],v=l.call(t,"type")?t.type:t,b=l.call(t,"namespace")?t.namespace.split("."):[];if(o=d=s=r=r||m,3!==r.nodeType&&8!==r.nodeType&&!vt.test(v+w.event.triggered)&&(v.indexOf(".")>-1&&(v=(b=v.split(".")).shift(),b.sort()),u=v.indexOf(":")<0&&"on"+v,(t=t[w.expando]?t:new w.Event(v,"object"===(void 0===t?"undefined":_typeof(t))&&t)).isTrigger=a?2:3,t.namespace=b.join("."),t.rnamespace=t.namespace?new RegExp("(^|\\.)"+b.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,t.result=void 0,t.target||(t.target=r),n=null==n?[t]:w.makeArray(n,[t]),f=w.event.special[v]||{},a||!f.trigger||!1!==f.trigger.apply(r,n))){if(!a&&!f.noBubble&&!y(r)){for(c=f.delegateType||v,vt.test(c+v)||(o=o.parentNode);o;o=o.parentNode)g.push(o),s=o;s===(r.ownerDocument||m)&&g.push(s.defaultView||s.parentWindow||e)}for(i=0;(o=g[i++])&&!t.isPropagationStopped();)d=o,t.type=i>1?c:f.bindType||v,(p=(X.get(o,"events")||Object.create(null))[t.type]&&X.get(o,"handle"))&&p.apply(o,n),(p=u&&o[u])&&p.apply&&U(o)&&(t.result=p.apply(o,n),!1===t.result&&t.preventDefault());return t.type=v,a||t.isDefaultPrevented()||f._default&&!1!==f._default.apply(g.pop(),n)||!U(r)||u&&h(r[v])&&!y(r)&&((s=r[u])&&(r[u]=null),w.event.triggered=v,t.isPropagationStopped()&&d.addEventListener(v,bt),r[v](),t.isPropagationStopped()&&d.removeEventListener(v,bt),w.event.triggered=void 0,s&&(r[u]=s)),t.result}},simulate:function(e,t,n){var r=w.extend(new w.Event,n,{type:e,isSimulated:!0});w.event.trigger(r,null,t)}}),w.fn.extend({trigger:function(e,t){return this.each(function(){w.event.trigger(e,t,this)})},triggerHandler:function(e,t){var n=this[0];if(n)return w.event.trigger(e,t,n,!0)}}),d.focusin||w.each({focus:"focusin",blur:"focusout"},function(e,t){var n=function(e){w.event.simulate(t,e.target,w.event.fix(e))};w.event.special[t]={setup:function(){var r=this.ownerDocument||this.document||this,a=X.access(r,t);a||r.addEventListener(e,n,!0),X.access(r,t,(a||0)+1)},teardown:function(){var r=this.ownerDocument||this.document||this,a=X.access(r,t)-1;a?X.access(r,t,a):(r.removeEventListener(e,n,!0),X.remove(r,t))}}});var wt=e.location,Tt={guid:Date.now()},St=/\?/;w.parseXML=function(t){var n;if(!t||"string"!=typeof t)return null;try{n=(new e.DOMParser).parseFromString(t,"text/xml")}catch(e){n=void 0}return n&&!n.getElementsByTagName("parsererror").length||w.error("Invalid XML: "+t),n};var xt=/\[\]$/,kt=/\r?\n/g,Ot=/^(?:submit|button|image|reset|file)$/i,jt=/^(?:input|select|textarea|keygen)/i;function At(e,t,n,r){var a;if(Array.isArray(t))w.each(t,function(t,a){n||xt.test(e)?r(e,a):At(e+"["+("object"===(void 0===a?"undefined":_typeof(a))&&null!=a?t:"")+"]",a,n,r)});else if(n||"object"!==b(t))r(e,t);else for(a in t)At(e+"["+a+"]",t[a],n,r)}w.param=function(e,t){var n,r=[],a=function(e,t){var n=h(t)?t():t;r[r.length]=encodeURIComponent(e)+"="+encodeURIComponent(null==n?"":n)};if(null==e)return"";if(Array.isArray(e)||e.jquery&&!w.isPlainObject(e))w.each(e,function(){a(this.name,this.value)});else for(n in e)At(n,e[n],t,a);return r.join("&")},w.fn.extend({serialize:function(){return w.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=w.prop(this,"elements");return e?w.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!w(this).is(":disabled")&&jt.test(this.nodeName)&&!Ot.test(e)&&(this.checked||!fe.test(e))}).map(function(e,t){var n=w(this).val();return null==n?null:Array.isArray(n)?w.map(n,function(e){return{name:t.name,value:e.replace(kt,"\r\n")}}):{name:t.name,value:n.replace(kt,"\r\n")}}).get()}});var Ct=/%20/g,Et=/#.*$/,_t=/([?&])_=[^&]*/,Nt=/^(.*?):[ \t]*([^\r\n]*)$/gm,Pt=/^(?:GET|HEAD)$/,It=/^\/\//,Mt={},Dt={},Rt="*/".concat("*"),Lt=m.createElement("a");function qt(e){return function(t,n){"string"!=typeof t&&(n=t,t="*");var r,a=0,i=t.toLowerCase().match(M)||[];if(h(n))for(;r=i[a++];)"+"===r[0]?(r=r.slice(1)||"*",(e[r]=e[r]||[]).unshift(n)):(e[r]=e[r]||[]).push(n)}}function Ft(e,t,n,r){var a={},i=e===Dt;function o(s){var c;return a[s]=!0,w.each(e[s]||[],function(e,s){var u=s(t,n,r);return"string"!=typeof u||i||a[u]?i?!(c=u):void 0:(t.dataTypes.unshift(u),o(u),!1)}),c}return o(t.dataTypes[0])||!a["*"]&&o("*")}function Vt(e,t){var n,r,a=w.ajaxSettings.flatOptions||{};for(n in t)void 0!==t[n]&&((a[n]?e:r||(r={}))[n]=t[n]);return r&&w.extend(!0,e,r),e}Lt.href=wt.href,w.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:wt.href,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(wt.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Rt,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":w.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?Vt(Vt(e,w.ajaxSettings),t):Vt(w.ajaxSettings,e)},ajaxPrefilter:qt(Mt),ajaxTransport:qt(Dt),ajax:function(t,n){"object"===(void 0===t?"undefined":_typeof(t))&&(n=t,t=void 0),n=n||{};var r,a,i,o,s,c,u,l,p,f,d=w.ajaxSetup({},n),h=d.context||d,y=d.context&&(h.nodeType||h.jquery)?w(h):w.event,g=w.Deferred(),v=w.Callbacks("once memory"),b=d.statusCode||{},T={},S={},x="canceled",k={readyState:0,getResponseHeader:function(e){var t;if(u){if(!o)for(o={};t=Nt.exec(i);)o[t[1].toLowerCase()+" "]=(o[t[1].toLowerCase()+" "]||[]).concat(t[2]);t=o[e.toLowerCase()+" "]}return null==t?null:t.join(", ")},getAllResponseHeaders:function(){return u?i:null},setRequestHeader:function(e,t){return null==u&&(e=S[e.toLowerCase()]=S[e.toLowerCase()]||e,T[e]=t),this},overrideMimeType:function(e){return null==u&&(d.mimeType=e),this},statusCode:function(e){var t;if(e)if(u)k.always(e[k.status]);else for(t in e)b[t]=[b[t],e[t]];return this},abort:function(e){var t=e||x;return r&&r.abort(t),O(0,t),this}};if(g.promise(k),d.url=((t||d.url||wt.href)+"").replace(It,wt.protocol+"//"),d.type=n.method||n.type||d.method||d.type,d.dataTypes=(d.dataType||"*").toLowerCase().match(M)||[""],null==d.crossDomain){c=m.createElement("a");try{c.href=d.url,c.href=c.href,d.crossDomain=Lt.protocol+"//"+Lt.host!=c.protocol+"//"+c.host}catch(e){d.crossDomain=!0}}if(d.data&&d.processData&&"string"!=typeof d.data&&(d.data=w.param(d.data,d.traditional)),Ft(Mt,d,n,k),u)return k;for(p in(l=w.event&&d.global)&&0==w.active++&&w.event.trigger("ajaxStart"),d.type=d.type.toUpperCase(),d.hasContent=!Pt.test(d.type),a=d.url.replace(Et,""),d.hasContent?d.data&&d.processData&&0===(d.contentType||"").indexOf("application/x-www-form-urlencoded")&&(d.data=d.data.replace(Ct,"+")):(f=d.url.slice(a.length),d.data&&(d.processData||"string"==typeof d.data)&&(a+=(St.test(a)?"&":"?")+d.data,delete d.data),!1===d.cache&&(a=a.replace(_t,"$1"),f=(St.test(a)?"&":"?")+"_="+Tt.guid+++f),d.url=a+f),d.ifModified&&(w.lastModified[a]&&k.setRequestHeader("If-Modified-Since",w.lastModified[a]),w.etag[a]&&k.setRequestHeader("If-None-Match",w.etag[a])),(d.data&&d.hasContent&&!1!==d.contentType||n.contentType)&&k.setRequestHeader("Content-Type",d.contentType),k.setRequestHeader("Accept",d.dataTypes[0]&&d.accepts[d.dataTypes[0]]?d.accepts[d.dataTypes[0]]+("*"!==d.dataTypes[0]?", "+Rt+"; q=0.01":""):d.accepts["*"]),d.headers)k.setRequestHeader(p,d.headers[p]);if(d.beforeSend&&(!1===d.beforeSend.call(h,k,d)||u))return k.abort();if(x="abort",v.add(d.complete),k.done(d.success),k.fail(d.error),r=Ft(Dt,d,n,k)){if(k.readyState=1,l&&y.trigger("ajaxSend",[k,d]),u)return k;d.async&&d.timeout>0&&(s=e.setTimeout(function(){k.abort("timeout")},d.timeout));try{u=!1,r.send(T,O)}catch(e){if(u)throw e;O(-1,e)}}else O(-1,"No Transport");function O(t,n,o,c){var p,f,m,T,S,x=n;u||(u=!0,s&&e.clearTimeout(s),r=void 0,i=c||"",k.readyState=t>0?4:0,p=t>=200&&t<300||304===t,o&&(T=function(e,t,n){for(var r,a,i,o,s=e.contents,c=e.dataTypes;"*"===c[0];)c.shift(),void 0===r&&(r=e.mimeType||t.getResponseHeader("Content-Type"));if(r)for(a in s)if(s[a]&&s[a].test(r)){c.unshift(a);break}if(c[0]in n)i=c[0];else{for(a in n){if(!c[0]||e.converters[a+" "+c[0]]){i=a;break}o||(o=a)}i=i||o}if(i)return i!==c[0]&&c.unshift(i),n[i]}(d,k,o)),!p&&w.inArray("script",d.dataTypes)>-1&&(d.converters["text script"]=function(){}),T=function(e,t,n,r){var a,i,o,s,c,u={},l=e.dataTypes.slice();if(l[1])for(o in e.converters)u[o.toLowerCase()]=e.converters[o];for(i=l.shift();i;)if(e.responseFields[i]&&(n[e.responseFields[i]]=t),!c&&r&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),c=i,i=l.shift())if("*"===i)i=c;else if("*"!==c&&c!==i){if(!(o=u[c+" "+i]||u["* "+i]))for(a in u)if((s=a.split(" "))[1]===i&&(o=u[c+" "+s[0]]||u["* "+s[0]])){!0===o?o=u[a]:!0!==u[a]&&(i=s[0],l.unshift(s[1]));break}if(!0!==o)if(o&&e.throws)t=o(t);else try{t=o(t)}catch(e){return{state:"parsererror",error:o?e:"No conversion from "+c+" to "+i}}}return{state:"success",data:t}}(d,T,k,p),p?(d.ifModified&&((S=k.getResponseHeader("Last-Modified"))&&(w.lastModified[a]=S),(S=k.getResponseHeader("etag"))&&(w.etag[a]=S)),204===t||"HEAD"===d.type?x="nocontent":304===t?x="notmodified":(x=T.state,f=T.data,p=!(m=T.error))):(m=x,!t&&x||(x="error",t<0&&(t=0))),k.status=t,k.statusText=(n||x)+"",p?g.resolveWith(h,[f,x,k]):g.rejectWith(h,[k,x,m]),k.statusCode(b),b=void 0,l&&y.trigger(p?"ajaxSuccess":"ajaxError",[k,d,p?f:m]),v.fireWith(h,[k,x]),l&&(y.trigger("ajaxComplete",[k,d]),--w.active||w.event.trigger("ajaxStop")))}return k},getJSON:function(e,t,n){return w.get(e,t,n,"json")},getScript:function(e,t){return w.get(e,void 0,t,"script")}}),w.each(["get","post"],function(e,t){w[t]=function(e,n,r,a){return h(n)&&(a=a||r,r=n,n=void 0),w.ajax(w.extend({url:e,type:t,dataType:a,data:n,success:r},w.isPlainObject(e)&&e))}}),w.ajaxPrefilter(function(e){var t;for(t in e.headers)"content-type"===t.toLowerCase()&&(e.contentType=e.headers[t]||"")}),w._evalUrl=function(e,t,n){return w.ajax({url:e,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,converters:{"text script":function(){}},dataFilter:function(e){w.globalEval(e,t,n)}})},w.fn.extend({wrapAll:function(e){var t;return this[0]&&(h(e)&&(e=e.call(this[0])),t=w(e,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){for(var e=this;e.firstElementChild;)e=e.firstElementChild;return e}).append(this)),this},wrapInner:function(e){return h(e)?this.each(function(t){w(this).wrapInner(e.call(this,t))}):this.each(function(){var t=w(this),n=t.contents();n.length?n.wrapAll(e):t.append(e)})},wrap:function(e){var t=h(e);return this.each(function(n){w(this).wrapAll(t?e.call(this,n):e)})},unwrap:function(e){return this.parent(e).not("body").each(function(){w(this).replaceWith(this.childNodes)}),this}}),w.expr.pseudos.hidden=function(e){return!w.expr.pseudos.visible(e)},w.expr.pseudos.visible=function(e){return!!(e.offsetWidth||e.offsetHeight||e.getClientRects().length)},w.ajaxSettings.xhr=function(){try{return new e.XMLHttpRequest}catch(e){}};var Ht={0:200,1223:204},zt=w.ajaxSettings.xhr();d.cors=!!zt&&"withCredentials"in zt,d.ajax=zt=!!zt,w.ajaxTransport(function(t){var n,r;if(d.cors||zt&&!t.crossDomain)return{send:function(a,i){var o,s=t.xhr();if(s.open(t.type,t.url,t.async,t.username,t.password),t.xhrFields)for(o in t.xhrFields)s[o]=t.xhrFields[o];for(o in t.mimeType&&s.overrideMimeType&&s.overrideMimeType(t.mimeType),t.crossDomain||a["X-Requested-With"]||(a["X-Requested-With"]="XMLHttpRequest"),a)s.setRequestHeader(o,a[o]);n=function(e){return function(){n&&(n=r=s.onload=s.onerror=s.onabort=s.ontimeout=s.onreadystatechange=null,"abort"===e?s.abort():"error"===e?"number"!=typeof s.status?i(0,"error"):i(s.status,s.statusText):i(Ht[s.status]||s.status,s.statusText,"text"!==(s.responseType||"text")||"string"!=typeof s.responseText?{binary:s.response}:{text:s.responseText},s.getAllResponseHeaders()))}},s.onload=n(),r=s.onerror=s.ontimeout=n("error"),void 0!==s.onabort?s.onabort=r:s.onreadystatechange=function(){4===s.readyState&&e.setTimeout(function(){n&&r()})},n=n("abort");try{s.send(t.hasContent&&t.data||null)}catch(e){if(n)throw e}},abort:function(){n&&n()}}}),w.ajaxPrefilter(function(e){e.crossDomain&&(e.contents.script=!1)}),w.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(e){return w.globalEval(e),e}}}),w.ajaxPrefilter("script",function(e){void 0===e.cache&&(e.cache=!1),e.crossDomain&&(e.type="GET")}),w.ajaxTransport("script",function(e){var t,n;if(e.crossDomain||e.scriptAttrs)return{send:function(r,a){t=w("<script>").attr(e.scriptAttrs||{}).prop({charset:e.scriptCharset,src:e.url}).on("load error",n=function(e){t.remove(),n=null,e&&a("error"===e.type?404:200,e.type)}),m.head.appendChild(t[0])},abort:function(){n&&n()}}});var $t,Bt=[],Wt=/(=)\?(?=&|$)|\?\?/;w.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=Bt.pop()||w.expando+"_"+Tt.guid++;return this[e]=!0,e}}),w.ajaxPrefilter("json jsonp",function(t,n,r){var a,i,o,s=!1!==t.jsonp&&(Wt.test(t.url)?"url":"string"==typeof t.data&&0===(t.contentType||"").indexOf("application/x-www-form-urlencoded")&&Wt.test(t.data)&&"data");if(s||"jsonp"===t.dataTypes[0])return a=t.jsonpCallback=h(t.jsonpCallback)?t.jsonpCallback():t.jsonpCallback,s?t[s]=t[s].replace(Wt,"$1"+a):!1!==t.jsonp&&(t.url+=(St.test(t.url)?"&":"?")+t.jsonp+"="+a),t.converters["script json"]=function(){return o||w.error(a+" was not called"),o[0]},t.dataTypes[0]="json",i=e[a],e[a]=function(){o=arguments},r.always(function(){void 0===i?w(e).removeProp(a):e[a]=i,t[a]&&(t.jsonpCallback=n.jsonpCallback,Bt.push(a)),o&&h(i)&&i(o[0]),o=i=void 0}),"script"}),d.createHTMLDocument=(($t=m.implementation.createHTMLDocument("").body).innerHTML="<form></form><form></form>",2===$t.childNodes.length),w.parseHTML=function(e,t,n){return"string"!=typeof e?[]:("boolean"==typeof t&&(n=t,t=!1),t||(d.createHTMLDocument?((r=(t=m.implementation.createHTMLDocument("")).createElement("base")).href=m.location.href,t.head.appendChild(r)):t=m),i=!n&&[],(a=A.exec(e))?[t.createElement(a[1])]:(a=be([e],t,i),i&&i.length&&w(i).remove(),w.merge([],a.childNodes)));var r,a,i},w.fn.load=function(e,t,n){var r,a,i,o=this,s=e.indexOf(" ");return s>-1&&(r=ht(e.slice(s)),e=e.slice(0,s)),h(t)?(n=t,t=void 0):t&&"object"===(void 0===t?"undefined":_typeof(t))&&(a="POST"),o.length>0&&w.ajax({url:e,type:a||"GET",dataType:"html",data:t}).done(function(e){i=arguments,o.html(r?w("<div>").append(w.parseHTML(e)).find(r):e)}).always(n&&function(e,t){o.each(function(){n.apply(this,i||[e.responseText,t,e])})}),this},w.expr.pseudos.animated=function(e){return w.grep(w.timers,function(t){return e===t.elem}).length},w.offset={setOffset:function(e,t,n){var r,a,i,o,s,c,u=w.css(e,"position"),l=w(e),p={};"static"===u&&(e.style.position="relative"),s=l.offset(),i=w.css(e,"top"),c=w.css(e,"left"),("absolute"===u||"fixed"===u)&&(i+c).indexOf("auto")>-1?(o=(r=l.position()).top,a=r.left):(o=parseFloat(i)||0,a=parseFloat(c)||0),h(t)&&(t=t.call(e,n,w.extend({},s))),null!=t.top&&(p.top=t.top-s.top+o),null!=t.left&&(p.left=t.left-s.left+a),"using"in t?t.using.call(e,p):("number"==typeof p.top&&(p.top+="px"),"number"==typeof p.left&&(p.left+="px"),l.css(p))}},w.fn.extend({offset:function(e){if(arguments.length)return void 0===e?this:this.each(function(t){w.offset.setOffset(this,e,t)});var t,n,r=this[0];return r?r.getClientRects().length?(t=r.getBoundingClientRect(),n=r.ownerDocument.defaultView,{top:t.top+n.pageYOffset,left:t.left+n.pageXOffset}):{top:0,left:0}:void 0},position:function(){if(this[0]){var e,t,n,r=this[0],a={top:0,left:0};if("fixed"===w.css(r,"position"))t=r.getBoundingClientRect();else{for(t=this.offset(),n=r.ownerDocument,e=r.offsetParent||n.documentElement;e&&(e===n.body||e===n.documentElement)&&"static"===w.css(e,"position");)e=e.parentNode;e&&e!==r&&1===e.nodeType&&((a=w(e).offset()).top+=w.css(e,"borderTopWidth",!0),a.left+=w.css(e,"borderLeftWidth",!0))}return{top:t.top-a.top-w.css(r,"marginTop",!0),left:t.left-a.left-w.css(r,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var e=this.offsetParent;e&&"static"===w.css(e,"position");)e=e.offsetParent;return e||ne})}}),w.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(e,t){var n="pageYOffset"===t;w.fn[e]=function(r){return H(this,function(e,r,a){var i;if(y(e)?i=e:9===e.nodeType&&(i=e.defaultView),void 0===a)return i?i[t]:e[r];i?i.scrollTo(n?i.pageXOffset:a,n?a:i.pageYOffset):e[r]=a},e,r,arguments.length)}}),w.each(["top","left"],function(e,t){w.cssHooks[t]=ze(d.pixelPosition,function(e,n){if(n)return n=He(e,t),Le.test(n)?w(e).position()[t]+"px":n})}),w.each({Height:"height",Width:"width"},function(e,t){w.each({padding:"inner"+e,content:t,"":"outer"+e},function(n,r){w.fn[r]=function(a,i){var o=arguments.length&&(n||"boolean"!=typeof a),s=n||(!0===a||!0===i?"margin":"border");return H(this,function(t,n,a){var i;return y(t)?0===r.indexOf("outer")?t["inner"+e]:t.document.documentElement["client"+e]:9===t.nodeType?(i=t.documentElement,Math.max(t.body["scroll"+e],i["scroll"+e],t.body["offset"+e],i["offset"+e],i["client"+e])):void 0===a?w.css(t,n,s):w.style(t,n,a,s)},t,o?a:void 0,o)}})}),w.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){w.fn[t]=function(e){return this.on(t,e)}}),w.fn.extend({bind:function(e,t,n){return this.on(e,null,t,n)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,n,r){return this.on(t,e,n,r)},undelegate:function(e,t,n){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",n)},hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)}}),w.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),function(e,t){w.fn[t]=function(e,n){return arguments.length>0?this.on(t,null,e,n):this.trigger(t)}});var Ut=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;w.proxy=function(e,t){var n,r,i;if("string"==typeof t&&(n=e[t],t=e,e=n),h(e))return r=a.call(arguments,2),(i=function(){return e.apply(t||this,r.concat(a.call(arguments)))}).guid=e.guid=e.guid||w.guid++,i},w.holdReady=function(e){e?w.readyWait++:w.ready(!0)},w.isArray=Array.isArray,w.parseJSON=JSON.parse,w.nodeName=j,w.isFunction=h,w.isWindow=y,w.camelCase=W,w.type=b,w.now=Date.now,w.isNumeric=function(e){var t=w.type(e);return("number"===t||"string"===t)&&!isNaN(e-parseFloat(e))},w.trim=function(e){return null==e?"":(e+"").replace(Ut,"")},"function"==typeof define&&define.amd&&define("jquery",[],function(){return w});var Gt=e.jQuery,Xt=e.$;return w.noConflict=function(t){return e.$===w&&(e.$=Xt),t&&e.jQuery===w&&(e.jQuery=Gt),w},void 0===t&&(e.jQuery=e.$=w),w}),define("jqueryplugins",["jquery"],function(e){e.prototype.extend({popAttr:function(e){var t=this.attr(e);return this.removeAttr(e),t},popData:function(e){var t=this.data(e);return this.removeData(e),t},tag:function(){return this[0]&&this[0].tagName&&this[0].tagName.toLowerCase()},textNodes:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"*";return 1===this.length&&this[0]instanceof Text?[this[0]]:this.get().concat(this.contents().get(),this.find(e).contents().get()).filter(function(e,t,n){return e instanceof Text&&n.indexOf(e)===t}).sort(function(e,t){return 2&e.compareDocumentPosition(t)?1:-1})},findAndFilter:function(e){return this.filter(e).add(this.find(e))}})}),function(){var e=void 0,t={};function n(){for(var e=0;e<arguments.length;e++)for(var t in arguments[e])this[t]=arguments[e][t]}function r(e,t){e.childAt=e.childAt||{};for(var n=t.start;n<t.end;n+=1)e.childAt[n]=t}function a(e,t,n,r){return!(e.canFollow&&!(e.canFollow.indexOf(n&&n.type)>-1)||e.cannotFollow&&(-1!==e.cannotFollow.indexOf(n&&n.type)||e.cannotFollow.indexOf("text")>-1&&r)||e.peek&&e.peek.toLowerCase()!==t.slice(0,e.peek.length).toLowerCase())}function i(e){for(var n=e.innerText,r=[],i=0,s=i,c=n.length,u=null;i<c;){for(var l=n.slice(i),p=(r.length?r[0]:e).innerMode,f=0,d=p.length;f<d;f+=1){var h=t[p[f]];if(a(h,l,u,s<i)&&h.pattern.test(l)){var y=h.pattern.exec(l),m=h.fn(y),g=!1,v=0;if(m.matches){for(;v<r.length;v+=1){var b=r[v].type;if(b in m.matches){g=!0;break}0===b.indexOf("verbatim")&&(b="verbatimOpener"),m.cannotCross&&m.cannotCross.indexOf(b)>-1&&(v=r.length-1)}if(v>=r.length&&!m.isFront)continue}s<i&&e.addChild({type:"text",text:n.slice(s,i),innerMode:p}),s=i+=(u=e.addChild(m)).text.length,g&&(o(e,u,r[v]),r=r.slice(v+1)),u.isFrontToken()&&r.unshift(u);break}}f===d&&(i+=1,null===u&&(u={type:"text"}))}for(s<i&&e.addChild({type:"text",text:n.slice(s,i),innerMode:(r.length?r[0]:e).innerMode});r.length>0;)r.shift().demote();return e}function o(e,t,n){var a=e.children.indexOf(t),i=e.children.indexOf(n);t.children=e.children.splice(i+1,a-(i+1)),t.children.forEach(function(e){r(t,e)}),t.type=t.matches[n.type],t.innerText="";for(var o=0,s=t.children.length;o<s;o++)t.innerText+=t.children[o].text;t.start=n.start,t.text=n.text+t.innerText+t.text,Object.keys(n).forEach(function(e){Object.hasOwnProperty.call(t,e)||(t[e]=n[e])}),t.isFront&&(t.isFront=!1),e.children.splice(i,1),r(e,t)}n.prototype={constructor:n,addChild:function(e){var t=this.lastChildEnd(),a=new n({start:t,end:e.text&&t+e.text.length,children:[]},e);return a.innerText&&i(a),this.children.push(a),r(this,a),a},firstChild:function(){return this.children&&this.children[0]||null},lastChild:function(){return this.children&&this.children[this.children.length-1]||null},lastChildEnd:function(){var e=this.lastChild();return e?e.end:this.start+Math.max(0,this.text.indexOf(this.innerText))},tokenAt:function(e){if(e<this.start||e>=this.end)return null;if(this.childAt)return this.childAt[e]&&this.childAt[e].tokenAt(e)||this;if(this.children.length)for(var t=0;t<this.children.length;t+=1){var n=this.children[t].tokenAt(e);if(n)return n}return this},pathAt:function(e){if(e<this.start||e>=this.end)return[];if(this.childAt)return(this.childAt[e]&&this.childAt[e].pathAt(e)||[]).concat(this);var t=[];if(this.children.length)for(var n=0;n<this.children.length;n+=1){var r=this.children[n].pathAt(e);if(r.length){t.concat(r);break}}return t.concat(this)},nearestTokenAt:function(e){return e<this.start||e>=this.end?null:this.children?this.children.reduce(function(t,n){return t||(e>=n.start&&e<n.end?n:null)},null):this},everyLeaf:function(e){return this.children&&0!==this.children.length?this.children.reduce(function(t,n){return t&&n.everyLeaf(e)},!0):!!e(this)},isWhitespace:function(){return this.everyLeaf(function(e){return"whitespace"===e.type||!e.text.trim()})},isFrontToken:function(){return this.isFront},isBackToken:function(){return"matches"in this},demote:function(){this.type="text"},error:function(e){this.type="error",this.message=e},toString:function(){var e=this.type+"("+this.start+"\u2192"+this.end+")";return this.children&&this.children.length>0&&(e+="["+this.children+"]"),e}},e={lex:function(t,r){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"start";return i(new n({type:"root",start:r||0,end:t.length,text:t,innerText:t,children:[],childAt:{},innerMode:e.modes[a]}))},rules:t,modes:{}},"object"===("undefined"==typeof module?"undefined":_typeof(module))?module.exports=e:"function"==typeof define&&define.amd?define("lexer",[],function(){return e}):this&&this.loaded?(this.modules||(this.modules={}),this.modules.Lexer=e):this.TwineLexer=e}.call(eval("this")||("undefined"!=typeof global?global:window)),function(){var e;function t(e){return e&&"object"===(void 0===e?"undefined":_typeof(e))?(Object.keys(e).forEach(function(n){e[n]=t(e[n])}),e):(e+"").replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")}function n(e){return function(){return"("+e+Array.apply(0,arguments).join("|")+")"}}var r=n("?:"),a=n("?!"),i=n("?="),o="[ \\f\\t\\v\\u00a0\\u2000-\\u200a\\u2028\\u2029\\u202f\\u205f\\u3000]*",s=o.replace("*","+"),c="\\b",u="[\\w\\-\\u00c0-\\u00de\\u00df-\\u00ff\\u0150\\u0170\\u0151\\u0171\\uD800-\\uDFFF]",l=u.replace("\\-",""),p=r("\\n","$"),f=o+"(\\*+)"+s,d=o+"((?:0\\.)+)"+s,h=o+"-{3,}"+o+p,y=o+"(==+>|<=+|=+><=+|<==+>)"+o+p,m=o+"(=+\\|+|\\|+=+|=+\\|+=+|\\|=+\\|)"+o+p,g={opener:"\\[\\[(?!\\[)",text:"("+function(){return"[^"+Array.apply(0,arguments).map(t).join("")+"]*"}("]")+")",rightSeparator:r("\\->","\\|"),leftSeparator:"<\\-",closer:"\\]\\]",legacySeparator:"\\|",legacyText:"("+r("[^\\|\\]]","\\]"+a("\\]"))+"+)"},v=l+"*"+l.replace("\\w","a-zA-Z")+l+"*",b="\\$("+v+")",w="_("+v+")",T="'s"+s+"("+v+")",S="("+v+")"+s+"of"+c+a("it\\b"),x="'s"+s,k=r("it","time","visits?","exits?","pos")+c,O="its"+s+"("+v+")",j="its"+s,A="("+v+")"+s+"of"+s+"it"+c,C="of\\b"+s+"it"+c,E={opener:"\\(",name:"("+r("\\$","_")+"?"+u+"+):"+a("\\/"),closer:"\\)"},_=r("=<","=>","[gl]te?\\b","n?eq\\b","isnot\\b","are\\b","x\\b","isa\\b","or"+s+"a"+c),N="[a-zA-Z][\\w\\-]*",P="(?:\"[^\"]*\"|'[^']*'|[^'\">])*?",I="\\|("+u+"+)(>|\\))",M="(<|\\()("+u+"+)\\|",D="\\b(\\d+(?:\\.\\d+)?(?:[eE][+\\-]?\\d+)?)"+a("m?s")+c;g.main=g.opener+r(g.text+g.rightSeparator,g.text.replace("*","*?")+g.leftSeparator)+g.text,e={upperLetter:"[A-Z\\u00c0-\\u00de\\u0150\\u0170]",lowerLetter:"[a-z0-9_\\-\\u00df-\\u00ff\\u0151\\u0171]",anyLetter:u,anyLetterStrict:l,whitespace:s.replace("[","[\\n\\r"),escapedLine:"\\\\\\n\\\\?|\\n\\\\",br:"\\n(?!\\\\)",commentFront:"\x3c!--",commentBack:"--\x3e",tag:"<\\/?"+N+P+">",tagPeek:"<",scriptStyleTag:"<("+r("script","style","textarea")+")"+P+">[^]*?<\\/\\1>",scriptStyleTagOpener:"<",url:"("+r("https?","mailto","javascript","ftp","data")+":\\/\\/[^\\s<]+[^<.,:;\"')\\]\\s])",bullet:"\\*",hr:h,heading:"[ \\f\\t\\v\\u00a0\\u2000-\\u200a\\u2028\\u2029\\u202f\\u205f\\u3000]*(#{1,6})[ \\f\\t\\v\\u00a0\\u2000-\\u200a\\u2028\\u2029\\u202f\\u205f\\u3000]*",align:y,column:m,bulleted:f,numbered:d,strikeOpener:t("~~"),italicOpener:t("//"),boldOpener:t("''"),supOpener:t("^^"),strongFront:t("**"),strongBack:t("**"),emFront:t("*"),emBack:t("*"),verbatimOpener:"`+",collapsedFront:"{",collapsedBack:"}",hookAppendedFront:"\\["+a("=+"),hookPrependedFront:I+"\\["+a("=+"),hookFront:"\\["+a("=+"),hookBack:"\\]"+a(M),hookAppendedBack:"\\]"+M,unclosedHook:"\\[=+",unclosedHookPrepended:I+"\\[=+",unclosedCollapsed:"\\{=+",passageLink:g.main+g.closer,passageLinkPeek:"[[",legacyLink:g.opener+g.legacyText+g.legacySeparator+g.legacyText+g.closer,legacyLinkPeek:"[[",simpleLink:g.opener+g.legacyText+g.closer,simpleLinkPeek:"[[",macroFront:E.opener+i(E.name),macroFrontPeek:"(",macroName:E.name,groupingFront:"\\("+a(E.name),groupingFrontPeek:"(",groupingBack:"\\)",twine1Macro:"<<[^>\\s]+\\s*(?:\\\\.|'(?:[^'\\\\]*\\\\.)*[^'\\\\]*'|\"(?:[^\"\\\\]*\\\\.)*[^\"\\\\]*\"|[^'\"\\\\>]|>(?!>))*>>",twine1MacroPeek:"<<",validPropertyName:v,property:T,propertyPeek:"'s",belongingProperty:S,possessiveOperator:x,belongingOperator:"of\\b",belongingOperatorPeek:"of",itsOperator:j,itsOperatorPeek:"its",belongingItOperator:C,belongingItOperatorPeek:"of",variable:b,variablePeek:"$",tempVariable:w,tempVariablePeek:"_",hookName:"\\?("+u+"+)\\b",hookNamePeek:"?",cssTime:"(\\d+\\.?\\d*|\\d*\\.?\\d+)(m?s)\\b",colour:r(r("Red","Orange","Yellow","Lime","Green","Cyan","Aqua","Blue","Navy","Purple","Fuchsia","Magenta","White","Gray","Grey","Black","Transparent"),"#[\\dA-Fa-f]{3}(?:[\\dA-Fa-f]{3})?"),datatype:r("alnum","alphanumeric","any(?:case)?","array","bool(?:ean)?","changer","colou?r","const","command","dm","data"+r("map","type","set"),"ds","digit","gradient","empty","even","int"+a("o")+"(?:eger)?","lambda","lowercase","macro","linebreak","num(?:ber)?","odd","str(?:ing)?","uppercase","whitespace")+c,number:D,boolean:r("true","false")+c,identifier:k,itsProperty:O,itsPropertyPeek:"its",belongingItProperty:A,escapedStringChar:"\\\\[^\\n]",singleStringOpener:"'",doubleStringOpener:'"',singleStringCloser:"'",doubleStringCloser:'"',is:"is"+a(s+"not"+c,s+"an?"+c,s+"in"+c,s+"<",s+">")+c,isNot:"is"+s+"not"+a(s+r("an?","in")+c)+c,isA:"is"+s+"an?"+c,isNotA:"is"+s+"not"+s+"an?"+c,matches:"matches\\b",doesNotMatch:"does"+s+"not"+s+"match"+c,and:"and\\b",or:"or\\b",not:"not\\b",inequality:"((?:is(?:"+s+"not)?"+o+")*)("+r("<(?!=)","<=",">(?!=)",">=")+")",isIn:"is"+s+"in"+c,contains:"contains\\b",doesNotContain:"does"+s+"not"+s+"contain"+c,isNotIn:"is"+s+"not"+s+"in"+c,addition:t("+")+a("="),subtraction:t("-")+a("=","type"),multiplication:t("*")+a("="),division:r("/","%")+a("="),comma:",",spread:"\\.\\.\\."+a("\\."),to:r("to\\b","="),into:"into\\b",making:"making\\b",where:"where\\b",when:"when\\b",via:"via\\b",each:"each\\b",augmentedAssign:r("\\+","\\-","\\*","\\/","%")+"=",bind:"2?bind\\b",typeSignature:t("-type")+c,incorrectOperator:_},"object"===("undefined"==typeof module?"undefined":_typeof(module))?module.exports=e:"function"==typeof define&&define.amd?define("patterns",[],function(){return e}):this&&this.loaded?(this.modules||(this.modules={}),this.modules.Patterns=e):this.Patterns=e}.call(eval("this")||("undefined"!=typeof global?global:window)),function(){var e=void 0;Object.assign=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e};var t=Object.keys,n=Object.assign;function r(r){return Object.freeze({lex:function(r){function a(e){return e=e||"innerText",function(t){var n=t.reduceRight(function(e,t,n){return e||(n?t:"")},""),r={};return r[e]=n,r}}function i(e,t){var n={};return n[e]=t,function(){return{isFront:!0,matches:n,cannotCross:["verbatimOpener"]}}}var o=Object.bind(0,null);function s(e,t){return Object.keys(t).forEach(function(n){var r=t[n].fn;t[n].fn=function(t){var a=r(t);return a.text||(a.text=t[0]),a.type||(a.type=n),a.innerMode||(a.innerMode=e),a}}),t}var c=[],u=[],l=[],p=s(c,{hr:{fn:o},bulleted:{fn:function(e){return{depth:e[1].length}}},numbered:{fn:function(e){return{depth:e[1].length/2}}},heading:{fn:function(e){return{depth:e[1].length}}},align:{fn:function(e){var t=void 0,n=e[1],r=n.indexOf("><");return~r?25===(t=Math.round(r/(n.length-2)*50))&&(t="center"):"<"===n[0]&&">"===n.slice(-1)?t="justify":n.indexOf(">")>-1?t="right":n.indexOf("<")>-1&&(t="left"),{align:t}}},column:{fn:function(e){var t=void 0,n=e[1],r=n.indexOf("|");return r&&r<n.length-1?t="center":"|"===n[0]&&"|"===n.slice(-1)?t="none":r===n.length-1?t="right":r||(t="left"),{column:t,width:/\|+/.exec(n)[0].length,marginLeft:/^=*/.exec(n)[0].length,marginRight:/=*$/.exec(n)[0].length}}}});t(p).forEach(function(e){p[e].canFollow=[null,"br","hr","bulleted","numbered","heading","align","column","escapedLine"],p[e].cannotFollow=["text"]});var f=s(c,{twine1Macro:{fn:function(){return{type:"error",message:"Harlowe macros use a different syntax to Twine 1, SugarCube, and Yarn macros."}}},emBack:{fn:function(){return{matches:{emFront:"em"},cannotCross:["verbatimOpener"]}}},strongBack:{fn:function(){return{matches:{strongFront:"strong"},cannotCross:["verbatimOpener"]}}},strongFront:{fn:function(){return{isFront:!0}}},emFront:{fn:function(){return{isFront:!0}}},boldOpener:{fn:i("boldOpener","bold")},italicOpener:{fn:i("italicOpener","italic")},strikeOpener:{fn:i("strikeOpener","strike")},supOpener:{fn:i("supOpener","sup")},commentFront:{fn:function(){return{isFront:!0}}},commentBack:{fn:function(){return{matches:{commentFront:"comment"}}}},scriptStyleTag:{fn:o},tag:{fn:o},url:{fn:o},hookPrependedFront:{fn:function(e){return{name:e[1],hidden:")"===e[2],isFront:!0,tagPosition:"prepended"}}},hookFront:{fn:function(){return{isFront:!0}}},hookBack:{fn:function(){return{matches:{hookPrependedFront:"hook",hookFront:"hook"},cannotCross:["verbatimOpener"]}}},hookAppendedBack:{fn:function(e){return{name:e[2],hidden:"("===e[1],tagPosition:"appended",matches:{hookFront:"hook"},cannotCross:["verbatimOpener"]}}},unclosedHook:{fn:o},unclosedHookPrepended:{fn:function(e){return{type:"unclosedHook",name:e[1],hidden:")"===e[2]}}},verbatimOpener:{fn:function(e){var t=e[0].length,n={};return n["verbatim"+t]="verbatim",{type:"verbatim"+t,isFront:!0,matches:n}}},unclosedCollapsed:{fn:o},collapsedFront:{fn:function(){return{isFront:!0}}},collapsedBack:{fn:function(){return{matches:{collapsedFront:"collapsed"},cannotCross:["verbatimOpener"]}}},escapedLine:{fn:o},legacyLink:{fn:function(e){return{type:"twineLink",innerText:e[1],passage:e[2],innerMode:c}}},br:{fn:o}}),d=n(s(u,{macroFront:{fn:function(e){return{isFront:!0,name:e[1]}}},groupingBack:{fn:function(){return{matches:{groupingFront:"grouping",macroFront:"macro"},cannotCross:["singleStringOpener","doubleStringOpener"]}}},passageLink:{fn:function(e){var t=e[1]||"",n=e[2]||"",r=e[3]||"";return{type:"twineLink",innerText:n?r:t,passage:t?r:n,innerMode:c}}},simpleLink:{fn:function(e){return{type:"twineLink",innerText:e[1]||"",passage:e[1]||"",innerMode:c}}},variable:{cannotFollow:["macroFront"],fn:a("name")},tempVariable:{cannotFollow:["macroFront"],fn:a("name")}}),{hookFront:f.hookFront,hookBack:f.hookBack}),h=s(u,n({macroName:{canFollow:["macroFront"],fn:a("name")},groupingFront:{fn:function(){return{isFront:!0}}},property:{fn:a("name"),canFollow:["variable","hookName","property","tempVariable","colour","itsProperty","belongingItProperty","macro","grouping","string","datatype","hook","boolean","number"]},possessiveOperator:{fn:o},itsProperty:{cannotFollow:["text"],fn:a("name")},itsOperator:{cannotFollow:["text"],fn:o},belongingItProperty:{cannotFollow:["text"],fn:a("name")},belongingItOperator:{cannotFollow:["text"],fn:o},belongingProperty:{cannotFollow:["text"],fn:a("name")},belongingOperator:{cannotFollow:["text"],fn:o},escapedStringChar:{fn:function(){return{type:"text"}}},singleStringOpener:{fn:function(){return{isFront:!0,matches:{singleStringOpener:"string"},innerMode:l}}},doubleStringOpener:{fn:function(){return{isFront:!0,matches:{doubleStringOpener:"string"},innerMode:l}}},hookName:{fn:a("name")},cssTime:{fn:function(e){return{value:+e[1]*("s"===e[2].toLowerCase()?1e3:1)}}},datatype:{cannotFollow:["text"],fn:function(e){return{name:e[0].toLowerCase()}}},colour:{cannotFollow:["text"],fn:function(e){var t=e[0].toLowerCase(),n={red:"e61919",orange:"e68019",yellow:"e5e619",lime:"80e619",green:"19e619",cyan:"19e5e6",aqua:"19e5e6",blue:"197fe6",navy:"1919e6",purple:"7f19e6",fuchsia:"e619e5",magenta:"e619e5",white:"fff",black:"000",gray:"888",grey:"888"};return{colour:Object.hasOwnProperty.call(n,t)?"#"+n[t]:t}}},number:{fn:function(e){return{value:parseFloat(e[0])}}},inequality:{fn:function(e){return{operator:e[2],negate:e[1].indexOf("not")>-1}}},augmentedAssign:{fn:function(e){return{operator:e[0][0]}}},identifier:{fn:a("name"),cannotFollow:["text"]},whitespace:{fn:o,cannotFollow:"text"},incorrectOperator:{fn:function(e){var t={"=>":">=","=<":"<=",gte:">=",lte:"<=",gt:">",lt:"<",eq:"is",isnot:"is not",neq:"is not",isa:"is a",are:"is",x:"*","or a":"or"}[e[0].toLowerCase().replace(/\s+/g," ")];return{type:"error",message:"Please say "+(t?"'"+t+"'":"something else")+" instead of '"+e[0]+"'.",explanation:"In the interests of readability, I want certain operators to be in a specific form."}},cannotFollow:"text"}},["boolean","is","to","into","where","when","via","making","each","and","or","not","isNot","contains","doesNotContain","isIn","isA","isNotA","isNotIn","matches","doesNotMatch","bind"].reduce(function(e,t){return e[t]={fn:o,cannotFollow:["text"]},e},{}),["comma","spread","typeSignature","addition","subtraction","multiplication","division"].reduce(function(e,t){return e[t]={fn:o},e},{}))),y=s(l,{singleStringCloser:h.singleStringOpener,doubleStringCloser:h.doubleStringOpener,escapedStringChar:h.escapedStringChar});c.push.apply(c,_toConsumableArray(t(p)).concat(_toConsumableArray(t(d)),_toConsumableArray(t(f)))),u.push.apply(u,_toConsumableArray(t(d)).concat(_toConsumableArray(t(h)))),l.push.apply(l,_toConsumableArray(t(y)));var m=n({},p,f,d,h,y);t(m).forEach(function(t){var n=e[t];m[t].pattern="string"!=typeof n?n:RegExp("^(?:"+n+")","i"),e[t+"Peek"]&&(m[t].peek=e[t+"Peek"])}),n(r.rules,m);var g=r.modes;return g.start=g.markup=c,g.macro=u,g.string=l,r}(r).lex,Patterns:e})}"object"===("undefined"==typeof module?"undefined":_typeof(module))?(e=require("./patterns"),module.exports=r(require("./lexer"))):"function"==typeof define&&define.amd?define("markup",["lexer","patterns"],function(t,n){return e=n,r(t)}):this&&this.loaded&&this.modules?(e=this.modules.Patterns,this.modules.Markup=r(this.modules.Lexer)):(e=this.Patterns,this.TwineMarkup=r(this.TwineLexer))}.call(eval("this")||("undefined"!=typeof global?global:window)),define("utils/polyfills",[],function(){var e=Array.prototype;"function"!=typeof e.includes&&(e.includes=function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(!Number.isNaN(t)&&Number.isFinite(n)&&void 0!==t)return e.indexOf.call(this,t,n)>-1;var r=Object(this),a=parseInt(r.length);if(a<=0)return!1;for(var i=n>=0?n:Math.max(0,a+n);i<a;){if(Object.is(t,r[i]))return!0;i+=1}return!1}),!window.Symbol&&(window.Symbol={iterator:"_es6-shim iterator_"})}),define("utils",["jquery","markup","utils/polyfills"],function(e){var t=String.fromCharCode,n="audio,blockquote,canvas,div,h1,h2,h3,h4,h5,hr,ol,p,pre,table,ul,video,tw-align,tw-story,tw-passage,tw-sidebar,tw-columns,tw-column,tw-meter".split(","),r="a,b,i,em,strong,sup,sub,abbr,acronym,s,strike,del,big,small,script,img,button,input,tw-link,tw-broken-link,tw-verbatim,tw-collapsed,tw-error,tw-colour,tw-icon".split(","),a=["audio"],i=[function(e){return t(e)!==t(e).toLowerCase()},function(e){return t(e)!==t(e).toUpperCase()},function(e){return t(e).toLowerCase()!==t(e).toUpperCase()}].map(function(e){return"["+Array.from(Array(57343)).map(function(e,t){return t}).filter(e).map(function(e,n,r){return e===r[n-1]+1&&e===r[n+1]-1?"-":t(e)}).join("").replace(/\-+/g,"-")+"]"}),o=_slicedToArray(i,3),s=o[0],c=o[1],u=o[2];function l(e){return"instant"===e?0:800}var p=void 0,f=[],d={},h=0,y={},m=0,g={},v=void 0;function b(e,t,n,r,a){var i=null,o=0,s=t+n;function c(n){1&e[0].compareDocumentPosition(document)&&(s=0),i&&(s-=n-i,o+=n-i),i=n,r>0&&h+m>0&&(s-=r,e.css("animation-delay",(v.cssTimeUnit(e.css("animation-delay"))||0)-r+"ms")),s<=0?a(o):requestAnimationFrame(c),s<=t&&e.css("visibility","")}s?requestAnimationFrame(c):c()}return e(document.documentElement).on("keydown keyup mousedown mouseup",function(e){var t=e.key,n=e.button,r=e.type.includes("down"),a=t?d:y,i=t&&v.insensitiveName(t)||n;a[i]&&!r?t?h=Math.max(h-1,0):m=Math.max(m-1,0):!a[i]&&r&&(t?h+=1:m+=1),a[i]=r}).on("mousemove",function(e){var t=e.pageX,n=e.pageY;g.x=t,g.y=n}),v={lockProperty:function(e,t,n){var r=Object.create({configurable:0,writable:0});return n&&(r.value=n),Object.defineProperty(e,t,r),e},permutations:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];for(var r=t.length,a=[[].concat(t)],i=Array(r).fill(0),o=1,s=void 0,c=void 0;o<r;)i[o]<o?(s=o%2&&i[o],c=t[o],t[o]=t[s],t[s]=c,++i[o],o=1,a.push([].concat(t))):(i[o]=0,++o);return a},shuffled:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.reduce(function(e,t,n){var r=Math.random()*(n+1)|0;return r===n?e.push(t):(e.push(e[r]),e[r]=t),e},[])},matMul:function(e,t){for(var n=arguments.length,r=Array(n>2?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];var i;if(r.length>0)return(i=v).matMul.apply(i,[v.matMul(e,t)].concat(r));if(!t)return e;for(var o=[],s=0;s<e.length;s++){o[s]=[];for(var c=0;c<t[0].length;c++){for(var u=0,l=0;l<e[0].length;l++)u+=e[s][l]*t[l][c];o[s][c]=u}}return o},cssTimeUnit:function(e){return"ms"===(e=e.toLowerCase()).slice(-2)?+e.slice(0,-2)||0:"s"===e.slice(-1)&&1e3*+e.slice(0,-1)||0},nth:function(e){var t=(+e+"").slice(-1);return e+("1"===t?"st":"2"===t?"nd":"3"===t?"rd":"th")},plural:function(e,t){return e+" "+t+(e>1?"s":"")},andList:function(e){return 1===e.length?e[0]:e.slice(0,-1).join(", ")+" and "+e[e.length-1]},realWhitespace:"[ \\n\\r\\f\\t\\v\\u00a0\\u2000-\\u200a\\u2028\\u2029\\u202f\\u205f\\u3000]",anyRealLetter:"[\\dA-Za-z\\u00c0-\\u00de\\u00df-\\u00ff\\u0150\\u0170\\u0151\\u0171\\uD800-\\uDFFF]",anyUppercase:s,anyLowercase:c,anyCasedLetter:u,anyNewline:"(?:\\n|\\r|\\r\\n)",unescape:function(e){return e.replace(/&(?:amp|lt|gt|quot|nbsp|zwnj|#39|#96);/g,function(e){return{"&amp;":"&","&gt;":">","&lt;":"<","&quot;":'"',"&#39;":"'","&nbsp;":String.fromCharCode(160),"&zwnj;":String.fromCharCode(8204)}[e]})},escape:function(e){return e.replace(/[&><"']/g,function(e){return{"&":"&amp;",">":"&gt;","<":"&lt;",'"':"&quot;","'":"&#39;"}[e]})},insensitiveName:function(e){return(e+"").toLowerCase().replace(/-|_/g,"")},allKeysDown:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.every(function(e){return d[e]})},someKeysDown:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.some(function(e){return d[e]})},buttonsDown:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.every(function(e){return y[e]})},anyInputDown:function(){return h+m>0},mouseCoords:g,parentColours:function(e){for(var t={colour:null,backgroundColour:null},n=/^\w+a\(.+?,\s*0\s*\)$|^transparent$/;e.length&&e[0]!==document;e=e.parent()){if(!t.backgroundColour){var r=e.css("background-color");r.match(n)||(t.backgroundColour=r)}if(!t.colour){var a=e.css("color");a.match(n)||(t.colour=a)}if(t.colour&&t.backgroundColour)return t}return{colour:"#fff",backgroundColour:"#000"}},childrenProbablyInline:function(e){var t=[];return[].every.call(e.findAndFilter("*"),function(e){return!!(e.hidden||/none|inline/.test(e.style.display)||/display: (none|inline)/.test(e.getAttribute("style")))||!n.includes(e.tagName.toLowerCase())&&!/display: (?!none|inline|inherit|unset)/.test(e.getAttribute("style"))&&(!!r.includes(e.tagName.toLowerCase())||(t.push(e),!0))})&&t.every(function(e){return window.getComputedStyle(e).display.includes("inline")})},transitionReplace:function(t,n,r){var a=t.closest("tw-hook");a.length>0&&(t=a);var i=e("<tw-transition-container>").css("position","relative");i.insertBefore(t.first());var o=void 0;n&&(o=e("<tw-transition-container>").appendTo(i),n.appendTo(o));var s=e("<tw-transition-container>").css("position","absolute").prependTo(i);t.detach().appendTo(s),v.transitionOut(s,r),n&&v.transitionIn(o,r,function(){o.unwrap().children().first().unwrap()})},transitionOut:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:void 0;0!==e.length&&(n=n||l(t),(e.length>1||!v.childrenProbablyInline(e)||!["tw-hook","tw-passage","tw-expression"].includes(e.tag()))&&(e=e.wrapAll("<tw-transition-container>").parent()),o&&e.css("transform-origin",o),e.attr("data-t8n",t).addClass("transition-out").css({"animation-duration":n+"ms","animation-delay":r-i+"ms"}),requestAnimationFrame(function(){v.childrenProbablyInline(e)?e.css("display","inline"):e.parent().is("tw-backdrop,tw-story")||e[0].setAttribute("style",e[0].getAttribute("style")+"display:block !important;width:100%")}),b(e,n,r-i,a,function(){e.remove()}))},transitionIn:function(t,n,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,c=arguments.length>6&&void 0!==arguments[6]?arguments[6]:void 0;if(0!==t.length){r=r||l(n);var u=t.length>1||!v.childrenProbablyInline(t)||!["tw-hook","tw-passage","tw-expression"].includes(t.tag());u&&(t=t.wrapAll("<tw-transition-container>").parent()),c&&t.css("transform-origin",c),t.attr("data-t8n",n).addClass("transition-in").css(Object.assign({"animation-duration":r+"ms","animation-delay":i-s+"ms"},i-s?{visibility:"hidden"}:{})),requestAnimationFrame(function(){v.childrenProbablyInline(t)?t.css("display","inline"):t.parent().is("tw-backdrop,tw-story")||t[0].setAttribute("style",t[0].getAttribute("style")+"display:block !important;width:100%")}),b(t,r,i-s,o,function(n){var r=0===t.filter(a.join(",")).length;u&&r?(t.find("tw-transition-container").each(function(t,r){(r=e(r)).css("animation-delay",v.cssTimeUnit(r.css("animation-delay")||0)-n+"ms")}),t.contents().unwrap()):t.removeClass("transition-in").removeAttr("data-t8n")})}},debounce:function(e){var t=void 0,n=void 0,r=0,a=function a(){Date.now()-r>300?(t=0,e.apply(void 0,_toConsumableArray(n))):t=requestAnimationFrame(a)};return function(){r=Date.now(),n=arguments,t&&cancelAnimationFrame(t),t=requestAnimationFrame(a)}},impossible:function(e,t){window.console&&console.error(e+"(): "+t)},assertMustHave:function(e,t){if(window.console)for(var n=0;n<t.length;n+=1)t[n]in e||console.error("Assertion failed: object lacks property "+t[n])},assertOnlyHas:function(e,t){if(window.console)for(var n in e)t.includes(n)||console.error("Assertion failed: object had unexpected property '"+n+"'!")},onStartup:function(e){f?f.push(e):e()},get storyElement(){return p}},e(function(){p=e("tw-story"),f.forEach(function(e){return e()}),f=null}),Object.freeze(v)}),define("utils/naturalsort",[],function(){return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:String;return function(n,r){var a,i,o,s,c=/(^-?[0-9]+(\.?[0-9]*)[df]?e?[0-9]?$|^0x[0-9a-f]+$|[0-9]+)/gi,u=/(^([\w ]+,?[\w ]+)?[\w ]+,?[\w ]+\d+:\d+(:\d+)?[\w ]?|^\d{1,4}[\/\-]\d{1,4}[\/\-]\d{1,4}|^\w+, \w+ \d+, \d{4})/,l=/^0x[0-9a-f]+$/i,p=/^0/,f=t(n).trim(),d=t(r).trim(),h=f.replace(c,"\0$1\0").replace(/\0$/,"").replace(/^\0/,"").split("\0"),y=d.replace(c,"\0$1\0").replace(/\0$/,"").replace(/^\0/,"").split("\0"),m=parseInt(f.match(l))||1!==h.length&&f.match(u)&&Date.parse(f),g=parseInt(d.match(l))||m&&d.match(u)&&Date.parse(d)||null;if(e&&window.Intl&&window.Intl.Collator&&(o=window.Intl.Collator(e)),g){if(m<g)return-1;if(m>g)return 1}for(var v=0,b=Math.max(h.length,y.length);v<b;v++){if(a=!(h[v]||"").match(p)&&parseFloat(h[v])||h[v]||0,i=!(y[v]||"").match(p)&&parseFloat(y[v])||y[v]||0,isNaN(a)!==isNaN(i))return isNaN(a)?1:-1;if((void 0===a?"undefined":_typeof(a))!==(void 0===i?"undefined":_typeof(i)))a+="",i+="";else if("string"==typeof a&&o&&0!==(s=o.compare(a,i)))return s;if(a<i)return-1;if(a>i)return 1}return 0}}}),define("twinescript/compiler",["utils"],function(e){var t=e.impossible,n=JSON.stringify;function r(e,t){for(var n=0;n<e.length;n+=1)if(t.includes(e[n].type))return n;return NaN}function a(e,t){var n=[];return e.length?([["error"],["comma"],["to","into"],["where","when","via"],["making","each"],["typeSignature"],["augmentedAssign"],["and","or"],["is","isNot"],["contains","doesNotContain","isIn","isNotIn"],["isA","isNotA","matches","doesNotMatch"],["inequality"],["addition","subtraction"],["multiplication","division"],{rightAssociative:["spread","bind"]},{rightAssociative:["not","positive","negative"]},{rightAssociative:["belongingProperty","belongingItProperty","belongingOperator","belongingItOperator"]},["property","itsProperty","possessiveOperator","itsOperator"],["twineLink"],["macro"],["grouping"]]["most"===t?"reverse":"valueOf"]().some(function(t){var a=void 0;if(a=t.rightAssociative?r(e,t.rightAssociative):function(e,t){return e.length-1-r.apply(void 0,[[].concat(_toConsumableArray(e)).reverse(),t])}(e,t),!Number.isNaN(a)&&a>-1)return n=[e[a],a],!0}),n):n}function i(e){if("inequality"===e.type){var t=e.operator;return e.negate?{">":"<=","<":">=",">=":"<","<=":">"}[t]:t}return e.type}function o(e){var t=i(e);return{">":"<","<":">",">=":"<=","<=":">=",contains:"isIn",doesNotContain:"isNotIn",isIn:"contains",isA:"typifies",typifies:"isA",isNotA:"untypifies",untypifies:"isNotA"}[t]||t}var s=["inequality","is","isNot","isIn","contains","doesNotContain","isNotIn","isA","typifies","isNotA","untypifies","matches","doesNotMatch"];return function e(r){var c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},u=c.isVarRef,l=c.isTypedVar,p=c.whitespaceError,f=c.elidedComparison,d=c.testNeedsRight,h="Operations.Identifiers.it";if(!(r=[].concat(r)).length)return u&&p?"TwineError.create('operation',"+n(p)+")":"";var y=void 0;if(1===r.length){var m=(y=r[0]).type;if("identifier"===m)return u?"VarRef.create(Operations.Identifiers,"+n(y.text)+")":"Operations.Identifiers."+y.text.toLowerCase()+" ";if("variable"===m||"tempVariable"===m){var g="VarRef.create("+("tempVariable"===m?"section.stackTop.tempV":"State.v")+"ariables,"+n(y.name)+")"+(u||l?"":".get()");return l?"TypedVar.create(Datatype.create('any'),"+g+")":g}if("hookName"===m)return"HookSet.create({type:'name', data:'"+y.name+"'}) ";if("string"===m)return y.text.replace(/\n/g,"\\n");if("hook"===m)return"CodeHook.create("+n(y.text.slice(1,-1))+","+n(y.html||"")+")";if("colour"===m)return"Colour.create("+n(y.colour)+")";if("datatype"===m)return"Datatype.create("+n(y.name)+")";if("blockedValue"===m)return"section.blockedValue()";if("root"===m)return e(y.children);if("whitespace"===m&&u&&p)return"TwineError.create('operation',"+n(p)+")"}var v,b=a(r,"least"),w=_slicedToArray(b,2);y=w[0],v=w[1];var T=(y||{}).type,S=r.slice(0,v),x=r.slice(v+1),k=function(e,t){return{isVarRef:!0,isTypedVar:t,whitespaceError:"I need usable data to be on the "+e+' of "'+y.text+'".'}},O="must",j="mustn't",A="may",C=void 0,E=void 0,_="",N="",P="",I=O,M=O,D=!1;if(T)if("comma"===T)N=",",M=A;else if("spread"===T)_="Operations.makeSpreader(",P=")",I=A;else if("bind"===T)_="VarBind.create(",E=e(x,k("right")),P=(y.text.startsWith("2")?",'two way'":"")+")",I=j;else if("to"===T)_="Operations.makeAssignmentRequest(Operations.setIt(",E=e(x,k("right")),N="),",C=e(S,k("left",!0)),P=",'to')";else if("into"===T)_="Operations.makeAssignmentRequest(",E=e(S,k("left")),N=",Operations.setIt(",C=e(x,k("right",!0)),P="),'into')";else if("typeSignature"===T)_="TypedVar.create(",N=",",E=e(x,k("right")),P=")",l=!1;else if("where"===T||"when"===T||"via"===T)_="Lambda.create(",C=e(S,{isVarRef:!0,whitespaceError:null}).trim()||"undefined",N=","+n(y.type)+",",E=n(e(x)),P=","+n(r.map(function(e){return e.text}).join(""))+")";else if("making"===T||"each"===T)"each"===T?(_="Lambda.create(",E=e(x,k("right")).trim(),P=",'where','true',"+n(r.map(function(e){return e.text}).join(""))+")",I=A):(_="Lambda.create(",C=e(S,{isVarRef:!0,whitespaceError:null}).trim()||"undefined",N=","+n(y.type)+",",E=e(x,k("right")).trim(),P=","+n(r.map(function(e){return e.text}).join(""))+")");else if("augmentedAssign"===T)_="Operations.makeAssignmentRequest(",C=e(S,k("left")),N=",",E="Operations["+n(y.operator)+"]("+e(S)+","+e(x)+")",P=","+n(y.operator)+")";else if("and"===T||"or"===T){var R=function e(t){var n=a(t,"least"),r=_slicedToArray(n,2),i=r[0],o=r[1];if(i)return s.includes(i.type)?i:["and","or"].includes(i.type)?e(t.slice(0,o))||e(t.slice(o+1)):void 0},L=R(S),q=R(x),F="TwineError.create('operation', 'This use of \"is not\" and \""+T+"\" is grammatically ambiguous','Maybe try rewriting this as \"__ is not __ "+T+" __ is not __\"') ";if(_="Operations."+T+"(",N=",",P=")",f===y.type)_=P="",C=e(S,{isVarRef:u,elidedComparison:f}).trim(),E=e(x,{elidedComparison:f}).trim();else if(L&&!q){var V=L,H=n(i(V));if("isNot"===V.type||"isNotA"===V.type||"untypifies"===V.type)return F;E="Operations.elidedComparisonOperator("+n(y.type)+","+H+","+e(x,{elidedComparison:T})+")"}else if(!L&&q){var z=q,$=r.indexOf(z),B=n(o(z));if("isNot"===z.type||"isNotA"===z.type||"untypifies"===z.type)return F;E="Operations.elidedComparisonOperator("+n(y.type)+","+B+","+e(S,{elidedComparison:T})+")",C=e([].concat(_toConsumableArray(r.slice($+1)),[Object.assign(Object.create(z),_defineProperty({},"inequality"===z.type?"operator":"type",o(z)))],_toConsumableArray(r.slice(v+1,$))))}u=!1}else if(s.includes(T))D=!0,u=!1,_="Operations["+n(i(y))+"](",N=",",P=")";else if("addition"===T||"subtraction"===T){if(!e(S,{testNeedsRight:!0}).trim())return y.type={addition:"positive",subtraction:"negative"}[T],e(r,{isVarRef:u,whitespaceError:p,elidedComparison:f,testNeedsRight:d});u=!1,_="Operations["+n(y.text)+"](",N=",",P=")"}else if("multiplication"===T||"division"===T)u=!1,_="Operations["+n(y.text)+"](",N=",",P=")";else if("positive"===T||"negative"===T)u=!1,C="negative"===T?"-1":"1",_="Operations['*'](",N=",",P=")";else if("not"===T)_="Operations.not(",E=e(x),P=")",I=A;else if("belongingProperty"===T)_="VarRef.create(",E=e(x,k("right")),P=","+n(y.name)+")"+(u?"":".get()"),I=A;else if("belongingOperator"===T||"belongingItOperator"===T)C=y.type.includes("It")?h:e(x,k("right")),E=e(S),_="VarRef.create(",N=",{computed:true,value:",P="})"+(u?"":".get()");else if("property"===T)_="VarRef.create(",C=e(S,k("left")),P=","+n(y.name)+")"+(u?"":".get()"),M=A;else if("itsProperty"===T||"belongingItProperty"===T)_="VarRef.create(",C=h,P=","+n(y.name)+")"+(u?"":".get()"),I=M=A;else if("possessiveOperator"===T||"itsOperator"===T)y.type.includes("it")&&(C=h,I=A),_="VarRef.create(",N=",{computed:true,value:",P="})"+(u?"":".get()"),l=!1;else if("twineLink"===T)N='Macros.run("link-goto", [section,'+n(y.innerText)+","+n(y.passage)+"])",I=M=j;else if("macro"===T){var W=y.children[0],U="$"===W.text[0]||"_"===W.text[0];"macroName"===W.type||U||t("Compiler.compile","macro token had no macroName child token"),N="Macros.run"+(U?"Custom":"")+"("+(U?"VarRef.create("+("_"===W.text[0]?"section.stackTop.tempV":"State.v")+"ariables,"+n(W.text.trim().slice(1,-1))+").get()":'"'+y.name+'"')+", [section,"+e(y.children.slice(1),{isTypedVar:l})+"])",I=M=j}else if("grouping"===T)N="("+e(y.children,{isVarRef:u})+")",I=M=j;else if("error"===T)return"TwineError.create('syntax',"+n(y.message)+(y.explanation?", "+n(y.explanation):"")+")";return v>-1?(C=(C||e(S,{isVarRef:u,isTypedVar:l})).trim(),E=(E||e(x)).trim(),D&&!C&&(C=h),I===O&&!C||M===O&&!E?d&&M&&!E?"":"TwineError.create('operation','I need usable code to be "+(I===O?"left ":"")+(I===O&&M===O?"and ":"")+(M===O?"right ":"")+'of "'+y.text+"\"')":I===j&&C||M===j&&E?"TwineError.create('operation','There can't be code to the "+(I===j?"left ":"")+(I===j&&M===j?"or ":"")+(M===j?"right ":"")+'of "'+y.text+"\"')":_+C+N+E+P):1===r.length?(("value"in r[0]?r[0].value:r[0].text)+"").trim()||" ":r.reduce(function(t,n){return t+e(n,{isVarRef:u,isTypedVar:l})},"")}}),define("internaltypes/twineerror",["jquery","utils"],function(e,t){var n=t.impossible,r=t.escape;e(document.documentElement).on("click","tw-folddown",function(t){var n=t.target;for((n=e(n)).toggleClass("open");n&&!n.next().length;)n=n.parent();n&&n.next().toggle()});var a={syntax:"The markup seems to contain a mistake.",saving:"I tried to save or load the game, but I couldn't do it.",operation:"I tried to perform an operation on some data, but the data's type was incorrect.",macrocall:"I tried to use a macro, but its call wasn't written correctly.",datatype:"I tried to use a macro, but was given the wrong type of data to it.",custommacro:"I tried to use a custom macro, but its code hook had a mistake in it.",infinite:"I almost ended up doing the same thing over and over, forever.",property:"I tried to access a value in a string/array/datamap, but I couldn't find it.",unimplemented:"I currently don't have this particular feature. I'm sorry.",javascript:"This error message was reported by your browser's Javascript engine. I don't understand it either, but it usually means that an expression was badly written.",propagated:"Click the 'Open' button to see the code hook as it was executed.",user:"This is a custom error created by (error:). It usually means you used a custom macro incorrectly.",assertion:"This command exists to provide a helpful error if a certain important condition wasn't true."},i={error:[],warning:[]},o={create:function(e,t,r,i){return t&&"string"==typeof t||n("TwineError.create","has a bad message string"),r||e in a||n("TwineError.create","no error explanation given"),"user"!==e&&(t=t[0].toUpperCase()+t.slice(1)),Object.assign(Object.create(this),{type:e,message:t,explanation:r,source:void 0,innerDOM:i,appendTitleText:!1})},fromError:function(e){return o.create("javascript","\u2615 "+e.message)},containsError:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.reduce(function(e,t){return e||(t instanceof Error?t:o.isPrototypeOf(t)?t:!!Array.isArray(t)&&o.containsError.apply(o,_toConsumableArray(t)))},!1)},createWarning:function(e,t){return Object.assign(this.create(e,t),{warning:!0})},render:function(n){var o=this;n=n||this.source||"";var s=e("<tw-error class='"+("javascript"===this.type?"javascript ":"")+(this.warning?"warning":"error")+"' title='"+r(n)+"'>"+r(this.message+(this.appendTitleText?" "+n:""))+"</tw-error>"),c=e("<tw-error-explanation>").text(this.explanation||a[this.type]).hide(),u=e("<tw-folddown tabindex=0>");return this.innerDOM&&e("<tw-open-button>").on("click",function(){var n=e("<tw-backdrop><tw-dialog></tw-backdrop>");n.find("tw-dialog").prepend(o.innerDOM,e("<tw-link tabindex=0>OK</tw-link>").on("click",function(){o.innerDOM.detach(),n.remove()}).wrap("<tw-dialog-links>").parent()),t.storyElement.prepend(n)}).appendTo(s),s.append(u).append(c),s.data("TwineError",this),i.error.forEach(function(e){return e(o,n)}),s},on:function(e,t){if(e in i)return"function"!=typeof t||i[e].includes(t)||i[e].push(t),o;n("TwineError.on","invalid event name")}};return o}),define("renderer",["utils","markup","twinescript/compiler","internaltypes/twineerror"],function(e,t,n,r){var a=e.escape,i=e.impossible,o=e.insensitiveName,s=void 0;function c(e,t){return"<"+t+">"+e+"</"+t+">"}function u(e,t){var n=s.render(e.children);return n&&c(n,t)}var l,p,f="text-align: center; max-width:50%; ",d=RegExp(t.Patterns.macroFront+t.Patterns.macroName,"ig");return s={options:{debug:!1,blockerMacros:[],metadataMacros:[]},preprocess:function(e){var a=s.options.metadataMacros;if(!(e.match(d)||[]).some(function(e){return a.some(function(t){return o(e.slice(1,-1))===t})}))return{};var i=!1,c={};return t.lex(e).children.forEach(function e(t){if("macro"===t.type){if(a.some(function(e){return t.name===e})){if(r.isPrototypeOf(c[t.name]))return;if(i)return void(c[t.name]=r.create("syntax","The ("+t.name+":) macro can't appear after non-metadata macros."));if(c[t.name])return void(c[t.name]=r.create("syntax","There is more than one ("+t.name+":) macro."));c[t.name]={code:n(t),source:t.text}}else i=!0;t.children.forEach(function e(t){"macro"===t.type&&a.some(function(e){return t.name===e})?c[t.name]=r.create("syntax","The ("+t.name+":) macro can't be inside another macro."):t.children.forEach(e)})}else t.children.forEach(e)}),c},exec:(l=void 0,p=void 0,function(e){return"string"!=typeof e?(i("Renderer.exec","source was not a string, but "+(void 0===e?"undefined":_typeof(e))),""):e===l?p:(l=e,p=s.render(t.lex(e).children))}),render:function e(i){var l="",p=[];if(!i)return l;for(var d=i.length,h=0;h<d;h+=1){var y=i[h];switch(y.type){case"error":l+=r.create("syntax",y.message,y.explanation).render(a(y.text))[0].outerHTML;break;case"numbered":case"bulleted":var m="numbered"===y.type?"ol":"ul";l+="<"+m+">";for(var g=1;h<d&&i[h];){if("br"===i[h].type){if(l+="</li>",!i[h+1]||i[h+1].type!==y.type)break}else i[h].type===y.type?(l+=("<"+m+">").repeat(Math.max(0,i[h].depth-g)),l+=("</"+m+">").repeat(Math.max(0,g-i[h].depth)),l+="<li>",g=i[h].depth):l+=e([i[h]]);h+=1}l+=("</"+m+">").repeat(g+1);break;case"align":for(;y&&"align"===y.type;){var v=y.align,b=h+=1;if("left"===v){h-=1;break}for(;h<d&&i[h]&&"align"!==i[h].type;)h+=1;var w=e(i.slice(b,h)),T="";switch(v){case"center":T+=f+"margin-left: auto; margin-right: auto;";break;case"justify":case"right":T+="text-align: "+v+";";break;default:+v&&(T+=f+"margin-left: "+v+"%;")}l+="<tw-align "+(T?'style="'+T+'"':"")+">"+w+"</tw-align>\n",y=i[h]}break;case"column":for(var S=[];y&&"column"===y.type;){var x=y.column,k=h+=1;if("none"===x){h-=1;break}for(;h<d&&i[h]&&"column"!==i[h].type;)h+=1;S.push({text:y.text,type:x,body:e(i.slice(k,h)),width:y.width,marginLeft:y.marginLeft,marginRight:y.marginRight}),y=i[h]}S.length&&function(){var e=S.reduce(function(e,t){return e+t.width},0);l+="<tw-columns>"+S.map(function(t){return"<tw-column type="+t.type+'  style="width:'+t.width/e*100+"%; margin-left: "+t.marginLeft+"em; margin-right: "+t.marginRight+'em;">'+t.body+"</tw-column>\n"}).join("")+"</tw-columns>"}();break;case"heading":for(l+="<h"+y.depth+">";++h<d&&i[h];){if("br"===i[h].type){l+="</h"+y.depth+">";break}l+=e([i[h]])}break;case"br":if(!p.length||/td|th/.test(p[0])){l+="<br>";for(var O=i[h+1];O&&("br"===O.type||"tag"===O.type&&/^<br\b/i.test(O.text));)l+="<tw-consecutive-br"+("tag"===O.type?" data-raw":"")+"></tw-consecutive-br>",O=i[(h+=1)+1]}break;case"hr":l+="<hr>";break;case"escapedLine":case"comment":break;case"inlineUrl":l+='<a class="link" href="'+a(y.text)+'">'+y.text+"</a>";break;case"scriptStyleTag":case"tag":var j=y.text.toLowerCase();/^<\/?(?:table|thead|tbody|tr|tfoot|td|th)\b/.test(j)&&p[y.text.startsWith("</")?"shift":"unshift"](j),l+=y.text.startsWith("</")?y.text:y.text.replace(/>$/," data-raw>");break;case"sub":case"sup":case"strong":case"em":l+=u(y,y.type);break;case"strike":l+=u(y,"s");break;case"bold":l+=u(y,"b");break;case"italic":l+=u(y,"i");break;case"twineLink":var A=_slicedToArray(t.lex("(link-goto:"+JSON.stringify(y.innerText)+","+JSON.stringify(y.passage)+")").children,1)[0];l+='<tw-expression type="macro" name="link-goto"'+(s.options.debug?' title="'+a(y.text)+'"':"")+' js="'+a(n(A))+'"></tw-expression>';break;case"hook":l+="<tw-hook "+(y.hidden?"hidden ":"")+(y.name?'name="'+o(y.name)+'"':"")+(s.options.debug&&y.name?' title="Hook: ?'+y.name+'"':"")+' source="'+a(y.innerText)+'"></tw-hook>';break;case"unclosedHook":return l+="<tw-hook "+(y.hidden?"hidden ":"")+(y.name?'name="'+o(y.name)+'"':"")+'source="'+a(i.slice(h+1,d).map(function(e){return e.text}).join(""))+'"></tw-hook>';case"verbatim":l+=c(a(y.innerText).replace(/\n/g,"<br>"),"tw-verbatim");break;case"collapsed":l+=u(y,"tw-collapsed");break;case"unclosedCollapsed":return l+="<tw-collapsed>"+e(i.slice(h+1,d))+"</tw-collapsed>";case"variable":case"tempVariable":case"macro":var C=function(){var t=[],i=[];if("macro"===y.type&&function n(r){"string"!==r.type&&"hook"!==r.type&&r.children.every(n);var a=r.firstChild();if("macro"===r.type&&a&&"macroName"===a.type&&s.options.blockerMacros.includes(o(a.text.slice(0,-1))))t.push(r);else if("hook"===r.type){if(!r.everyLeaf(function(e){return"error"!==e.type||(i.push(e),!1)}))return!1;r.html=e(r.children)}return!0}(y),i.length)return{v:r.create("syntax","This code hook's markup contained "+i.length+" error"+(i.length?"s":"")+":<br>\u2014"+i.map(function(e){return e.message}).join("<br>\u2014")).render(a(y.text))[0].outerHTML};var c=t.length&&t.map(function(e){var t=n(e);return e.type="blockedValue",t});l+='<tw-expression type="'+y.type+'" name="'+a(y.name||y.text)+'"'+(s.options.debug?' title="'+a(y.text)+'"':"")+(t.length?' blockers="'+a(JSON.stringify(c))+'"':"")+' js="'+a(n(y))+'"></tw-expression>',t.forEach(function(e){return e.type="macro"})}();if("object"===(void 0===C?"undefined":_typeof(C)))return C.v;break;default:l+=y.children&&y.children.length?e(y.children):y.text}}return l}},Object.freeze(s)}),define("passages",["jquery","utils/naturalsort","utils","markup","renderer","internaltypes/twineerror"],function(e,t,n,r,a,i){var o=n.unescape,s=n.onStartup,c=Object.assign;function u(e){var t=o(e.html()),n=a.preprocess(t);return c(new Map([["source",t],["tags",(e.attr("tags")||"").split(/\s/)||[]],["name",e.attr("name")]]),{TwineScript_TypeName:"a passage datamap",TwineScript_ObjectName:"a passage datamap",metadata:n})}var l=c(new Map,{TwineScript_ObjectName:"the Passages datamap",getTagged:function(e){var n=t("en",function(e){return e.get("name")}),r=[];return this.forEach(function(t){var n=t instanceof Map&&t.get("tags");Array.isArray(n)&&n.includes(e)&&r.push(t)}),r.sort(n)},getStorylets:function(e,n){var r=n?n.filter(e,[].concat(_toConsumableArray(l.values()))):[].concat(_toConsumableArray(l.values()));if(i.containsError(r))return r;var a=[],o=-1/0,s=r.reduce(function(t,n){if(t)return t;var r=n.get("storylet");if(r){var s=e.speculate(r,n.get("name"),"a (storylet:) macro");if(i.containsError(s))return s.message="There's an error in the storylet passage \""+n.get("name")+'":\n'+s.message,s.source=r.TwineScript_ToSource(),s;if(s){var c=n.get("exclusivity");o=Math.max(o,"number"==typeof c?c:0),a.push(n)}}},void 0);if(s)return s;var c=t("en");return a.filter(function(e){var t=e.get("exclusivity");return(t="number"==typeof t?t:0)===o}).sort(function(e,t){var n=e.get("urgency"),r=t.get("urgency");return(n="number"==typeof n?n:0)!==(r="number"==typeof r?r:0)?r-n:c(e.get("name"),t.get("name"))})},allStorylets:function(){return[].concat(_toConsumableArray(l.values())).filter(function(e){return e.get("storylet")})},loadMetadata:function(e){var t=[];return l.forEach(function(n){n.metadata&&Object.keys(n.metadata).forEach(function(r){if(i.containsError(n.metadata[r]))t.push(n.metadata[r]);else{var a=n.metadata[r],o=a.code,s=a.source,c=e.speculate(o,n.get("name"),"a ("+r+":) macro"),u='In "'+n.get("name")+'":\n';if(i.containsError(c))return c.message=u+c.message,c.source=s,void t.push(c);c instanceof Map?c.forEach(function(e,t){return l(t,e)}):l(r,c)}function l(e,r){n.has(e)?t.push(i.create("syntax","This passage's datamap already has a '"+JSON.stringify(e)+"' data name.")):n.set(e,r)}}),n.metadata=void 0}),t},hasValid:function(e){var t=this.get(e);return t&&t instanceof Map&&t.has("source")},create:u});return s(function(){Array.from(e("tw-storydata > tw-passagedata")).forEach(function(t){t=e(t),l.set(t.attr("name"),new u(t))})}),l}),define("utils/operationutils",["utils/naturalsort","utils","internaltypes/twineerror","patterns"],function(e,t,n,r){var a=t.impossible,i=t.nth,o=t.insensitiveName,s=t.permutations,c=r.validPropertyName,u="object",l="boolean",p="string",f="number",d="function";function h(e){return!!e&&((void 0===e?"undefined":_typeof(e))===u||(void 0===e?"undefined":_typeof(e))===d)}function y(e){return e&&Object.getPrototypeOf(e)===Object.prototype}function m(e){return Array.isArray(e)?"array":e instanceof Map?"datamap":e instanceof Set?"dataset":(void 0===e?"undefined":_typeof(e))===p?p:e&&(void 0===e?"undefined":_typeof(e))===u?u:""}function g(e){if(!h(e))return e;if(_typeof(e.TwineScript_Clone)===d)return e.TwineScript_Clone();if(Array.isArray(e))return[].concat(_toConsumableArray(e));if(e instanceof Map)return new Map(e);if(e instanceof Set)return new Set(e);if((void 0===e?"undefined":_typeof(e))===d)return Object.assign(e.bind(),e);switch(Object.getPrototypeOf(e)){case Object.prototype:return Object.assign({},e);case null:return Object.assign(Object.create(null),e)}return a("OperationUtils.clone","The value "+e+" cannot be cloned!"),e}function v(e){return h(e)&&"TwineScript_ObjectName"in e?e.TwineScript_ObjectName:Array.isArray(e)?"an array":e instanceof Map?"a datamap":e instanceof Set?"a dataset":(void 0===e?"undefined":_typeof(e))===l?"the boolean value '"+e+"'":(void 0===e?"undefined":_typeof(e))===p||(void 0===e?"undefined":_typeof(e))===f?"the "+(void 0===e?"undefined":_typeof(e))+" "+JSON.stringify(e):void 0===e?"an empty variable":"...whatever this is"}function b(e,t){return(void 0===e?"undefined":_typeof(e))!==u&&(void 0===t?"undefined":_typeof(t))!==u?e===t:Array.isArray(e)&&Array.isArray(t)?e.length===t.length&&e.every(function(e,n){return b(t[n],e)}):e instanceof Map&&t instanceof Map?b(Array.from(e.entries()).sort(),Array.from(t.entries()).sort()):e instanceof Set&&t instanceof Set?b([].concat(_toConsumableArray(e)),[].concat(_toConsumableArray(t))):e&&_typeof(e.TwineScript_is)===d?e.TwineScript_is(t):e&&(void 0===e?"undefined":_typeof(e))===u&&t&&(void 0===t?"undefined":_typeof(t))===u&&y(e)&&y(t)?b(Object.getOwnPropertyNames(e).map(function(t){return[t,e[t]]}),Object.getOwnPropertyNames(t).map(function(e){return[e,t[e]]})):Object.is(e,t)}return Object.freeze({isObject:h,isPureObject:y,singleTypeCheck:function e(t,n){if(null===n)return void 0===t;var r=void 0===t?"undefined":_typeof(t);if((void 0===n?"undefined":_typeof(n))!==d&&n.pattern){if("optional"===n.pattern||"zero or more"===n.pattern)return void 0===t||e(t,n.innerType);if("either"===n.pattern)return n.innerType.some(function(n){return e(t,n)});if("lambda"===n.pattern&&e(t,n.innerType))return n.clauses.includes("where")==="where"in t&&n.clauses.includes("making")==="making"in t&&n.clauses.includes("via")==="via"in t&&n.clauses.includes("with")==="with"in t;if("insensitive set"===n.pattern)return n.innerType.includes(o(t));if("range"===n.pattern)return n.range(t);if("wrapped"===n.pattern)return e(t,n.innerType)}return(void 0===n||void 0!==t)&&("anything"===n.TwineScript_TypeName&&void 0!==t&&!t.TwineScript_Unstorable||"everything"===n.TwineScript_TypeName&&void 0!==t||(n===String?r===p:n===Boolean?r===l:n===parseInt?r===f&&!Number.isNaN(t)&&!(t+"").includes("."):n===Number?r===f&&!Number.isNaN(t):n===Array?Array.isArray(t):n===Map||n===Set?t instanceof n:Object.isPrototypeOf.call(n,t)))},isValidDatamapName:function(e,t){if(e instanceof Map||a("isValidDatamapName","called with non-Map"),n.containsError(t))return t;if((void 0===t?"undefined":_typeof(t))!==p&&(void 0===t?"undefined":_typeof(t))!==f)return n.create("property","Only strings and numbers can be used as data names for "+v(e)+", not "+v(t)+".");var r=(void 0===t?"undefined":_typeof(t))===p?+t:""+t;return!(!Number.isNaN(r)&&e.has(r))||n.create("property","You mustn't use both "+v(t)+" and "+v(r)+" as data names in the same datamap.")},collectionType:m,isSequential:function(e){return(void 0===e?"undefined":_typeof(e))===p||Array.isArray(e)||_typeof(e.hooks)===d},unstorableValue:function e(t){return t&&t.TwineScript_Unstorable&&t||Array.isArray(t)&&t.find(e)||t instanceof Map&&[].concat(_toConsumableArray(t.values())).find(e)||t instanceof Set&&[].concat(_toConsumableArray(t)).find(e)},clone:g,objectName:v,typeName:function e(t){var n=y(t);if(n&&t.innerType)return t.typeName?t.typeName:"insensitive set"===t.pattern?"a case-insensitive string name":"either"===t.pattern?(Array.isArray(t.innerType)||a("typeName",'"either" pattern had non-array inner type'),t.innerType.map(e).join(" or ")):"optional"===t.pattern?"(optional) "+e(t.innerType):e(t.innerType);if(n&&t.pattern&&"range"===t.pattern){if(t.name)return t.name;var r=t.min,i=t.max;return"a"+(r>0?" positive":"")+(t.integer?" whole":"")+" number"+(0===r?" between 0 and "+i:i<1/0?" up to "+i:"")}return t===String||t===Number||t===Boolean?"a "+_typeof(t()):t===parseInt?"a whole number":t===Map?"a datamap":t===Set?"a dataset":t===Array?"an array":h(t)&&"TwineScript_TypeName"in t?t.TwineScript_TypeName:v(t)},typeID:function(e){var t=void 0===e?"undefined":_typeof(e);return[l,p,f].includes(t)?t:Array.isArray(e)?"array":e instanceof Map?"datamap":e instanceof Set?"dataset":e.TwineScript_TypeID||""},toSource:function t(r,o){var s=n.containsError(r);return s&&a("toSource","received a TwineError: "+s.message),_typeof(r.TwineScript_ToSource)===d?r.TwineScript_ToSource():y(r)&&"first"in r&&"last"in r?(r.first<0?(-1!==r.first?i(-r.first):"")+"last":i(r.first+1))+"to"+(r.last<0?(-1!==r.last?i(-r.last):"")+"last":i(r.last+1)):Array.isArray(r)?"(a:"+("property"===o?r.map(function(e){return e+(e>0)}):r).map(t)+")":r instanceof Map?"(dm:"+Array.from(r.entries()).sort(function(t,n){return[t[0],n[0]].sort(e("en"))[0]===t[0]?-1:1}).map(function(e){return e.map(t)})+")":r instanceof Set?"(ds:"+Array.from(r).sort(e("en")).map(t)+")":(void 0===r?"undefined":_typeof(r))===f&&"property"===o?r<0?-1===r?"last":i(-r)+"last":i(r+1):(void 0===r?"undefined":_typeof(r))===p&&"property"===o?RegExp(c).test(r)?r:"("+JSON.stringify(r)+")":JSON.stringify(r)},is:b,contains:function(e,t){if(e||""===e){if((void 0===e?"undefined":_typeof(e))===p)return(void 0===t?"undefined":_typeof(t))!==p?n.create("operation",v(e)+" can only contain strings, not "+v(t)+"."):e.includes(t);if(Array.isArray(e))return e.some(function(e){return b(e,t)});if(e instanceof Set||e instanceof Map)return Array.from(e.keys()).some(function(e){return b(e,t)})}return n.create("operation",v(e)+" cannot contain any values, let alone "+v(t))},isA:function(e,t){return _typeof(t.TwineScript_IsTypeOf)===d?t.TwineScript_IsTypeOf(e):n.create("operation",'"is a" should only be used to compare type names, not '+v(t)+".")},matches:function e(t,r){var a=!1;if(t&&_typeof(t.TwineScript_IsTypeOf)===d){var i=t.TwineScript_IsTypeOf(r);if(n.containsError(i))return i;a|=i}if(r&&_typeof(r.TwineScript_IsTypeOf)===d){var o=r.TwineScript_IsTypeOf(t);if(n.containsError(o))return o;a|=o}if(a)return!0;if(Array.isArray(t)&&Array.isArray(r)){for(var c=0,u=0,l=!0;l&&c<t.length&&u<r.length;){var p=t[c],f=r[u];if(p.rest){for(;u<r.length&&e(p,f);)f=r[u+=1];c+=1}else if(f.rest){for(;c<t.length&&e(p,f);)p=t[c+=1];u+=1}else e(p,f)?(c+=1,u+=1):l=!1}return l&&c>=t.length&&u>=r.length}return t instanceof Map&&r instanceof Map?e(Array.from(t.entries()).sort(),Array.from(r.entries()).sort()):t instanceof Set&&r instanceof Set?(t=[].concat(_toConsumableArray(t)),s.apply(void 0,_toConsumableArray(r)).some(function(n){return e(t,n)})):b(t,r)},subset:function e(t,r,a){if(!r||!a)return n.create("macrocall","The sub"+m(t)+" index value must not be "+(r&&a)+".");var i=(void 0===t?"undefined":_typeof(t))===p;if(i&&(t=Array.from(t)),r<0&&(r=Math.max(0,t.length+r+1)),a<0&&(a=Math.max(0,t.length+a+1)),r>a)return e(arguments[0],a,r);var o=t.slice(r>0?r-1:r,a).map(g);return i?o.join(""):o},range:function e(t,n){if(t>n)return e(n,t);var r=[t];for(n-=t;n-- >0;)r.push(++t);return r},printBuiltinValue:function e(t){return n.containsError(t)?t:t&&_typeof(t.TwineScript_Print)===d?t.TwineScript_Print():t instanceof Map?(t=Array.from(t.entries()),n.containsError(t)?t:t.reduce(function(t,n){var r=_slicedToArray(n,2),a=r[0],i=r[1];return t+"<tr><td>`"+e(a)+"`</td><td>`"+e(i)+"`</td></tr>"},"<table class=datamap>")+"</table>"):t instanceof Set?Array.from(t.values()).map(e)+"":Array.isArray(t)?t.map(e)+"":t&&_typeof(t.jquery)===p?t:h(t)?n.create("unimplemented","I don't know how to print this value yet."):t+""},unique:function(e,t,n){return!n.slice(t+1).some(function(t){return b(e,t)})}})}),define("utils/renderutils",["jquery","utils","renderer"],function(e,t,n){var r=RegExp(t.realWhitespace+"+"),a=RegExp(t.realWhitespace+"+","g");function i(e,t,n){var r=e.textContent.length;if(!(t>=r)){var a=void 0,i=[a=0===t?e:e.splitText(t)];return n&&(n<=0&&(n=r-n),n<r&&i.push(a.splitText(n-t))),i}}var o,s=(o=void 0,function(){if(void 0!==o)return o;var t=e("<p>");return t[0].normalize?(t.append(document.createTextNode("0-"),document.createTextNode("2"),document.createTextNode(""))[0].normalize(),o=1===t.contents().length):o=!1});var c="tw-collapsed,[collapsing=true]";var u=/^(=*)([^=]+)=*$/;return Object.freeze({dialog:function(){var r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=r.section,i=r.parent,o=void 0===i?t.storyElement:i,s=r.cd,c=r.message,u=void 0===c?"":c,l=r.defaultValue,p=r.buttons,f=void 0===p?[{name:"OK",confirm:!0,callback:Object}]:p,d=e("<tw-backdrop><tw-dialog>"+(l||""===l?"<input type=text style='display:block;margin:0 auto'></input>\n":"")+"<tw-dialog-links>"+(f.length?f.reduce(function(e,t,n){var r=t.name;return e+"<tw-link style='margin:0 "+(n===f.length-1?"0 0 0.5em":0===n?"0.5em 0 0":"0.5em")+"' tabindex=0>"+r+"</tw-link>"},""):"<tw-link tabindex=0>"+f[0].name+"</tw-link>")+"</tw-dialog-links></tw-dialog></tw-backdrop>"),h=d.find("tw-dialog");if(o.append(d),a){a.renderInto(u,h,Object.assign({},s,{append:"prepend"}));var y=s&&s.transition&&d.find("tw-dialog > tw-transition-container");y&&y.length&&y.appendTo(d).append(h.prepend(y.contents().detach()))}else h.prepend(n.exec(u));if(l){var m=d.find("input").last();m.val(l).on("keypress",function(e){13===e.which&&(d.remove(),f.filter(function(e){return e.confirm}).forEach(function(e){return e.callback()}))}),setTimeout(function(){return m.focus()},100)}return f.reverse().forEach(function(t,n){e(d.find("tw-link").get(-n-1)).on("click",function(){d.remove(),t.callback()})}),d},realWhitespace:r,textNodeToChars:function(e){var t=[].concat(_toConsumableArray(e.textContent));return 1===t.length?[e]:t.reduce(function(e,t){return t.match(r)&&e.length&&e[e.length-1].match(r)?e[e.length-1]+=t:e.push(t),e},[]).reduce(function(t,n){var r=e;return n.length<e.textContent.length&&(e=e.splitText(n.length)),t.concat(r)},[])},findTextInNodes:function e(t,n){var r=[],a="",o=[];if(!t.length||!n)return o;for(;t.length>0;){r.push(t[0]),a+=t[0].textContent,t.shift();var s=a.indexOf(n);if(s>-1){for(var c,u=a.length-(s+n.length);s>=r[0].textContent.length;)s-=r[0].textContent.length,r.shift();if(1===r.length){var l=i(r[0],s,s+n.length);o.push(l[0]),l[1]&&t.unshift(l[1]);break}o.push(i(r[0],s,r[0].length)[0]),(c=o).push.apply(c,_toConsumableArray(r.slice(1,-1)));var p=i(r[r.length-1],0,r[r.length-1].textContent.length-u);o.push(p[0]),p[1]&&t.unshift(p[1]),o=o.filter(Boolean);break}}return[o].concat(_toConsumableArray(e(t,n)))},collapse:function(t){function n(t){return 0===e(this||t).parentsUntil(c).filter("tw-verbatim, tw-expression, [collapsing=false]").length}var r=function e(t){var n=t[0],r=t.parent();if(!r.length||t.findAndFilter("tw-story").length)return null;var a=r.textNodes().filter(function(e){var t=e.compareDocumentPosition(n);return 4&t&&!(8&t)});return(a=a[a.length-1])||e(r)}(t);e(r).parents(c).length||(r=null);var i=function e(t){var n=t[0],r=t.parent();if(!r.length||t.findAndFilter("tw-story").length)return null;var a=r.textNodes().filter(function(e){var t=e.compareDocumentPosition(n);return 2&t&&!(8&t)})[0];return a||e(r)}(t);e(i).parents(c).length||(i=null);var o="br:not([data-raw]),tw-consecutive-br:not([data-raw])";t.find(o).filter(n).replaceWith(document.createTextNode(" "));var u=(t=e(t.get().map(function(t){return e(t).filter(n).is(o)?e(document.createTextNode(" ")).replaceAll(t)[0]:t}))).textNodes(),l=0;u.reduce(function(e,t){return n(t)?(t.textContent=t.textContent.replace(a," ")," "!==t.textContent[0]||e&&e.textContent&&!(e.textContent.search(/\s$/)>-1)||(t.textContent=t.textContent.slice(1)),t):document.createTextNode("A")},r),[].concat(_toConsumableArray(u)).reverse().every(function(e){return!!n(e)&&(e.textContent.match(/^\s*$/)?(l+=e.textContent.length,e.textContent="",!0):(e.textContent=e.textContent.replace(/\s+$/,function(e){return l+=e.length,""}),!1))}),l>0&&i&&(u[u.length-1].textContent+=" "),t[0]&&s()&&t[0].normalize()},geomStringRegExp:u,geomParse:function(e){var t=e.length,n=u.exec(e)||[],r=_slicedToArray(n,3),a=r[0],i=r[1],o=r[2];return a?{marginLeft:i.length/t*100,size:o.length/t*100}:{marginLeft:0,size:0}}})}),define("datatypes/hookset",["jquery","utils","utils/renderutils","utils/operationutils"],function(e,t,n,r){var a=n.textNodeToChars,i=n.realWhitespace,o=n.findTextInNodes,s=r.toSource;function c(n){var r=n.dom,s=e();this.next&&(s=s.add(c.call(this.next,n)));var u=function(t,n){if(Array.isArray(n))return n.reduce(function(e,n){return e.add(t.get(n))},e());if(n&&"object"===(void 0===n?"undefined":_typeof(n))&&"first"in n&&"last"in n){var r=n.first,o=n.last,s=t.length;r<0&&(r+=s),o<0&&(o+=s);for(var c=[t.get(r)];r!==o;)r+=Math.sign(o-r),c.push(t.get(r));return e(c)}if("string"==typeof n){if("chars"===n){var u=[],l=!0,p=!1,f=void 0;try{for(var d,h=t.textNodes(":not(tw-error, tw-error *)")[Symbol.iterator]();!(l=(d=h.next()).done);l=!0){var y=d.value,m=!0,g=!1,v=void 0;try{for(var b,w=a(y)[Symbol.iterator]();!(m=(b=w.next()).done);m=!0){var T=b.value;T.textContent.match(i)||u.push(T)}}catch(e){g=!0,v=e}finally{try{!m&&w.return&&w.return()}finally{if(g)throw v}}}}catch(e){p=!0,f=e}finally{try{!l&&h.return&&h.return()}finally{if(p)throw f}}return e(u)}if("links"===n)return t.findAndFilter("tw-link, .enchantment-link");if("visited"===n)return t.findAndFilter("tw-link.visited");if("lines"===n){var S=t.findAndFilter("br:not(tw-sidebar *),tw-consecutive-br:not(tw-sidebar *)").get(),x=[[]];return t.textNodes(":not(tw-error, tw-error *):not(tw-sidebar, tw-sidebar *)").forEach(function(e){S.length&&2&e.compareDocumentPosition(S[0])&&(S.shift(),x.push([])),x[x.length-1]=x[x.length-1].concat(e)}),x=x.map(function(t){return t.map(function(n){for(var r=n.parentNode;e(r).textNodes().every(function(e){return t.includes(e)})&&!t.every(function(t){return e(r).has(t).length});){r=(n=r).parentNode}return n})}),e(x.map(function(t){return e(t).wrapAll("<tw-pseudo-hook>").parent()[0]}))}}return e(t.get(n))};if(this.selector){var l=void 0;if("string"===this.selector.type)l=function(t,n){var r=o(n.textNodes(),t),a=e();return r.forEach(function(t){a=a.add(e(t).wrapAll("<tw-pseudo-hook>").parent())}),a}(this.selector.data,r);else{if("base"===this.selector.type)return s.add(u(c.call(this.selector.data,n),this.property));var p=function(e){var n='tw-hook[name="'+(e=t.insensitiveName(e).replace(/"/g,"&quot;"))+'"],tw-enchantment[name="'+e+'"]';return n+={page:", tw-story",passage:", tw-passage",sidebar:", tw-sidebar",link:", tw-link, .enchantment-link"}[e]||""}(this.selector.data);l=r.findAndFilter(p).add(r.parentsUntil(t.storyElement.parent())).filter(p)}s=this.property?s.add(u(l,this.property)):s.add(l)}return s}function u(e){if(!e)return[];var n=e.selector,r=e.property,a=e.next;return[JSON.stringify(["base"===n.type?u(n.data):t.insensitiveName(n.data),r])].concat(_toConsumableArray(u(a))).sort()}var l=Object.freeze({forEach:function(t,n){var r=c.call(this,t).each(function(t){n(e(this),t)});return t.dom.findAndFilter("tw-pseudo-hook").contents().unwrap(),r},hooks:function(e){return c.call(this,e)},get TwineScript_ObjectName(){return this.property||this.next?"a complex hook name":"?"+this.selector.data+" (a hook name)"},TwineScript_TypeID:"hookName",TwineScript_TypeName:"a hook name (like ?this)",TwineScript_Unstorable:!0,TwineScript_ToSource:function(){var e="",n=this.selector,r=n.type,a=n.data;return"name"===r?a.match(RegExp("^"+t.anyRealLetter+"+$"))?e+="?"+a:e+="(hooks-named:"+JSON.stringify(a)+")":"string"===r?e+=JSON.stringify(a):"base"===r&&(e+=a.TwineScript_ToSource()+"'s "+s(this.property,"property")),this.next&&(e+=" + "+this.next.TwineScript_ToSource()),e},"TwineScript_+":function(e){for(var t=this.TwineScript_Clone(),n=t;n.next;)n=n.next;return n.next=e,t},TwineScript_is:function(e){return u(this)+""==u(e)+""},TwineScript_GetProperty:function(e){return l.create({type:"base",data:this},e,void 0)},TwineScript_Properties:["chars","links","lines","visited"],TwineScript_Clone:function(){return l.create(this.selector,this.property,this.next)},create:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;return Object.assign(Object.create(this||l),{selector:Object.freeze(e),property:t,next:n})},from:function(e){return l.isPrototypeOf(e)||"string"==typeof e||t.impossible("HookSet.from() was given a non-HookSet non-string."),l.isPrototypeOf(e)?e:l.create({type:"string",data:e})}});return l}),define("internaltypes/changedescriptor",["jquery","utils","renderer","datatypes/hookset"],function(e,t,n,r){var a=t.assertOnlyHas,i=t.impossible,o=t.transitionIn,s=n.exec,c=Object.assign,u=Object.keys,l=Object.create,p=Object.seal,f=function(e){return e.split(/\n/g).reduce(function(e,t,n,r){var a=r.length;return e.concat(document.createTextNode(t),n!==a-1&&document.createElement(t.length?"br":"tw-consecutive-br"))},[])},d=void 0,h={source:"",appendSource:null,enabled:!0,enablers:null,verbatim:!1,target:null,append:"",newTargets:null,transition:"",transitionTime:null,transitionDeferred:!1,transitionDelay:0,transitionSkip:0,transitionOrigin:null,loopVars:null,styles:null,attr:null,data:null,innerEnchantments:null,section:null,timestamp:0,summary:function(){var e=this;return["source","appendSource","enabled","verbatim","target","append","newTargets","transition","transitionTime","transitionDeferred","transitionDelay","transitionSkip","transitionOrigin","innerEnchantments","enablers"].filter(function(t){return e.hasOwnProperty(t)}).concat([this.attr.length&&"attr",this.styles.length&&"styles",u(this.loopVars).length&&"loopVars",u(this.data).length&&"data"].filter(Boolean))},create:function(e,t){var n=c(l(this),{attr:[].concat(this.attr||[]),styles:[].concat(this.styles||[]),loopVars:this.loopVars||{},data:this.data||{}},e);return t&&t.run(n),n},update:function(){var e=this,t=this.section,n=this.newTargets,a=this.transition,i=this.transitionDeferred,s=this.append,c=this.target;"function"==typeof c&&(c=c());var l=function(t){if(Array.isArray(e.styles)&&e.styles.length>0){var n=e.styles.reduce(function(e,t){return u(t).forEach(function(n){var r=t[n];e[+("function"==typeof r)].push(_defineProperty({},n,r))}),e},[[],[]]),r=_slicedToArray(n,2),a=r[0],i=r[1];a.forEach(function(e){return t.css(e)}),setTimeout(function(){i.forEach(function(e){return t.css(e)})})}e.attr&&e.attr.forEach(function(e){return t.attr(e)}),e.data&&t.data(e.data)};if(Array.isArray(n)&&n.length&&(c=n.map(function(e){return e.target})),[].concat(c).forEach(function(e){r.isPrototypeOf(e)?e.forEach(t,l):l(e)}),a&&!i&&!s){var p=c,f=void 0;do{!(f=p.data("timestamp"))&&(p=p.parent())}while(!f&&p.length);o(c,a,this.transitionTime,this.transitionDelay,this.transitionSkip,f?Date.now()-f:0,this.transitionOrigin)}},render:function(){var t=this,n=this.source,u=this.transition,l=this.transitionTime,p=this.transitionDeferred,y=this.enabled,m=this.enablers,g=this.data,v=this.section,b=this.newTargets,w=this.innerEnchantments,T=this.appendSource,S=this.target,x=this.target,k=this.append;if("function"==typeof S&&(S=S()),a(this,d),!k)return i("ChangeDescriptor.render","This doesn't have an 'append' method chosen."),e();if(m&&m.length){var O=m[0],j=O.descriptor,A=O.changer,C=j.render();if(A){var E=h.create({section:v,target:C});A.run(E),E.update()}return C}if(!y||void 0!==S.attr("hidden"))return h.create({target:S,attr:this.attr.filter(function(e){return!("style"in e)}),data:c({},g,{originalSource:n,hidden:!0})}).update(),e();if(Array.isArray(b)&&b.length&&(S=b),!S)return i("ChangeDescriptor.render","ChangeDescriptor has source but not a target!"),e();var _=e();if([].concat(S).filter(function(e){return!e.jquery}).map(function(e){var t=k,n=void 0;if(e.target&&e.append){var r=e;t=r.append,n=r.before,e=e.target}return{elements:e.hooks(v,x).filter(function(){return!(n&&1&this.compareDocumentPosition(document)&&2&this.compareDocumentPosition(x[0]))}),append:t}},[]).forEach(function(n){var r=n.elements,a=n.append;r.each(function(n,r){r=e(r),_=_.add(t.create({target:r,append:a,newTargets:null}).render()),r.filter("tw-pseudo-hook").contents().unwrap()})}),_.length||Array.isArray(S)||r.isPrototypeOf(S))return _;if(!(k in S)){if("replace"!==k)return i("ChangeDescriptor.render","The target doesn't have a '"+k+"' method."),e();S[0]instanceof Text?k="replaceWith":(S.empty(),k="append")}return S[0]instanceof Text&&("append"===k&&(k="after"),"prepend"===k&&(k="before")),_=e(n&&(this.verbatim?f(n):e.parseHTML(s(n),document,!0))),Array.isArray(T)&&T.forEach(function(n){var r=n.source,a=n.append,i=e(t.verbatim?f(r):e.parseHTML(s(r),document,!0));_="append"===a?_.add(i):"prepend"===a?i.add(_):i}),S[k](_.length?_:void 0),S.data("timestamp",Date.now()),this.update(),u&&!p&&o("replace"===k?S:_,u,l,this.transitionDelay,this.transitionSkip,this.expedite,this.transitionOrigin),w&&w.map(function(e){return e(S)}).forEach(function(e){return v.addEnchantment(e)}),_}};return d=u(h),p(h)}),define("datatypes/changercommand",["utils","utils/operationutils","internaltypes/changedescriptor","internaltypes/twineerror"],function(e,t,n,r){var a=e.impossible,i=t.is,o=t.toSource,s={},c={TwineScript_TypeID:"changer",TwineScript_TypeName:"a changer",TwineScript_Print:function(){return"`[A ("+this.macroName+":) changer]`"},TwineScript_ToSource:function(){return"("+this.macroName+":"+("else"===this.name?"":this.params.map(o))+")"+(this.next?"+"+this.next.TwineScript_ToSource():"")},summary:function(){var e=n.create();return this.run(e),e.summary()},create:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return Array.isArray(t)||a("ChangerCommand.create","params was not an array but "+t),Object.assign(Object.create(this),{macroName:e,params:t,next:n,TwineScript_ObjectName:"a ("+e+":) changer"})},"TwineScript_+":function(e){for(var t=this.TwineScript_Clone(),n=t;n.next;)n=n.next;return n.next=e,t},TwineScript_is:function(e){if(c.isPrototypeOf(e))return this.macroName===e.macroName&&i(this.params,e.params)&&i(this.next,e.next)},TwineScript_Clone:function(){for(var e=this.create(this.macroName,this.params,this.next),t=e;t.next;)t=t.next=t.next.TwineScript_Clone();return e},run:function(e){var t=s[this.macroName].apply(s,[e].concat(_toConsumableArray(this.params)));if(r.containsError(t))return t;this.next&&this.next.run(e)},register:function(e,t){s[e]=t}};return Object.freeze(c)}),define("state",["utils","passages","datatypes/changercommand","internaltypes/twineerror","utils/operationutils","markup","twinescript/compiler"],function(e,t,n,r,a,i,o){var s=e.impossible,c=a.objectName,u=a.toSource,l=i.lex,p=Object.assign,f=Object.create,d=["localStorage","sessionStorage"].map(function(e){try{return!!window[e]&&(window[e].setItem("test","1"),window[e].removeItem("test"),!0)}catch(e){return!1}}),h=p(f(null),{TwineScript_ObjectName:"this story's variables",TwineScript_TypeDefs:f(null),TwineScript_VariableStore:!0,TwineScript_MockVisits:null}),y={passage:"",variables:h,create:function(e,t){var n=f(y);return n.passage=e||"",n.variables=p(f(this.variables),t),n}},m=[],g=-1,v=y.create(),b=void 0,w={forward:[],back:[],load:[]},T=void 0;function S(e){v=(m[g]||y).create(e),function(){if(T.hasSessionStorage){var e=T.serialise();if("string"==typeof e)try{sessionStorage.setItem("Saved Session",e)}catch(e){return}}}()}return T=p({get passage(){return v.passage},get variables(){return v.variables},get pastLength(){return g},get futureLength(){return m.length-1-g},get mockVisits(){return v.variables.TwineScript_MockVisits||[]},set mockVisits(e){v.variables.TwineScript_MockVisits=e},passageNameVisited:function(e){var n=0;if(!t.get(e))return 0;for(var r=0;r<=g;r++)n+=+(e===m[r].passage);return n},passageNameLastVisited:function(e){if(!t.get(e))return 1/0;if(e===v.passage)return 0;for(var n=g;n>0;n--)if(m[n].passage===e)return g-n+1;return 1/0},pastPassageNames:function(){for(var e=[],t=g-1;t>=0;t--)e.unshift(m[t].passage);return e},timelinePassageNames:function(){return m.map(function(e){return e.passage})},play:function(e){v||s("State.play","present is undefined!"),v.passage=e,m=m.slice(0,g+1).concat(v),g+=1,S(e),w.forward.forEach(function(t){return t(e)})},rewind:function(e){var t=1,n=!1;if(e)if("string"==typeof e){if((t=this.passageNameLastVisited(e))===1/0)return}else"number"==typeof e&&(t=e);for(;t>0&&g>0;t--)n=!0,g-=1;return n&&(S(m[g].passage),w.back.forEach(function(e){return e()})),n},fastForward:function(e){var t=1,n=!1;for("number"==typeof e&&(t=e);t>0&&m.length>0;t--)n=!0,g+=1;return n&&(S(m[g].passage),w.forward.forEach(function(e){return e(m[g].passage,"fastForward")})),n},on:function(e,t){if(e in w)return"function"!=typeof t||w[e].includes(t)||w[e].push(t),T;s("State.on","invalid event name")},reset:function(){m=[],g=-1,v=y.create(),b=void 0,w.load.forEach(function(e){return e(m)})},hasStorage:d[0],hasSessionStorage:d[1]},function(){function e(e,t){Object.keys(t).forEach(function(n){return!n.startsWith("TwineScript_")&&(t[n]=e.eval(o(l(t[n],0,"macro"))))})}return{serialise:function(){var e=m.slice(0,g+1),t=e.map(function(e){return Object.keys(e.variables).filter(function(t){return e.variables[t]&&(n=e.variables[t],a=void 0===n?"undefined":_typeof(n),!(!r.containsError(n)&&("function"==typeof n.TwineScript_ToSource||Array.isArray(n)||n instanceof Map||n instanceof Set||"string"===a||"number"===a||"boolean"===a||Object.isPrototypeOf.call(h.TwineScript_TypeDefs,n))));var n,a}).map(function(t){return[t,e.variables[t]]})});if(b||(b=t.reduce(function(e,t,n){var r=_slicedToArray(t,2),a=r[0],i=r[1];return e||a&&[a,i,n+1]},void 0)),b){var n=_slicedToArray(b,3),a=n[0],i=n[1],o=n[2];return r.create("saving","The variable $"+a+" holds "+c(i)+" (which is, or contains, a complex data value) on turn "+o+"; the game can no longer be saved.")}try{return JSON.stringify(e,function(e,t){return this.TwineScript_VariableStore?"TwineScript_TypeDefs"===e?Object.keys(t).reduce(function(e,n){return e[n]=u(t[n]),e},{}):u(t):t})}catch(e){return!1}},deserialise:function(n,r){var a,i=void 0,o=h,s="The save data is unintelligible.";try{i=JSON.parse(r)}catch(e){return Error(s)}return Array.isArray(i)?(a=(i=i.map(function(r){if("object"!==(void 0===r?"undefined":_typeof(r))||!r.hasOwnProperty("passage")||!r.hasOwnProperty("variables"))return Error(s);if(!t.hasValid(r.passage))return Error("The data refers to a passage named '"+r.passage+"', but it isn't in this story.");if(r.variables=p(f(o),r.variables),Object.hasOwnProperty.call(r.variables,"TwineScript_TypeDefs")){var a=r.variables.TwineScript_TypeDefs=p(f(o.TwineScript_TypeDefs),r.variables.TwineScript_TypeDefs);try{e(n,a)}catch(e){return Error(s)}}try{e(n,r.variables)}catch(e){return Error(s)}return o=r.variables,p(f(y),r)})).find(function(e){return e instanceof Error}))?a:(m=i,w.load.forEach(function(e){return e(m)}),g=m.length-1,S(m[g].passage),!0):Error(s)}}}()),Object.seal(y),Object.freeze(T)}),define("internaltypes/varref",["state","internaltypes/twineerror","utils","utils/operationutils","datatypes/hookset"],function(e,t,n,r,a){var i=n.impossible,o=n.andList,s=n.nth,c=r.is,u=r.isObject,l=r.toSource,p=r.isSequential,f=r.objectName,d=r.typeName,h=r.clone,y=r.isValidDatamapName,m=r.subset,g=r.collectionType,v=r.unstorableValue,b=r.matches,w=void 0,T=0,S={set:[],delete:[]};function x(e,n){var r=void 0;if(e instanceof Map&&(r=t.containsError(y(e,n))))return r;if(p(e)){var i=void 0,s="You can only access position strings/numbers ('4th', 'last', '2ndlast', (2), etc.) or slices ('1stTo2ndlast', '3rdTo5th'), ",c="You can't access the '0th' or '0thlast' position of "+f(e)+".";if("number"==typeof n){if(0===n)return t.create("property","You can't access elements at position 0 of "+f(e)+".","Only positive and negative position values exist.");n>0&&(n-=1)}else if("string"==typeof n&&(i=/^(\d+)(?:st|[nr]d|th)last$/i.exec(n))){if("0"===i[1])return t.create("property",c);n=-i[1]}else if("string"==typeof n&&(i=/^(\d+)(?:st|[nr]d|th)$/i.exec(n))){if("0"===i[1])return t.create("property",c);n=i[1]-1}else if("string"==typeof n&&(i=/^(?:(\d+)(?:st|[nr]d|th)(last)?|last)to(?:(\d+)(?:st|[nr]d|th)(last)?|last)$/i.exec(n))){var u=_slicedToArray(i,5),l=u[1],d=void 0===l?0:l,h=u[2],m=u[3],g=void 0===m?0:m;n={last:g=u[4]?-g:g-1,first:d=h?-d:d-1}}else if("last"===n)n=-1;else if("random"===n){if(!e.length)return t.create("property","I can't get a random value from "+f(e)+", because it's empty");n=Math.random()*Array.from(e).length|0}else{if(a.isPrototypeOf(e)&&!a.TwineScript_Properties.includes(n))return t.create("property",s+o(a.TwineScript_Properties.map(function(e){return"'"+e+"'"}))+" of "+f(e)+", not "+f(n)+".");if(!["length","any","all","start","end","random"].includes(n)&&!a.isPrototypeOf(e))return t.create("property",s+"'length', 'any', 'all', 'start', 'end', and 'random' of "+f(e)+", not "+f(n)+".")}}else if(e instanceof Set){if(!["length","any","all"].includes(n))return t.create("property","You can only get the 'length', 'any' and 'all' of "+f(e)+".","To check contained values, use the 'contains' operator.");"length"===n&&(n="size")}else{if(Array.isArray(e.TwineScript_Properties)&&!e.TwineScript_Properties.includes(n))return t.create("property","You can only get the "+o(e.TwineScript_Properties.map(function(e){return"'"+e+"'"}))+" of "+f(e)+", not "+f(n)+".");if("number"==typeof e||"boolean"==typeof e)return t.create("property","You can't get data values from "+f(e)+".")}return n}function k(e,t){return t-0<0&&Math.abs(t)<=e.length?e.length+(t-0):t}function O(e,t){if(void 0===e)return e;if(e instanceof Map||w.isPrototypeOf(e))return e.get(t);if(("any"===t||"all"===t||"start"===t||"end"===t)&&!e.TwineScript_VariableStoreName)return function(e,t){var n="'"+t+"' value"+("any"===t?"":"s")+" of ";return{determiner:t,array:[].concat(_toConsumableArray(e)),string:"string"==typeof e&&e,TwineScript_ObjectName:n+f(e),TwineScript_TypeName:n+"a data structure",TwineScript_Unstorable:!0,TwineScript_Print:function(){return"`["+this.TwineScript_TypeName+"]`"}}}(e,t);if("string"==typeof e&&(e=[].concat(_toConsumableArray(e))),p(e)&&Number.isFinite(t)&&(t=k(e,t)),e.TwineScript_GetProperty)return e.TwineScript_GetProperty(t);var n=e[t];return"function"!=typeof n?n:void 0}function j(e){if(e.computed){var t=e.value;return w.isPrototypeOf(t)&&(t=t.get()),"string"==typeof t?"('"+t+"')":"("+t+")"}return"number"==typeof e?s(e):"'"+e+"'"}function A(n,r,i){if(n.TwineScript_VariableStore){if(n.TwineScript_TypeDefs&&r in n.TwineScript_TypeDefs){var o=n.TwineScript_TypeDefs[r];if("const"===o.name){if(void 0!==n[r])return t.create("operation","I can't alter "+(n===e.variables?"$":"_")+r+" because it's been restricted to a constant value.","This variable can't be changed for the rest of the story.")}else if(!b(o,i))return t.create("operation","I can't set "+(n===e.variables?"$":"_")+r+" to "+d(i)+" because it's been restricted to "+l(o)+"-type data.","You can restrict a variable or data name by giving a typed variable to (set:) or (put:).")}return!0}return Array.isArray(r)?r.map(function(e){return A(n,e)}):n instanceof Map?"string"==typeof r||t.create("operation",f(n)+" can only have string data names, not "+f(r)+"."):p(n)?["length","random","any","all","start","end"].includes(r)?t.create("operation","I can't forcibly alter the '"+r+"' of "+f(n)+".","start"===r||"end"===r?"Alter the values at actual positions, like 1st or 2ndlast, rather than just the '"+r+"'.":void 0):+r==(0|r)||t.create("property",f(n)+" can only have position keys ('3rd', '1st', (5), etc.), not "+j(r)+"."):n.TwineScript_Identifiers&&r in n?t.create("keyword","I can't alter the value of the '"+r+"' identifier.","You can only alter data in variables and hooks, not fixed identifiers."):t.create("operation","I can't modify "+f(n),n instanceof Set?"You should use an (array:) if you need to modify the data inside this dataset.":a.isPrototypeOf(n)?"You should alter hooks indirectly using macros like (replace:) or (enchant:).":void 0)}function C(e,t,n){var r=t;e instanceof Map?e.set(t,n):(p(e)&&(t=k(e,t)),e.TwineScript_Set?e.TwineScript_Set(t):e[t]=n),S.set.forEach(function(t){return t(e,r,n)})}function E(e,t){var n=t;p(e)&&(t=k(e,t)),Array.isArray(e)&&/^(?:[1-9]\d*|0)$/.exec(t)?e.splice(t,1):e instanceof Map||e instanceof Set?e.delete(t):delete e[t],S.delete.forEach(function(t){return t(e,n)})}function _(e){return Object.assign(Object.create(w),{error:e})}function N(n,r){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:r;if(r&&"object"===(void 0===r?"undefined":_typeof(r))&&"last"in r&&"first"in r){if(a.isPrototypeOf(n))return n.TwineScript_GetProperty(r);var s=r.first,c=r.last;return m(n,s+(s>=0),c+(c>=0))}if(Array.isArray(r))return a.isPrototypeOf(n)?n.TwineScript_GetProperty(r):r.map(function(e){return N(n,e,e)})["string"==typeof n?"join":"valueOf"]("");var u=O(n,r);if(void 0===u){if(n===e.variables)return T;if(n.TwineScript_VariableStore)return t.create("property","There isn't a temp variable named _"+i+" in this place.","Temp variables only exist inside the same passage and hook in which they're (set:).");if(Array.isArray(n)&&"number"==typeof r)return t.create("property","This array of "+n.length+" elements doesn't have a "+j(i)+" element.",n.length?"It contains: "+o(n.map(f))+".":"The array is empty.");var l=Array.from("function"==typeof n.keys&&n.keys());return t.create("property","I can't find a "+j(i)+" data name in "+f(n),n instanceof Map&&l.length?"Its names include: "+o(l)+".":void 0)}return u}function P(e,n){var r=this,a=this.compiledPropertyChain.reduce(function(e,t){var n=void 0;return n=0===e.length?r.object:N.apply(void 0,_toConsumableArray(e[e.length-1])),e.push([n,t])&&e},[]).reduceRight(e,n);return t.containsError(a)?a:void 0}return w=Object.freeze({get:function(){return this.error?this.error:N(this.compiledPropertyChain.slice(0,-1).reduce(function(e,t){return N(e,t)},this.object),this.compiledPropertyChain.slice(-1)[0],this.propertyChain.slice(-1)[0])},set:function(n){var r=this;return this.error?this.error:!this.object||this.object.TwineScript_VariableStore||this.object.TwineScript_Identifiers?P.call(this,function(n,a,i){var o,s=_slicedToArray(a,2),c=s[0],l=s[1];if(o=t.containsError(n,c,l)||t.containsError(A(c,l,n)))return o;var d;if(d=v(n))return t.create("operation",f(n)+" can't be stored"+(g(n)?" because it holds "+f(d)+".":""));if(i>0)c=h(c);else if(c.TwineScript_VariableStore&&c!==e.variables){for(var y=c;y.TwineScript_VariableStore&&!y.hasOwnProperty(l);)y=Object.getPrototypeOf(y);y.TwineScript_VariableStore&&(c=y)}if("string"==typeof c){if("string"!=typeof n)return t.create("datatype","I can't put this non-string value, "+f(n)+", in a string.");if(n.length!==(Array.isArray(l)?l.length:1))return t.create("datatype",f(n)+"is not the right length to fit into this string location.");c=[].concat(_toConsumableArray(c));var m=[].concat(_toConsumableArray(n));[].concat(l).forEach(function(e){0+e<0&&(e=c.length+(0+e)),c=[].concat(_toConsumableArray(c.slice(0,e)),[m.shift()],_toConsumableArray(c.slice(e+1)))}),c=c.join("")}else u(c)&&(void 0!==n.TwineScript_KnownName&&(n.TwineScript_KnownName=r.TwineScript_ObjectName),Array.isArray(l)&&p(n)?("string"==typeof n&&(n=[].concat(_toConsumableArray(n))),l.map(function(e,t){return[e,n[t]]}).forEach(function(e){var t=_slicedToArray(e,2),n=t[0],r=t[1];return C(c,n,r)})):C(c,l,n));return c},n):t.create("macrocall","I can't (set:) "+f(this)+", if the "+(f(this.object).match(/ (.+$)/)||["","value"])[1]+" isn't stored in a variable.","Modifying data structures that aren't in variables won't change the game state at all.")},delete:function(){return this.error?this.error:P.call(this,function(e,n,r){var a,i=_slicedToArray(n,2),o=i[0],s=i[1];if(a=t.containsError(e,o,s)||t.containsError(A(o,s)))return a;if(r>0&&(o=h(o)),null===e){var c="string"==typeof o;c&&(o=[].concat(_toConsumableArray(o))),Array.isArray(s)?(p(o)&&(s=[].concat(_toConsumableArray(new Set(s)))).sort(function(e,t){return k(o,t)-k(o,e)}),s.forEach(function(e){return E(o,e)})):E(o,s),c&&(o=o.join(""))}else C(o,s,e);return o},null)},defineType:function(e){var n=this.object,r=this.compiledPropertyChain;if(!n||!n.TwineScript_VariableStore||1!==r.length||!n.TwineScript_TypeDefs)return t.create("unimplemented","I can only restrict the datatypes of variables, not data names or anything else.");var a=r[0];Object.hasOwnProperty.call(n,"TwineScript_TypeDefs")||(n.TwineScript_TypeDefs=Object.create(n.TwineScript_TypeDefs));var i=n.TwineScript_TypeDefs,o=i[a];if(o&&!c(o,e))return t.create("operation","I can't redefine the type of "+f(this)+" to "+(e.TwineScript_ObjectName||d(e))+", as it is already "+(o.TwineScript_ObjectName||d(o))+".");i[a]=e,"const"===e.name&&(n[a]=void 0)},matches:function(e,t){return this.object===e&&this.compiledPropertyChain[0]===t},getName:function(){return this.compiledPropertyChain[0]},create:function(e,n){var r=void 0;if(r=t.containsError(e))return _(r);n=[].concat(n),w.isPrototypeOf(e)&&(n=e.propertyChain.concat(n),e=e.object);var a=function(e,n){return n.reduce(function(r,a,i){var o;return a.computed&&(a=a.value),w.isPrototypeOf(a)&&(a=a.get()),a=Array.isArray(a)?a.map(function(t){return x(e,t)}):x(e,a),(o=t.containsError(r,a))?o:(i<n.length-1&&(e=N(e,a)),r.push(a),r)},[])}(e,n);return(r=t.containsError(a))?_(r):Object.assign(Object.create(w),{object:e,propertyChain:n,compiledPropertyChain:a})},TwineScript_ToSource:function(){var t=this,n=function(e,n){return!n&&t.object.TwineScript_VariableStore?e:j(e)};return(this.object===e.variables?"$":this.object.TwineScript_VariableStore?"_":f(this.object)+"'s ")+(1===this.propertyChain.length?n(this.propertyChain[0]):this.propertyChain.reduce(function(e,t,r){return e+"'s "+n(t,r)}))},get TwineScript_ObjectName(){return this.TwineScript_ToSource()+(this.object.TwineScript_VariableStoreName?" in "+this.object.TwineScript_VariableStoreName:"")},on:function(e,t){if(e in S)return"function"!=typeof t||S[e].includes(t)||S[e].push(t),w;i("VarRef.on","invalid event name")}})}),define("internaltypes/varscope",[],function(){return Object.seal({TwineScript_ObjectName:"the temporary variables",TwineScript_VariableStore:!0,TwineScript_TypeDefs:Object.create(null)})}),define("internaltypes/twinenotifier",["jquery","utils"],function(e,t){var n=t.impossible,r={create:function(e){return e||n("TwineNotifier.create","called with only 1 string."),Object.assign(Object.create(r),{message:e})},render:function(){return e("<tw-notifier>").attr("message",this.message)}};return r}),define("datatypes/custommacro",["jquery","utils/operationutils","internaltypes/changedescriptor","internaltypes/varref","internaltypes/varscope","internaltypes/twineerror","internaltypes/twinenotifier"],function(e,t,n,r,a,i,o){var s=t.objectName,c=t.typeName,u=t.matches,l=Object.assign,p=Object.create,f=function(t){return function(c){for(var u=arguments.length,f=Array(u>1?u-1:0),d=1;d<u;d++)f[d-1]=arguments[d];t.called+=1;var h=t.varNames,y=t.params,m=t.body,g=l(p(a),{TwineScript_VariableStoreName:t.TwineScript_ObjectName+" call #"+t.called,TwineScript_TypeDefs:p(null)}),v=[],b=0;f.forEach(function(e,t){var n=h[b];g.TwineScript_TypeDefs[n]=y[b].datatype.rest?y[b].datatype.create("array"):y[b].datatype;var a=r.create(g,n);if(y[b].datatype.rest){var i=(g[n]||[]).concat([e]);if(t<f.length-1)return void(g[n]=i);a.set(i)}else a.set(e),b+=1;v.push(o.create(s(a)+" is now "+s(g[n])))}),f.length&&(b+=1),y[b]&&y[b].datatype.rest&&(r.create(g,h[b]).set([]),g.TwineScript_TypeDefs[name]=y[b].datatype.create("array"));var w=void 0,T=e("<p>").append(m.html),S=c.stack.length;for(c.stack.unshift({tempVariables:g,dom:T,output:function(e){w=e}}),c.execute();c.stack.length>S;)c.stack.shift();var x,k,O=T.find("tw-error");return O.length?(T.prepend(v.map(function(e){return e.render()}),"<br>"),i.create("propagated",O.length+" error"+(O.length>1?"s":"")+" occurred when running "+t.TwineScript_ObjectName+".",void 0,T)):void 0===w?i.create("custommacro",t.TwineScript_ObjectName+" didn't output any data or hooks using (output:) or (output-data:)."):n.isPrototypeOf(w)?(x=w,k=l({TwineScript_TypeID:"command",TwineScript_ObjectName:"a custom command",TwineScript_TypeName:"a custom command",TwineScript_Print:function(){return"`[a custom command]`"},TwineScript_Attach:function(e){return e.run(x),k},TwineScript_Run:function(){return x}})):w}},d=Object.freeze({TwineScript_TypeID:"macro",TwineScript_TypeName:"a custom macro",get TwineScript_ObjectName(){return this.TwineScript_KnownName?"the "+this.TwineScript_KnownName+" macro":"a custom macro"},TwineScript_GetProperty:function(e){if("params"===e)return[].concat(_toConsumableArray(this.params))},TwineScript_Properties:["params"],TwineScript_Print:function(){return"`["+this.TwineScript_ObjectName+"]`"},TwineScript_Clone:function(){return l(p(d),this)},TwineScript_ToSource:function(){return"(macro:"+this.params.map(function(e){return e.TwineScript_ToSource()}).concat("")+this.body.TwineScript_ToSource()+")"},create:function(e,t){var n=l(p(this),{params:e,called:0,varNames:e.map(function(e){return e.varRef.propertyChain[0]}),typeSignature:e.map(function(e){var t=void 0;return t=e.datatype.toTypeSignatureObject?e.datatype.toTypeSignatureObject({rest:e.rest}):{pattern:"range",range:function(t){return u(e.datatype,t)},name:c(e.datatype)},e.rest?{pattern:"zero or more",innerType:t}:t}),body:t,TwineScript_KnownName:""});return n.fn=f(n),n}});return d}),define("datatypes/lambda",["utils/operationutils","internaltypes/varscope","internaltypes/varref","internaltypes/twineerror"],function(e,t,n,r){var a=e.objectName,i=Object.freeze({TwineScript_TypeID:"lambda",TwineScript_TypeName:"a lambda",get TwineScript_ObjectName(){return'a "'+("making"in this?"making ... ":"")+("where"in this?"where ... ":"")+("when"in this?"when ... ":"")+("via"in this?"via ... ":"")+'" lambda'},TwineScript_Print:function(){return"`[A lambda]`"},TwineScript_is:function(e){return e===this},TwineScript_ToSource:function(){return this.source},TypeSignature:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return{pattern:"lambda",innerType:i,clauses:t,typeName:'a "'+t.concat("").join(" ...")+'" lambda'}},TwineScript_Clone:function(){return Object.assign(Object.create(i),this)},create:function(e,o,s,c){var u=void 0;function l(e){var r=e&&e.varRef?e.varRef:e;return void 0===r||r&&n.isPrototypeOf(r)&&t.isPrototypeOf(r.object)&&1===r.propertyChain.length}if("making"===o&&!l(s))return r.create("syntax","I need a temp variable, or typed temp variable, to the right of '"+o+"', not "+a(s)+".");if(r.containsError(e))return e;if(i.isPrototypeOf(e)){if("when"===o||"when"in e)return r.create("syntax","A 'when' lambda cannot have any other clauses, such as '"+o+"'.");if(o in e&&("where"!==o||"true"!==e[o]))return r.create("syntax","This lambda has two '"+o+"' clauses.");u=e}else{if("when"===o&&void 0!==e)return r.create("syntax","A 'when' lambda shouldn't begin with a temp variable (just use 'when' followed by the condition).");if(!l(e))return r.create("syntax","This lambda needs to start with a single temp variable, or typed temp variable, not "+a(e)+".");(u=Object.create(this)).loop=e||""}return u.source=c.trim(),u[o]=s,u.making&&u.making.getName()===(u.loop&&u.loop.getName())?r.create("syntax","This lambda has two variables named '"+u.loop.getName()+"'.","Lambdas should have all-unique parameter names."):u},apply:function(e,n){var a=n.loop,i=n.pos,o=n.making,s=n.ignoreVia,c=n.tempVariables;function u(e,t){if(e)if("datatype"in e&&"varRef"in e){var n=e.varRef.create(c,e.varRef.propertyChain);n.defineType(e.datatype);var a=n.set(t);if(r.containsError(a))return a}else c[e.getName()]=t}c=c||Object.create(e.stack.length?e.stackTop.tempVariables:t);var l=u(this.loop,a)||u(this.making,o);if(r.containsError(l))return l;e.stack.unshift(Object.assign(Object.create(e.stackTop||null),{tempVariables:c,lambdaPos:this.when?void 0:i}));var p=e.eval("Operations");!a||this.making||this.when?p.initialiseIt(r.create("operation","I can't use 'it', or an implied 'it', in "+this.TwineScript_ObjectName)):p.initialiseIt(a);var f=!s&&this.via,d=e.eval("where"in this||"when"in this?"Operations.where("+(this.where||this.when)+","+(f||"true")+",null)":f||"true");return e.stack.shift(),d},filter:function(e,t){var n=this,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=void 0,o=t.reduce(function(t,o,s){if(i=r.containsError(t))return i;var c=n.apply(e,{loop:o,pos:s+1,ignoreVia:!0,tempVariables:a});return(i=r.containsError(c))?i:t.concat(c?[o]:[])},[]);return(i=r.containsError(o))?i:o}});return i}),define("datatypes/codehook",["internaltypes/twineerror","renderer"],function(e,t){var n=t.exec;return Object.freeze({TwineScript_TypeName:"a code hook",TwineScript_ObjectName:"a code hook",TwineScript_Unstorable:!0,TwineScript_ToSource:function(){return"["+this.source+"]"},create:function(t,r){r||(r=n(t));var a=e.containsError(r);return a||Object.assign(Object.create(this),{source:t,html:r})}})}),define("datatypes/colour",["jquery","utils"],function(e,t){var n=t.matMul,r=Math.max,a=Math.min,i=Math.sin,o=Math.cos,s=Math.pow,c=Math.round,u=Math.floor,l=Math.atan2,p=Math.cbrt,f=Math.sqrt,d=Math.PI,h=Object.assign,y=Object.create,m=/^([\da-fA-F])([\da-fA-F])([\da-fA-F])$/,g=/^([\da-fA-F])([\da-fA-F])([\da-fA-F])([\da-fA-F])([\da-fA-F])([\da-fA-F])$/,v=y(null);function b(e){var t=e.r,n=e.g,i=e.b,o=e.a,s=r(t/=255,n/=255,i/=255),u=a(t,n,i),l=(s+u)/2,p=s-u;if(s===u)return{h:0,s:0,l:l};var f=void 0;switch(s){case t:f=(n-i)/p+(n<i?6:0);break;case n:f=(i-t)/p+2;break;case i:f=(t-n)/p+4}return{h:f=c(60*f),s:l>.5?p/(2-s-u):p/(s+u),l:l,a:o}}var w=[.96422,1,.82521],T=24389/27,S=216/24389,x=function(e){return e.map(function(e){return[e]})},k=function(e){return e.map(function(e){return e[0]})};function O(e){var t=e.l,r=e.c,a=e.h,c=e.a;t*=100;var u=[];u[1]=(t+16)/116,u[0]=r*o(a*d/180)/500+u[1],u[2]=u[1]-r*i(a*d/180)/200;var l=[s(u[0],3)>S?s(u[0],3):(116*u[0]-16)/T,t>T*S?s((t+16)/116,3):t/T,s(u[2],3)>S?s(u[2],3):(116*u[2]-16)/T].map(function(e,t){return e*w[t]}),p=k(n([[.9555766,-.0230393,.0631636],[-.0282895,1.0099416,.0210077],[.0122982,-.020483,1.3299098]],n([[3.2404542,-1.5371385,-.4985314],[-.969266,1.8760108,.041556],[.0556434,-.2040259,1.0572252]],x(l)))).map(function(e){return 255*e}),f=_slicedToArray(p,3);return{r:f[0],g:f[1],b:f[2],a:c}}function j(e){var t=O(e);return[t.r,t.g,t.b].every(function(e){return e>=0&&e<=255})}var A=Object.freeze({TwineScript_TypeID:"colour",TwineScript_TypeName:"a colour",TwineScript_ObjectName:"a colour",TwineScript_DebugName:function(){return"a colour "+this.TwineScript_Print()},"TwineScript_+":function(e){var t=this.toRGBA(),n=e.toRGBA();return A.create({r:Math.min(Math.round(.6*(t.r+n.r)),255),g:Math.min(Math.round(.6*(t.g+n.g)),255),b:Math.min(Math.round(.6*(t.b+n.b)),255),a:(t.a+n.a)/2})},TwineScript_Print:function(){var e=this.toRGBA();return"<tw-colour style='background-color:rgba("+[e.r,e.g,e.b,e.a]+");'></tw-colour>"},TwineScript_is:function(e){if(!A.isPrototypeOf(e))return!1;if(e.lcha&&this.lcha)return e.lcha.l===this.lcha.l&&e.lcha.c===this.lcha.c&&e.lcha.h===this.lcha.h&&e.a===this.a;var t=this.toRGBA();return(e=e.toRGBA()).r===t.r&&e.g===t.g&&e.b===t.b&&e.a===t.a},TwineScript_Clone:function(){return A.create(this)},toRGBAString:function(){var e=this.toRGBA();return"rgba("+e.r+", "+e.g+", "+e.b+", "+e.a+")"},toHSLA:function(){return b(this.toRGBA())},toRGBA:function(){return this.lch?O(function(e){if(j(e))return e;var t=(e=h({},e)).c,n=0;for(e.c/=2;t-n>1e-5;)j(e)?n=e.c:t=e.c,e.c=(t+n)/2;return e}(h({},this.lch,{a:this.a}))):this},toLCHA:function(){return this.lch?h({},this.lch):(t=(e=this).r,r=e.g,a=e.b,i=e.a,o=k(n([[1.0478112,.0228866,-.050127],[.0295424,.9904844,-.0170491],[-.0092345,.0150436,.7521316]],n([[.4124564,.3575761,.1804375],[.2126729,.7151522,.072175],[.0193339,.119192,.9503041]],x([t/255,r/255,a/255])))).map(function(e,t){return e/w[t]}).map(function(e){return e>S?p(e):(T*e+16)/116}),c=[116*o[1]-16,500*(o[0]-o[1]),200*(o[1]-o[2])],u=180*l(c[2],c[1])/d,{l:c[0]/100,c:f(s(c[1],2)+s(c[2],2)),h:u>=0?u:u+360,a:i});var e,t,r,a,i,o,c,u},LCHRotate:function(e){e<0&&(e=360+e);var t=this.toLCHA();return t.h=(t.h+e)%360,t.a=this.a,A.create(t)},TwineScript_GetProperty:function(e){if("lch"===e){var t=this.toLCHA();return new Map([["l",t.l],["c",t.c],["h",t.h]])}var n=this.toRGBA();return"h"===e||"s"===e||"l"===e?b(n)[e]:"r"===e||"g"===e||"b"===e||"a"===e?n[e]:void 0},TwineScript_Properties:["h","s","l","r","g","b","a","lch"],TwineScript_ToSource:function(){var e=!this.lch&&b(this);if(e&&!e.h&&!e.s){if(1===e.l)return"white";if(0===e.l)return"black"}return"("+(this.lch?"lch":"hsl")+":"+(this.lch?[this.lch.l,this.lch.c,this.lch.h]:[e.h,e.s,e.l])+(1!==this.a?","+this.a:"")+")"},create:function(t){return"string"==typeof t?this.create((A.isHexString(t)?function(e){return"string"!=typeof e?e:(e=(e=e.replace("#","")).replace(m,"$1$1$2$2$3$3"),{r:parseInt(e.slice(0,2),16),g:parseInt(e.slice(2,4),16),b:parseInt(e.slice(4,6),16)})}:function(t){if(t in v)return v[t];var n=e("<p>").css("background-color",t).css("background-color");return n="transparent"===n?{r:0,g:0,b:0,a:0}:n.startsWith("rgb")?n.match(/\d+/g).reduce(function(e,t,n){return e["rgb"[n]]=+t,e},{}):{r:192,g:192,b:192},v[t]=n,n})(t)):!("h"in t&&"s"in t&&"l"in t)||"r"in t||"g"in t||"b"in t?("a"in t&&"number"==typeof t.a||(t.a=1),h(y(this),"h"in t&&"c"in t&&!("s"in t)&&"l"in t?{a:t.a,lch:{l:t.l,c:t.c,h:t.h}}:t)):this.create(function(e){var t=e.h,n=e.s,r=e.l,a=e.a;if(0===n){var i=u(255*r);return{r:i,g:i,b:i}}var o=r<.5?r*(1+n):r+n-r*n,s=2*r-o;function c(e){return e<0&&(e+=1),e>1&&(e-=1),e<1/6?s+6*(o-s)*e:e<.5?o:e<2/3?s+(o-s)*(2/3-e)*6:s}return{r:u(255*c((t/=360)+1/3)),g:u(255*c(t)),b:u(255*c(t-1/3)),a:a}}(t))},isHexString:function(e){return"string"==typeof e&&"#"===e[0]&&(e.slice(1).match(m)||e.slice(1).match(g))},isCSS3Function:function(e){return"string"==typeof e&&/^(?:rgb|hsl)a?\(\s*\d+\s*,\s*\d+%?\s*,\s*\d+%?(?:,\s*\d+(?:\.\d+)?\s*)?\)$/.test(e)}});return A}),define("datatypes/gradient",["utils/operationutils"],function(e){var t=e.toSource,n=Object.freeze({TwineScript_TypeID:"gradient",TwineScript_TypeName:"a gradient",TwineScript_ObjectName:"a gradient",TwineScript_DebugName:function(){return"a gradient "+this.TwineScript_Print()},TwineScript_GetProperty:function(e){var t=this;return"angle"===e?this.angle:"stops"===e?this.stops.map(function(e){return new Map([[t.repeating?"pixels":"percent",e.stop],["colour",e.colour.TwineScript_Clone()]])}):void 0},TwineScript_Properties:["angle","stops"],TwineScript_ToSource:function(){return"(gradient:"+this.angle+","+this.stops.map(function(e){return t(e.stop)+","+t(e.colour)})+")"},TwineScript_is:function(e){var t=this;return e.angle===this.angle&&e.stops.length===this.stops.length&&e.stops.every(function(e,n){var r=e.colour,a=e.stop;return t.stops[n].stop===a&&t.stops[n].colour.TwineScript_is(r)})},TwineScript_Clone:function(){return n.create(this.angle,[].concat(_toConsumableArray(this.stops)))},TwineScript_Print:function(){return"<tw-colour style='background:"+this.toLinearGradientString()+"'></tw-colour>"},create:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return Object.assign(Object.create(this),{angle:e,stops:t.sort(function(e,t){return e.stop-t.stop}),repeating:n})},multiply:function(e){return n.create(this.angle,this.stops.map(function(t){return{colour:t.colour,stop:t.stop*e}}))},toLinearGradientString:function(){var e=this;return(this.repeating?"repeating-":"")+"linear-gradient("+this.angle+"deg, "+this.stops.reduce(function(t,n){var r=n.colour,a=n.stop;return t+r.toRGBAString()+" "+a*(e.repeating?1:100)+(e.repeating?"px,":"%,")},"").slice(0,-1)+")"}});return n}),define("datatypes/datatype",["utils","utils/operationutils","datatypes/changercommand","datatypes/colour","datatypes/gradient","datatypes/lambda","datatypes/custommacro","internaltypes/twineerror"],function(e,t,n,r,a,i,o,s){var c=e.realWhitespace,u=e.anyRealLetter,l=e.anyCasedLetter,p=e.anyNewline,f=t.objectName,d=Object.assign,h=Object.seal,y=Object.keys,m=Math.floor,g=Math.abs,v=void 0,b=void 0,w={TwineScript_TypeID:"datatype",TwineScript_TypeName:"a datatype",TwineScript_Print:function(){return"`["+this.TwineScript_ObjectName+"]`"},get TwineScript_ObjectName(){return"the "+(this.rest?"...":"")+this.name+" datatype"},TwineScript_is:function(e){return w.isPrototypeOf(e)&&e.name===this.name},TwineScript_Clone:function(){return this.rest?this:Object.create(this)},TwineScript_ToSource:function(){return(this.rest?"...":"")+this.name},TwineScript_IsTypeOf:function(e){var t=this.name,n=this.rest;return!!v[t]&&v[t](e,n)},toTypeSignatureObject:function(){var e=this.name,t={pattern:"range",range:v[e],name:"a "+("dm"===e?"datamap":"ds"===e?"dataset":"num"===e?e+"ber":"str"===e?e+"ing":"color"===e?"colour":"bool"===e?e+"ean":"alnum"===e?"alphanumeric character":"int"===e?e+"eger":"even"===e||"odd"===e?e+" number":e.endsWith("case")||"whitespace"===e?e+" character":"empty"===e?e+" value":e)};return this.rest?{pattern:"zero or more",innerType:t}:t},create:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e="datamap"===e?"dm":"dataset"===e?"ds":"number"===e?"num":"string"===e?"str":"color"===e?"colour":"boolean"===e?"bool":"alphanumeric"===e?"alnum":"integer"===e?"int":e;var n=Object.create(this);return n.name=e,n.rest=t,n},from:function(e){var t=y(b).find(function(t){return b[t](e)});return t?w.create(t):s.create("datatype",f(e)+" doesn't correspond to a datatype value.")}};return b={array:Array.isArray,dm:function(e){return e instanceof Map},ds:function(e){return e instanceof Set},datatype:function(e){return w.isPrototypeOf(e)},changer:function(e){return n.isPrototypeOf(e)},colour:function(e){return r.isPrototypeOf(e)},gradient:function(e){return a.isPrototypeOf(e)},lambda:function(e){return i.isPrototypeOf(e)},macro:function(e){return o.isPrototypeOf(e)},str:function(e){return"string"==typeof e},num:function(e){return"number"==typeof e},bool:function(e){return"boolean"==typeof e}},v=d({},b,{even:function(e){return!isNaN(e)&&m(g(e))%2==0},odd:function(e){return!isNaN(e)&&m(g(e))%2==1},empty:function(e){return e instanceof Map||e instanceof Set?!e.size:!(!Array.isArray(e)&&"string"!=typeof e)&&!e.length},int:function(e){return"number"==typeof e&&e===(0|e)},uppercase:function(e){return"string"==typeof e&&1===[].concat(_toConsumableArray(e)).length&&[].concat(_toConsumableArray(e)).every(function(e){return e!==e.toLowerCase()})},lowercase:function(e){return"string"==typeof e&&1===[].concat(_toConsumableArray(e)).length&&[].concat(_toConsumableArray(e)).every(function(e){return e!==e.toUpperCase()})},whitespace:function(e){return"string"==typeof e&&!!e.match("^"+c+"$")},digit:function(e){return"string"==typeof e&&!!e.match("^\\d$")},alnum:function(e){return"string"==typeof e&&!!e.match("^"+u+"$")},anycase:function(e){return"string"==typeof e&&!!e.match("^"+l+"$")},linebreak:function(e){return"string"==typeof e&&!!e.match("^"+p+"$")},any:function(){return!0},const:function(){return!0}}),h(w)}),define("datatypes/typedvar",["utils/operationutils","datatypes/datatype","internaltypes/varref","internaltypes/twineerror"],function(e,t,n,r){var a=e.typeName,i=e.matches,o=e.toSource,s=e.unstorableValue,c=Object.freeze,u=Object.assign,l=Object.create,p=c({TwineScript_TypeName:"a typed variable name",get TwineScript_ObjectName(){return this.TwineScript_ToSource()},TwineScript_Print:function(){return"`[A typed variable name]`"},TwineScript_Unstorable:!0,TwineScript_Clone:function(){return u(l(p),{datatype:this.datatype.TwineScript_Clone(),varRef:this.varRef})},TwineScript_ToSource:function(){return o(this.datatype)+"-type "+this.varRef.TwineScript_ToSource()},TwineScript_GetProperty:function(e){return"name"===e?this.getName():this[e]},TwineScript_Properties:["datatype","name"],TwineScript_IsTypeOf:function(e){return i(this.datatype,e)},get:function(){var e;return(e=this.varRef).get.apply(e,arguments)},getName:function(){return this.varRef.getName()},defineType:function(){if("any"!==this.datatype.name)return this.varRef.defineType(this.datatype)},create:function(e,t){var n;if(n=r.containsError(t)||r.containsError(e)||t.error)return n;var i=s(e);return i&&!p.isPrototypeOf(i)?r.create("syntax","The -type syntax can't have "+a(i)+" to its left."):u(l(this),{datatype:e,varRef:t})}});return p}),define("macros",["jquery","utils/naturalsort","utils","utils/operationutils","datatypes/changercommand","datatypes/custommacro","datatypes/lambda","datatypes/hookset","datatypes/codehook","datatypes/typedvar","datatypes/datatype","internaltypes/changedescriptor","internaltypes/twineerror"],function(e,t,n,r,a,i,o,s,c,u,l,p,f){var d=n.insensitiveName,h=n.nth,y=n.plural,m=n.andList,g=n.lockProperty,v=(r.clone,r.objectName),b=r.typeName,w=r.singleTypeCheck,T=r.toSource,S=void 0,x={};function k(e,n,r){var a=n.fn,i=n.typeSignature,s=n.isChanger,u=void 0!==s&&s,l=r[0];r=function(e){return e.reduce(function(e,n){if(n&&!0===n.spreader){var r=n.value,a=f.containsError(r);if(a)e.push(a);else if(Array.isArray(r)||"string"==typeof r)for(var i=0;i<r.length;i++)e.push(r[i]);else r instanceof Set?e.push.apply(e,_toConsumableArray(Array.from(r).sort(t("en")))):e.push(f.create("operation","I can't spread out "+v(r)+", because it is not a string, dataset, or array."))}else e.push(n);return e},[])}(r.slice(1)),i=[].concat(i||[]);var p=!e,d=p?"":"("+(Array.isArray(e)&&e.length>1?e[0]:e)+":)";e=p?"this custom macro":"the "+d+" macro";var g=void 0;g=i.length>0?e+" must only be given "+m(i.map(b))+(i.length>1?", in that order":"."):e+" must not be given any data."+(p?"":" Just write "+d);for(var T=void 0,x=function(t,n){var a=i[t],s=r[t];if(f.containsError(s))return{v:s};if(c.isPrototypeOf(s)&&u)return{v:f.create("syntax","Please put this hook outside the parentheses of the changer macro, not inside it.","Hooks should appear after a macro"+(p?".":": "+d+"[Some text]"))};if(t>=i.length&&!T)return{v:f.create("datatype",r.length-i.length+" too many values were given to "+e+".",g)};if(a||(a=T),!a.innerType||"rest"!==a.pattern&&"zero or more"!==a.pattern||(T=a.innerType,"rest"===a.pattern&&(a=a.innerType)),!w(s,a)){if(void 0===s){var l=i.filter(function(e){return!("optional"===e.pattern||"zero or more"===e.pattern)}).length;return{v:f.create("datatype",e+" needs "+y(l-t,"more value")+".",g)}}return s&&s.TwineScript_Unstorable&&(a===S.TypeSignature.Any||a.innerType&&a.innerType===S.TypeSignature.Any)?{v:f.create("datatype",e+"'s "+h(t+1)+" value, "+v(s)+", is not valid data for this macro.",g)}:s&&o.isPrototypeOf(s)&&"lambda"===a.pattern?{v:f.create("datatype",e+"'s "+h(t+1)+" value (a lambda) should have "+m(["where","when","making","via","with"].filter(function(e){return a.clauses.includes(e)}).map(function(e){return"a '"+e+"' clause"}))+", not "+m(["where","when","making","via","with"].filter(function(e){return e in s}).map(function(e){return"a '"+e+"' clause"}))+".")}:"insensitive set"===a.pattern?{v:f.create("datatype",v(s)+" is not a valid name string for "+e+".","Only the following names are recognised (capitalisation and hyphens ignored): "+m(a.innerType)+".")}:{v:f.create("datatype",e+"'s "+h(t+1)+" value is "+v(s)+", but should be "+b(a)+".",a.message||g)}}},k=0,O=Math.max(r.length,i.length);k<O;k+=1){var j=x(k);if("object"===(void 0===j?"undefined":_typeof(j)))return j.v}return a.apply(void 0,[l].concat(_toConsumableArray(r)))}function O(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a={fn:t,typeSignature:n};r&&(a.isChanger=!0),Object.freeze(a),Array.isArray(e)?e.forEach(function(e){return g(x,d(e),a)}):g(x,d(e),a)}return S={has:function(e){return e=d(e),x.hasOwnProperty(e)},get:function(e){return e=d(e),x.hasOwnProperty(e)&&x[e]},add:function e(t,n,r){return O(t,n,r),e},addChanger:function e(t,n,r,i){return O(t,n,i,!0),a.register(Array.isArray(t)?t[0]:t,r),e},addCommand:function e(t,n,r,a){var i=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];return O(t,function(e,t,n,r){return function(a){for(var i=arguments.length,o=Array(i>1?i-1:0),s=1;s<i;s++)o[s-1]=arguments[s];var c=t.apply(void 0,o);if(c)return c;var u=p.create(),l=Object.assign({TwineScript_TypeID:"command",TwineScript_ObjectName:"a ("+e+":) command",TwineScript_TypeName:"a ("+e+":) command",TwineScript_Print:function(){return"`[A ("+e+":) command]`"},TwineScript_ToSource:function(){return"("+e+":"+o.map(T)+")"},TwineScript_is:function(e){return T(this)===T(e)}},r?{TwineScript_Attach:function(e,t){return u.section=e,t.run(u),l},TwineScript_Run:function(e){return n.apply(void 0,[u,e].concat(o))}}:{TwineScript_Run:function(e){return n.apply(void 0,[e].concat(o))}});return l}}([].concat(t)[0],n,r,i),a),e},TypeSignature:{optional:function(e){return{pattern:"optional",innerType:e}},zeroOrMore:function(e){return{pattern:"zero or more",innerType:e}},either:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return{pattern:"either",innerType:t}},rest:function(e){return{pattern:"rest",innerType:e}},insensitiveSet:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return{pattern:"insensitive set",innerType:t}},numberRange:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0;return{pattern:"range",min:e,max:t,range:function(n){return"number"==typeof n&&!Number.isNaN(n)&&n>=e&&n<=t}}},nonNegativeInteger:{pattern:"range",integer:!0,min:0,max:1/0,range:function(e){return"number"==typeof e&&!Number.isNaN(e)&&e>=0&&!(e+"").includes(".")}},positiveInteger:{pattern:"range",integer:!0,min:1,max:1/0,range:function(e){return"number"==typeof e&&!Number.isNaN(e)&&e>=1&&!(e+"").includes(".")}},wrapped:function(e,t){return{pattern:"wrapped",innerType:e,message:t}},Any:{TwineScript_TypeName:"anything"},Everything:{TwineScript_TypeName:"everything"}},run:function(e,t){return S.has(e)?k(e,S.get(e),t):f.create("macrocall","I can't run the macro '"+e+"' because it doesn't exist.","Did you mean to run a macro? If you have a word written like (this:), it is regarded as a macro name.")},runCustom:function(e,t){return i.isPrototypeOf(e)?k("",e,t):f.create("macrocall","I can't call "+v(e)+" because it isn't a custom macro.")}},Object.assign(S.TypeSignature,{positiveNumber:S.TypeSignature.numberRange(Math.pow(2,-52),1/0),nonNegativeNumber:S.TypeSignature.numberRange(0,1/0),percent:S.TypeSignature.numberRange(0,1)}),Object.freeze(S)}),define("datatypes/varbind",["jquery","utils","utils/operationutils","internaltypes/varref","internaltypes/twineerror"],function(e,t,n,r,a){var i=n.objectName;return r.on("set",function(n,r){n.TwineScript_VariableStore&&e(t.storyElement).find("[data-2bind]").each(function(t,a){var i=(a=e(a)).data("twoWayBindEvent");"function"==typeof i&&i(a,n,r)})}),Object.freeze({TwineScript_TypeName:"a bound variable",TwineScript_ObjectName:"a bound variable",TwineScript_Unstorable:!0,TwineScript_ToSource:function(){return("two way"===this.bind?"2":"")+"bind "+this.varRef.TwineScript_ToSource()},set:function(e){var t,n=this.varRef.set(e);if(t=a.containsError(n))return t},create:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"one way";return r.isPrototypeOf(e)?e.error?e.error:Object.assign(Object.create(this),{varRef:e,bind:t}):a.create("operation","I can only 'bind' a variable, not "+i(e)+".")}})}),define("datatypes/assignmentrequest",["utils/operationutils","datatypes/typedvar","datatypes/datatype","internaltypes/varref","internaltypes/twineerror"],function(e,t,n,r,a){var i=e.objectName,o=e.matches;return Object.freeze({assignmentRequest:!0,TwineScript_TypeName:"a 'to' or 'into' expression",TwineScript_ObjectName:"a 'to' or 'into' expression",TwineScript_Unstorable:!0,set:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],s=void 0,c=[],u=function e(s,c){var u,l=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],p=[],f=void 0;if(f=c&&r.isPrototypeOf(c)?c.get():c,u=a.containsError(f))return u;if(Array.isArray(f)&&Array.isArray(s)){for(var d=0,h=0;d<s.length&&h<f.length;){var y=s[d],m=f[h];if(t.isPrototypeOf(y)&&y.datatype.rest||n.isPrototypeOf(y)&&y.rest){for(var g=h;h<f.length&&o(y,m);)m=f[h+=1];t.isPrototypeOf(y)?y.datatype=[y.datatype]:n.isPrototypeOf(y)&&(y=n.create("array")),p=p.concat(e(y,r.isPrototypeOf(c)?r.create(c,{first:g+1,last:h+1}):f.slice(g,h)))}else p=p.concat(e(y,r.isPrototypeOf(c)?r.create(c,h+1):m)),h+=1;d+=1}return d<s.length?l&&a.create("operation","I can't unpack this array because it needs "+(s.length-d)+" more value"+(s.length-d>0?"s":"")+"."):p}if(s instanceof Map&&f instanceof Map){var v=!0,b=!1,w=void 0;try{for(var T,S=s.entries()[Symbol.iterator]();!(v=(T=S.next()).done);v=!0){var x=_slicedToArray(T.value,2),k=x[0],O=x[1];if(!f.has(k))return l&&a.create("operation","I can't unpack this datamap because it needs a '"+k+"' data name.");p=p.concat(e(O,r.isPrototypeOf(c)?r.create(c,k):f.get(k)))}}catch(e){b=!0,w=e}finally{try{!v&&S.return&&S.return()}finally{if(b)throw w}}return p}if(t.isPrototypeOf(s)){if("function"==typeof s.datatype.destructure)return[{dest:s,value:f,src:c}].concat(s.datatype.destructure(f));if(!o(f,s.datatype))return[l&&a.create("operation","I can't unpack "+i(f)+" into "+s.varRef.TwineScript_ToSource()+" because it doesn't match "+i(s.datatype)+".")];p=p.concat(e(s.datatype,f))}return r.isPrototypeOf(s)||t.isPrototypeOf(s)?p.concat({dest:s,value:f,src:c}):"function"==typeof s.destructure?p.concat(s.destructure(f)):o(f,s)?p:l&&a.create("operation","I tried to unpack, but "+i(s)+" in the pattern didn't match "+i(f)+".")}(this.dest,this.src);if(s=a.containsError(u))return s;if(!u.length)return a.create("operation","I can't store a new value inside "+i(this.dest)+" that isn't in a variable.","You need a variable, or a data structure containing variables at certain positions, to store the value.");var l=!0,p=!1,f=void 0;try{for(var d,h=u.reverse()[Symbol.iterator]();!(l=(d=h.next()).done);l=!0){var y=d.value,m=y.dest,g=y.value,v=y.src;if(t.isPrototypeOf(m)){if(s=a.containsError(m.defineType()))return s;m=m.varRef}if(s=m.set(g),a.isPrototypeOf(s))return s;e&&v&&v.delete(),c.shift(i(m)+" is now "+i(g))}}catch(e){p=!0,f=e}finally{try{!l&&h.return&&h.return()}finally{if(p)throw f}}return c.join("; ")},create:function(e,t,n){return Object.assign(Object.create(this),{dest:e,src:t,operator:n})}})}),define("twinescript/operations",["jquery","state","datatypes/assignmentrequest","utils/operationutils","internaltypes/varref","datatypes/typedvar","datatypes/datatype","internaltypes/twineerror"],function(e,t,n,r,a,i,o,s){var c=r.isObject,u=r.collectionType,l=r.is,p=r.isA,f=r.clone,d=r.unique,h=r.contains,y=r.matches,m=r.objectName,g=void 0,v=0;function b(e,t,n,r){return n=n||"do this to",function(a,i){1===t.length&&(i=a);var o;return(o=s.containsError(a,i))?o:(void 0===a?"undefined":_typeof(a))!==e||(void 0===i?"undefined":_typeof(i))!==e?s.create("operation","I can only "+n+" "+e+"s, not "+m((void 0===a?"undefined":_typeof(a))!==e?a:i)+".",r):t(a,i)}}function w(e){return function(t,n){var r;if(r=s.containsError(t,n))return r;if((void 0===t?"undefined":_typeof(t))!==(void 0===n?"undefined":_typeof(n))||c(t)&&"TwineScript_TypeName"in t&&c(n)&&"TwineScript_TypeName"in n&&t.TwineScript_TypeName!==n.TwineScript_TypeName||u(t)!==u(n)){var a=m(t)+" isn't the same type of data as "+m(n);return s.create("operation",a[0].toUpperCase()+a.slice(1))}return e(t,n)}}function T(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return function r(a,i){var o=void 0;if(o=s.containsError(a,i))return o;v=a;var c=a.determiner?[a,i]:i.determiner?[i,a]:[],u=_slicedToArray(c,2),l=u[0],p=u[1];if(l){var f=l.determiner;if("start"===f||"end"===f){if(t)return s.create("operation","I can't use '"+t+"' with the 'start' or 'end' of "+m(l)+".");if(p.determiner){if("start"===p.determiner||"end"===p.determiner)return s.create("operation","I can't compare one value's 'start' or 'end' with another value's 'start' or 'end'.","Please change one of them to use an exact range, such as '1stto4th' or '2ndlasttolast'.");var d=[p,l];l=d[0],p=d[1]}for(var h=l.string||l.array,y=0;y<h.length+1;y+=1){var g=y?"end"===f?h.slice(-y):h.slice(0,y):h.constructor(),b=l===a?r(g,i):r(a,g);if(o=s.containsError(b))return o;if(b!==n)return b}return n}var w="all"===f;return l.array.reduce(function(e,t){var n,o=l===a?r(t,i):r(a,t);return(n=s.containsError(e,o))?n:w?e&&o:e||o},w)}return e(a,i)}}function S(e,t){return T(function(t,n){var r=e(t,n);return s.containsError(r)?r:!r},t,!0)}var x="If one of these values is a number, you may want to write a check that it 'is not 0'. Also, if one is a string, you may want to write a check that it 'is not \"\" '.";return g={create:function(n){var r=Object.create(this);return r.Identifiers={TwineScript_Identifiers:!0,get it(){return v},get time(){return n.stackTop&&n.stackTop.evaluateOnly?s.create("operation","'time' can't be used in "+n.stackTop.evaluateOnly+"."):Date.now()-n.timestamp},get visits(){var e=n.stackTop.speculativePassage,r=function(n){return n===(e||t.passage)};return t.pastPassageNames().filter(r).length+t.mockVisits.filter(r).length+(!e||e===t.passage)},get visit(){return r.Identifiers.visits},get exits(){return n.stackTop&&n.stackTop.evaluateOnly?s.create("operation","'exit' and 'exits' can't be used in "+n.stackTop.evaluateOnly+"."):n.dom.find("tw-enchantment, tw-link").filter(function(t,n){return e(n).data("enchantmentEvent")||e(n).parent().data("linkPassageName")||e(n).parent().data("clickEvent")}).length},get exit(){return r.Identifiers.exits},get pos(){return n.stackTop&&!n.stackTop.evaluateOnly&&n.stackTop.lambdaPos?+n.stackTop.lambdaPos||1:s.create("operation","'pos' can only be used in lambdas that aren't 'when' lambdas.")}},r},elidedComparisonOperator:function(e,t){for(var n=arguments.length,r=Array(n>2?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];return r.reduce(function(n,r){return"boolean"==typeof r?r:g[e](n,g[t](v,r))},"and"===e)},and:b("boolean",w(function(e,t){return e&&t}),"use 'and' to join",x),or:b("boolean",w(function(e,t){return e||t}),"use 'or' to join",x),not:b("boolean",function(e){return!e},"use 'not' to invert",x),"+":w(function(e,t){if(Array.isArray(e))return[].concat(_toConsumableArray(e),_toConsumableArray(t));var n=void 0;return e instanceof Map?(n=new Map(e),t.forEach(function(e,t){return n.set(t,e)}),n):e instanceof Set?new Set([].concat(_toConsumableArray(e),_toConsumableArray(t)).filter(d).map(f)):"function"==typeof e["TwineScript_+"]?e["TwineScript_+"](t):"string|number|boolean".includes(void 0===e?"undefined":_typeof(e))?e+t:s.create("operation","I can't use + on "+m(e)+".")}),"-":w(function(e,t){if(Array.isArray(e))return e.filter(function(e){return!t.some(function(t){return l(e,t)})});if(e instanceof Set){var n=[].concat(_toConsumableArray(t));return new Set([].concat(_toConsumableArray(e)).filter(function(e){return!n.some(function(t){return l(e,t)})}))}return"string"==typeof e?e.split(t).join(""):"number"==typeof e?e-t:s.create("operation","I can't use - on "+m(e)+".")}),"*":b("number",w(function(e,t){return e*t}),"multiply"),"/":b("number",w(function(e,t){return 0===t?s.create("operation","I can't divide "+m(e)+" by zero."):e/t}),"divide"),"%":b("number",w(function(e,t){return 0===t?s.create("operation","I can't modulo "+m(e)+" by zero."):e%t}),"modulus"),"<":T(b("number",w(function(e,t){return e<t}),"do < to"),"<"),">":T(b("number",w(function(e,t){return e>t}),"do > to"),">"),"<=":T(b("number",w(function(e,t){return e<=t}),"do <= to"),"<="),">=":T(b("number",w(function(e,t){return e>=t}),"do >= to"),">="),is:T(l),isNot:S(l),contains:T(h,"contains"),doesNotContain:S(h,"does not contain"),isIn:T(function(e,t){return h(t,e)},"is in"),isNotIn:S(function(e,t){return h(t,e)},"is not in"),isA:T(p,"is a"),isNotA:S(p,"is not a"),typifies:T(function(e,t){return p(t,e)}),untypifies:S(function(e,t){return p(t,e)}),matches:T(y),doesNotMatch:S(y),where:function(e,t,n){var r;return(r=s.containsError(e))?r:"boolean"!=typeof e?s.create("operation","This lambda's 'where' clause must evaluate to true or false, not "+m(e)+"."):e?t:n},makeSpreader:function(e){if(i.isPrototypeOf(e)||o.isPrototypeOf(e)){var t=f(e);return(i.isPrototypeOf(e)?t.datatype:t).rest=!0,t}return{value:e,spreader:!0,TwineScript_TypeName:"a spreaded '...' value",TwineScript_ObjectName:"a spreaded '...' value",TwineScript_Unstorable:!0}},makeAssignmentRequest:function(e,t,r){var a=s.containsError(e,t);return a||n.create(e,t,r)},setIt:function(e){return a.isPrototypeOf(e)||i.isPrototypeOf(e)?(v=e.get(),e):e},initialiseIt:function(e){v=e}},Object.freeze(g)}),define("twinescript/environ",["macros","state","utils","datatypes/colour","datatypes/hookset","datatypes/lambda","datatypes/datatype","datatypes/varbind","datatypes/codehook","datatypes/typedvar","internaltypes/varref","internaltypes/twineerror","twinescript/operations"],function(Macros,State,Utils,Colour,HookSet,Lambda,Datatype,VarBind,CodeHook,TypedVar,VarRef,TwineError,OperationsProto){return function(section){"object"===(void 0===section?"undefined":_typeof(section))&&section||Utils.impossible("TwineScript.environ","no Section argument was given!");var Operations=OperationsProto.create(section);return section.eval=function(){try{return eval(arguments[0])}catch(e){return e}},section}}),define("section",["jquery","utils","renderer","twinescript/environ","twinescript/operations","state","utils/operationutils","utils/renderutils","datatypes/changercommand","datatypes/hookset","datatypes/colour","datatypes/lambda","internaltypes/changedescriptor","internaltypes/varscope","internaltypes/twineerror","internaltypes/twinenotifier"],function(e,t,n,r,a,i,o,s,c,u,l,p,f,d,h,y){var m,g=o.printBuiltinValue,v=o.objectName,b=o.typeID,w=s.collapse;function T(e,n,r){if(n&&"object"===(void 0===n?"undefined":_typeof(n))&&c.isPrototypeOf(n)){if(r.data("originalSource",r.popAttr("source")),!this.renderInto(r.data("originalSource"),r,n)){var a=t.insensitiveName(e.attr("name"));if(["if","elseif","unless","else","testfalse"].includes(a)&&(e.addClass("false"),"elseif"!==a&&(this.stackTop.lastHookShown=!1)),r.data("live")){var i=r.data("live"),o=i.delay,s=i.event;(function(e,n){var r=this,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:20,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:void 0;i&&t.assertMustHave(i,["when"]);var o=n.data("originalSource")||"",s=_slicedToArray(this.stack,1)[0].tempVariables,c=this.whenUnblocked.bind(this,function(){if(r.inDOM()){var t=i&&i.filter(r,[!0],s);h.containsError(t)?t.render(e.attr("title")).replaceAll(e):!i||t[0]?(r.renderInto(o,n,{append:"replace"}),t||n.find("tw-expression[name='stop']").length||r.inDOM()&&setTimeout(c,a)):setTimeout(c,a)}});setTimeout(c,a)}).call(this,e,r,o,s)}return}}else{if(!1===n)return r.attr("source")&&(r.data("originalSource",r.popAttr("source")),r.data("hidden",!0)),e.addClass("false"),void(this.stackTop.lastHookShown=!1);!0!==n&&e.replaceWith(h.create("datatype",v(n)+" cannot be attached to this hook.","Only Booleans and changers can be attached to hooks.").render(e.attr("title")))}this.stackTop.lastHookShown=!0}function S(t){var n=(t instanceof e?t[0]:t).nextSibling;if(n&&(n instanceof Text&&!n.textContent.trim()||["br","tw-consecutive-br"].includes((n.tagName||"").toLowerCase()))){var r=S(n),a=r.whitespace,i=r.nextElem;return{whitespace:e(n).add(a),nextElem:i}}return{whitespace:e(),nextElem:e(n)}}var x={add:[],remove:[]};return m={create:function(e){var n=Object.assign(Object.create(this),{timestamp:Date.now(),dom:e||t.storyElement,stack:[],enchantments:[],unblockCallbacks:[]});return n=r(n)},get stackTop(){return this.stack[0]},inDOM:function(){return e(t.storyElement).find(this.dom).length>0},evaluateTwineMarkup:function(t,n){var r=e("<p>");this.stack.unshift({desc:f.create({target:r,source:t,section:this,append:"append"}),tempVariables:this.stackTop.tempVariables,evaluateOnly:n,finalIter:!0}),this.execute();var a;return(a=r.find("tw-error")).length>0?a:r},speculate:function(e,t,n){this.stack.unshift({evaluateOnly:n,finalIter:!0,tempVariables:Object.assign(Object.create(d),{TwineScript_VariableStoreName:n}),speculativePassage:t});var r=void 0;return r=p.isPrototypeOf(e)?e.apply(this,{fail:!1,pass:!0}):this.eval(e),this.stack.shift(),r},renderInto:function(t,n,r){var a=this,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=f.create({target:n,source:t,section:this,append:"append"});if(r)if(c.isPrototypeOf(r)){var s=r.run(o);if(h.containsError(s))return s.render(n.attr("title")).replaceAll(n),!1}else Object.assign(o,r);if((n=o.target,this.stack.length>=50)&&this.stack.reduce(function(e,t){return e+!!t.finalIter},0)>=50)return h.create("infinite","Printing this expression may have trapped me in an infinite loop.").render(n.attr("title")).replaceAll(n),!1;var u=function(t,r,i){var o=n instanceof e&&n.is("tw-hook")&&n.parents("tw-collapsed,[collapsing=true]").length>0;a.stack.unshift({desc:t,finalIter:i,tempVariables:r,collapses:o,evaluateOnly:a.stackTop&&a.stackTop.evaluateOnly})};if(i||(i=Object.create(this.stack.length?this.stackTop.tempVariables:d)),!i.hasOwnProperty("TwineScript_VariableStoreName")){var l=n&&n.tag();i.TwineScript_VariableStoreName="tw-hook"===l?n.attr("name")?"?"+n.attr("name"):"an unnamed hook":"tw-expression"===l?"a "+n.attr("type")+" expression":"tw-passage"===l?"this passage":"an unknown scope"}return Object.keys(o.loopVars).length?function(){var e=Object.assign({},o.loopVars),t=Math.min.apply(Math,_toConsumableArray(Object.keys(e).map(function(t){return e[t].length})));if(y.create(t+" loop"+(1!==t?"s":"")).render().prependTo(n),t){for(var r=function(n){u(o,Object.keys(e).reduce(function(t,r){return t[r]=e[r][n],t},Object.create(i),n===t-1))},s=t-1;s>=0;s-=1)r(s);for(s=t-1;s>=0&&!a.stackTop.blocked;s-=1)a.execute()}}():(u(o,i,!0),this.execute()),0===this.stack.length&&this.updateEnchantments(),o.enabled},execute:function(){var n=this,r=this.stackTop,i=r.desc,o=r.dom,s=r.collapses,u=r.evaluateOnly;i&&!o&&(o=i.render(),this.stackTop.dom=o,this.stackTop.desc=void 0),o.findAndFilter("tw-hook,tw-expression").each(function(r,i){if(n.stackTop.blocked)return!1;switch((i=e(i)).tag()){case"tw-hook":var o=i.popAttr("source")||"";if(o&&i.data("originalSource",o),i.data("tempVariables",n.stackTop.tempVariables),i.popAttr("hidden")){i.data("hidden",!0);break}o&&n.renderInto(o,i);break;case"tw-expression":if(i.attr("blockers")){if(u)return void i.removeAttr("blockers").removeAttr("js").replaceWith(h.create("syntax","I can't use a macro like (prompt:) or (confirm:) in "+u+".","Please rewrite this without putting such macros here.").render(i.attr("title"),i));var s=[];try{s=JSON.parse(i.popAttr("blockers")),i.data("blockers",s)}catch(e){t.impossible("Section.execute","JSON.parse blockers failed.")}}if(i.data("blockers")){var p=i.data("blockers");if(p.length){n.stackTop.blocked=!0;var d=n.eval(p.shift());return h.containsError(d)&&(n.stackTop.blocked=!1,i.removeData("blockers").replaceWith(d.render(i.attr("title"),i))),!1}i.removeData("blockers")}i.attr("js")&&function(n){var r=this.eval(n.popAttr("js")||"");this.stackTop.evaluateOnly&&r&&(c.isPrototypeOf(r)||"function"==typeof r.TwineScript_Run)&&(r=h.create("syntax","I can't work out what "+this.stackTop.evaluateOnly+" should evaluate to, because it contains a "+(c.isPrototypeOf(r)?"changer.":"command."),"Please rewrite this without putting changers or commands here."));var i=void 0,o=void 0,s=e();for(o=n;c.isPrototypeOf(r);){var u=S(o);if(i=u.whitespace,(o=u.nextElem)[0]instanceof Text&&"+"===o[0].textContent.trim()){var p,d=o,m=S(d);if(p=m.whitespace,(o=m.nextElem).is("tw-expression")){var w=this.eval(o.popAttr("js"));if(h.containsError(w)){r=w;break}var x=a["+"](r,w);e(i).add(d).add(p).remove(),r=h.containsError(x)?h.create("operation","I can't combine "+v(r)+" with "+v(w)+".","function"==typeof w.TwineScript_Run?"If you want to attach this changer to "+v(w)+", remove the + between them.":"Changers can only be added to other changers."):x;continue}}if(o.is("tw-expression")){var k=this.eval(o.popAttr("js"));if(h.containsError(k)){r=k;break}if(k&&"object"===(void 0===k?"undefined":_typeof(k))&&"function"==typeof k.TwineScript_Attach){r=k.TwineScript_Attach(this,r);break}return c.isPrototypeOf(k)?void n.replaceWith(h.create("operation","Changers like ("+r.macroName+":) need to be combined using + between them.","Place the + between the changer macros, or the variables holding them. The + is absent only between a changer and its attached hook or command.").render(n.attr("title"))):void n.replaceWith(h.create("operation",v(k)+" can't have changers like ("+r.macroName+":) attached.","Changers placed just before hooks, links and commands will attempt to attach, but in this case it didn't work.").render(n.attr("title")))}if(o.is("tw-hook")){i.remove(),s=o;break}r.macroName||t.impossible("Section.runExpression","changer has no macroName");var O=n.attr("title")||"("+r.macroName+": ...)";return void n.replaceWith(h.create("syntax","The ("+r.macroName+":) changer should be stored in a variable or attached to a hook.","Macros like this should appear before a hook: "+O+"[Some text]").render(n.attr("title")))}n.attr("return",b(r)),s=s.length?s:S(n).nextElem.filter("tw-hook");var j=void 0;if(j=h.containsError(r))j instanceof Error&&(j=h.fromError(j)),n.replaceWith(j.render(n.attr("title"),n));else if(y.isPrototypeOf(r))n.append(r.render());else if(r&&"function"==typeof r.TwineScript_Run)if(r=r.TwineScript_Run(this),h.containsError(r))n.replaceWith(r.render(n.attr("title")));else if(f.isPrototypeOf(r)){if(r.data&&r.data.live)return void n.replaceWith(h.create("unimplemented","I currently can't attach (live:) or (event:) macros to commands - only hooks.").render(n.attr("title")));r.section=this,r.target=o,this.renderInto("",o,r)}else{if("blocked"===r)return this.stackTop.blocked=!0,void n.attr("js","section.blockedValue()");r&&t.impossible("Section.runExpression","TwineScript_Run() returned a non-ChangeDescriptor "+(void 0===r?"undefined":_typeof(r))+': "'+r+'"')}else!s.length&&("string"==typeof r||"number"==typeof r||r instanceof Map||r instanceof Set||Array.isArray(r)||l.isPrototypeOf(r))||r&&"function"==typeof r.TwineScript_Print&&!c.isPrototypeOf(r)?(r=g(r),h.containsError(r)?(r instanceof Error&&(r=h.fromError(r)),n.replaceWith(r.render(n.attr("title")))):"string"!=typeof r?t.impossible("printBuiltinValue() produced a non-string "+(void 0===r?"undefined":_typeof(r))):this.renderInto(r,n)):s.length?T.call(this,n,r,s):c.isPrototypeOf(r)||"boolean"==typeof r||t.impossible("Section.runExpression","The expression evaluated to an unknown value: "+r)}.call(n,i)}}),this.stackTop.blocked||(o.length&&s&&w(o),o.findAndFilter("tw-collapsed,[collapsing=true]").each(function(){w(e(this))}),this.stack.shift())},updateEnchantments:function(){this.enchantments.forEach(function(e){e.disenchant(),e.enchantScope()})},on:function(e,t){return x[e].push(t),this},addEnchantment:function(e){var t=this;this.enchantments.push(e),x.add.forEach(function(n){return n(t,e)})},removeEnchantment:function(e){var t=this,n=this.enchantments.indexOf(e);this.enchantments.splice(n,1),e.disenchant(),x.remove.forEach(function(n){return n(t,e)})},unblock:function(e){for(this.stack.length||t.impossible("Section.unblock","stack is empty"),this.stackTop.blocked=!1,void 0!==e&&(this.stackTop.blockedValues=(this.stackTop.blockedValues||[]).concat(e));this.stack.length&&!this.stackTop.blocked;)this.execute();if(!this.stack.length)for(;this.unblockCallbacks.length>0;){if(this.unblockCallbacks.shift()(),this.stackTop&&this.stackTop.blocked)return}},whenUnblocked:function(e){this.stack.length&&this.stackTop.blocked?this.unblockCallbacks=this.unblockCallbacks.concat(e):e()},blockedValue:function(){var e=this.stackTop;return e||t.impossible("Section.blockedValue","stack is empty"),e.blockedValues&&e.blockedValues.length||t.impossible("Section.blockedValue","blockedValues is missing or empty"),e.blockedValues.shift()}},Object.preventExtensions(m)}),define("engine",["jquery","utils","state","section","passages"],function(e,t,n,r,a){var i,o=t.escape,s=t.impossible,c=t.passageSelector,u=t.transitionOut,l=Object.create(null);function p(e,t){return"<tw-include type="+e+" title='"+o(t.get("name"))+"'>"+t.get("source")+"</tw-include>"}function f(i){var o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t.assertOnlyHas(o,["stretch","transition"]);var f=a.get(i),d=t.storyElement,h=d.parent(),y=o.stretch,m=o.transition,g=(m=void 0===m?{}:m).depart,v=void 0===g?"instant":g,b=m.arrive,w=void 0===b?"dissolve":b,T=m.departOrigin,S=m.arriveOrigin,x=m.time;h.findAndFilter("tw-enchantment").each(function(t,n){var r=(n=e(n)).data("enchantedProperties");r&&d.css(r.reduce(function(e,t){return e[t]="",e},{})),n[0]===h[0]&&(h=d.unwrap().parent())}),a.hasValid(i)||s("Engine.showPassage","There's no passage with the name \""+i+'"!');var k,O,j,A,C=d.children(c).not(".transition-out, .transition-out *"),E=(f.get("tags")||[]).join(" "),_=(k=e("<tw-passage><tw-sidebar>"),O=k.children("tw-sidebar"),j=e('<tw-icon tabindex=0 alt="Undo" title="Undo">&#8630;</tw-icon>'),A=e('<tw-icon tabindex=0 alt="Redo" title="Redo">&#8631;</tw-icon>'),n.pastLength<=0&&j.css("visibility","hidden"),n.futureLength<=0&&A.css("visibility","hidden"),O.append(j,A),k);"function"==typeof T&&(T=T.call(C)),"function"==typeof S&&(S=S.call(_)),d.detach(),_.appendTo(d).attr({tags:E}),!y&&v&&(u(C,v,x,0,0,0,T),C.css("position","absolute")),d.attr({tags:E});var N=r.create(_),P=f.get("source");P=a.getTagged("header").map(p.bind(0,"header")).join("")+(l.debug?a.getTagged("debug-header").map(p.bind(0,"debug-header")).join(""):"")+P+a.getTagged("footer").map(p.bind(0,"footer")).join("")+(l.debug?a.getTagged("debug-footer").map(p.bind(0,"debug-footer")).join(""):""),n.pastLength<=0&&(l.debug&&(P=a.getTagged("debug-startup").map(p.bind(0,"debug-startup")).join("")+P),P=a.getTagged("startup").map(p.bind(0,"startup")).join("")+P),N.renderInto(P,_,{transition:w,transitionTime:x,transitionOrigin:S}),h.append(d.parents().length?d.parents().last():d),scroll(0,y?_.offset().top-.05*e(window).height():d.offset().top)}return i={goBack:function(e){n.rewind()&&f(n.passage,e)},goForward:function(e){n.fastForward()&&f(n.passage,e)},goToPassage:function(e,t){n.play(e),f(e,t)},toggleFullscreen:function(){var e=document.documentElement;document.fullscreenElement?document.exitFullscreen():document.msFullscreenElement?document.msExitFullscreen():(e.msRequestFullscreen||e.requestFullscreen).call(e)},showPassage:f,options:l},Object.freeze(i)}),define("debugmode/panel",["jquery"],function(e){return Object.freeze({create:function(t){var n=t.className,r=t.rowAdd,a=t.rowCheck,i=t.columnHead,o=t.tabName,s=t.tabUpdate,c=e("<div class='panel panel-"+n+"' hidden><table class='panel-rows'></table></div>"),u=e("<button class='tab tab-"+n+"'>0 "+o+"s</button>");return u.click(function(){u.toggleClass("enabled"),u.parent().siblings(".panel").attr("hidden",""),u.is(".enabled")&&(u.siblings(".tab:not(.tab-"+n+")").removeClass("enabled"),c.removeAttr("hidden"))}),s||(s=function(e){return u.text(e+" "+o+(1!==e?"s":""))}),Object.assign(Object.create(this),{tabName:o,tab:u,panel:c,panelRows:c.find(".panel-rows"),rowAdd:r,rowCheck:a,columnHead:i,tabUpdate:s})},update:function(t,n){var r=this.rowCheck,a=this.rowAdd,i=this.panelRows,o=this.columnHead,s=[],c=i.children();t.forEach(function(t){var n=c.filter(function(n,a){return r(t,e(a))}),o=a(t);n.length?n.replaceWith(o):i.append(o),s.push(o[0])}),c.filter(function(e,t){return!s.includes(t)}).remove(),this.tabUpdate(n),n>0&&!i.find(".panel-head").length?i.prepend(o()):0===n&&i.find(".panel-head").remove()}})}),define("debugmode/mode",["jquery","utils","state","internaltypes/varref","internaltypes/twineerror","utils/operationutils","engine","passages","section","debugmode/panel"],function(e,t,n,r,a,i,o,s,c,u){var l=t.escape,p=t.nth,f=t.storyElement,d=t.debounce,h=i.objectName,y=i.isObject,m=i.toSource;return function(t,i){var g=e(document.documentElement),v=e("<tw-debugger>\n\t\t<div class='panel panel-errors' hidden><table></table></div>\n\t\t<div class='tabs'></div>\n\t\t<label style='user-select:none'>Turns: </label><select class='turns' disabled></select><button class='show-invisibles'>Debug View</button><button class='show-dom'>DOM View</button>\n\t\t<div class='resizer'>\n\t\t</tw-debugger>"),b=v.find(".tabs"),w=v.find(".show-dom"),T=v.find(".show-invisibles"),S=v.find(".turns");v.find(".resizer").mousedown(function(e){if(1!==e.which)return!0;e.stopPropagation();var t=e.pageX,n=v.width();g.on("mousemove.debugger-resizer",function(e){var r=e.pageX;v.width((n+t-r|0)+"px")}).on("mouseup.debugger-resizer",function(){g.off(".debugger-resizer")})}),T.click(function(){g.toggleClass("debug-mode").removeClass("dom-debug-mode"),T.toggleClass("enabled"),w.removeClass("enabled")}),w.click(function(){g.toggleClass("dom-debug-mode").removeClass("debug-mode"),w.toggleClass("enabled"),T.removeClass("enabled")}),n.timelinePassageNames().forEach(function(e,t){S.append("<option value="+t+">"+(t+1)+": "+e+"</option>")}),S.val(n.pastLength),n.pastLength>0&&S.removeAttr("disabled"),S.change(function(e){var t=e.target.value-n.pastLength;0!==t&&(n[t<0?"rewind":"fastForward"](Math.abs(t)),o.showPassage(n.passage))}),n.on("forward",function(t){var r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=n.pastLength;a>=1&&S.removeAttr("disabled"),r?(S.find("[selected]").removeAttr("selected"),S.val(a)):(S.children().each(function(t,n){t>=a&&e(n).remove()}),S.append("<option value="+a+">"+(a+1)+": "+t+"</option>").val(a))}).on("back",function(){n.pastLength<=1&&S.attr("disabled"),S.find("[selected]").removeAttr("selected"),S.val(n.pastLength)}).on("load",function(e){S.empty(),S[e.length<=1?"attr":"removeAttr"]("disabled"),e.forEach(function(e,t){return S.append("<option value="+t+">"+(t+1)+": "+e.passage+"</option>")})});var x=new Set,k=u.create({className:"variables",tabName:"Variable",rowAdd:function(t){var n=t.name,r=t.dataset,a=t.path,i=t.value,o=t.tempScope,s=t.type,c=y(i)&&i.TwineScript_DebugName?i.TwineScript_DebugName():l(h(i)),u="";a.length&&(u=a.reduce(function(e,t){return e+t+"'s "},"")),r&&(n="???");var p=s?m(s):"",f=c.length>48&&!i.TwineScript_DebugName,d="object"===(void 0===i?"undefined":_typeof(i))||f,g=f?c.slice(0,48)+"\u2026":c;return e('<div class="variable-row">').attr("data-name",n).attr("data-path",a+"").attr("data-scope",o||"").css("padding-left",Math.min(5,a.length)+"em").append("<td class='variable-type'>"+(p?p+"-type ":"")+"</td>","<td class='variable-name'>"+(u?"<span class='variable-path'>"+(o?"_":"$")+l(u)+"</span> ":"")+(u?"":o?"_":"$")+l(n+"")+"</td>","<td class='temporary-variable-scope'>"+(o||"")+"</td>","<td class='variable-value'>"+g+"</td><td class='panel-row-buttons'>"+(d?"<tw-folddown tabindex=0>(source:) </tw-folddown>":"")+"</td>").add(d?"<tr class='variable-row panel-row-source' style='display:none'><td colspan='5'>"+l(m(i))+"</td></tr>":"")},rowCheck:function(e,t){var n=e.name,r=e.path;e.tempScope;return t.attr("data-name")===n&&t.attr("data-path")===r+""},columnHead:function(){return'<tr class="panel-head"><th>Type</th><th>Name</th><th>Scope</th><th>Value</th></tr>'}}),O=d(function(){var e=[],t=n.variables,r=e.length;function a(t){if(!(e.length>500)){e.push(t);var n=t.path.concat(t.name),r=t.value,i=t.tempScope;Array.isArray(r)?r.forEach(function(e,t){return a({name:p(t+1),path:n,value:e,tempScope:i})}):r instanceof Map?[].concat(_toConsumableArray(r)).forEach(function(e){var t=_slicedToArray(e,2),r=t[0],o=t[1];return a({name:r,path:n,value:o,tempScope:i})}):r instanceof Set&&[].concat(_toConsumableArray(r)).forEach(function(e,t){return a({name:t,dataset:!0,path:n,value:e,tempScope:i})})}}for(var i in t)i.startsWith("TwineScript")||(r+=1,a({name:i,path:[],value:t[i],tempScope:"",type:t.TwineScript_TypeDefs&&t.TwineScript_TypeDefs[i]}));e.push.apply(e,_toConsumableArray(x)),r+=x.size,k.update(e,r),k.panel[(r?"remove":"add")+"Class"]("panel-variables-empty")}),j=void 0;r.on("set",function(e,t,r){if(e!==n.variables&&e.TwineScript_VariableStoreName&&!e.TwineScript_VariableStoreName.match(/#\d+$/)){var a=e.TwineScript_VariableStoreName,i=e.TwineScript_TypeDefs&&e.TwineScript_TypeDefs[t],o=[].concat(_toConsumableArray(x)).find(function(e){return e.name===t&&e.tempScope===a});o?o.value=r:x.add({name:t,path:[],value:r,tempScope:a,type:i})}O(),j()}).on("delete",function(){O(),j()}),k.panel.append("<div class='panel-variables-bottom'>\n\t\t\t<button class='panel-variables-copy'>Copy $ variables as (set:) call</button>\n\t\t\t<input class='clipboard' type=\"text\" style='opacity:0;pointer-events:none;position:absolute;'></input>\n\t\t</div>").removeAttr("hidden"),k.tab.addClass("enabled");var A=k.panel.find(".clipboard");g.on("click",".panel-variables-copy",function(){var e=[];for(var t in n.variables)t.startsWith("TwineScript")||e.push("$"+t+" to "+m(n.variables[t]));A.val("(set:"+e+")")[0].select(),document.execCommand("copy")});var C=u.create({className:"enchantments",tabName:"Enchantment",rowAdd:function(t){var n=t.scope,r=t.changer,a=t.name,i=t.localHook,o=void 0;return o=r?l(h(r)):"<em>enchanted via ("+a+":)</em>",e('<div class="enchantment-row">').data("enchantment",t).append("<td><span class='enchantment-name'>"+m(n)+(i?"</span><span class=enchantment-local>"+("function"==typeof i.TwineScript_ToSource?i.TwineScript_ToSource():i.attr("name")?"?"+i.attr("name"):"an unnamed hook"):"")+"</span></td><td class='enchantment-value'>"+o+"</td>"+(r?"<td class='panel-row-buttons'><tw-folddown tabindex=0>(source:)</tw-folddown></td>":"")).add(r?"<tr class='panel-row-source' style='display:none'><td colspan='3'>"+l(m(r))+"</td></tr>":"")},rowCheck:function(e,t){return t.data("enchantment")===e},columnHead:function(){return'<tr class="panel-head"><th>Scope</th><th>Value</th></div>'}}),E=d(function(e){C.update(e.enchantments,e.enchantments.length)});c.on("add",E).on("remove",E);var _=c.create(f),N=u.create({className:"storylets",tabName:"Storylet",rowAdd:function(t){var n=t.name,r=t.active,a=t.storyletSource,i=t.exclusive,o=t.urgent;return e('<tr class="storylet-row '+(r?"":"storylet-closed")+'">').attr("data-name",n).append("<td class='storylet-name'>"+n+"</td><td class='storylet-lambda'>"+a+"</td><td class='storylet-exclusive'>"+i+"</td><td class='storylet-urgent'>"+o+"</td>")},rowCheck:function(e,t){var n=e.name;return t.attr("data-name")===l(n+"")},columnHead:function(){return"<tr class=\"panel-head\"><th>Name</th><th>Condition</th><th class='storylet-exclusive'>Exclusivity</th><th class='storylet-urgent'>Urgency</th></tr>"}});N.tab.hide(),j=d(function(){var e=s.getStorylets(_),t=a.containsError(e),n=s.allStorylets();N.update(n.map(function(n){return{name:n.get("name"),storyletSource:n.get("storylet").TwineScript_ToSource(),active:!t&&e.some(function(e){return e.get("name")===n.get("name")}),exclusive:"number"==typeof n.get("exclusivity")?n.get("exclusivity"):0,urgent:"number"==typeof n.get("urgency")?n.get("urgency"):0}}),t?0:e.length),N.panel[(t?"add":"remove")+"Class"]("storylet-error");var r=n.some(function(e){return e.get("exclusivity")&&"number"==typeof e.get("exclusivity")}),i=n.some(function(e){return e.get("urgency")&&"number"==typeof e.get("urgency")});N.panel[(r?"add":"remove")+"Class"]("panel-exclusive"),N.panel[(i?"add":"remove")+"Class"]("panel-urgent"),n.length&&N.tab.show()});var P=u.create({className:"source",tabName:"Source",rowAdd:e.noop,rowCheck:e.noop,tabUpdate:e.noop,columnHead:e.noop});P.tab.text("Source");var I=u.create({className:"errors",tabName:"Error",rowAdd:e.noop,rowCheck:e.noop,columnHead:e.noop}),M=function(t,r){if("propagated"!==t.type){I.panelRows.children().length>500&&I.panelRows.children(":first-child").remove();var a=e('<tr class="error-row"><td class="error-passage">'+n.passage+'</td><td class="error-message">'+t.message+"</td></tr>");a.find(".error-message").attr("title",r),I.panelRows.append(a),I.tabUpdate(I.panelRows.children().length)}};function D(){if(x=new Set,O(),j(),C.panelRows.empty(),C.tabUpdate(0),n.passage){var e=s.get(n.passage);e&&P.panelRows.text(e.get("source"))}}a.on("error",M),v.prepend(k.panel,C.panel,I.panel,N.panel,P.panel),b.prepend(k.tab,C.tab,I.tab,N.tab,P.tab),n.on("forward",D).on("back",D).on("load",D),t&&(M(t,i),D()),e(document.body).append(v)}}),define("macrolib/values",["macros","utils","utils/operationutils","datatypes/colour","datatypes/gradient","datatypes/datatype","datatypes/hookset","internaltypes/twineerror"],function(e,t,n,r,a,i,o,s){var c=t.realWhitespace,u=t.nth,l=t.anyRealLetter,p=n.subset,f=n.objectName,d=n.clone,h=n.toSource,y=e.TypeSignature,m=y.rest,g=y.zeroOrMore,v=y.either,b=y.optional,w=y.insensitiveSet,T=y.numberRange,S=y.percent,x=y.nonNegativeInteger,k=y.positiveInteger,O=y.Any,j=Math.max,A=Math.min,C=Math.round,E=Math.floor,_=Math.ceil;function N(e){return function(){var t=e.apply(void 0,arguments);return"number"!=typeof t||isNaN(t)?s.create("macrocall","This mathematical expression doesn't compute!"):t}}e.add(["str","string","text"],function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return n.join("")},[g(e.TypeSignature.either(String,Number,Boolean,Array))])("source",function(e,t){return t&&"command"===t.TwineScript_TypeID&&!t.TwineScript_ToSource?s.create("datatype","I can't construct the source code of a command created by a custom macro."):h(t)},[O])("substring",function(e,t,n,r){return p(t,n,r)},[String,parseInt,parseInt])("lowercase",function(e,t){return t.toLowerCase()},[String])("uppercase",function(e,t){return t.toUpperCase()},[String])("lowerfirst",function(e,t){return t.replace(RegExp(l+"+"),function(e){return(e=Array.from(e))[0].toLowerCase()+e.slice(1).join("").toLowerCase()})},[String])("upperfirst",function(e,t){return t.replace(RegExp(l+"+"),function(e){return(e=Array.from(e))[0].toUpperCase()+e.slice(1).join("").toLowerCase()})},[String])("words",function(e,t){return t.split(RegExp(c+"+")).filter(Boolean)},[String])(["str-repeated","string-repeated"],function(e,t,n){return 0===n.length?s.create("macrocall","I can't repeat an empty string."):n.repeat(t)},[x,String])(["str-reversed","string-reversed"],function(e,t){return[].concat(_toConsumableArray(t)).reverse().join("")},[String])("joined",function(e,t){for(var n=arguments.length,r=Array(n>2?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];return r.join(t)},[m(String)])("plural",function(e,t,n,r){return n&&""!==r?t+" "+(1!==Math.abs(t)?r||n+"s":n):s.create("macrocall","The (plural:) macro can't be given empty strings.")},[parseInt,String,b(String)])(["str-nth","string-nth"],function(e,t){return u(t)},[parseInt])(["num","number"],function(e,t){return Number.isNaN(+t)?s.create("macrocall","I couldn't convert "+f(t)+" to a number."):+t},[String])("datatype",function(e,t){return i.from(t)},[O])("datapattern",function(e,t){return function e(t){var n,r=void 0;return Array.isArray(t)?r=t.map(e):t instanceof Map?(r=new Map,[].concat(_toConsumableArray(t)).forEach(function(t){var n=_slicedToArray(t,2),a=n[0],i=n[1];return r.set(a,e(i))})):r=i.from(t),(n=s.containsError(r))?n:r}(t)},[O])(["rgb","rgba"],function(e){return r.create({r:arguments.length<=1?void 0:arguments[1],g:arguments.length<=2?void 0:arguments[2],b:arguments.length<=3?void 0:arguments[3],a:arguments.length<=4?void 0:arguments[4]})},[T(0,255),T(0,255),T(0,255),b(S)])(["hsl","hsla"],function(e,t,n,a,i){return(t=C(t)%360)<0&&(t+=360),r.create({h:t,s:n,l:a,a:i})},[Number,S,S,b(S)])(["lch","lcha"],function(e,t,n,a,i){return(a=C(a)%360)<0&&(a+=360),r.create({l:t,c:n,h:a,a:i})},[S,T(0,132),Number,b(S)])("complement",function(e,t){return t.LCHRotate(180)},[r])("palette",function(e,t,n){var a=n.toLCHA(),i=a.l,o={l:i<=.75?.75+i/3:.75-3*(1-i),c:80,h:a.h,a:1},s=void 0,c=void 0,u=void 0;return s=r.create(o),o.l+=i<=.75?-.1:.1,o.l<.5&&(o.l*=.5/o.l),c=r.create(o),o.l+=i<=.85?.15:-.15,u=r.create(o),"adjacent"===t?(c=(s=s.LCHRotate(-30)).LCHRotate(30),u=s.LCHRotate(60)):"triad"===t&&(u=s.LCHRotate(180),c=s.LCHRotate(140),s=s.LCHRotate(-140)),[n,s,c,u]},[w("mono","adjacent","triad"),r])("gradient",function(e,t){for(var n=arguments.length,i=Array(n>2?n-2:0),o=2;o<n;o++)i[o-2]=arguments[o];if((t=C(t)%360)<0&&(t+=360),i.length<4)return s.create("datatype","(gradient:) must be given at least 2 colour-stop pairs of numbers and colours.");var c=void 0,u=[],l=i.reduce(function(e,t){if(s.containsError(e))return e;if(void 0===c)c=t;else{if("number"!=typeof c||!r.isPrototypeOf(t))return s.create("datatype","(gradient:) colour-stops should be pairs of numbers and colours, not colours and numbers.");u.push({stop:c,colour:d(t)}),c=void 0}return e},!0);return s.containsError(l)?l:void 0!==c?s.create("macrocall","This gradient has a colour-stop percent without a colour."):a.create(t,u)},[Number,m(v(S,r))])("stripes",function(e,t,n){for(var r=arguments.length,i=Array(r>3?r-3:0),o=3;o<r;o++)i[o-3]=arguments[o];(t=C(t)%360)<0&&(t+=360);var s=0,c=[];return i.forEach(function(e){c.push({stop:s,colour:d(e)}),s+=n,c.push({stop:s,colour:d(e)})}),a.create(t,c,!0)},[Number,k,r,m(r)])("hooks-named",function(e,t){return t?o.create({type:"name",data:t}):s.create("datatype","(hooks-named:) can't be given an empty string.")},[String])("cond",function(e){for(var t=0;t<(arguments.length<=1?0:arguments.length-1);t+=2){var n=arguments.length<=t+1?void 0:arguments[t+1];if(t===(arguments.length<=1?0:arguments.length-1)-1||s.containsError(n))return n;if("boolean"!=typeof n)return s.create("datatype","(cond:)'s "+u(t+1)+" value is "+f(n)+", but should be a boolean.");if(n)return arguments.length<=t+1+1?void 0:arguments[t+1+1]}return s.create("macrocall","An odd number of values must be given to (cond:), not "+(arguments.length<=1?0:arguments.length-1),"(cond:) must be given one or more pairs of booleans and values, as well as one final value.")},[Boolean,O,m(O)]),{weekday:[function(){return["Sun","Mon","Tues","Wednes","Thurs","Fri","Satur"][(new Date).getDay()]+"day"},null],monthday:[function(){return(new Date).getDate()},null],currenttime:[function(){var e=new Date,t=e.getHours()<12;return(e.getHours()%12||12)+":"+((e.getMinutes()<10?"0":"")+e.getMinutes())+" "+(t?"A":"P")+"M"},null],currentdate:[function(){return(new Date).toDateString()},null],min:[A,m(Number)],max:[j,m(Number)],abs:[Math.abs,Number],sign:[Math.sign,Number],sin:[Math.sin,Number],cos:[Math.cos,Number],tan:[Math.tan,Number],floor:[E,Number],round:[C,Number],trunc:[function(e){return e>0?E(e):_(e)},Number],ceil:[_,Number],pow:[N(Math.pow),[Number,Number]],exp:[Math.exp,Number],sqrt:[N(Math.sqrt),Number],log:[N(Math.log),Number],log10:[N(Math.log10),Number],log2:[N(Math.log2),Number],random:[function(e,t){var n=void 0,r=void 0;return t?(n=A(e,t),r=j(e,t)):(n=0,r=e),r+=1,~~(Math.random()*(r-n))+n},[parseInt,e.TypeSignature.optional(parseInt)]],either:[function(){var e;return e=~~(Math.random()*arguments.length),arguments.length<=e?void 0:arguments[e]},m(O)],nth:[function(e){var t;return e<=0?s.create("datatype","(nth:)'s first value should be a positive whole number, not "+e):(t=(e-1)%(arguments.length<=1?0:arguments.length-1)+1,arguments.length<=t?void 0:arguments[t])},[parseInt,m(O)]],"":function(){var t=this;Object.keys(this).forEach(function(n){if(n){var r=t[n][0],a=t[n][1];e.add(n,function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),a=1;a<t;a++)n[a-1]=arguments[a];return r.apply(void 0,n)},a)}})}}[""]()}),define("macrolib/commands",["jquery","macros","utils","state","passages","renderer","engine","internaltypes/twineerror","internaltypes/twinenotifier","datatypes/assignmentrequest","datatypes/hookset","datatypes/codehook","datatypes/lambda","datatypes/colour","datatypes/gradient","internaltypes/varref","datatypes/typedvar","datatypes/varbind","utils/operationutils","utils/renderutils"],function(e,t,n,r,a,i,o,s,c,u,l,p,f,d,h,y,m,g,v,b){var w=v.printBuiltinValue,T=v.objectName,S=v.clone,x=v.toSource,k=b.dialog,O=b.geomParse,j=b.geomStringRegExp,A=t.TypeSignature,C=A.Any,E=A.Everything,_=A.rest,N=A.either,P=A.optional,I=A.zeroOrMore,M=A.positiveInteger,D=A.positiveNumber,R=Object.assign,L=Math.floor,q=Math.ceil,F=Math.abs,V=Math.max,H=Math.min,z=e.noop;function $(e){return"("+e+" "+o.options.ifid+") "}["set","put","unpack"].forEach(function(e){return t.add(e,function(t){for(var n=0;n<(arguments.length<=1?0:arguments.length-1);n+=1){var r=arguments.length<=n+1?void 0:arguments[n+1];if("into"===r.operator&&"set"===e)return s.create("macrocall","Please say 'to' when using the (set:) macro.");if("to"===r.operator&&"set"!==e)return s.create("macrocall","Please say 'into' when using the (put:) or (unpack:) macro.");if((y.isPrototypeOf(r.dest)||m.isPrototypeOf(r.dest))===("unpack"===e))return s.create("macrocall","unpack"===e?"Please use the (unpack:) macro with arrays, datamaps or (p:) patterns containing variables to the right of 'into'.":"Please use the ("+e+":) macro with just single variables and typed variables to the "+("set"===e?"left of 'to'.":"right of 'into'."));var a=r.set();if(s.containsError(a))return a}return{TwineScript_TypeID:"instant",TwineScript_TypeName:"a ("+e+":) operation",TwineScript_ObjectName:"a ("+e+":) operation",TwineScript_Unstorable:!0,TwineScript_Print:function(){return o.options.debug,""}}},[_(u)])}),t.add("move",function(e){for(var t=0;t<(arguments.length<=1?0:arguments.length-1);t+=1){var n=arguments.length<=t+1?void 0:arguments[t+1];if("into"!==n.operator)return s.create("macrocall","Please say 'into' when using the (move:) macro.");var r=n.set(!0);if(s.containsError(r))return r}return{TwineScript_TypeID:"instant",TwineScript_TypeName:"a (move:) operation",TwineScript_ObjectName:"a (move:) operation",TwineScript_Unstorable:!0,TwineScript_Print:function(){return o.options.debug,""}}},[_(u)]),t.addCommand("display",function(e){if(!a.hasValid(e))return s.create("macrocall","I can't (display:) the passage '"+e+"' because it doesn't exist.")},function(e,t,r){return R(e,{source:n.unescape(a.get(r).get("source"))})},[String])("print",z,function(e,t,n){return R(e,{source:w(n)})},[C])(["verbatim-print","v6m-print"],z,function(e,t,n){return R(e,{verbatim:!0,source:w(n)})},[C])(["verbatim-source","v6m-source"],function(e){if(e&&"command"===e.TwineScript_TypeID&&!e.TwineScript_ToSource)return s.create("datatype","I can't construct the source code of a command created by a custom macro.")},function(e,t,n){return R(e,{verbatim:!0,source:w(x(n))})},[C])("go-to",function(e){if(!a.hasValid(e))return s.create("macrocall","I can't (go-to:) the passage '"+e+"' because it doesn't exist.")},function(e,t,n){return requestAnimationFrame(function(){return o.goToPassage(n,{transition:e.data.passageT8n})}),"blocked"},[String])("undo",z,function(e){return r.pastLength<1?s.create("macrocall","I can't (undo:) on the first turn."):(requestAnimationFrame(function(){return o.goBack({transition:e.data.passageT8n})}),"blocked")},[]),n.onStartup(function(){return e(n.storyElement).on("click.icon","tw-icon",function(t){var n=e(this),a=n.data("clickEvent"),i=n.attr("alt");a&&a(n),"Undo"===i&&(t.stopPropagation(),o.goBack()),"Redo"===i&&(t.stopPropagation(),o.goForward()),"Fullscreen"===i&&(t.stopPropagation(),o.toggleFullscreen()),"Restart"===i&&(r.hasSessionStorage&&sessionStorage.removeItem("Saved Session"),window.location.reload())})}),[["Undo","&#8630;",function(){return r.pastLength>0}],["Redo","&#8631;",function(){return r.futureLength>0}],["Fullscreen","&#9974;",function(){return document.fullscreenEnabled||document.msFullscreenEnabled}],["Restart","&#10226;",Object]].forEach(function(e){var n=_slicedToArray(e,3),r=n[0],a=n[1],i=n[2];t.addCommand("icon-"+r.toLowerCase(),function(e,t){if("string"==typeof e&&"string"==typeof t){var n=[].concat(_toConsumableArray(e)).length,a=[].concat(_toConsumableArray(t)).length;if(n>1&&a>1)return s.create("datatype","One of the two strings given to (icon-"+r.toLowerCase()+":) should be 1 character long, for its icon.");if(1===n&&1===a)return s.create("datatype","One of the two strings given to (icon-"+r.toLowerCase()+":) should be 2 or more characters long, for its label.")}},function(e,t,n,o){if("string"==typeof o&&1===[].concat(_toConsumableArray(o)).length||"string"==typeof n&&[].concat(_toConsumableArray(n)).length>1){var s=[o,n];n=s[0],o=s[1]}return R(e,{source:'<tw-icon tabindex=0 alt="'+r+'" '+(o?'data-label="'+o.replace('"',"&quot;")+'"':"")+' title="'+r+'" '+(i()?"":'style="visibility:hidden"')+">"+(n||a)+"</tw-icon>"})},[P(String),P(String)])}),t.addCommand("icon-counter",function(e,t,n){var r=" label string given to (icon-counter:) can't be empty or only whitespace.";return t&&t.trim()?"string"!=typeof n||n.trim()?void 0:s.create("datatype","The 2nd "+r):s.create("datatype","The 1st "+r)},function(e,t,r,a,i){e.attr.push({"data-2bind":!0}),e.data.twoWayBindEvent=function(t,n,o){if(r.varRef.matches(n,o)){var s=r.varRef.get();if("number"==typeof s)e.target.children("tw-icon").text(s>0?L(s):q(s)).attr("data-label",1!==F(s)&&void 0!==i?i:a)}};var o=r.varRef.get();return"number"!=typeof o?s.create("datatype","(icon-counter:) can only be bound to a variable holding a number, not "+T(o)+"."):R(e,{source:'<tw-icon data-label="'+n.escape(1!==F(o)&&void 0!==i?i:a)+'">'+(o>0?L(o):q(o))+"</tw-icon>"})},[g,String,P(String)]),t.addCommand("meter",function(e,t,n,r){return"string"!=typeof r||r.trim()?-1===n.search(j)||!n.includes("=")&&n.length>1?s.create("datatype",'The (meter:) macro requires a sizing line("==X==", "==X", "=XXXX=" etc.) be provided, not '+JSON.stringify(n)+"."):void 0:s.create("datatype","The label string given to (meter:) can't be empty or only whitespace.")},function(e,t,n,r,a,i,o){i&&"string"!=typeof i&&(o=i,i=void 0),o||(o=d.create({h:0,s:0,l:.5,a:.5})),d.isPrototypeOf(o)&&(o=h.create(90,[{colour:o,stop:0},{colour:o,stop:1}]));var c=O(a),u=c.marginLeft,l=c.size,p=u>0&&Math.ceil(u+l)<100,f=function(e){var t=V(0,H(1,e/r)),n=o.repeating?o:o.multiply(r/e);return"height:100%;background-repeat:no-repeat;background-image:"+(p?R(n,n.repeating?{}:{angle:270}).toLinearGradientString()+", ":"")+R(n,n.repeating?{}:{angle:p||0===u?90:270}).toLinearGradientString()+";background-size:"+(p?Array(2).fill(50*t+"%"):100*t+"%")+";background-position-x:"+(p?-100/(2-t)+100+"%,"+100/(2-t)+"%":0===u?"left":"right")+";text-align:"+(p?"center":0===u?"left":"right")};e.styles.push({"margin-left":u+"%",width:l+"%",height:"1.5em",display:"block"}),e.attr.push({"data-2bind":!0});var y=i&&t.stackTop.tempVariables;e.data.twoWayBindEvent=function(t,r,a){if(n.varRef.matches(r,a)){var o=n.varRef.get();if("number"==typeof o){var s=e.target.children("tw-meter");s.attr("style",f(o)),i&&e.section.renderInto("",null,{source:i,target:s,append:"replace",transitionDeferred:!1},y)}}};var m=n.varRef.get();return"number"!=typeof m?s.create("datatype","(meter:) can only be bound to a variable holding a number, not "+T(m)+"."):R(e,{source:'<tw-meter style="'+f(m)+'">'+(i||"")+"</tw-meter>"})},[g,D,String,P(N(String,d,h)),P(N(d,h))]),[["cycling-link"],["seq-link","sequence-link"]].forEach(function(e,n){return t.addCommand(e,function(){return""===(arguments.length<=0?void 0:arguments[0])?s.create("datatype","The first string in a ("+e[0]+":) can't be empty."):arguments.length<=(g.isPrototypeOf(arguments.length<=0?void 0:arguments[0])?2:1)?s.create("datatype","I need two or more strings to "+(n?"sequence":"cycle")+" through, not just '"+(t=arguments.length-1,arguments.length<=t?void 0:arguments[t])+"'."):void 0;var t},function(e,t){for(var r=arguments.length,a=Array(r>2?r-2:0),i=2;i<r;i++)a[i-2]=arguments[i];var o=void 0;g.isPrototypeOf(a[0])&&(o=a.shift());var c=0;if(o&&"two way"===o.bind){e.attr.push({"data-2bind":!0});var u=a.indexOf(o.varRef.get());u>-1&&(c=u)}var l=t.stackTop.tempVariables;function p(t,r){var i=c>=a.length-1&&n,u=""===a[c]?"":i?a[c]:"<tw-link>"+a[c]+"</tw-link>";if(i&&(e.data.clickEvent=void 0),o&&!r){var p=o.set(a[c]);if(s.containsError(p))return void t.replaceWith(p.render(a[c]))}var f=R({},e,{source:u,transitionDeferred:!1});e.section.renderInto("",null,f,l)}a[c]&&(e.data.clickEvent=function(e){c=(c+1)%a.length,p(e,!1)})&&(e.data.twoWayBindEvent=function(e,t,n){if(o.varRef.matches(t,n)){var r=o.varRef.get(),i=a.indexOf(r);i>-1&&i!==c&&(c=i,p(e,!0))}});var f="<tw-link>"+a[c]+"</tw-link>";if(o){var d=o.set(a[c]);if(s.containsError(d))return d}return R(e,{source:f,append:"replace",transitionDeferred:!0})},[N(g,String),_(String)])}),n.onStartup(function(){return e(n.storyElement).on("change.dropdown-macro","select",function(){var t=e(this),n=t.closest("tw-expression, tw-hook").data("dropdownEvent");n&&n(t)})}),t.addCommand("dropdown",function(e){var t;return""===(arguments.length<=1?void 0:arguments[1])||""===(t=(arguments.length<=1?0:arguments.length-1)-1+1,arguments.length<=t?void 0:arguments[t])?s.create("datatype","The first or last strings in a (dropdown:) can't be empty.","Because empty strings create separators within (dropdown:)s, having them at the start or end doesn't make sense."):(arguments.length<=1?0:arguments.length-1)<=1?s.create("datatype","I need two or more strings to create a (dropdown:) menu, not just "+(arguments.length<=1?0:arguments.length-1)+"."):void 0},function(t,r,a){for(var i=arguments.length,o=Array(i>3?i-3:0),c=3;c<i;c++)o[c-3]=arguments[c];var u=0;if("two way"===a.bind){t.attr.push({"data-2bind":!0});var l=o.indexOf(a.varRef.get());l>-1&&(u=l)}var p=Math.max.apply(Math,_toConsumableArray(o.map(function(e){return[].concat(_toConsumableArray(e)).length}))),f="<select>"+o.map(function(e,t){return"<option"+(t===u?" selected":"")+(""===e?" disabled":"")+">"+n.escape(e||"\u2500".repeat(p))+"</option>"}).join("\n")+"</select>";t.data.dropdownEvent=function(e){var t=e.val(),n=a.set(t);s.containsError(n)&&e.replaceWith(n.render(t))},t.data.twoWayBindEvent=function(e,t,n){if(a.varRef.matches(t,n)){var r=a.varRef.get(),i=o.indexOf(r);i>-1&&i!==u&&(e.find("select").val(r),u=i)}},t.styles.push({"background-color":function(){return n.parentColours(e(this)).backgroundColour}});var d=a.set(o[u]);return s.containsError(d)?d:R(t,{source:f,append:"replace"})},[g,String,_(String)]),n.onStartup(function(){return e(n.storyElement).on("input.checkbox-macro","input[type=checkbox]",function(){var t=e(this),n=t.closest("tw-expression").data("checkboxEvent");n&&n(t)})});var B=1;t.addCommand("checkbox",function(){},function(e,t,n,r){var a=!1,i="checkbox-"+ ++B;if("two way"===n.bind){e.attr.push({"data-2bind":!0});var o=n.varRef.get();"boolean"==typeof o&&(a=o),e.data.twoWayBindEvent=function(e,t,r){if(n.varRef.matches(t,r)){var a=n.varRef.get();"boolean"==typeof a&&e.children("input[type=checkbox]").prop("checked",a)}}}return e.data.checkboxEvent=function(e){var t=e.is(":checked"),r=n.set(t);s.containsError(r)&&e.replaceWith(r.render(""))},R(e,{source:'<input id="'+i+'" type="checkbox" '+(a?"checked":"")+'><label for="'+i+'">'+r+"</label>",append:"replace"})},[g,String]),n.onStartup(function(){return e(document).on("fullscreenchange",function(){e("input[type=checkbox][id^=fullscreen]",n.storyElement).each(function(t,n){(e(n).closest("tw-expression").data("fullscreenEvent")||Object)(n)})})}),t.addCommand("checkbox-fullscreen",function(){},function(t,n,r){var a="fullscreenCheckbox-"+ ++B;return t.data.fullscreenEvent=function(t){return e(t).prop("checked",!(!document.fullscreenElement&&!document.msFullscreenElement))},t.data.checkboxEvent=function(){return o.toggleFullscreen()},R(t,{source:'<input id="'+a+'" type="checkbox" '+(document.fullscreenEnabled||document.msFullscreenEnabled?" ":"disabled ")+(document.fullscreenElement||document.msFullscreenElement?"checked":"")+'><label for="'+a+'">'+r+"</label>",append:"replace"})},[String]),n.onStartup(function(){return e(n.storyElement).on("input.input-box-macro","textarea",function(){var t=e(this),n=t.closest("tw-expression").data("inputBoxEvent");n&&n(t)})}),["input-box","force-input-box"].forEach(function(e){return t.addCommand(e,function(){for(var t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];var a=g.isPrototypeOf(n[0]),i="number"==typeof n[1+a],o="string"==typeof n[1+a+i],c=n[+a];if("string"!=typeof c||-1===c.search(j)||!c.includes("=")&&c.length>1)return s.create("datatype","The ("+e+':) macro requires a sizing line("==X==", "==X", "=XXXX=" etc.) be provided, not '+JSON.stringify(c)+".");if("force-input-box"===e&&!o)return s.create("datatype","The ("+e+":) macro requires a string of text to forcibly input.");var u=1+a+i+o;return n.length>u?s.create("datatype","An incorrect combination of values was given to this ("+e+":) macro."):void 0},function(t,r){for(var a=arguments.length,i=Array(a>2?a-2:0),o=2;o<a;o++)i[o-2]=arguments[o];var c="force-input-box"===e,u=g.isPrototypeOf(i[0]),l="number"==typeof i[1+u],p=u&&i[0],f=l?i[1+u]:3,d=O(i[+u]),h=d.marginLeft,y=d.size,m="string"==typeof i[1+u+l]?i[1+u+l]:"",v=c?"":m;if("two way"===p.bind){t.attr.push({"data-2bind":!0});var b=p.varRef.get();if("string"==typeof b){v=c?m.slice(0,b.length):b;var w=p.set(v);if(s.containsError(w))return w}t.data.twoWayBindEvent=function(e,t,n){if(p.varRef.matches(t,n)){var r=p.varRef.get();"string"==typeof r&&e.find("textarea").val(c?m.slice(0,r.length):r)}}}else if(p){var T=p.set(c?"":m);if(s.containsError(T))return T}!c&&p&&(t.data.inputBoxEvent=function(e){var t=e.val(),n=p.set(t);s.containsError(n)&&e.replaceWith(n.render(""))});var S='<textarea style="width:100%" rows='+f+">"+n.escape(v)+"</textarea>";if(c){var x=Array.from(m);t.data.inputBoxEvent=function(e){var t=e.val().length,n=x.slice(0,t).join("");if(e.val(n),p){var r=p.set(n);s.containsError(r)&&e.replaceWith(r.render(""))}return!0}}return t.styles.push({display:"block","margin-left":h+"%",width:y+"%","border-style":function(){return this.style.borderStyle||"solid"}}),R(t,{source:S,append:"replace"})},[N(g,String),P(N(M,String)),P(N(M,String)),P(String)])}),["show","rerun"].forEach(function(n){return t.addCommand(n,z,function(t,r){for(var a=arguments.length,i=Array(a>2?a-2:0),o=2;o<a;o++)i[o-2]=arguments[o];return i.forEach(function(a){return a.forEach(r,function(a){var i=a.data("hidden");if(void 0!==i!=("rerun"===n))if(a.removeData("hidden"),i instanceof e)a.empty().append(i);else{var o=a.data("tempVariables");r.renderInto("",null,R({},t,{append:"replace",source:a.data("originalSource")||"",target:a}),o&&Object.create(o))}})}),t},[_(l)])});var W=function(e){return["I can't use a dialog macro in "+e+".","Please rewrite this without putting such macros here."]};t.addCommand("hide",z,function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];n.forEach(function(t){return t.forEach(e,function(e){Boolean(e.data("hidden"))||e.data("hidden",e.contents().detach())})})},[_(l)],!1)("stop",z,z,[],!1)("load-game",z,function(e,t){var n=localStorage.getItem($("Saved Game")+t);if(!n)return s.create("saving","I can't find a save slot named '"+t+"'!");var a=r.deserialise(e,n);if(a instanceof Error){var i=k({message:"Sorry to interrupt... The story tried to load saved data, but there was a problem.\n"+a.message+"\n\nThat data might have been saved from a different version of this story. Should I delete it?\n(Type 'delete' and choose Yes to delete it.)\n\nEither way, the story will now continue without loading the data.",defaultValue:"",buttons:[{name:"Yes",confirm:!0,callback:function(){"delete"===i.find("input").last().val()&&localStorage.removeItem($("Saved Game")+t),e.unblock("")}},{name:"No",cancel:!0,callback:function(){return e.unblock()}}]});return"blocked"}requestAnimationFrame(o.showPassage.bind(o,r.passage,!1))},[String],!1)("mock-visits",function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];if(!o.options.debug)return s.create("operation","(mock-visits:) cannot be used outside of debug mode.","This macro is not meant to be used outside of debugging your story.");var r=t.find(function(e){return!a.hasValid(e)});return r?s.create("datatype","I can't mock-visit '"+r+"' because no passage with that name exists."):void 0},function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),a=1;a<t;a++)n[a-1]=arguments[a];r.mockVisits=S(n)},[_(String)],!1)(["dialog","alert"],function(e,t){for(var r=arguments.length,a=Array(r>2?r-2:0),i=2;i<r;i++)a[i-2]=arguments[i];if(g.isPrototypeOf(e)){if("two way"===e.bind)return s.create("datatype","(dialog:) shouldn't be given two-way bound variables.");if(void 0===t)return s.create("datatype","(dialog:) needs a message string to display.")}else void 0!==t&&a.unshift(t);var o=a.findIndex(function(e){return""===e});if(o>-1)return s.create("datatype","(dialog:)'s "+n.nth(o+1)+" link text shouldn't be an empty string.")},function(e,t,n,r){for(var a=arguments.length,i=Array(a>4?a-4:0),o=4;o<a;o++)i[o-4]=arguments[o];return g.isPrototypeOf(n)||(void 0!==r&&i.unshift(r),r=n,n=void 0),i.length||(i=["OK"]),k({section:t,message:r,cd:e,buttons:i.map(function(e){return{name:e,callback:function(){t.unblock(n&&n.set(e)||"")}}})}),"blocked"},[N(g,String),I(String)])("open-url",z,function(e,t){window.open(t,"")},[String],!1)(["restart","reload"],z,function(){if(r.pastLength<1)return s.create("infinite","I mustn't (restart:) the story in the starting passage.");r.hasSessionStorage&&sessionStorage.removeItem("Saved Session"),window.location.reload()},[],!1)("goto-url",z,function(e,t){window.location.assign(t)},[String],!1)("ignore",z,z,[I(E)])("assert-exists",function(e){if(""===e)return s.create("datatype","(assert-exists:) mustn't be given an empty string.")},function(e,t,n){var r=0;return("string"==typeof n?l.create({type:"string",data:n}):n).forEach(t,function(){++r}),r?e:s.create("assertion","I didn't see any "+("string"==typeof n?"text occurrences of":"hooks matching")+" "+x(n)+" in this passage.")},[N(l,String)]),t.add("assert",function(e,t){return t?{TwineScript_TypeID:"instant",TwineScript_TypeName:"an (assert:) operation",TwineScript_ObjectName:"an (assert:) operation",TwineScript_Unstorable:!0,TwineScript_Print:function(){return""}}:R(s.create("assertion","An assertion failed: "),{appendTitleText:!0})},[Boolean])("save-game",function(e,t,n){if(n=n||"",!r.hasStorage)return!1;var a=r.serialise();if(s.containsError(a))return a;if(!1===a)return!1;try{return localStorage.setItem($("Saved Game")+t,a),localStorage.setItem($("Saved Game Filename")+t,n),!0}catch(e){return!1}},[String,P(String)])("prompt",function(e,t,n,r,a){if(e.stackTop&&e.stackTop.evaluateOnly)return s.create.apply(s,["macrocall"].concat(_toConsumableArray(W(e.stackTop.evaluateOnly))));if(""===a)return s.create("datatype","The text for (prompt:)'s confirm link can't be blank.");var i=k({section:e,message:t,defaultValue:n,buttons:[{name:a||"OK",confirm:!0,callback:function(){return e.unblock(i.find("input").last().val())}}].concat(""===r?[]:{name:r||"Cancel",cancel:!0,callback:function(){return e.unblock(n)}})});setTimeout(function(){return i.find("input").last().focus()},100)},[String,String,P(String),P(String)])("confirm",function(e,t,n,r){return e.stackTop&&e.stackTop.evaluateOnly?s.create.apply(s,["macrocall"].concat(_toConsumableArray(W(e.stackTop.evaluateOnly)))):""===r?s.create("datatype","The text for (confirm:)'s confirm link can't be blank."):void k({section:e,message:t,defaultValue:!1,buttons:[{name:r||"OK",confirm:!0,callback:function(){return e.unblock(!0)}}].concat(""===n?[]:{name:n||"Cancel",cancel:!0,callback:function(){return e.unblock(!1)}})})},[String,P(String),P(String)])("page-url",function(){return window.location.href},[]),i.options.blockerMacros.push("prompt","confirm")}),define("macrolib/datastructures",["jquery","utils","utils/naturalsort","macros","utils/operationutils","state","engine","passages","datatypes/lambda","datatypes/datatype","datatypes/typedvar","internaltypes/varref","internaltypes/twineerror"],function(e,t,n,r,a,i,o,s,c,u,l,p,f){var d=t.shuffled,h=t.permutations,y=a.objectName,m=a.subset,g=a.collectionType,v=a.isValidDatamapName,b=a.is,w=a.unique,T=a.clone,S=a.range,x=r.TypeSignature,k=x.optional,O=x.rest,j=x.either,A=x.zeroOrMore,C=x.Any,E=x.nonNegativeInteger;r.add(["a","array"],function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return n},A(j(l,C)))("range",function(e,t,n){return S(t,n)},[parseInt,parseInt])("subarray",function(e,t,n,r){return m(t,n,r)},[Array,parseInt,parseInt])("reversed",function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return n.reverse().map(T)},A(C))("shuffled",function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return d.apply(void 0,n).map(T)},[C,O(C)])("sorted",function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];return r.sort(n("en"))},[j(Number,String),O(j(Number,String))])("rotated",function(e,t){for(var n=arguments.length,r=Array(n>2?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];return 0===(t*=-1)?f.create("macrocall","I can't rotate these values by 0 positions."):Math.abs(t)>=r.length?f.create("macrocall","I can't rotate these "+r.length+" values by "+t+" positions."):r.slice(t).concat(r.slice(0,t)).map(T)},[parseInt,C,O(C)])("rotated-to",function(e,t){for(var n=arguments.length,r=Array(n>2?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];var i=t.filter(e,r);if(f.containsError(i))return i;if(!i.length)return f.create("macrocall","None of these "+r.length+" values matched the lambda, so I can't rotate them.");var o=r.indexOf(i[0]);return r.slice(o).concat(r.slice(0,o)).map(T)},[c.TypeSignature("where"),C,O(C)])("repeated",function(e,t){for(var n=arguments.length,r=Array(n>2?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];for(var i=[];t-- >0;)i.push.apply(i,r);return i.map(T)},[E,O(C)])("interlaced",function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];for(var a=Math.min.apply(Math,_toConsumableArray(n.map(function(e){return e.length}))),i=[],o=0;o<a;o+=1)for(var s=0;s<n.length;s+=1)i.push(T(n[s][o]));return i},[Array,O(Array)])("permutations",function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return n.length?h.apply(void 0,n):[]},[A(C)]),r.add("altered",function(e,t){for(var n=arguments.length,r=Array(n>2?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];return r.map(function(n,r){return t.apply(e,{loop:n,pos:r+1})})},[c.TypeSignature("via"),A(C)])("find",function(e,t){for(var n=arguments.length,r=Array(n>2?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];return t.filter(e,r)},[c.TypeSignature("where"),A(C)])(["all-pass","pass"],function(e,t){for(var n=arguments.length,r=Array(n>2?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];var i=t.filter(e,r);return f.containsError(i)||i.length===r.length},[c.TypeSignature("where"),A(C)])("some-pass",function(e,t){for(var n=arguments.length,r=Array(n>2?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];var i=t.filter(e,r);return f.containsError(i)||i.length>0},[c.TypeSignature("where"),A(C)])("none-pass",function(e,t){for(var n=arguments.length,r=Array(n>2?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];var i=t.filter(e,r);return f.containsError(i)||0===i.length},[c.TypeSignature("where"),A(C)])("folded",function(e,t){for(var n=arguments.length,r=Array(n>2?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];return"where"in t&&(r=t.filter(e,r)),f.containsError(r)||r.reduce(function(n,r,a){return t.apply(e,{making:n,loop:r,pos:a+1})})},[j(c.TypeSignature("where","via","making"),c.TypeSignature("via","making")),O(C)]),r.add("datanames",function(e,t){return Array.from(t.keys()).sort(n("en"))},[Map])("datavalues",function(e,t){return Array.from(t.entries()).sort(n("en",function(e){return String(e[0])})).map(function(e){return T(e[1])})},[Map])("dataentries",function(e,t){return Array.from(t.entries()).sort(function(e,t){return[e[0],t[0]].sort(n("en"))[0]===e[0]?-1:1}).map(function(e){return new Map([["name",e[0]],["value",T(e[1])]])})},[Map])("history",function(e,t){var n=i.mockVisits.concat(i.pastPassageNames());if(!t)return n;var r=t.filter(e,n.map(function(e){return s.get(e)}));return f.containsError(r)?r:r.map(function(e){return e.get("name")})},[k(c.TypeSignature("where"))])("passage",function(e,t){return T(s.get(t||i.passage))||f.create("macrocall","There's no passage named '"+t+"' in this story.")},[k(String)])("passages",function(e,t){var r=n("en"),a=[].concat(_toConsumableArray(s.values())).map(function(e){return T(e)}),i=t?t.filter(e,a):a,o=f.containsError(i);return o||i.sort(function(e,t){return r(e.get("name"),t.get("name"))})},[k(c.TypeSignature("where"))])("open-storylets",function(e,t){if(e.stackTop.evaluateOnly)return f.create("macrocall","(open-storylets:) can't be used in "+e.stackTop.evaluateOnly+".");var n=s.getStorylets(e,t),r=f.containsError(n);return r||n.map(T)},[k(c.TypeSignature("where"))])("savedgames",function(){function e(e){return"("+e+" "+o.options.ifid+") "}var t=0,n=void 0,r=new Map;do{if(!i.hasStorage)break;n=localStorage.key(t),t+=1;var a=e("Saved Game");n&&n.startsWith(a)&&(n=n.slice(a.length),r.set(n,localStorage.getItem(e("Saved Game Filename")+n)))}while(n);return r},[])(["datamap","dm"],function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var a=void 0,i=new Map,o=n.reduce(function(e,t){var n=void 0;if(f.containsError(e))return e;if(void 0===a)a=t;else{if(n=f.containsError(v(i,a)))return n;if(i.has(a))return f.create("macrocall","You used the same data name ("+y(a)+") twice in the same (datamap:) call.");i.set(a,T(t)),a=void 0}return e},!0);return f.containsError(o)?o:void 0!==a?f.create("macrocall","This datamap has a data name without a value."):i},A(j(l,C)))(["dataset","ds"],function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return new Set(n.filter(w).map(T))},A(C))("count",function e(t,n){for(var r=arguments.length,a=Array(r>2?r-2:0),i=2;i<r;i++)a[i-2]=arguments[i];if(a.length>1){var o,s=a.map(function(r){return e(t,n,r)});return(o=f.containsError(s))?o:s.reduce(function(e,t){return e+t},0)}var c=a[0];switch(g(n)){case"dataset":case"datamap":return f.create("macrocall","(count:) shouldn't be given a datamap or dataset.","You should use the 'contains' operator instead. For instance, write: $variable contains 'value'.");case"string":return"string"!=typeof c?f.create("macrocall",y(n)+" can't contain  "+y(c)+" because it isn't also a string."):c?n.split(c).length-1:0;case"array":return n.reduce(function(e,t){return e+b(t,c)},0);default:return f.create("macrocall",y(n)+" can't contain values, let alone "+y(c)+".")}},[C,O(C)])}),define("macrolib/stylechangers",["jquery","macros","utils","utils/renderutils","datatypes/colour","datatypes/hookset","datatypes/gradient","datatypes/changercommand","datatypes/lambda","internaltypes/changedescriptor","internaltypes/twineerror"],function(e,t,n,r,a,i,o,s,c,u,l){var p=r.geomParse,f=r.geomStringRegExp,d=Object.assign,h=t.TypeSignature,y=h.either,m=h.wrapped,g=h.optional,v=h.Any,b=h.Everything,w=h.zeroOrMore,T=h.rest,S=h.insensitiveSet,x=h.positiveNumber,k=h.positiveInteger,O=h.nonNegativeNumber,j=h.percent,A=[m(Boolean,'If you gave a number, you may instead want to check that the number is not 0. If you gave a string, you may instead want to check that the string is not "".')];n.onStartup(function(){return e(n.storyElement).on("mouseenter.hover-macro","[hover=false]",function(){var t=e(this),n=t.data("hoverChanger");t.data({mouseoutStyle:t.attr("style")||""}),u.create({target:t},n).update(),t.attr("hover",!0)}).on("mouseleave.hover-macro","[hover=true]",function(){var t=e(this),n=t.data("mouseoutStyle");t.attr("style",n).removeData("mouseoutStyle").attr("hover",!1)})});var C,E,_=S("instant","dissolve","fade","rumble","shudder","pulse","zoom","flicker","slideleft","slideright","slideup","slidedown","fadeleft","faderight","fadeup","fadedown","blur"),N=S("dotted","dashed","solid","double","groove","ridge","inset","outset","none");t.addChanger("if",function(e,t){return s.create("if",[t])},function(e,t){return e.enabled=e.enabled&&t},A)("unless",function(e,t){return s.create("unless",[t])},function(e,t){return e.enabled=e.enabled&&!t},A)("elseif",function(e,t){return"lastHookShown"in e.stack[0]?s.create("elseif",[!1===e.stack[0].lastHookShown&&!!t]):l.create("macrocall","There's no (if:) or something else before this to do (else-if:) with.")},function(e,t){return e.enabled=e.enabled&&t},A)("else",function(e){return"lastHookShown"in e.stack[0]?s.create("else",[!1===e.stack[0].lastHookShown]):l.create("macrocall","There's nothing before this to do (else:) with.")},function(e,t){return e.enabled=e.enabled&&t},null)("hidden",function(){return s.create("hidden")},function(e){return e.enabled=!1},null)(["verbatim","v6m"],function(){return s.create("verbatim")},function(e){return e.verbatim=!0},null)("live",function(e,t){return s.create("live",[t])},function(e,t){e.enabled=!1,e.data.live={delay:t}},g(Number))("event",function(e,t){return s.create("event",[t])},function(e,t){e.enabled=!1,e.data.live={event:t}},c.TypeSignature("when"))("more",function(){return s.create("more")},function(e){e.enabled=!1,e.data.live={event:{when:!0,filter:function(e){return 0!==e.eval("Operations").Identifiers.exits?[]:[!0]}}}},null)("after",function(e,t,n){return s.create("after",[t].concat(void 0!==n?[n]:[]))},function(e,t,r){e.enabled=!1,e.data.live={event:{when:!0,filter:function(e){return n.anyInputDown()&&(t-=r),e.eval("Operations").Identifiers.time>t?[!0]:[]}}}},[x,g(O)])("hook",function(e,t){return t?s.create("hook",[t]):l.create("datatype","(hook:) names can't be empty strings.")},function(e,t){return e.attr.push({name:t})},[String])(["for","loop"],function(e,t){for(var n=arguments.length,r=Array(n>2?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];return t.loop?s.create("for",[t].concat(r)):l.create("datatype","The lambda provided to (for:) must refer to a temp variable, not just 'it'.")},function(e,t){for(var n=arguments.length,r=Array(n>2?n-2:0),a=2;a<n;a++)r[a-2]=arguments[a];var i,o=t.filter(e.section,r);if(i=l.containsError(o))return i;e.loopVars[t.loop.getName()]=o||[]},[c.TypeSignature("where"),w(v)])(["transition","t8n"],function(e,t){return s.create("transition",[n.insensitiveName(t)])},function(t,r){return t.transition=r,"zoom"===r&&(t.transitionOrigin=function(){var t=e(this).offset(),r=t.left,a=t.top;return n.mouseCoords.x-r+"px "+(n.mouseCoords.y-a)+"px"}),t},[_])(["transition-time","t8n-time"],function(e,t){return s.create("transition-time",[t])},function(e,t){return e.transitionTime=t,e.data.passageT8n=d(e.data.passageT8n||{},{time:t}),e},[x])(["transition-delay","t8n-delay"],function(e,t){return s.create("transition-delay",[t])},function(e,t){return e.transitionDelay=t,e},[O])(["transition-skip","t8n-skip"],function(e,t){return s.create("transition-skip",[t])},function(e,t){return e.transitionSkip=t,e},[x])(["transition-depart","t8n-depart"],function(e,t){return s.create("transition-depart",[n.insensitiveName(t)])},function(t,r){return t.data.passageT8n=d(t.data.passageT8n||{},{depart:r}),"zoom"===r&&(t.data.passageT8n.departOrigin=function(){var t=e(this).offset(),r=t.left,a=t.top;return n.mouseCoords.x-r+"px "+(n.mouseCoords.y-a)+"px"}),t},[_])(["transition-arrive","t8n-arrive"],function(e,t){return s.create("transition-arrive",[n.insensitiveName(t)])},function(t,r){return t.data.passageT8n=d(t.data.passageT8n||{},{arrive:r}),"zoom"===r&&(t.data.passageT8n.arriveOrigin=function(){var t=e(this),r=t.offset(),a=r.left,i=r.top,o=t.height();return{"transform-origin":100*(n.mouseCoords.x-a)/t.width()+"% "+100*(n.mouseCoords.y-i)/o+"%",height:o+"px"}}),t},[_])("button",function(){return s.create("button",[])},function(e){return e.attr.push({class:function(){return this.className+(this.classList.contains("enchantment-button")?"":" ".repeat(this.className.length>0)+"enchantment-button")}}),e},[])(["border","b4r"],function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];return s.create("border",r.map(n.insensitiveName))},function(t){for(var n=arguments.length,r=Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];return t.styles.push({display:function(){var t=e(this).css("display");return r.every(function(e){return"none"===e})||!t.includes("inline")?t:"inline-block"},"border-style":r.join(" "),"border-width":function(){return this.style.borderWidth||"2px"}}),t},[N].concat(_toConsumableArray(Array(3).fill(g(N)))))(["border-size","b4r-size"],function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return s.create("border-size",n)},function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return e.styles.push({"border-width":n.map(function(e){return e+"px"}).join(" ")}),e},[O].concat(_toConsumableArray(Array(3).fill(g(O)))))("corner-radius",function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return s.create("corner-radius",n)},function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return e.styles.push({"border-radius":n.map(function(e){return e+"px"}).join(" "),padding:function(){return this.style.padding||n.map(function(e){return e+"px"}).join(" ")}}),e},[O].concat(_toConsumableArray(Array(3).fill(g(O)))))(["border-colour","b4r-colour","border-color","b4r-color"],function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return s.create("border-colour",n.map(function(e){return a.isPrototypeOf(e)?e.toRGBAString(e):e}))},function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return e.styles.push({"border-color":n.join(" ")}),e},[y(String,a)].concat(_toConsumableArray(Array(3).fill(g(y(String,a))))))("opacity",function(e,t){return s.create("opacity",[t])},function(e,t){return e.styles.push({opacity:t})},[j])("font",function(e,t){return s.create("font",[t])},function(e,t){return e.styles.push({"font-family":t}),e},[String])("align",function(e,t){var n=void 0,r=t.indexOf("><");if(!/^(==+>|<=+|=+><=+|<==+>)$/.test(t))return l.create("datatype",'The (align:) macro requires an alignment arrow ("==>", "<==", "==><=" etc.) be provided, not "'+t+'"');if(~r){var a=Math.round(r/(t.length-2)*50);n=d({"text-align":"center","max-width":"50%"},25===a?{"margin-left":"auto","margin-right":"auto"}:{"margin-left":a+"%"})}else n="<"===t[0]&&">"===t.slice(-1)?{"text-align":"justify","max-width":"50%"}:t.includes(">")?{"text-align":"right"}:{"text-align":"left"};return n.display="inline-block",s.create("align",[n])},function(e,t){e.styles.push(t)},[String])(["text-colour","text-color","color","colour"],function(e,t){return s.create("text-colour",[t])},function(e,t){return a.isPrototypeOf(t)&&(t=t.toRGBAString(t)),e.styles.push({color:t}),e},[y(String,a)])(["text-size","size"],function(e,t){return s.create("text-size",[t])},function(e,t){return e.styles.push({"font-size":24*t+"px","line-height":36*t+"px"}),e},[O])("text-indent",function(e,t){return s.create("text-indent",[t])},function(e,t){return e.styles.push({"text-indent":t+"px",display:"inline-block"}),e},[O])(["text-rotate-z","text-rotate"],function(e,t){return s.create("text-rotate-z",[t])},function(t,n){return t.styles.push({display:"inline-block",transform:function(){var t=e(this).css("transform")||"";return"none"===t&&(t=""),t+" rotate("+n+"deg)"}}),t},[Number])("text-rotate-y",function(e,t){return s.create("text-rotate-y",[t])},function(t,n){return t.styles.push({display:"inline-block",transform:function(){var t=e(this).css("transform")||"";return"none"===t&&(t=""),t+" perspective(50vw) rotateY("+n+"deg)"}}),t},[Number])("text-rotate-x",function(e,t){return s.create("text-rotate-x",[t])},function(t,n){return t.styles.push({display:"inline-block",transform:function(){var t=e(this).css("transform")||"";return"none"===t&&(t=""),t+" perspective(50vw) rotateX("+n+"deg)"}}),t},[Number])(["background","bg"],function(e,t){return s.create("background",[t])},function(t,r){var i=void 0;return a.isPrototypeOf(r)?r=r.toRGBAString(r):o.isPrototypeOf(r)&&(r=r.toLinearGradientString(r)),i=a.isHexString(r)||a.isCSS3Function(r)?{"background-color":r}:r.startsWith("linear-gradient(")||r.startsWith("repeating-linear-gradient(")?{"background-image":r}:{"background-size":"cover","background-image":"url("+r+")"},t.styles.push(i,{display:function(){var t=e(this);return!t.children().length||n.childrenProbablyInline(t)?e(this).css("display"):"block"}}),t},[y(String,a,o)]).apply(void 0,_toConsumableArray((C={color:function(){return"transparent"}},E=d(Object.create(null),{none:{},bold:{"font-weight":"bold"},italic:{"font-style":"italic"},underline:{"text-decoration":"underline"},doubleunderline:{"text-decoration":"underline","text-decoration-style":"double"},wavyunderline:{"text-decoration":"underline","text-decoration-style":"wavy"},strike:{"text-decoration":"line-through"},doublestrike:{"text-decoration":"line-through","text-decoration-style":"double"},wavystrike:{"text-decoration":"line-through","text-decoration-style":"wavy"},superscript:{"vertical-align":"super","font-size":".83em"},subscript:{"vertical-align":"sub","font-size":".83em"},blink:{animation:"fade-in-out 1s steps(1,end) infinite alternate"},shudder:{animation:"shudder linear 0.1s 0s infinite"},mark:{"background-color":"hsla(60, 100%, 50%, 0.6)"},condense:{"letter-spacing":"-0.08em"},expand:{"letter-spacing":"0.1em"},outline:[{"text-shadow":function(){var t=e(this).css("color");return"-1px -1px 0 "+t+", 1px -1px 0 "+t+",-1px  1px 0 "+t+", 1px  1px 0 "+t}},{color:function(){return n.parentColours(e(this)).backgroundColour}}],shadow:{"text-shadow":function(){return"0.08em 0.08em 0.08em "+e(this).css("color")}},emboss:{"text-shadow":function(){return"0.04em 0.04em 0em "+e(this).css("color")}},smear:[{"text-shadow":function(){var t=e(this).css("color");return"0em   0em 0.02em "+t+",-0.2em 0em  0.5em "+t+", 0.2em 0em  0.5em "+t}},C],blur:[{"text-shadow":function(){return"0em 0em 0.08em "+e(this).css("color")}},C],blurrier:[{"text-shadow":function(){return"0em 0em 0.2em "+e(this).css("color")},"user-select":"none"},C],mirror:{display:"inline-block",transform:"scaleX(-1)"},upsidedown:{display:"inline-block",transform:"scaleY(-1)"},fadeinout:{animation:"fade-in-out 2s ease-in-out infinite alternate"},rumble:{animation:"rumble linear 0.1s 0s infinite"},sway:{animation:"sway linear 2.5s 0s infinite"},buoy:{animation:"buoy linear 2.5s 0s infinite"},fidget:{animation:function(){return"fidget step-end 60s "+60*-Math.random()+"s infinite"+(Math.random()<.5?" reverse":"")}}}),["text-style",function(e){for(var t=arguments.length,r=Array(t>1?t-1:0),a=1;a<t;a++)r[a-1]=arguments[a];return s.create("text-style",r.map(n.insensitiveName))},function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];for(var a=0;a<n.length;a+=1)"none"===n[a]?e.styles=[]:e.styles=e.styles.concat(E[n[a]]);return e},[T(S.apply(void 0,_toConsumableArray(Object.keys(E))))]])))("collapse",function(){return s.create("collapse")},function(e){return e.attr.push({collapsing:!0}),e},[])("hover-style",function(e,t){var n=u.create(),r=(t.run(n),n.summary());return r+""=="styles"||r.every(function(e){return"styles"===e||"attr"===e})&&n.attr.every(function(e){return Object.keys(e)+""=="style"})?s.create("hover-style",[t]):l.create("datatype","The changer given to (hover-style:) must only change the hook's style.")},function(e,t){return e.data.hoverChanger=t,e.attr.push({hover:function(e,t){return void 0!==t&&t}}),e},[s])("css",function(e,t){return t.trim().endsWith(";")||(t+=";"),s.create("css",[t])},function(t,n){return t.attr.push({style:function(){return(e(this).attr("style")||"")+n}}),t},[String])("test-true",function(){return s.create("test-true",[])},function(e){return e.enabled=!0},w(b))("test-false",function(){return s.create("test-false",[])},function(e){return e.enabled=!1},w(b)),t.addCommand("animate",e.noop,function(e,t,r,a,i){r.forEach(t,function(t){var r=void 0;if("zoom"===name){var o=t.offset(),s=o.left,c=o.top;r=n.mouseCoords.x-s+"px "+(n.mouseCoords.y-c)+"px"}n.transitionIn(t,a,e.transitionTime||i,e.transitionDelay,e.transitionSkip,0,r)})},[T(i),S.apply(void 0,_toConsumableArray(_.innerType.filter(function(e){return"instant"!==e}))),g(x)]),["box","float-box"].forEach(function(r){return t.addChanger(r,function(e,t,n){var a=-1===t.search(f)||t.length>1&&!t.includes("="),i="float-box"===r&&(-1===n.search(f)||n.length>1&&!n.includes("="));return a||i?l.create("datatype","The ("+r+':) macro requires a sizing line("==X==", "==X", "=XXXX=" etc.) be provided, not "'+(a?t:n)+'".'):s.create(r,[t,n].filter(function(e){return void 0!==e}))},function(t,a,i){var o,s=p(a),c=s.marginLeft,u=s.size,l=void 0;if("float-box"===r){var f=p(i);l=f.marginLeft,i=f.size}var h="box"===r?"%":"vw",y=(_defineProperty(o={display:"block",width:u+h,"max-width":u+h},"box"===r?"margin-left":"left",c+h),_defineProperty(o,"box-sizing","content-box"),_defineProperty(o,"overflow-y","auto"),_defineProperty(o,"padding",function(){return e(this).css("padding")||"1em"}),o);return void 0!==i&&(y.height=i+("box"===r?"em":"vh")),"float-box"===r&&d(y,{position:"fixed",top:l+"vh","background-color":function(){return n.parentColours(e(this)).backgroundColour}}),t.styles.push(y),t},[String,"box"===r?g(k):String])})}),define("internaltypes/enchantment",["jquery","utils","internaltypes/changedescriptor","datatypes/changercommand","utils/operationutils","internaltypes/twineerror","utils/renderutils"],function(e,t,n,r,a,i,o){var s=a.objectName,c=o.collapse,u={create:function(n){return t.assertOnlyHas(n,["scope","localHook","section","attr","data","changer","functions","lambda","name"]),Object.assign(Object.create(this),{enchantments:e()},n)},enchantScope:function(){var a=this,o=this.attr,u=this.data,l=this.functions,p=this.section,f=this.scope,d=this.localHook,h=this.lambda,y=[];f.forEach(p,function(m,g){if(!d||(d.jquery?d:d.hooks(p)).has(m[0]).length){var v=void 0;if(h)if(v=h.apply(p,{loop:f.TwineScript_GetProperty(g),pos:g+1}),i.containsError(v))m.replaceWith(v.render("")),h=v=null;else if(r.isPrototypeOf(v)){var b=v.summary();(b.includes("newTargets")||b.includes("target"))&&(m.replaceWith(i.create("macrocall","The changer produced by the 'via' lambda given to enchantment macros can't include a revision or enchantment changer like (replace:) or (click:).").render("")),h=v=null)}else m.replaceWith(i.create("macrocall","The 'via' lambda given to enchantment macros must return a changer, not "+s(v)+".").render("")),h=v=null;else v=a.changer;var w=!o&&!u&&(!v||v.summary().every(function(e){return e.startsWith("transition")})),T=w?m:m.wrap("<tw-enchantment>").parent();if(o&&T.attr(o),u&&T.data(u),l&&l.forEach(function(e){return e(T)}),v){var S=n.create({section:p,target:T});if(v.run(S),S.update(),m.is(t.storyElement)){var x=Object.keys(Object.assign.apply(Object,[{}].concat(_toConsumableArray(S.styles))));m.css(x.reduce(function(e,t){return e[t]="inherit",e},{})),T.data({enchantedProperties:x})}else if(m.is("tw-passage")&&S.styles.some(function(e){return"margin-left"in e||"margin"in e||"margin-right"in e})){var k="padding-left",O="padding-right";t.storyElement.css(k,"0px").css(O,"0px"),T.data({enchantedProperties:[k,O]})}}m.is(t.storyElement)&&T.css({width:"100%",height:"100%"}),"true"===T.attr("collapsing")&&(T.find("[collapsing=false]").each(function(){e(this).removeAttr("collapsing")}),c(T)),w||y.push(T)}}),this.enchantments=e(y)},disenchant:function(){this.enchantments.each(function(){e(this).contents().unwrap();var n=e(this).data("enchantedProperties");n&&t.storyElement.css(n.reduce(function(e,t){return e[t]="",e},{}))})}};return Object.freeze(u)}),define("macrolib/enchantments",["jquery","utils","utils/operationutils","engine","state","passages","macros","datatypes/hookset","datatypes/changercommand","datatypes/lambda","internaltypes/changedescriptor","internaltypes/enchantment","internaltypes/twineerror"],function(e,t,n,r,a,i,o,s,c,u,l,p,f){var d=n.is,h=o.TypeSignature,y=h.either,m=h.rest,g=h.optional;function v(e,t){if(c.isPrototypeOf(t)){var n=t.summary();if(["newTargets","target","appendSource","functions"].some(function(e){return n.includes(e)}))return f.create("datatype","The changer given to ("+e+":) can't include a revision or enchantment changer like (replace:) or (click:).")}}["enchant","change"].forEach(function(e){o.addCommand(e,function(t,n){var r=v(e,n);if(r)return r},function(t,n,r){var a;n=s.from(n);var i=[];if(c.isPrototypeOf(r)){var o=l.create({section:t});if(r.run(o),(o.innerEnchantments||[]).length>0){var u=o.innerEnchantments.map(function(e){return e(n)});i.push.apply(i,_toConsumableArray(u))}}return i.push(p.create((_defineProperty(a={scope:n},c.isPrototypeOf(r)?"changer":"lambda",r),_defineProperty(a,"section",t),a))),i.forEach(function(n){"enchant"===e?(t.addEnchantment(n),t.updateEnchantments()):n.enchantScope()}),""},[y(s,String),y(c,u.TypeSignature("via"))],!1)}),o.addChanger("enchant-in",function(e,t,n){var r=v("enchant-in",n);return r||c.create("enchant-in",[t,n])},function(e,t,n){return e.innerEnchantments=(e.innerEnchantments||[]).concat(function(r){var a;return p.create((_defineProperty(a={scope:s.from(t),localHook:r},c.isPrototypeOf(n)?"changer":"lambda",n),_defineProperty(a,"section",e.section),a))}),e},[y(s,String),y(c,u.TypeSignature("via"))]),[["link-style",s.create({type:"name",data:"link"})],["line-style",s.create({type:"base",data:s.create({type:"name",data:"page"})},"lines",void 0)],["char-style",s.create({type:"base",data:s.create({type:"name",data:"page"})},"chars",void 0)]].forEach(function(e){var t=_slicedToArray(e,2),n=t[0],r=t[1];o.addChanger(n,function(e,t){var r=v(n,t);return r||c.create(n,[t])},function(e,t){return e.innerEnchantments=(e.innerEnchantments||[]).concat(function(n){var a;return p.create((_defineProperty(a={scope:r,localHook:n},c.isPrototypeOf(t)?"changer":"lambda",t),_defineProperty(a,"section",e.section),a))}),e},[y(c,u.TypeSignature("via"))])});var b=["replace","append","prepend"];function w(n,a){return t.onStartup(function(){var r=n.classList.replace(/ /g,"."),a=n.blockClassList?n.blockClassList.replace(/ /g,"."):"",i="."+r+(a?",."+a:"");t.storyElement.on(n.event.map(function(e){return e+".enchantment"}).join(" "),i,function(){var t=e(Array.from(e(this).parents(i).add(this)).sort(function(e,t){return 8&e.compareDocumentPosition(t)?1:-1})[0]),n=t.data("enchantmentEvent");n&&n(t)})}),[function(e,t,n){if(!t)return f.create("datatype","A string given to this ("+a+":) macro was empty.");if(n){var r=v(a,n);if(r)return r}return c.create(a,[s.from(t)].concat(n?[n]:[]))},function(e,t,i){e.enabled=!1,e.transitionDeferred=!0,n.rerender&&(e.newTargets=(e.newTargets||[]).concat({target:t,append:n.rerender}));var o=e.section&&e.section.stackTop?e.section.stackTop.tempVariables:Object.create(null),s=p.create(_defineProperty({functions:[function(e){e.attr("class",e.children().is("tw-story, tw-sidebar, tw-passage")||"block"===e.children().css("display")?n.blockClassList:n.classList)}],attr:(n.classList+"").match(/\b(?:link|enchantment-clickblock)\b/)?{tabIndex:"0"}:{},data:{enchantmentEvent:function(){e.section.stackTop&&e.section.stackTop.blocked||(n.once&&e.section.removeEnchantment(s),n.goto?r.goToPassage(n.goto,{transition:n.transition}):n.undo?r.goBack({transition:n.transition}):e.section.renderInto(e.source,null,Object.assign({},e,{enabled:!0,transitionDeferred:!1}),o))}},scope:t,section:e.section,name:a},c.isPrototypeOf(i)?"changer":"lambda",i));return e.section&&(e.section.addEnchantment(s),s.enchantScope()),e},[y(s,String),g(y(c,u.TypeSignature("via")))]]}b.forEach(function(t){o.addChanger(t,function(e){for(var n=arguments.length,r=Array(n>1?n-1:0),a=1;a<n;a++)r[a-1]=arguments[a];return r.every(Boolean)?c.create(t,r.map(s.from)):f.create("datatype","A string given to this ("+t+":) macro was empty.")},function(n){for(var r,a=arguments.length,i=Array(a>1?a-1:0),o=1;o<a;o++)i[o-1]=arguments[o];return e(n.target).parents().filter("tw-collapsed,[collapsing=true]").length>0||n.attr.some(function(e){return e.collapsing})||(n.attr=[].concat(_toConsumableArray(n.attr),[{collapsing:!1}])),n.newTargets=n.newTargets||[],(r=n.newTargets).push.apply(r,_toConsumableArray(i.filter(function(e){return!n.newTargets.some(function(n){var r=n.target,a=n.append;return d(e,r)&&t===a})}).map(function(e){return{target:e,append:t,before:!0}}))),n},m(y(s,String)))(t+"-with",function(e,n){return c.create(t+"-with",[n])},function(e,n){return e.appendSource=(e.appendSource||[]).concat({source:n,append:t}),e},String)});var T="ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0,S=[{name:"click",enchantDesc:{event:["click"],once:!0,rerender:"",classList:"link enchantment-link",blockClassList:"enchantment-clickblock"}},{name:"mouseover",enchantDesc:{event:["mouseenter",T?"click":""].filter(Boolean),once:!0,rerender:"",classList:"enchantment-mouseover",blockClassList:"enchantment-mouseoverblock"}},{name:"mouseout",enchantDesc:{event:["mouseleave",T?"click":""].filter(Boolean),once:!0,rerender:"",classList:"enchantment-mouseout",blockClassList:"enchantment-mouseoutblock"}}];S.forEach(function(e){return o.addChanger.apply(o,[e.name].concat(_toConsumableArray(w(e.enchantDesc,e.name))))}),t.onStartup(function(){S.forEach(function(n){var r=n.enchantDesc;r.blockClassList&&t.storyElement.on(r.event.map(function(e){return e+".enchantment"}).join(" "),function(){var t=e(Array.from(e(this).parents("."+r.blockClassList.replace(/ /g,"."))).sort(function(e,t){return 8&e.compareDocumentPosition(t)?1:-1})[0]),n=t.data("enchantmentEvent");n&&n(t)})})}),b.forEach(function(e){S.forEach(function(t){var n=Object.assign({},t.enchantDesc,{rerender:e}),r=t.name+"-"+e;o.addChanger.apply(o,[r].concat(_toConsumableArray(w(n,r))))})}),S.forEach(function(e){["goto","undo"].forEach(function(t){var n=e.name+"-"+t;o.addCommand(n,function(e,r){return!e||!r&&"goto"===t?f.create("datatype","A string given to this ("+n+":) macro was empty."):"goto"!==t||i.hasValid(r)?void 0:f.create("macrocall","I can't ("+n+":) the passage '"+r+"' because it doesn't exist.")},function(r,i,o,c){if("undo"===t&&a.pastLength<1)return f.create("macrocall","I can't (undo:) on the first turn.");var u=w(Object.assign({},e.enchantDesc,{transition:r.data.passageT8n},"undo"===t?{undo:!0}:{goto:c}),n);return(0,_slicedToArray(u,2)[1])({section:i},s.from(o)),Object.assign(r,{source:""})},[y(s,String)].concat("undo"===t?[]:String))})})}),define("macrolib/metadata",["macros","renderer","utils/operationutils","datatypes/lambda","internaltypes/twineerror"],function(e,t,n,r,a){var i=n.clone,o=n.objectName,s=n.isValidDatamapName,c=e.TypeSignature,u=c.zeroOrMore,l=c.Any,p=t.options.metadataMacros,f=function(e){return{TwineScript_TypeName:"a ("+e+":) macro",TwineScript_ObjectName:"a ("+e+":) macro",TwineScript_Unstorable:!0,TwineScript_Print:function(){return""}}};[["storylet",r.TypeSignature("when")],["urgency",Number],["exclusivity",Number]].forEach(function(t){var n=_slicedToArray(t,2),r=n[0],a=n[1];e.add(r,function(e,t){return e.stackTop.speculativePassage?t:f(r)},a),p.push(r)}),e.add("metadata",function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var c=void 0,u=new Map,l=n.reduce(function(e,t){var n=void 0;if(a.containsError(e))return e;if(void 0===c)c=t;else{if(n=a.containsError(s(u,c)))return n;if(u.has(c))return a.create("macrocall","You used the same data name ("+o(c)+") twice in the same (metadata:) call.");u.set(c,i(t)),c=void 0}return e},!0);return a.containsError(l)?l:void 0!==c?a.create("macrocall","This (metadata:) macro has a data name without a value."):e.stackTop.speculativePassage?u:f("storylet")},u(l)),p.push("metadata")}),define("macrolib/patterns",["jquery","macros","utils","utils/operationutils","datatypes/datatype","datatypes/typedvar","internaltypes/twineerror"],function(e,t,n,r,a,i,o){var s=n.anyRealLetter,c=n.anyUppercase,u=n.anyLowercase,l=n.anyCasedLetter,p=n.realWhitespace,f=n.impossible,d=r.objectName,h=r.toSource,y=t.TypeSignature,m=y.rest,g=y.either,v=y.optional,b=y.nonNegativeInteger,w=Object.assign,T=Object.create,S=m(g(String,a,i)),x=function e(t){var n,r=t.name,y=t.fullArgs,m=t.args,g=t.makeRegExpString,v=void 0===g?function(e){return e.join("")}:g,b=t.insensitive,S=void 0!==b&&b,x=t.canContainTypedVars,k=void 0===x||x,O=t.canBeUsedAlone,j=void 0===O||O,A=m||y,C=A.map(function e(t){if(i.isPrototypeOf(t)){if(!k)return o.create("operation","Optional string patterns, like ("+r+":)"+("p-many"===r?" with min 0":"")+", can't have typed variables inside them.");var n=e(t.datatype);return o.containsError(n)?n:"("+n+")"}if(a.isPrototypeOf(t)){if(!k&&"typedVars"in t&&t.typedVars().length)return o.create("operation","("+r+":) can't have typed variables inside its pattern.");if(t.regExp)return(t.rest?"(?:":"")+(S?t.insensitive().regExp:t.regExp)+(t.rest?")*":"");var h=t.name,y=t.rest?"*":"";return"alnum"===h?s+y:"whitespace"===h?p+y:"uppercase"===h?(S?l:c)+y:"lowercase"===h?(S?l:u)+y:"anycase"===h?l+y:"digit"===h?"\\d"+y:"linebreak"===h?"(?:\\r|\\n|\\r\\n)"+y:"str"===h?".*?":["even","odd","int","num"].includes(h)?o.create("datatype","Please use string datatypes like 'digit' in ("+r+":) instead of number datatypes."):o.create("datatype","The ("+r+":) macro must only be given string-related datatypes, not "+d(t)+".")}return"string"==typeof t?(t=t.replace(/[.*+\-?^${}()|[\]\\]/g,"\\$&"),S&&(t=t.replace(RegExp("("+c+"|"+u+")","g"),function(e){return"["+e.toUpperCase()+e.toLowerCase()+"]"})),t):(f("createPattern","mapper() was given a non-string non-datatype "+t),"")});if(n=o.containsError(C))return n;var E=v(C),_=w(T(a),{name:r,regExp:E,insensitive:function(){return S?_:e({name:r,fullArgs:y,args:A.map(function(e){return a.isPrototypeOf(e)&&"function"==typeof e.insensitive?e.insensitive():e}),makeRegExpString:v,insensitive:!0,canContainTypedVars:k,canBeUsedAlone:j})},typedVars:function(){return A.reduce(function(t,n){return i.isPrototypeOf(n)&&(t=t.concat(S?i.create(e({name:"p-ins",fullArgs:[n.datatype],insensitive:!0}),n.varRef):n),n=n.datatype),a.isPrototypeOf(n)&&"function"==typeof n.typedVars&&(t=t.concat(n.typedVars())),t},[])},destructure:function(t){if("string"!=typeof t)return[o.create("operation","I can't unpack "+d(t)+" into "+this.TwineScript_ToSource()+" because it isn't a string.")];var n=this.typedVars();if(!n.length)return[];var r=(RegExp("^"+(this.rest?"(?:":"")+E+(this.rest?")*":"")+"$").exec(t)||[]).slice(1);return r.length?r.map(function(t,r){var a=n[r];if(a)return a.datatype.rest&&!a.datatype.regExp&&((a=a.TwineScript_Clone()).datatype=e({name:"p",fullArgs:[a.datatype]})),{dest:a,value:t||"",src:void 0}}).filter(Boolean):[o.create("operation","I can't unpack "+d(t)+" because it doesn't match the pattern "+this.TwineScript_ToSource()+".")]},TwineScript_IsTypeOf:function(e){return j?"string"==typeof e&&!!e.match("^"+(this.rest?"(?:":"")+E+(this.rest?")*":"")+"$"):o.create("operation","A ("+r+":) datatype must only be used with a (p:) macro.")},TwineScript_toTypeSignatureObject:function(){var e=this;return{pattern:"range",name:r,range:function(t){return e.TwineScript_IsTypeOf(t)}}},TwineScript_ToSource:function(){return(this.rest?"...":"")+"("+r+":"+y.map(h)+")"}});return Object.defineProperty(_,"TwineScript_ObjectName",{get:function(){return"a ("+r+":) datatype"}}),_};t.add(["p","pattern"],function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return x({name:"p",fullArgs:n})},S)(["p-either","pattern-either"],function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return x({name:"p-either",fullArgs:n,canContainTypedVars:!1,makeRegExpString:function(e){return"(?:"+e.join("|")+")"}})},S)(["p-opt","pattern-opt","p-optional","pattern-optional"],function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return x({name:"p-opt",fullArgs:n,canContainTypedVars:!1,makeRegExpString:function(e){return"(?:"+e.join("")+")?"}})},S)(["p-not","pattern-not"],function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return n.find(function(e){return"string"==typeof e?1!==[].concat(_toConsumableArray(e)).length:e.rest||e.regExp||["str","empty"].includes(e.name)})?o.create("datatype","(p-not:) should only be given single character"):x({name:"p-not",fullArgs:n,canContainTypedVars:!1,makeRegExpString:function(e){return"[^"+e.map(function(e){return e.startsWith("[")&&e.endsWith("]")?e.slice(1,-1):e}).join("")+"]"}})},S)(["p-many","pattern-many"],function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var s=n.slice(),c=void 0,u=void 0;if("number"==typeof n[0]&&(c=n.shift(),u="number"==typeof n[0]?n.shift():1/0),void 0!==u&&u<c)return o.create("datatype","The (p-many:) macro needs to be given string patterns, not just min and max numbers.");if(!n.length)return o.create("datatype","The (p-many:) macro needs to be given string patterns, not just min and max numbers.");var l=n.find(function(e){return"string"!=typeof e&&!a.isPrototypeOf(e)&&!i.isPrototypeOf(e)});return l?o.create("datatype","This (p-many:) macro can only be given a min and max number followed by datatypes or strings, but was also given "+d(l)+"."):x({name:"p-many",args:n,fullArgs:s,canContainTypedVars:c>0,makeRegExpString:function(e){return"(?:"+e.join("")+")"+(void 0!==c?"{"+c+(u===1/0?",":u!==c?","+u:"")+"}":"+")}})},[m(g(b,String,a,i))])(["p-ins","pattern-ins","p-insensitive","pattern-insensitive"],function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return x({name:"p-ins",fullArgs:n,insensitive:!0})},S)(["split","splitted"],function(e,t,n){if(t=x({name:"split",fullArgs:[t],canContainTypedVars:!1}),o.containsError(t))return t;if(!n)return[""];if(!t.regExp)return[].concat(_toConsumableArray(n));for(var r=RegExp(t.regExp),a=[],i=void 0;n&&(i=r.exec(n));){if(i.index+i[0].length===0)return a;a.push(n.slice(0,i.index)),n=n.slice(i.index+i[0].length)}return a.concat(n||[])},[g(String,a),String])("trimmed",function(e,t,n){return void 0===n||a.isPrototypeOf(t)&&"whitespace"===t.name?t.trim():(t=x({name:"trimmed",fullArgs:[t],canContainTypedVars:!1}),o.containsError(t)?t:t.regExp?n.replace(RegExp("^("+t.regExp+")*|("+t.regExp+")*$","g"),""):n)},[g(String,a),v(String)])}),define("macrolib/links",["jquery","macros","utils","state","passages","engine","datatypes/changercommand","internaltypes/changedescriptor","datatypes/hookset","datatypes/lambda","internaltypes/twineerror"],function(e,t,n,r,a,i,o,s,c,u,l){var p=t.TypeSignature,f=p.optional,d=p.rest,h=p.either,y=["Links can't have empty strings for their displayed text.","In the link syntax, a link's displayed text is inside the [[ and ]], and on the non-pointy side of the -> or <- arrow if it's there."],m=Object.assign;function g(e,t,r){r=r||t;var i=a.hasValid(t)&&t===r,o=e.evaluateTwineMarkup(n.unescape(r),"a link's passage name"),s=void 0;if(i){var c=o.children().length>0?"`".repeat((r.match(/`+/)||[]).reduce(function(e,t){return Math.max(e,t.length+1)},1)):"";t=c+"\0".repeat(!!c)+t+"\0".repeat(!!c)+c}else o.findAndFilter("tw-error").length&&(s=o.findAndFilter("tw-error").data("TwineError")),r=o.text();return{text:t,passage:r,error:s}}n.onStartup(function(){e(n.storyElement).on("click.passage-link","tw-link",function(t){var n=e(this),r=n.closest("tw-expression"),a=n.closest("tw-expression, tw-hook"),o=a.data("clickEvent"),s=a.data("section");if(!(s&&s.stackTop&&s.stackTop.blocked)){if(o){if(n.find("tw-error").length>0)return;return t.stopPropagation(),void o(n)}var c=r.data("linkPassageName"),u=Object.assign({},r.data("passageT8n")||{});return r.find("tw-enchantment").each(function(t,n){Object.assign(u,e(n).data("passageT8n")||{})}),c?(t.stopPropagation(),void i.goToPassage(c,{transition:u})):n.is("[undo]")?(t.stopPropagation(),void i.goBack({transition:u})):n.is("[fullscreen]")?(t.stopPropagation(),void i.toggleFullscreen()):void 0}}),e(document).on("fullscreenchange",function(){e("tw-link[fullscreen]",n.storyElement).each(function(t,n){(e(n).closest("tw-expression, tw-hook").data("fullscreenEvent")||Object)(n)})})}),[["link","link-replace"],["link-reveal"],["link-repeat"],["link-rerun"]].forEach(function(e){return t.addChanger(e,function(t,n,r){if(!n)return l.create("datatype",y[0]);if(r){var a=r.summary();if(["newTargets","target","appendSource","functions"].some(function(e){return a.includes(e)}))return l.create("datatype","The changer given to ("+e[0]+":) can't include a revision or enchantment changer like (replace:) or (click:).")}return o.create(e[0],[n].concat(r||[]))},function(t,n,r){var a=e[0],i=t.section&&t.section.stackTop?t.section.stackTop.tempVariables:Object.create(null),o=s.create({source:"<tw-link tabindex=0>"+n+"</tw-link>",target:function(){return t.target},append:"replace",data:{section:t.section,clickEvent:function(e){t.enablers=t.enablers.filter(function(e){return e.descriptor!==o}),"link-reveal"===a&&e.contents().unwrap();var n=e.parentsUntil(":not(tw-enchantment)").parent();if(n.length||(n=e.parent()),"link-rerun"===a){var r=e.parentsUntil(":not(tw-enchantment)");e.detach(),r.remove()}"link"!==a&&"link-rerun"!==a||n.empty(),t.section.renderInto("",null,t,i),"link-rerun"===a&&n.prepend(e)}}});return t.enablers=(t.enablers||[]).concat({descriptor:o,changer:r}),t},[String,f(o)])}),t.addCommand("link-goto",function(e){if(!e)return l.create.apply(l,["datatype"].concat(y))},function(e,t,i,o){var s,c=g(t,i,o);if(i=c.text,o=c.passage,s=c.error)return s;if(e.transition){var u="transition";return l.create("datatype","Please attach ("+u+"-depart:) or ("+u+"-arrive:) to a passage link, not ("+u+":).")}var p=void 0;return a.hasValid(o)||(p='<tw-broken-link passage-name="'+n.escape(o)+'">'+i+"</tw-broken-link>"),p=p||"<tw-link tabindex=0 "+(r.passageNameVisited(o)>0?'class="visited" ':"")+">"+i+"</tw-link>",e.data.linkPassageName=o,e.data.section=t,m(e,{source:p,transitionDeferred:!0})},[String,f(String)])("link-storylet",function(){var e,t=(e=1===arguments.length||"string"!=typeof(arguments.length<=0?void 0:arguments[0])?0:1,arguments.length<=e?void 0:arguments[e]);if(!t||"string"==typeof t)return l.create("datatype","(link-storylet:) should be given one index number or one 'where' lambda, after the optional link text string.")},function(e,t){var n,i,o,s=(n=2+(1==(arguments.length<=2?0:arguments.length-2)?0:3==(arguments.length<=2?0:arguments.length-2)||"string"==typeof(arguments.length<=2?void 0:arguments[2])?1:2),arguments.length<=n?void 0:arguments[n]),c="string"==typeof(arguments.length<=2?void 0:arguments[2])&&(arguments.length<=2?void 0:arguments[2]),p=(i=(arguments.length<=2?0:arguments.length-2)-1+2,(arguments.length<=i?void 0:arguments[i])!==s&&(o=(arguments.length<=2?0:arguments.length-2)-1+2,arguments.length<=o?void 0:arguments[o]));if(e.transition){var f="transition";return l.create("datatype","Please attach ("+f+"-depart:) or ("+f+"-arrive:) to (link-storylet:), not ("+f+":).")}var d=u.isPrototypeOf(s),h=a.getStorylets(t,d&&s),y=l.containsError(h);if(y)return y;var g=h[d?0:s<0?h.length+s:s-1],v=void 0;if(g)g=g.get("name"),c=c||g,v=v||"<tw-link tabindex=0 "+(r.passageNameVisited(g)>0?'class="visited" ':"")+">"+c+"</tw-link>",e.data.linkPassageName=g,e.data.section=t;else{if(!p)return e;v=p}return m(e,{source:v,transitionDeferred:!0})},[h(parseInt,String,u.TypeSignature("where")),f(h(parseInt,String,u.TypeSignature("where"))),f(String)])("link-undo",function(e){if(!e)return l.create("datatype",y[0])},function(e,t,n){return r.pastLength<1?l.create("macrocall","I can't use (link-undo:) on the first turn."):(e.data.section=t,m(e,{source:"<tw-link tabindex=0 undo>"+n+"</tw-link>",transitionDeferred:!0}))},[String])("link-show",function(e){if(!e)return l.create("datatype",y[0])},function(t,n,r){for(var a=arguments.length,i=Array(a>3?a-3:0),o=3;o<a;o++)i[o-3]=arguments[o];return t.data.section=n,t.data.clickEvent=function(r){r.contents().unwrap(),i.forEach(function(r){return r.forEach(n,function(r){var a=r.data("originalSource")||"",i=r.data("hidden");if(i)if(r.removeData("hidden"),i instanceof e)r.empty().append(i);else{var o=r.data("tempVariables");n.renderInto("",null,m({},t,{source:a,target:r,transitionDeferred:!1}),o&&Object.create(o))}})})},m(t,{source:"<tw-link tabindex=0>"+r+"</tw-link>",transitionDeferred:!0})},[String,d(c)])("link-fullscreen",function(e,t){if(!e||!t)return l.create("datatype",y[0])},function(e,t,n,r){var a=function(){return document.fullscreenEnabled||document.msFullscreenEnabled?"<tw-link tabindex=0 fullscreen>"+(document.fullscreenElement||document.msFullscreenElement?r:n)+"</tw-link>":r?"<tw-broken-link>"+r+"</tw-broken-link>":""},i=t.stackTop.tempVariables;return e.data.section=t,e.data.fullscreenEvent=function(){(document.fullscreenEnabled||document.msFullscreenEnabled)&&e.data.section.whenUnblocked(function(){var t=m({},e,{append:"replace",source:a(),transitionDeferred:!1});e.section.renderInto("",null,t,i)})},m(e,{source:a(),transitionDeferred:!0})},[String,String,f(String)]),t.addChanger(["link-reveal-goto"],function(e,t,n,r){if(!t)return l.create.apply(l,["datatype"].concat(y));if(o.isPrototypeOf(n)){if(o.isPrototypeOf(r))return l.create("datatype","You mustn't give two changers to (link-reveal-goto:)");r=n,n=void 0}if(r){var a=r.summary();if(["newTargets","target","appendSource","functions"].some(function(e){return a.includes(e)}))return l.create("datatype","The changer given to (link-reveal-goto:) can't include a revision or enchantment changer like (replace:) or (click:).")}var i=g(e,t,n);return t=i.text,n=i.passage,i.error||o.create("link-reveal-goto",[t,n,r].filter(function(e){return void 0!==e}))},function(e,t,o,c){if(a.hasValid(o)){var u=r.passageNameVisited(o),l=e.section&&e.section.stackTop?e.section.stackTop.tempVariables:Object.create(null),p=s.create({source:"<tw-link tabindex=0 "+(u>0?'class="visited" ':"")+">"+t+"</tw-link>",target:e.target,append:"replace",data:{section:e.section,append:"replace",clickEvent:function(t){e.enablers=e.enablers.filter(function(e){return e.descriptor!==p}),t.contents().unwrap(),e.section.renderInto("",null,e,l),e.section.whenUnblocked(function(){return i.goToPassage(o,{transition:e.data.passageT8n})})}}});return e.enablers=(e.enablers||[]).concat({descriptor:p,changer:c}),e}e.source='<tw-broken-link passage-name="'+n.escape(o)+'">'+t+"</tw-broken-link>"},[String,f(h(o,String)),f(o)])}),define("macrolib/custommacros",["utils","macros","state","utils/operationutils","datatypes/changercommand","datatypes/custommacro","datatypes/codehook","datatypes/typedvar","internaltypes/twineerror"],function(e,t,n,r,a,i,o,s,c){var u=t.add,l=t.addChanger,p=t.addCommand,f=t.TypeSignature,d=f.rest,h=f.either,y=f.Any,m=r.objectName;u("macro",function(t){for(var r=arguments.length,a=Array(r>1?r-1:0),o=1;o<r;o++)a[o-1]=arguments[o];var u=void 0,l=[];for(u=0;u<a.length;u+=1){var p=u===a.length-1;if(s.isPrototypeOf(a[u])===p)return c.create("datatype","The "+(p?"":e.nth(a.length-u+1)+"-")+"last value given to (macro:) should be a "+(p?"code hook":"datatyped variable")+", not "+m(a[u]));if(!p){var f="A custom macro";if(a[u].varRef.object===n.variables)return c.create("datatype",f+"'s typed variables must be temp variables (with a '_'), not global variables (with a '$').","Write them with a _ symbol at the start instead of a $ symbol.");if(a[u].varRef.propertyChain.length>1)return c.create("datatype",f+"'s typed variables can't be properties inside a data structure.");if(a[u].datatype.rest&&u!==a.length-2)return c.create("datatype",f+" can only have one spread variable, and it must be its last variable.");var d=a[u].varRef.propertyChain[0];if(l.includes(d))return c.create("datatype",f+"'s typed variables can't both be named '"+d+"'.");l.push(d)}}return i.create(a.slice(0,-1),a[a.length-1])},[d(h(s,o))]);var g=function(e,t,n){if(!t.some(function(e){if("function"==typeof e.output)return e.output(n),!0}))return c.create("macrocall","("+e+":) should only be used inside a code hook passed to (macro:).")};p(["output-data","out-data"],function(){},function(e,t){var n=e.stack;return g("output-data",n,t)||"blocked"},[y],!1),l(["output","out"],function(e){return Object.assign(a.create("output",[e]))},function(e,t){var n=t.stack,r=t.stackTop;return e.loopVars=Object.keys(r.tempVariables).reduce(function(e,t){return e[t]=[r.tempVariables[t]],e},{}),g("output",n,e),r.blocked=!0,e},[]),p("error",function(e){if(!e)return c.create("datatype","This (error:) macro was given an empty string.")},function(e,t){var n=e.stack;return g("error",n,c.create("user",t))||"blocked"},[String],!1)}),define("repl",["utils","engine","markup","twinescript/compiler","twinescript/environ"],function(e,t,n,r,a){e.onStartup(function(){return setTimeout(function(){t.options.debug&&(window.REPL=function(e){var t=r(n.lex("(print:"+e+")"));console.log(t);var i=a({}).eval(t);return i.TwineScript_Run?i.TwineScript_Run().source:i},window.LEX=function(e){var t=n.lex(e);return 1===t.length?t[0]:t})})})}),require.config({paths:{jquery:"../node_modules/jquery/dist/jquery",almond:"../node_modules/almond/almond","es6-shim":"../node_modules/es6-shim/es6-shim",jqueryplugins:"utils/jqueryplugins",markup:"./markup/markup",lexer:"./markup/lexer",patterns:"./markup/patterns"},deps:["es6-shim","jqueryplugins"]}),require(["jquery","debugmode/mode","renderer","state","section","engine","passages","utils","utils/renderutils","internaltypes/varscope","internaltypes/twineerror","macros","macrolib/values","macrolib/commands","macrolib/datastructures","macrolib/stylechangers","macrolib/enchantments","macrolib/metadata","macrolib/patterns","macrolib/links","macrolib/custommacros","repl"],function($,DebugMode,Renderer,State,Section,Engine,Passages,Utils,_ref118,VarScope,TwineError){var dialog=_ref118.dialog;function __HarloweEval(text){return eval(text+"")}var _installHandlers=function(){$(document.documentElement).on("keydown",function(e){13===e.which&&"0"===e.target.getAttribute("tabindex")&&$(e.target).trigger("click")}),Engine.options.debug?DebugMode():TwineError.on("error",function(e,t){return!$("tw-debugger").length&&DebugMode(e,t)}),_installHandlers=null},oldOnError;function printJSError(e){var t=e.name+": "+e.message;if(e.stack){var n=e.stack.split("\n"),r=n.findIndex(function(e){return e.includes("__HarloweEval")});t+="\n"+n.slice(0,r).join("\n").replace(/\([^\)]+\)/g,"")}return"<div style='font-family:monospace;overflow-y:scroll;max-height:30vh'>```"+t+"```</div>"}oldOnError=window.onerror,window.onerror=function(e,t,n,r,a){window.onerror=oldOnError,Utils.storyElement.parent().append(dialog({message:"Sorry to interrupt, but this page's code has got itself in a mess.\n\n"+printJSError(a)+"\n(This is probably due to a bug in the Harlowe game engine.)"})),"function"==typeof oldOnError&&oldOnError.apply(void 0,arguments)},Utils.onStartup(function(){var e=$("tw-storydata");if(0!==e.length){var t=e.attr("options");t&&t.split(/\s/).forEach(function(e){Renderer.options[e]=Engine.options[e]=!0});var n=e.attr("startnode");Renderer.options.ifid=Engine.options.ifid=e.attr("ifid"),n||(n=[].reduce.call($("tw-passagedata"),function(e,t){var n=t.getAttribute("pid");return n<e?n:e},1/0)),n=$("tw-passagedata[pid="+n+"]").attr("name"),_installHandlers();var r=!1;$("[role=script]").each(function(e){try{__HarloweEval($(this).html())}catch(t){r||(r=!0,dialog({parent:Utils.storyElement.parent(),message:"There is a problem with this story's "+Utils.nth(e+1)+" script:\n\n"+printJSError(t)}))}}),$("[role=stylesheet]").each(function(e){$(document.head).append('<style data-title="Story stylesheet '+(e+1)+'">'+$(this).html())});var a=Section.create();a.stack=[{tempVariables:Object.create(VarScope)}];var i=Passages.loadMetadata(a);if(i.length){var o=dialog({parent:Utils.storyElement.parent(),message:"These errors occurred when running the `(metadata:)` macro calls in this story's passages:<p></p>"});i.forEach(function(e){return o.find("p").append(e.render(""))})}var s=!Engine.options.debug&&State.hasSessionStorage&&sessionStorage.getItem("Saved Session");s&&!0===State.deserialise(a,s)?Engine.showPassage(State.passage,!1):Engine.goToPassage(n)}})}),define("harlowe",function(){}),require(["harlowe"])}();
</script>

</body>
</html>
